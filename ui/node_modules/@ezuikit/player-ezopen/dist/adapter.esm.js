/*
*
* JsPlugin.js v8.2.5
* Copyright (c) 2026-1-15 Ezviz-OpenBiz
* Released under MIT the License.
*
*/
import t from"deepmerge";import e from"@ezuikit/utils-logger";import a from"@ezuikit/utils-i18n";import{parseEzopenUrl as r,getStaticPath as n,isMobile as s}from"@ezuikit/utils-tools";import x from"@ezuikit/utils-service";import o from"ua-parser-js";import f from"eventemitter3";import l from"dayjs";import _ from"@ezuikit/player-plugin-record";var h=["attribute vec4 vertexPos;","attribute vec2 texturePos;","varying vec2 textureCoord;","void main()","{","gl_Position = vertexPos;","textureCoord = texturePos;","}"].join("\n"),c=["precision highp float;","varying highp vec2 textureCoord;","uniform sampler2D ySampler;","uniform sampler2D uSampler;","uniform sampler2D vSampler;","const mat4 YUV2RGB = mat4","(","1.1643828125, 0, 1.59602734375, -.87078515625,","1.1643828125, -.39176171875, -.81296875, .52959375,","1.1643828125, 2.017234375, 0, -1.081390625,","0, 0, 0, 1",");","void main(void) {","highp float y = texture2D(ySampler,  textureCoord).r;","highp float u = texture2D(uSampler,  textureCoord).r;","highp float v = texture2D(vSampler,  textureCoord).r;","gl_FragColor = vec4(y, u, v, 1) * YUV2RGB;","}"].join("\n");window.SuperRender=function(){function t(t){this.canvasElement=document.getElementById(t),this.initContextGL(),this.contextGL&&(this.YUVProgram=this.initProgram(h,c),this.initBuffers(),this.initTextures())}return t.prototype.initContextGL=function(){var t=this.canvasElement,e=null;try{e=t.getContext("webgl")||t.getContext("experimental-webgl")}catch(t){e=null}e&&"function"==typeof e.getParameter||(e=null),this.contextGL=e},t.prototype.initProgram=function(t,e){var a=this.contextGL,r=a.createShader(a.VERTEX_SHADER);a.shaderSource(r,t),a.compileShader(r),a.getShaderParameter(r,a.COMPILE_STATUS);var i=a.createShader(a.FRAGMENT_SHADER);a.shaderSource(i,e),a.compileShader(i),a.getShaderParameter(i,a.COMPILE_STATUS);var n=a.createProgram();return a.attachShader(n,r),a.attachShader(n,i),a.linkProgram(n),a.getProgramParameter(n,a.LINK_STATUS),a.deleteShader(r),a.deleteShader(i),n},t.prototype.initBuffers=function(){var t=this.contextGL,e=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null);var a=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,a),t.bufferData(t.ARRAY_BUFFER,new Float32Array([1,0,0,0,1,1,0,1]),t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,null),this.vertexPosBuffer=e,this.texturePosBuffer=a},t.prototype.initTexture=function(){var t=this.contextGL,e=t.createTexture();return t.bindTexture(t.TEXTURE_2D,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindTexture(t.TEXTURE_2D,null),e},t.prototype.initTextures=function(){var t=this.contextGL,e=this.YUVProgram;t.useProgram(e);var a=this.initTexture(),r=t.getUniformLocation(e,"ySampler");t.uniform1i(r,0),this.yTextureRef=a;var i=this.initTexture(),n=t.getUniformLocation(e,"uSampler");t.uniform1i(n,1),this.uTextureRef=i;var s=this.initTexture(),x=t.getUniformLocation(e,"vSampler");t.uniform1i(x,2),this.vTextureRef=s,t.useProgram(null)},t.prototype.SR_DisplayFrameData=function(t,e,a,r,i){if(!(t<=0||e<=0)){var n=this.contextGL;if(null==a)return n.clearColor(0,0,0,0),void n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT);var s=this.canvasElement;this.nWindowWidth=s.width,this.nWindowHeight=s.height;var x=this.nWindowWidth,o=this.nWindowHeight;n.clearColor(.8,.8,1,1),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT),n.viewport(0,0,x,o),this.updateFrameData(t,e,a,r,i);var f=this.YUVProgram;n.useProgram(f);var l=this.vertexPosBuffer;n.bindBuffer(n.ARRAY_BUFFER,l);var _=n.getAttribLocation(f,"vertexPos");n.enableVertexAttribArray(_),n.vertexAttribPointer(_,2,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,null);var h=this.texturePosBuffer;n.bindBuffer(n.ARRAY_BUFFER,h);var c=n.getAttribLocation(f,"texturePos");n.enableVertexAttribArray(c),n.vertexAttribPointer(c,2,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,null),n.drawArrays(n.TRIANGLE_STRIP,0,4),n.disableVertexAttribArray(_),n.disableVertexAttribArray(c),n.useProgram(null)}},t.prototype.updateFrameData=function(t,e,a,r,i){var n=this.contextGL,s=this.yTextureRef,x=this.uTextureRef,o=this.vTextureRef,f=a;if(t==r&&e==i){var l=t*e,_=f.subarray(0,l);n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,n.LUMINANCE,t,e,0,n.LUMINANCE,n.UNSIGNED_BYTE,_);var h=t/2*e/2,c=f.subarray(t*e,t*e+h);n.activeTexture(n.TEXTURE2),n.bindTexture(n.TEXTURE_2D,o),n.texImage2D(n.TEXTURE_2D,0,n.LUMINANCE,t/2,e/2,0,n.LUMINANCE,n.UNSIGNED_BYTE,c);var u=h,d=f.subarray(t*e+t*e/4,t*e+t*e/4+u);n.activeTexture(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,x),n.texImage2D(n.TEXTURE_2D,0,n.LUMINANCE,t/2,e/2,0,n.LUMINANCE,n.UNSIGNED_BYTE,d)}else{l=r*i,_=new Uint8Array(l);for(var p=0;p<i;p++)for(var m=f.subarray(p*t,p*t+r),S=0;S<r;S++)_[p*r+S]=m[S];for(n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,n.LUMINANCE,r,i,0,n.LUMINANCE,n.UNSIGNED_BYTE,_),_=null,m=null,h=r/2*i/2,c=new Uint8Array(h),p=0;p<i/2;p++){var R=f.subarray(t*e+p*t/2,t*e+p*t/2+r/2);for(S=0;S<r/2;S++)c[p*r/2+S]=R[S]}for(n.activeTexture(n.TEXTURE2),n.bindTexture(n.TEXTURE_2D,o),n.texImage2D(n.TEXTURE_2D,0,n.LUMINANCE,r/2,i/2,0,n.LUMINANCE,n.UNSIGNED_BYTE,c),c=null,R=null,u=h,d=new Uint8Array(u),p=0;p<i/2;p++){var P=f.subarray(t*e*5/4+p*t/2,t*e*5/4+p*t/2+r/2);for(S=0;S<r/2;S++)d[p*r/2+S]=P[S]}n.activeTexture(n.TEXTURE1),n.bindTexture(n.TEXTURE_2D,x),n.texImage2D(n.TEXTURE_2D,0,n.LUMINANCE,r/2,i/2,0,n.LUMINANCE,n.UNSIGNED_BYTE,d),d=null,P=null}},t.prototype.SR_SetDisplayRect=function(t){var e=this.contextGL,a=this.nWindowWidth,r=this.nWindowHeight,i=null;if(t&&a>0&&r>0){var n=t.left/a,s=t.top/r,x=t.right/a,o=t.bottom/r;i=new Float32Array([x,s,n,s,x,o,n,o])}else i=new Float32Array([1,0,0,0,1,1,0,1]);var f=this.texturePosBuffer;e.bindBuffer(e.ARRAY_BUFFER,f),e.bufferSubData(e.ARRAY_BUFFER,0,i),e.bindBuffer(e.ARRAY_BUFFER,null)},t.prototype.SR_Destroy=function(){var t=this.contextGL,e=this.YUVProgram;t.deleteProgram(e);var a=this.vertexPosBuffer,r=this.texturePosBuffer;t.deleteBuffer(a),t.deleteBuffer(r);var i=this.yTextureRef,n=this.uTextureRef,s=this.vTextureRef;t.deleteTexture(i),t.deleteTexture(n),t.deleteTexture(s)},t}(),function(){var t=function(){function t(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,a,r){return a&&t(e.prototype,a),r&&t(e,r),e}}();function e(t,e){if(a=t,!(null!=(r=e)&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?r[Symbol.hasInstance](a):a instanceof r))throw new TypeError("Cannot call a class as a function");var a,r}var a,r=(a=void 0,function(t){return t&&(a=t),a});function i(){if(e(this,i),r())return r();if(void 0!==i.unique)return i.unique;i.unique=this,this.oAudioContext=null,this.currentVolume=80,this.bSetVolume=!1,this.gainNode=null,this.iWndNum=-1,this.mVolumes=new Map;var t=window.AudioContext||window.webkitAudioContext;this.oAudioContext=new t,this.writeString=function(t,e,a){for(var r=0;r<a.length;r++)t.setUint8(e+r,a.charCodeAt(r))},this.setBufferToDataview=function(t,e,a){for(var r=0;r<a.length;r++,e++)t.setUint8(e,a[r])},r(this)}t(i,[{key:"Play",value:function(t,e,a){var r=new ArrayBuffer(44+e),i=new DataView(r),n=a.samplesPerSec,s=a.channels,x=a.bitsPerSample;this.writeString(i,0,"RIFF"),i.setUint32(4,32+2*e,!0),this.writeString(i,8,"WAVE"),this.writeString(i,12,"fmt "),i.setUint32(16,16,!0),i.setUint16(20,1,!0),i.setUint16(22,s,!0),i.setUint32(24,n,!0),i.setUint32(28,2*n,!0),i.setUint16(32,s*x/8,!0),i.setUint16(34,x,!0),this.writeString(i,36,"data"),i.setUint32(40,e,!0),this.setBufferToDataview(i,44,t);var o=this;return this.oAudioContext.decodeAudioData(i.buffer,(function(t){var e=o.oAudioContext.createBufferSource();if(null==e)return-1;e.buffer=t,e.start(0),(null==o.gainNode||o.bSetVolume)&&(o.gainNode=o.oAudioContext.createGain(),o.bSetVolume=!1),o.gainNode.gain.value=o.currentVolume/100,o.gainNode.connect(o.oAudioContext.destination),e.connect(o.gainNode)}),(function(t){return-1})),0}},{key:"Stop",value:function(){return null!=this.gainNode&&(this.gainNode.disconnect(),this.gainNode=null),!0}},{key:"SetVolume",value:function(t){return this.bSetVolume=!0,this.currentVolume=t,this.mVolumes.set(this.iWndNum,this.currentVolume),!0}},{key:"SetWndNum",value:function(t){this.iWndNum=t;var e=this.mVolumes.get(t);return null==e&&(e=80),this.currentVolume=e,!0}},{key:"GetVolume",value:function(){var t=this.mVolumes.get(this.iWndNum);return null==t&&(t=80),t}}]),window.AudioRenderer=i}();var u={title:"title",name:"name {{name}}"},d={title:"标题",name:"姓名 {{name}}"};function p(t){return/^ezopen:\/\//.test(t)}var m={autoPlay:!0,decoderType:"auto",audio:!0,dpr:1,logger:{level:"INFO",name:"ezopen",showTime:!0},debugDownloadData:!1,disableRenderPrivateData:!1,streamInfoCBType:1};function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function R(t,e,a,r,i,n,s){try{var x=t[n](s),o=x.value}catch(t){return void a(t)}x.done?e(o):Promise.resolve(o).then(r,i)}function P(t){return function(){var e=this,a=arguments;return new Promise((function(r,i){var n=t.apply(e,a);function s(t){R(n,r,i,s,x,"next",t)}function x(t){R(n,r,i,s,x,"throw",t)}s(void 0)}))}}function y(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(a)return(a=a.call(t)).next.bind(a);if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return S(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?S(t,e):void 0}}(t))||e){a&&(t=a);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b(t,e){var a,r,i,n,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:x(0),throw:x(1),return:x(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function x(n){return function(x){return function(n){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,r=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],r=0}finally{a=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,x])}}}var E=function(){function t(t){this.plugins=new Map,this.context=t}var e=t.prototype;return e.usePlugins=function(t){var e=this;return P((function(){var a,r,i;return b(this,(function(n){switch(n.label){case 0:a=y(t),n.label=1;case 1:return(r=a()).done?[3,4]:(i=r.value,[4,e.use(i)]);case 2:n.sent(),n.label=3;case 3:return[3,1];case 4:return[2]}}))}))()},e.use=function(t){var e=this;return P((function(){var a;return b(this,(function(r){switch(r.label){case 0:return t.name?("function"==typeof(null==t?void 0:t.init)&&(null==t||t.init()),a=!0,(null==t?void 0:t.beforeExec)?[4,t.beforeExec(e.context)]:[3,2]):[3,3];case 1:a=r.sent(),r.label=2;case 2:return a&&t.exec(e.context),"function"==typeof(null==t?void 0:t.afterExec)&&(null==t||t.afterExec(e.context)),e.plugins.set(t.name.toLowerCase(),t),[3,4];case 3:r.label=4;case 4:return[2]}}))}))()},e.destroyByName=function(t){var e=this.plugins.get(t.toLowerCase());e&&"function"==typeof(null==e?void 0:e.destroy)&&e.destroy(),this.plugins.delete(t)},e.destroy=function(){var t=this;(this.plugins||[]).forEach((function(e,a){t.destroyByName(a)})),this.plugins=null},t}();function g(t,e,a){return{code:null!=e?e:0,data:t,msg:a}}function F(t,e,a,r){return{data:t,msg:e,source:a,target:r}}var C="playError",T="EVENT_CALLBACK",D={pluginErrorHandler:"pluginErrorHandler",getStreamHeaderCallback:"getStreamHeaderCallback",getVideoStreamCallback:"getVideoStreamCallback",appearFirstFrameCallback:"appearFirstFrameCallback",firstFrameCallback:"firstFrameCallback",averageStreamSuccessCallback:"averageStreamSuccessCallback",setRunTimeInfoCallBack:"setRunTimeInfoCallBack",setAdditionDataCallBack:"setAdditionDataCallBack",openStreamCallback:"openStreamCallback",stutterDetectedCallback:"stutterDetectedCallback"},A={initializing:"initializing",loadstart:"loadstart",abort:"abort",waiting:"waiting",canplay:"canplay",rateChange:"ratechange",volumeChange:"volumechange",debug:"debug",error:"error",videoInfo:"videoInfo",audioInfo:"audioInfo",decoder:"decoder",urlChange:"urlChange",API:{play:"play",pause:"pause",rateChange:"ratechange",volumeChange:"volumechange",destroy:"destroy",snapshot:"snapshot",fullscreen:"fullscreen",exitFullscreen:"exitFullscreen",resize:"resize",seek:"seek",resume:"resume"},NETWORK:{deviceCapacity:"network.deviceCapacity",deviceInfo:"network.deviceInfo",videoFragmentFiles:"network.videoFragmentFiles",error:{error:"network.error",deviceCapacity:"network.error.deviceCapacity",deviceInfo:"network.error.deviceInfo",realPlayUrl:"network.error.realPlayUrl",videoFragmentFiles:"network.error.videoFragmentFiles"}},SOCKET:{autoClose:"StreamClient.autoClose",openStream:"StreamClient.openStream",startPlay:"StreamClient.startPlay",stopAll:"StreamClient.stopAll",setPlayRate:"StreamClient.setPlayRate",seek:"StreamClient.seek",close:"StreamClient.close",error:"StreamClient.error"},CALLBACK:D,FECCorrect:{setFEC2DParam:"setFEC2DParam"},streamInfoCB:"streamInfoCB"};var I="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),M=new Uint8Array(16);function L(){if(!I)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return I(M)}var w=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var O=[],B=0;B<256;++B)O.push((B+256).toString(16).substr(1));function k(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=(O[t[e+0]]+O[t[e+1]]+O[t[e+2]]+O[t[e+3]]+"-"+O[t[e+4]]+O[t[e+5]]+"-"+O[t[e+6]]+O[t[e+7]]+"-"+O[t[e+8]]+O[t[e+9]]+"-"+O[t[e+10]]+O[t[e+11]]+O[t[e+12]]+O[t[e+13]]+O[t[e+14]]+O[t[e+15]]).toLowerCase();if(!function(t){return"string"==typeof t&&w.test(t)}(a))throw TypeError("Stringified UUID is invalid");return a}function N(t,e,a){var r=(t=t||{}).random||(t.rng||L)();return r[6]=15&r[6]|64,r[8]=63&r[8]|128,k(r)}var V=function(){function t(){}var e=t.prototype;return e.createClientObject=function(t,e,a,r){return{socket:t,id:e,iCurChannel:a,iCurStream:r,resolve:null,reject:null}},e.zeroPlayCmd=function(t,e){return new Uint8Array([0,0,0,44,0,0,0,0,0,0,0,0,0,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,t+1,0,0,0,e,0,0,4,0])},e.playCmd=function(t,e){return new Uint8Array([0,0,0,44,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,t,0,0,0,e,0,0,4,0])},e.playbackCmd=function(t,e,a,r){var i=t.split("T")[0],n=t.split("T")[1],s="0"+parseInt(i.substring(0,4),10).toString(16),x=parseInt(i.substring(4,6),10),o=parseInt(i.substring(6),10),f=parseInt(n.substring(0,2),10),l=parseInt(n.substring(2,4),10),_=parseInt(n.substring(4,6),10),h=e.split("T")[0],c=e.split("T")[1],u="0"+parseInt(h.substring(0,4),10).toString(16),d=parseInt(h.substring(4,6),10),p=parseInt(c.substring(0,2),10),m=parseInt(c.substring(2,4),10),S=parseInt(c.substring(4,6),10),R=[0,0,0,96,0,0,0,0,0,0,0,0,0,3,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,a,0,0,parseInt(s.substring(0,2),16),parseInt(s.substring(2,4),16),0,0,0,x,0,0,0,o,0,0,0,f,0,0,0,l,0,0,0,_,0,0,parseInt(u.substring(0,2),16),parseInt(u.substring(2,4),16),0,0,0,d,0,0,0,o,0,0,0,p,0,0,0,m,0,0,0,S,0,0,0,0,0,0,0,0,r,0,0,0];return new Uint8Array(R)},e.playRateCmd=function(t){for(var e=(parseInt(t,10)>>>0).toString(16).toLocaleUpperCase().toString(16),a=e.length;a<8;a++)e="0"+e;for(var r=[0,0,0,0],i=0,n=e.length;i<n;i+=2)r[Math.floor(i/2)]=parseInt(e.substring(i,i+2),16);var s=[0,0,0,36,0,0,0,0,0,0,0,0,0,3,1,47,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,r[0],r[1],r[2],r[3]];return new Uint8Array(s)},e.pauseCmd=function(){return new Uint8Array([0,0,0,32,0,0,0,0,0,0,0,0,0,3,1,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},e.resumeCmd=function(){return new Uint8Array([0,0,0,32,0,0,0,0,0,0,0,0,0,3,1,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])},t}(),U=function(){function t(){}var e=t.prototype;return e.createClientObject=function(t,e,a){return{socket:t,id:e,playURL:a,resolve:null,reject:null}},e.getMediaFromSdp=function(t){for(var e=t.indexOf("MEDIAINFO=")+10,a=t.slice(e,e+80),r=[],i=0,n=a.length/2;i<n;i++)r[i]=parseInt(a.slice(2*i,2*i+2),16);return new Uint8Array(r)},e.playCmd=function(t){var e={sequence:0,cmd:"realplay",url:t};return JSON.stringify(e)},e.playbackCmd=function(t,e,a){var r={sequence:0,cmd:"playback",url:a,startTime:t,endTime:e};return JSON.stringify(r)},e.playRateCmd=function(t){var e={sequence:0,cmd:"changespeed",speed:t};return JSON.stringify(e)},e.pauseCmd=function(){return JSON.stringify({sequence:0,cmd:"pause"})},e.resumeCmd=function(){return JSON.stringify({sequence:0,cmd:"resume"})},e.getError=function(t){var e=3001;return t&&(6===parseInt(t.statusCode,10)&&"streamLimit"===t.subStatusCode?e=3002:4===parseInt(t.statusCode,10)&&"badAuthorization"===t.subStatusCode&&(e=3003)),{iErrorNum:e,oError:t}},t}();function H(t,e,a){null!=t&&("number"==typeof t?this.fromNumber(t,e,a):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function W(){return new H(null)}H.prototype.am=function(t,e,a,r,i,n){var s=16383&e;for(e>>=14;--n>=0;){var x=16383&this[t],o=this[t++]>>14,f=e*x+o*s;i=((x=s*x+((16383&f)<<14)+a[r]+i)>>28)+(f>>14)+e*o;a[r++]=268435455&x}return i},H.prototype.DB=28,H.prototype.DM=268435455,H.prototype.DV=1<<28;H.prototype.FV=Math.pow(2,52),H.prototype.F1=24,H.prototype.F2=4;var Y,G,X=[];for(Y="0".charCodeAt(0),G=0;G<=9;++G)X[Y++]=G;for(Y="a".charCodeAt(0),G=10;G<36;++G)X[Y++]=G;for(Y="A".charCodeAt(0),G=10;G<36;++G)X[Y++]=G;function J(t){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(t)}function Z(t,e){var a=X[t.charCodeAt(e)];return null==a?-1:a}function j(t){var e=W();return e.fromInt(t),e}function z(t){var e,a=1;return 0!=(e=t>>>16)&&(t=e,a+=16),0!=(e=t>>8)&&(t=e,a+=8),0!=(e=t>>4)&&(t=e,a+=4),0!=(e=t>>2)&&(t=e,a+=2),t>>1&&(a+=1),a}function K(t){this.m=t}function q(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function Q(t,e){return t&e}function $(t,e){return t|e}function tt(t,e){return t^e}function et(t,e){return t&~e}function at(t){if(0==t)return-1;var e=0;return!(65535&t)&&(t>>=16,e+=16),!(255&t)&&(t>>=8,e+=8),!(15&t)&&(t>>=4,e+=4),!(3&t)&&(t>>=2,e+=2),!(1&t)&&++e,e}function rt(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function it(){}function nt(t){return t}function st(t){this.r2=W(),this.q3=W(),H.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}K.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},K.prototype.revert=function(t){return t},K.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},K.prototype.mulTo=function(t,e,a){t.multiplyTo(e,a),this.reduce(a)},K.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},q.prototype.convert=function(t){var e=W();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(H.ZERO)>0&&this.m.subTo(e,e),e},q.prototype.revert=function(t){var e=W();return t.copyTo(e),this.reduce(e),e},q.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var a,r=(a=32767&t[e])*this.mpl+((a*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[a=e+this.m.t]+=this.m.am(0,r,t,e,0,this.m.t);t[a]>=t.DV;)t[a]-=t.DV,t[++a]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},q.prototype.mulTo=function(t,e,a){t.multiplyTo(e,a),this.reduce(a)},q.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},H.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},H.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+DV:this.t=0},H.prototype.fromString=function(t,e){var a;if(16==e)a=4;else if(8==e)a=3;else if(256==e)a=8;else if(2==e)a=1;else if(32==e)a=5;else{if(4!=e)return void this.fromRadix(t,e);a=2}this.s=this.t=0;for(var r=t.length,i=!1,n=0;--r>=0;){var s=8==a?255&t[r]:Z(t,r);s<0?"-"==t.charAt(r)&&(i=!0):(i=!1,0==n?this[this.t++]=s:n+a>this.DB?(this[this.t-1]|=(s&(1<<this.DB-n)-1)<<n,this[this.t++]=s>>this.DB-n):this[this.t-1]|=s<<n,(n+=a)>=this.DB&&(n-=this.DB))}8==a&&128&t[0]&&(this.s=-1,n>0&&(this[this.t-1]|=(1<<this.DB-n)-1<<n)),this.clamp(),i&&H.ZERO.subTo(this,this)},H.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},H.prototype.dlShiftTo=function(t,e){var a;for(a=this.t-1;a>=0;--a)e[a+t]=this[a];for(a=t-1;a>=0;--a)e[a]=0;e.t=this.t+t,e.s=this.s},H.prototype.drShiftTo=function(t,e){for(var a=t;a<this.t;++a)e[a-t]=this[a];e.t=Math.max(this.t-t,0),e.s=this.s},H.prototype.lShiftTo=function(t,e){var a,r=t%this.DB,i=this.DB-r,n=(1<<i)-1,s=Math.floor(t/this.DB),x=this.s<<r&this.DM;for(a=this.t-1;a>=0;--a)e[a+s+1]=this[a]>>i|x,x=(this[a]&n)<<r;for(a=s-1;a>=0;--a)e[a]=0;e[s]=x,e.t=this.t+s+1,e.s=this.s,e.clamp()},H.prototype.rShiftTo=function(t,e){e.s=this.s;var a=Math.floor(t/this.DB);if(a>=this.t)e.t=0;else{var r=t%this.DB,i=this.DB-r,n=(1<<r)-1;e[0]=this[a]>>r;for(var s=a+1;s<this.t;++s)e[s-a-1]|=(this[s]&n)<<i,e[s-a]=this[s]>>r;r>0&&(e[this.t-a-1]|=(this.s&n)<<i),e.t=this.t-a,e.clamp()}},H.prototype.subTo=function(t,e){for(var a=0,r=0,i=Math.min(t.t,this.t);a<i;)r+=this[a]-t[a],e[a++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;a<this.t;)r+=this[a],e[a++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;a<t.t;)r-=t[a],e[a++]=r&this.DM,r>>=this.DB;r-=t.s}e.s=r<0?-1:0,r<-1?e[a++]=this.DV+r:r>0&&(e[a++]=r),e.t=a,e.clamp()},H.prototype.multiplyTo=function(t,e){var a=this.abs(),r=t.abs(),i=a.t;for(e.t=i+r.t;--i>=0;)e[i]=0;for(i=0;i<r.t;++i)e[i+a.t]=a.am(0,r[i],e,i,0,a.t);e.s=0,e.clamp(),this.s!=t.s&&H.ZERO.subTo(e,e)},H.prototype.squareTo=function(t){for(var e=this.abs(),a=t.t=2*e.t;--a>=0;)t[a]=0;for(a=0;a<e.t-1;++a){var r=e.am(a,e[a],t,2*a,0,1);(t[a+e.t]+=e.am(a+1,2*e[a],t,2*a+1,r,e.t-a-1))>=e.DV&&(t[a+e.t]-=e.DV,t[a+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(a,e[a],t,2*a,0,1)),t.s=0,t.clamp()},H.prototype.divRemTo=function(t,e,a){var r=t.abs();if(!(r.t<=0)){var i=this.abs();if(i.t<r.t)null!=e&&e.fromInt(0),null!=a&&this.copyTo(a);else{null==a&&(a=W());var n=W(),s=this.s,x=(t=t.s,this.DB-z(r[r.t-1]));if(x>0?(r.lShiftTo(x,n),i.lShiftTo(x,a)):(r.copyTo(n),i.copyTo(a)),0!=(i=n[(r=n.t)-1])){var o=i*(1<<this.F1)+(r>1?n[r-2]>>this.F2:0),f=this.FV/o,l=(o=(1<<this.F1)/o,1<<this.F2),_=a.t,h=_-r,c=null==e?W():e;for(n.dlShiftTo(h,c),a.compareTo(c)>=0&&(a[a.t++]=1,a.subTo(c,a)),H.ONE.dlShiftTo(r,c),c.subTo(n,n);n.t<r;)n[n.t++]=0;for(;--h>=0;){var u=a[--_]==i?this.DM:Math.floor(a[_]*f+(a[_-1]+l)*o);if((a[_]+=n.am(0,u,a,h,0,r))<u)for(n.dlShiftTo(h,c),a.subTo(c,a);a[_]<--u;)a.subTo(c,a)}null!=e&&(a.drShiftTo(r,e),s!=t&&H.ZERO.subTo(e,e)),a.t=r,a.clamp(),x>0&&a.rShiftTo(x,a),s<0&&H.ZERO.subTo(a,a)}}}},H.prototype.invDigit=function(){if(this.t<1)return 0;var t,e=this[0];return 1&e?(t=(t=(t=(t=(t=3&e)*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t:0},H.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},H.prototype.exp=function(t,e){if(t>4294967295||t<1)return H.ONE;var a=W(),r=W(),i=e.convert(this),n=z(t)-1;for(i.copyTo(a);--n>=0;)if(e.sqrTo(a,r),(t&1<<n)>0)e.mulTo(r,i,a);else{var s=a;a=r,r=s}return e.revert(a)},H.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);if(16==t)t=4;else if(8==t)t=3;else if(2==t)t=1;else if(32==t)t=5;else if(64==t)t=6;else{if(4!=t)return this.toRadix(t);t=2}var e,a=(1<<t)-1,r=!1,i="",n=this.t,s=this.DB-n*this.DB%t;if(n-- >0)for(s<this.DB&&(e=this[n]>>s)>0&&(r=!0,i=J(e));n>=0;)s<t?(e=(this[n]&(1<<s)-1)<<t-s,e|=this[--n]>>(s+=this.DB-t)):(e=this[n]>>(s-=t)&a,s<=0&&(s+=this.DB,--n)),e>0&&(r=!0),r&&(i+=J(e));return r?i:"0"},H.prototype.negate=function(){var t=W();return H.ZERO.subTo(this,t),t},H.prototype.abs=function(){return this.s<0?this.negate():this},H.prototype.compareTo=function(t){if(0!=(e=this.s-t.s))return e;var e,a=this.t;if(0!=(e=a-t.t))return e;for(;--a>=0;)if(0!=(e=this[a]-t[a]))return e;return 0},H.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+z(this[this.t-1]^this.s&this.DM)},H.prototype.mod=function(t){var e=W();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(H.ZERO)>0&&t.subTo(e,e),e},H.prototype.modPowInt=function(t,e){var a;return a=t<256||e.isEven()?new K(e):new q(e),this.exp(t,a)},H.ZERO=j(0),H.ONE=j(1),it.prototype.convert=nt,it.prototype.revert=nt,it.prototype.mulTo=function(t,e,a){t.multiplyTo(e,a)},it.prototype.sqrTo=function(t,e){t.squareTo(e)},st.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=W();return t.copyTo(e),this.reduce(e),e},st.prototype.revert=function(t){return t},st.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},st.prototype.mulTo=function(t,e,a){t.multiplyTo(e,a),this.reduce(a)},st.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)};var xt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],ot=67108864/xt[xt.length-1];function ft(){}function lt(){this.j=this.i=0,this.S=[]}H.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},H.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),a=j(e=Math.pow(t,e)),r=W(),i=W(),n="";for(this.divRemTo(a,r,i);r.signum()>0;)n=(e+i.intValue()).toString(t).substr(1)+n,r.divRemTo(a,r,i);return i.intValue().toString(t)+n},H.prototype.fromRadix=function(t,e){this.fromInt(0),null==e&&(e=10);for(var a=this.chunkSize(e),r=Math.pow(e,a),i=!1,n=0,s=0,x=0;x<t.length;++x){var o=Z(t,x);o<0?"-"==t.charAt(x)&&0==this.signum()&&(i=!0):(s=e*s+o,++n>=a&&(this.dMultiply(r),this.dAddOffset(s,0),s=n=0))}n>0&&(this.dMultiply(Math.pow(e,n)),this.dAddOffset(s,0)),i&&H.ZERO.subTo(this,this)},H.prototype.fromNumber=function(t,e,a){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,a),this.testBit(t-1)||this.bitwiseTo(H.ONE.shiftLeft(t-1),$,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(H.ONE.shiftLeft(t-1),this);else{var r=7&t;(a=[]).length=1+(t>>3),e.nextBytes(a),r>0?a[0]&=(1<<r)-1:a[0]=0,this.fromString(a,256)}},H.prototype.bitwiseTo=function(t,e,a){var r,i,n=Math.min(t.t,this.t);for(r=0;r<n;++r)a[r]=e(this[r],t[r]);if(t.t<this.t){for(i=t.s&this.DM,r=n;r<this.t;++r)a[r]=e(this[r],i);a.t=this.t}else{for(i=this.s&this.DM,r=n;r<t.t;++r)a[r]=e(i,t[r]);a.t=t.t}a.s=e(this.s,t.s),a.clamp()},H.prototype.changeBit=function(t,e){var a=H.ONE.shiftLeft(t);return this.bitwiseTo(a,e,a),a},H.prototype.addTo=function(t,e){for(var a=0,r=0,i=Math.min(t.t,this.t);a<i;)r+=this[a]+t[a],e[a++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;a<this.t;)r+=this[a],e[a++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;a<t.t;)r+=t[a],e[a++]=r&this.DM,r>>=this.DB;r+=t.s}e.s=r<0?-1:0,r>0?e[a++]=r:r<-1&&(e[a++]=this.DV+r),e.t=a,e.clamp()},H.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},H.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},H.prototype.multiplyLowerTo=function(t,e,a){var r,i=Math.min(this.t+t.t,e);for(a.s=0,a.t=i;i>0;)a[--i]=0;for(r=a.t-this.t;i<r;++i)a[i+this.t]=this.am(0,t[i],a,i,0,this.t);for(r=Math.min(t.t,e);i<r;++i)this.am(0,t[i],a,i,0,e-i);a.clamp()},H.prototype.multiplyUpperTo=function(t,e,a){--e;var r=a.t=this.t+t.t-e;for(a.s=0;--r>=0;)a[r]=0;for(r=Math.max(e-this.t,0);r<t.t;++r)a[this.t+r-e]=this.am(e-r,t[r],a,0,0,this.t+r-e);a.clamp(),a.drShiftTo(1,a)},H.prototype.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,a=this.s<0?t-1:0;if(this.t>0)if(0==e)a=this[0]%t;else for(var r=this.t-1;r>=0;--r)a=(e*a+this[r])%t;return a},H.prototype.millerRabin=function(t){var e=this.subtract(H.ONE),a=e.getLowestSetBit();if(a<=0)return!1;var r=e.shiftRight(a);(t=t+1>>1)>xt.length&&(t=xt.length);for(var i=W(),n=0;n<t;++n){i.fromInt(xt[Math.floor(Math.random()*xt.length)]);var s=i.modPow(r,this);if(0!=s.compareTo(H.ONE)&&0!=s.compareTo(e)){for(var x=1;x++<a&&0!=s.compareTo(e);)if(0==(s=s.modPowInt(2,this)).compareTo(H.ONE))return!1;if(0!=s.compareTo(e))return!1}}return!0},H.prototype.clone=function(){var t=W();return this.copyTo(t),t},H.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},H.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},H.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},H.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},H.prototype.toByteArray=function(){var t=this.t,e=[];e[0]=this.s;var a,r=this.DB-t*this.DB%8,i=0;if(t-- >0)for(r<this.DB&&(a=this[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=a|this.s<<this.DB-r);t>=0;)r<8?(a=(this[t]&(1<<r)-1)<<8-r,a|=this[--t]>>(r+=this.DB-8)):(a=this[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),!!(128&a)&&(a|=-256),0==i&&(128&this.s)!=(128&a)&&++i,(i>0||a!=this.s)&&(e[i++]=a);return e},H.prototype.equals=function(t){return 0==this.compareTo(t)},H.prototype.min=function(t){return this.compareTo(t)<0?this:t},H.prototype.max=function(t){return this.compareTo(t)>0?this:t},H.prototype.and=function(t){var e=W();return this.bitwiseTo(t,Q,e),e},H.prototype.or=function(t){var e=W();return this.bitwiseTo(t,$,e),e},H.prototype.xor=function(t){var e=W();return this.bitwiseTo(t,tt,e),e},H.prototype.andNot=function(t){var e=W();return this.bitwiseTo(t,et,e),e},H.prototype.not=function(){for(var t=W(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},H.prototype.shiftLeft=function(t){var e=W();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},H.prototype.shiftRight=function(t){var e=W();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},H.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+at(this[t]);return this.s<0?this.t*this.DB:-1},H.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,a=0;a<this.t;++a)t+=rt(this[a]^e);return t},H.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:!!(this[e]&1<<t%this.DB)},H.prototype.setBit=function(t){return this.changeBit(t,$)},H.prototype.clearBit=function(t){return this.changeBit(t,et)},H.prototype.flipBit=function(t){return this.changeBit(t,tt)},H.prototype.add=function(t){var e=W();return this.addTo(t,e),e},H.prototype.subtract=function(t){var e=W();return this.subTo(t,e),e},H.prototype.multiply=function(t){var e=W();return this.multiplyTo(t,e),e},H.prototype.divide=function(t){var e=W();return this.divRemTo(t,e,null),e},H.prototype.remainder=function(t){var e=W();return this.divRemTo(t,null,e),e},H.prototype.divideAndRemainder=function(t){var e=W(),a=W();return this.divRemTo(t,e,a),[e,a]},H.prototype.modPow=function(t,e){var a,r,i=t.bitLength(),n=j(1);if(i<=0)return n;a=i<18?1:i<48?3:i<144?4:i<768?5:6,r=i<8?new K(e):e.isEven()?new st(e):new q(e);var s=[],x=3,o=a-1,f=(1<<a)-1;if(s[1]=r.convert(this),a>1)for(i=W(),r.sqrTo(s[1],i);x<=f;)s[x]=W(),r.mulTo(i,s[x-2],s[x]),x+=2;var l,_=t.t-1,h=!0,c=W();for(i=z(t[_])-1;_>=0;){for(i>=o?l=t[_]>>i-o&f:(l=(t[_]&(1<<i+1)-1)<<o-i,_>0&&(l|=t[_-1]>>this.DB+i-o)),x=a;!(1&l);)l>>=1,--x;if((i-=x)<0&&(i+=this.DB,--_),h)s[l].copyTo(n),h=!1;else{for(;x>1;)r.sqrTo(n,c),r.sqrTo(c,n),x-=2;x>0?r.sqrTo(n,c):(x=n,n=c,c=x),r.mulTo(c,s[l],n)}for(;_>=0&&!(t[_]&1<<i);)r.sqrTo(n,c),x=n,n=c,c=x,--i<0&&(i=this.DB-1,--_)}return r.revert(n)},H.prototype.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return H.ZERO;for(var a=t.clone(),r=this.clone(),i=j(1),n=j(0),s=j(0),x=j(1);0!=a.signum();){for(;a.isEven();)a.rShiftTo(1,a),e?(i.isEven()&&n.isEven()||(i.addTo(this,i),n.subTo(t,n)),i.rShiftTo(1,i)):n.isEven()||n.subTo(t,n),n.rShiftTo(1,n);for(;r.isEven();)r.rShiftTo(1,r),e?(s.isEven()&&x.isEven()||(s.addTo(this,s),x.subTo(t,x)),s.rShiftTo(1,s)):x.isEven()||x.subTo(t,x),x.rShiftTo(1,x);a.compareTo(r)>=0?(a.subTo(r,a),e&&i.subTo(s,i),n.subTo(x,n)):(r.subTo(a,r),e&&s.subTo(i,s),x.subTo(n,x))}return 0!=r.compareTo(H.ONE)?H.ZERO:x.compareTo(t)>=0?x.subtract(t):x.signum()<0?(x.addTo(t,x),x.signum()<0?x.add(t):x):x},H.prototype.pow=function(t){return this.exp(t,new it)},H.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone();if(t=t.s<0?t.negate():t.clone(),e.compareTo(t)<0){var a=e;e=t,t=a}a=e.getLowestSetBit();var r=t.getLowestSetBit();if(r<0)return e;for(a<r&&(r=a),r>0&&(e.rShiftTo(r,e),t.rShiftTo(r,t));e.signum()>0;)(a=e.getLowestSetBit())>0&&e.rShiftTo(a,e),(a=t.getLowestSetBit())>0&&t.rShiftTo(a,t),e.compareTo(t)>=0?(e.subTo(t,e),e.rShiftTo(1,e)):(t.subTo(e,t),t.rShiftTo(1,t));return r>0&&t.lShiftTo(r,t),t},H.prototype.isProbablePrime=function(t){var e,a=this.abs();if(1==a.t&&a[0]<=xt[xt.length-1]){for(e=0;e<xt.length;++e)if(a[0]==xt[e])return!0;return!1}if(a.isEven())return!1;for(e=1;e<xt.length;){for(var r=xt[e],i=e+1;i<xt.length&&r<ot;)r*=xt[i++];for(r=a.modInt(r);e<i;)if(r%xt[e++]==0)return!1}return a.millerRabin(t)},H.prototype.square=function(){var t=W();return this.squareTo(t),t},function(t,e,a,r,i,n,s){function x(t){var e,r,i=this,n=t.length,s=0,x=i.i=i.j=i.m=0;for(i.S=[],i.c=[],n||(t=[n++]);s<a;)i.S[s]=s++;for(s=0;s<a;s++)x=x+(e=i.S[s])+t[s%n]&255,r=i.S[x],i.S[s]=r,i.S[x]=e;i.g=function(t){var e=i.S,r=i.i+1&255,n=e[r],s=i.j+n&255,x=e[s];e[r]=x,e[s]=n;for(var o=e[n+x&255];--t;)x=e[s=s+(n=e[r=r+1&255])&255],e[r]=x,e[s]=n,o=o*a+e[n+x&255];return i.i=r,i.j=s,o},i.g(a)}function o(t,e,a,r,i){var n;if(a=[],i=void 0===t?"undefined":(n=t)&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n,e&&"object"==i)for(r in t)if(r.indexOf("S")<5)try{a.push(o(t[r],e-1))}catch(t){}return a.length?a:t+("string"!=i?"\0":"")}function f(t,e,a,r){for(t+="",r=a=0;r<t.length;r++){var i=e,n=255&r,s=(a^=19*e[255&r])+t.charCodeAt(r);i[n]=255&s}for(r in t="",e)t+=String.fromCharCode(e[r]);return t}e.seedrandom=function(r,l){var _,h=[];r=f(o(l?[r,t]:arguments.length?r:[(new Date).getTime(),t,window],3),h);return f((_=new x(h)).S,t),e.random=function(){for(var t=_.g(6),e=s,r=0;t<i;)t=(t+r)*a,e*=a,r=_.g(1);for(;t>=n;)t/=2,e/=2,r>>>=1;return(t+r)/e},r},s=e.pow(a,6),i=e.pow(2,i),n=2*i,f(e.random(),t)}([],Math,256,0,52),ft.prototype.nextBytes=function(t){var e;for(e=0;e<t.length;e++)t[e]=Math.floor(256*Math.random())},lt.prototype.init=function(t){var e,a,r;for(e=0;e<256;++e)this.S[e]=e;for(e=a=0;e<256;++e)a=a+this.S[e]+t[e%t.length]&255,r=this.S[e],this.S[e]=this.S[a],this.S[a]=r;this.j=this.i=0},lt.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]};var _t,ht,ct;function ut(){var t;t=(new Date).getTime(),ht[ct++]^=255&t,ht[ct++]^=t>>8&255,ht[ct++]^=t>>16&255,ht[ct++]^=t>>24&255,ct>=256&&(ct-=256)}if(null==ht){var dt;for(ht=[],ct=0;ct<256;)dt=Math.floor(65536*Math.random()),ht[ct++]=dt>>>8,ht[ct++]=255&dt;ct=0,ut()}function pt(){if(null==_t){for(ut(),(_t=new lt).init(ht),ct=0;ct<ht.length;++ct)ht[ct]=0;ct=0}return _t.next()}function mt(){}mt.prototype.nextBytes=function(t){var e;for(e=0;e<t.length;++e)t[e]=pt()};var St=function(t){return function(t){function e(t,e){var a=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(a>>16)<<16|65535&a}function a(t,e){return t>>>e|t<<32-e}return t=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",a=0;a<t.length;a++){var r=t.charCodeAt(a);r<128?e+=String.fromCharCode(r):(r>127&&r<2048?e+=String.fromCharCode(r>>6|192):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128)),e+=String.fromCharCode(63&r|128))}return e}(t),function(t){for(var e="",a=0;a<4*t.length;a++)e+="0123456789abcdef".charAt(t[a>>2]>>8*(3-a%4)+4&15)+"0123456789abcdef".charAt(t[a>>2]>>8*(3-a%4)&15);return e}(function(t,r){var i,n,s,x,o,f,l,_,h,c,u,d,p=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],m=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],S=Array(64);for(t[r>>5]|=128<<24-r%32,t[15+(r+64>>9<<4)]=r,h=0;h<t.length;h+=16){for(i=m[0],n=m[1],s=m[2],x=m[3],o=m[4],f=m[5],l=m[6],_=m[7],c=0;c<64;c++)S[c]=c<16?t[c+h]:e(e(e(a(S[c-2],17)^a(S[c-2],19)^S[c-2]>>>10,S[c-7]),a(S[c-15],7)^a(S[c-15],18)^S[c-15]>>>3),S[c-16]),u=e(e(e(e(_,a(o,6)^a(o,11)^a(o,25)),o&f^~o&l),p[c]),S[c]),d=e(a(i,2)^a(i,13)^a(i,22),i&n^i&s^n&s),_=l,l=f,f=o,o=e(x,u),x=s,s=n,n=i,i=e(u,d);m[0]=e(i,m[0]),m[1]=e(n,m[1]),m[2]=e(s,m[2]),m[3]=e(x,m[3]),m[4]=e(o,m[4]),m[5]=e(f,m[5]),m[6]=e(l,m[6]),m[7]=e(_,m[7])}return m}(function(t){for(var e=[],a=0;a<8*t.length;a+=8)e[a>>5]|=(255&t.charCodeAt(a/8))<<24-a%32;return e}(t),8*t.length))}(t)};var Rt=function(t){return function(t){function e(t,e){return t<<e|t>>>32-e}function a(t){var e,a="";for(e=7;e>=0;e--)a+=(t>>>4*e&15).toString(16);return a}var r,i,n,s,x,o,f,l=Array(80),_=1732584193,h=4023233417,c=2562383102,u=271733878,d=3285377520;t=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",a=0;a<t.length;a++){var r=t.charCodeAt(a);r<128?e+=String.fromCharCode(r):(r>127&&r<2048?e+=String.fromCharCode(r>>6|192):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128)),e+=String.fromCharCode(63&r|128))}return e}(t),n=t.length;var p=[];for(r=0;r<n-3;r+=4)i=t.charCodeAt(r)<<24|t.charCodeAt(r+1)<<16|t.charCodeAt(r+2)<<8|t.charCodeAt(r+3),p.push(i);switch(n%4){case 0:r=2147483648;break;case 1:r=t.charCodeAt(n-1)<<24|8388608;break;case 2:r=t.charCodeAt(n-2)<<24|t.charCodeAt(n-1)<<16|32768;break;case 3:r=t.charCodeAt(n-3)<<24|t.charCodeAt(n-2)<<16|t.charCodeAt(n-1)<<8|128}for(p.push(r);p.length%16!=14;)p.push(0);for(p.push(n>>>29),p.push(n<<3&4294967295),t=0;t<p.length;t+=16){for(r=0;r<16;r++)l[r]=p[t+r];for(r=16;r<=79;r++)l[r]=e(l[r-3]^l[r-8]^l[r-14]^l[r-16],1);for(i=_,n=h,s=c,x=u,o=d,r=0;r<=19;r++)f=e(i,5)+(n&s|~n&x)+o+l[r]+1518500249&4294967295,o=x,x=s,s=e(n,30),n=i,i=f;for(r=20;r<=39;r++)f=e(i,5)+(n^s^x)+o+l[r]+1859775393&4294967295,o=x,x=s,s=e(n,30),n=i,i=f;for(r=40;r<=59;r++)f=e(i,5)+(n&s|n&x|s&x)+o+l[r]+2400959708&4294967295,o=x,x=s,s=e(n,30),n=i,i=f;for(r=60;r<=79;r++)f=e(i,5)+(n^s^x)+o+l[r]+3395469782&4294967295,o=x,x=s,s=e(n,30),n=i,i=f;_=_+i&4294967295,h=h+n&4294967295,c=c+s&4294967295,u=u+x&4294967295,d=d+o&4294967295}return(f=a(_)+a(h)+a(c)+a(u)+a(d)).toLowerCase()}(t)};function Pt(t,e){return new H(t,e)}function yt(){this.n=null,this.e=0,this.coeff=this.dmq1=this.dmp1=this.q=this.p=this.d=null}yt.prototype.doPublic=function(t){return t.modPowInt(this.e,this.n)},yt.prototype.setPublic=function(t,e){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=Pt(t,16),this.e=parseInt(e,16)):alert("Invalid RSA public key")},yt.prototype.encrypt=function(t){return null==(t=function(t,e){if(e<t.length+11)throw"Message too long for RSA (n="+e+", l="+t.length+")";for(var a=[],r=t.length-1;r>=0&&e>0;){var i=t.charCodeAt(r--);i<128?a[--e]=i:i>127&&i<2048?(a[--e]=63&i|128,a[--e]=i>>6|192):(a[--e]=63&i|128,a[--e]=i>>6&63|128,a[--e]=i>>12|224)}for(a[--e]=0,r=new mt,i=[];e>2;){for(i[0]=0;0==i[0];)r.nextBytes(i);a[--e]=i[0]}return a[--e]=2,a[--e]=0,new H(a)}(t,this.n.bitLength()+7>>3))||null==(t=this.doPublic(t))?null:1&(t=t.toString(16)).length?"0"+t:t},yt.prototype.doPrivate=function(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);var e=t.mod(this.p).modPow(this.dmp1,this.p);for(t=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(t)<0;)e=e.add(this.p);return e.subtract(t).multiply(this.coeff).mod(this.p).multiply(this.q).add(t)},yt.prototype.setPrivate=function(t,e,a){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=Pt(t,16),this.e=parseInt(e,16),this.d=Pt(a,16)):alert("Invalid RSA private key")},yt.prototype.setPrivateEx=function(t,e,a,r,i,n,s,x){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=Pt(t,16),this.e=parseInt(e,16),this.d=Pt(a,16),this.p=Pt(r,16),this.q=Pt(i,16),this.dmp1=Pt(n,16),this.dmq1=Pt(s,16),this.coeff=Pt(x,16)):alert("Invalid RSA private key")},yt.prototype.generate=function(t,e){var a=new ft,r=t>>1;this.e=parseInt(e,16);for(var i=new H(e,16);;){for(;this.p=new H(t-r,1,a),0!=this.p.subtract(H.ONE).gcd(i).compareTo(H.ONE)||!this.p.isProbablePrime(10););for(;this.q=new H(r,1,a),0!=this.q.subtract(H.ONE).gcd(i).compareTo(H.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var n=this.p;this.p=this.q,this.q=n}n=this.p.subtract(H.ONE);var s=this.q.subtract(H.ONE),x=n.multiply(s);if(0==x.gcd(i).compareTo(H.ONE)){this.n=this.p.multiply(this.q),this.d=i.modInverse(x),this.dmp1=this.d.mod(n),this.dmq1=this.d.mod(s),this.coeff=this.q.modInverse(this.p);break}}},yt.prototype.decrypt=function(t){return null==(t=this.doPrivate(Pt(t,16)))?null:function(t,e){for(var a=t.toByteArray(),r=0;r<a.length&&0==a[r];)++r;if(a.length-r!=e-1||2!=a[r])return null;for(++r;0!=a[r];)if(++r>=a.length)return null;for(var i="";++r<a.length;){var n=255&a[r];n<128?i+=String.fromCharCode(n):n>191&&n<224?(i+=String.fromCharCode((31&n)<<6|63&a[r+1]),++r):(i+=String.fromCharCode((15&n)<<12|(63&a[r+1])<<6|63&a[r+2]),r+=2)}return i}(t,this.n.bitLength()+7>>3)};var bt=[];bt.sha1="3021300906052b0e03021a05000414",bt.sha256="3031300d060960864801650304020105000420";var Et=[];function gt(t,e,a){e/=4;t=(0,Et[a])(t),a="00"+bt[a]+t,t="",e=e-4-a.length;for(var r=0;r<e;r+=2)t+="ff";return sPaddedMessageHex="0001"+t+a}function Ft(t,e,a){return function(t,e,a){var r=new yt;return r.setPublic(e,a),r.doPublic(t)}(t,e,a).toString(16).replace(/^1f+00/,"")}function Ct(t){for(var e in bt){var a=bt[e],r=a.length;if(t.substring(0,r)==a)return[e,t.substring(r)]}return[]}Et.sha1=Rt,Et.sha256=St,yt.prototype.signString=function(t,e){var a=gt(t,this.n.bitLength(),e);return this.doPrivate(Pt(a,16)).toString(16)},yt.prototype.signStringWithSHA1=function(t){return t=gt(t,this.n.bitLength(),"sha1"),this.doPrivate(Pt(t,16)).toString(16)},yt.prototype.signStringWithSHA256=function(t){return t=gt(t,this.n.bitLength(),"sha256"),this.doPrivate(Pt(t,16)).toString(16)},yt.prototype.verifyString=function(t,e){e=e.replace(/[ \n]+/g,"");var a=this.doPublic(Pt(e,16)).toString(16).replace(/^1f+00/,""),r=Ct(a);return 0!=r.length&&(a=r[1])==(r=(0,Et[r[0]])(t))},yt.prototype.verifyHexSignatureForMessage=function(t,e){return function(t,e,a,r){return 0!=(a=Ct(e=Ft(e,a,r))).length&&(e=a[1])==(0,Et[a[0]])(t)}(e,Pt(t,16),this.n.toString(16),this.e.toString(16))};var vt,Tt,Dt,At=(vt={Sbox:[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],ShiftRowTab:[0,5,10,15,4,9,14,3,8,13,2,7,12,1,6,11],Init:function(){vt.Sbox_Inv=Array(256);for(var t=0;t<256;t++)vt.Sbox_Inv[vt.Sbox[t]]=t;for(vt.ShiftRowTab_Inv=Array(16),t=0;t<16;t++)vt.ShiftRowTab_Inv[vt.ShiftRowTab[t]]=t;for(vt.xtime=Array(256),t=0;t<128;t++)vt.xtime[t]=t<<1,vt.xtime[128+t]=t<<1^27},Done:function(){delete vt.Sbox_Inv,delete vt.ShiftRowTab_Inv,delete vt.xtime},ExpandKey:function(t){var e,a=t.length,r=1;switch(a){case 16:e=176;break;case 24:e=208;break;case 32:e=240;break;default:alert("my.ExpandKey: Only key lengths of 16, 24 or 32 bytes allowed!")}for(var i=a;i<e;i+=4){var n=t.slice(i-4,i);i%a==0?(n=[vt.Sbox[n[1]]^r,vt.Sbox[n[2]],vt.Sbox[n[3]],vt.Sbox[n[0]]],(r<<=1)>=256&&(r^=283)):a>24&&i%a==16&&(n=[vt.Sbox[n[0]],vt.Sbox[n[1]],vt.Sbox[n[2]],vt.Sbox[n[3]]]);for(var s=0;s<4;s++)t[i+s]=t[i+s-a]^n[s]}},Encrypt:function(t,e){var a=e.length;vt.AddRoundKey(t,e.slice(0,16));for(var r=16;r<a-16;r+=16)vt.SubBytes(t,vt.Sbox),vt.ShiftRows(t,vt.ShiftRowTab),vt.MixColumns(t),vt.AddRoundKey(t,e.slice(r,r+16));vt.SubBytes(t,vt.Sbox),vt.ShiftRows(t,vt.ShiftRowTab),vt.AddRoundKey(t,e.slice(r,a))},Decrypt:function(t,e){var a=e.length;for(vt.AddRoundKey(t,e.slice(a-16,a)),vt.ShiftRows(t,vt.ShiftRowTab_Inv),vt.SubBytes(t,vt.Sbox_Inv),a-=32;a>=16;a-=16)vt.AddRoundKey(t,e.slice(a,a+16)),vt.MixColumns_Inv(t),vt.ShiftRows(t,vt.ShiftRowTab_Inv),vt.SubBytes(t,vt.Sbox_Inv);vt.AddRoundKey(t,e.slice(0,16))},SubBytes:function(t,e){for(var a=0;a<16;a++)t[a]=e[t[a]]},AddRoundKey:function(t,e){for(var a=0;a<16;a++)t[a]^=e[a]},ShiftRows:function(t,e){for(var a=[].concat(t),r=0;r<16;r++)t[r]=a[e[r]]},MixColumns:function(t){for(var e=0;e<16;e+=4){var a=t[e+0],r=t[e+1],i=t[e+2],n=t[e+3],s=a^r^i^n;t[e+0]^=s^vt.xtime[a^r],t[e+1]^=s^vt.xtime[r^i],t[e+2]^=s^vt.xtime[i^n],t[e+3]^=s^vt.xtime[n^a]}},MixColumns_Inv:function(t){for(var e=0;e<16;e+=4){var a=t[e+0],r=t[e+1],i=t[e+2],n=t[e+3],s=a^r^i^n,x=vt.xtime[s],o=vt.xtime[vt.xtime[x^a^i]]^s;s^=vt.xtime[vt.xtime[x^r^n]],t[e+0]^=o^vt.xtime[a^r],t[e+1]^=s^vt.xtime[r^i],t[e+2]^=o^vt.xtime[i^n],t[e+3]^=s^vt.xtime[n^a]}}},vt),It=function(){var t={};return At.Init(),t.b256to64=function(t){var e,a,r,i="",n=0,s=t.length;for(r=0;r<s;r++)a=t.charCodeAt(r),0==n?(i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>2&63),e=(3&a)<<4):1==n?(i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e|a>>4&15),e=(15&a)<<2):2==n&&(i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e|a>>6&3),i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&a)),3==(n+=1)&&(n=0);return n>0&&(i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e),i+="="),1==n&&(i+="="),i},t.b64to256=function(t){var e,a,r="",i=0,n=0,s=t.length;for(a=0;a<s;a++)(e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(t.charAt(a)))>=0&&(i&&(r+=String.fromCharCode(n|e>>6-i&255)),n=e<<(i=i+2&7)&255);return r},t.b16to64=function(t){var e,a,r="";for(t.length%2==1&&(t="0"+t),e=0;e+3<=t.length;e+=3)a=parseInt(t.substring(e,e+3),16),r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>6)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&a);for(e+1==t.length?(a=parseInt(t.substring(e,e+1),16),r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a<<2)):e+2==t.length&&(a=parseInt(t.substring(e,e+2),16),r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(a>>2)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt((3&a)<<4));(3&r.length)>0;)r+="=";return r},t.b64to16=function(t){var e,a,r="",i=0;for(e=0;e<t.length&&"="!=t.charAt(e);++e)v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(t.charAt(e)),v<0||(0==i?(r+=J(v>>2),a=3&v,i=1):1==i?(r+=J(a<<2|v>>4),a=15&v,i=2):2==i?(r+=J(a),r+=J(v>>2),a=3&v,i=3):(r+=J(a<<2|v>>4),r+=J(15&v),i=0));return 1==i&&(r+=J(a<<2)),r},t.string2bytes=function(t){for(var e=[],a=0;a<t.length;a++)e.push(t.charCodeAt(a));return e},t.bytes2string=function(t){for(var e="",a=0;a<t.length;a++)e+=String.fromCharCode(t[a]);return e},t.blockXOR=function(t,e){for(var a=Array(16),r=0;r<16;r++)a[r]=t[r]^e[r];return a},t.blockIV=function(){var t=new mt,e=Array(16);return t.nextBytes(e),e},t.pad16=function(t){var e=t.slice(0),a=(16-t.length%16)%16;for(i=t.length;i<t.length+a;i++)e.push(0);return e},t.depad=function(t){for(t=t.slice(0);0==t[t.length-1];)t=t.slice(0,t.length-1);return t},t.encryptAESCBC=function(e,a){var r=a.slice(0);At.ExpandKey(r);for(var i=t.string2bytes(e),n=(i=t.pad16(i),t.blockIV()),s=0;s<i.length/16;s++){var x=i.slice(16*s,16*s+16),o=n.slice(16*s,16*s+16);x=t.blockXOR(o,x);At.Encrypt(x,r),n=n.concat(x)}return r=t.bytes2string(n),t.b256to64(r)},t.decryptAESCBC=function(e,a){var r=a.slice(0);At.ExpandKey(r);e=t.b64to256(e);for(var i=t.string2bytes(e),n=[],s=1;s<i.length/16;s++){var x=i.slice(16*s,16*s+16),o=i.slice(16*(s-1),16*(s-1)+16);At.Decrypt(x,r),x=t.blockXOR(o,x),n=n.concat(x)}return n=t.depad(n),t.bytes2string(n)},t.wrap60=function(t){for(var e="",a=0;a<t.length;a++)a%60==0&&0!=a&&(e+="\n"),e+=t[a];return e},t.generateAESKey=function(){var t=Array(16);return(new mt).nextBytes(t),t},t.generateRSAKey=function(t,e){Math.seedrandom(St(t));var a=new yt;return a.generate(e,"10001"),a},t.publicKeyString=function(t){return pubkey=t.n.toString(16)},t.publicKeyID=function(t){return function(t){function e(t,e){var a,r,i,n,s;return i=2147483648&t,n=2147483648&e,s=(1073741823&t)+(1073741823&e),(a=1073741824&t)&(r=1073741824&e)?2147483648^s^i^n:a|r?1073741824&s?3221225472^s^i^n:1073741824^s^i^n:s^i^n}function a(t,a,r,i,n,s,x){return t=e(t,e(e(a&r|~a&i,n),x)),e(t<<s|t>>>32-s,a)}function r(t,a,r,i,n,s,x){return t=e(t,e(e(a&i|r&~i,n),x)),e(t<<s|t>>>32-s,a)}function i(t,a,r,i,n,s,x){return t=e(t,e(e(a^r^i,n),x)),e(t<<s|t>>>32-s,a)}function n(t,a,r,i,n,s,x){return t=e(t,e(e(r^(a|~i),n),x)),e(t<<s|t>>>32-s,a)}function s(t){var e,a="",r="";for(e=0;e<=3;e++)a+=(r="0"+(r=t>>>8*e&255).toString(16)).substr(r.length-2,2);return a}var x,o,f,l,_,h,c,u,d=function(t){for(var e,a=t.length,r=16*(((e=a+8)-e%64)/64+1),i=Array(r-1),n=0,s=0;s<a;)n=s%4*8,i[e=(s-s%4)/4]|=t.charCodeAt(s)<<n,s++;return i[(s-s%4)/4]|=128<<s%4*8,i[r-2]=a<<3,i[r-1]=a>>>29,i}(t=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",a=0;a<t.length;a++){var r=t.charCodeAt(a);r<128?e+=String.fromCharCode(r):(r>127&&r<2048?e+=String.fromCharCode(r>>6|192):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128)),e+=String.fromCharCode(63&r|128))}return e}(t));for(_=1732584193,h=4023233417,c=2562383102,u=271733878,t=0;t<d.length;t+=16)x=_,o=h,f=c,l=u,_=a(_,h,c,u,d[t+0],7,3614090360),u=a(u,_,h,c,d[t+1],12,3905402710),c=a(c,u,_,h,d[t+2],17,606105819),h=a(h,c,u,_,d[t+3],22,3250441966),_=a(_,h,c,u,d[t+4],7,4118548399),u=a(u,_,h,c,d[t+5],12,1200080426),c=a(c,u,_,h,d[t+6],17,2821735955),h=a(h,c,u,_,d[t+7],22,4249261313),_=a(_,h,c,u,d[t+8],7,1770035416),u=a(u,_,h,c,d[t+9],12,2336552879),c=a(c,u,_,h,d[t+10],17,4294925233),h=a(h,c,u,_,d[t+11],22,2304563134),_=a(_,h,c,u,d[t+12],7,1804603682),u=a(u,_,h,c,d[t+13],12,4254626195),c=a(c,u,_,h,d[t+14],17,2792965006),_=r(_,h=a(h,c,u,_,d[t+15],22,1236535329),c,u,d[t+1],5,4129170786),u=r(u,_,h,c,d[t+6],9,3225465664),c=r(c,u,_,h,d[t+11],14,643717713),h=r(h,c,u,_,d[t+0],20,3921069994),_=r(_,h,c,u,d[t+5],5,3593408605),u=r(u,_,h,c,d[t+10],9,38016083),c=r(c,u,_,h,d[t+15],14,3634488961),h=r(h,c,u,_,d[t+4],20,3889429448),_=r(_,h,c,u,d[t+9],5,568446438),u=r(u,_,h,c,d[t+14],9,3275163606),c=r(c,u,_,h,d[t+3],14,4107603335),h=r(h,c,u,_,d[t+8],20,1163531501),_=r(_,h,c,u,d[t+13],5,2850285829),u=r(u,_,h,c,d[t+2],9,4243563512),c=r(c,u,_,h,d[t+7],14,1735328473),_=i(_,h=r(h,c,u,_,d[t+12],20,2368359562),c,u,d[t+5],4,4294588738),u=i(u,_,h,c,d[t+8],11,2272392833),c=i(c,u,_,h,d[t+11],16,1839030562),h=i(h,c,u,_,d[t+14],23,4259657740),_=i(_,h,c,u,d[t+1],4,2763975236),u=i(u,_,h,c,d[t+4],11,1272893353),c=i(c,u,_,h,d[t+7],16,4139469664),h=i(h,c,u,_,d[t+10],23,3200236656),_=i(_,h,c,u,d[t+13],4,681279174),u=i(u,_,h,c,d[t+0],11,3936430074),c=i(c,u,_,h,d[t+3],16,3572445317),h=i(h,c,u,_,d[t+6],23,76029189),_=i(_,h,c,u,d[t+9],4,3654602809),u=i(u,_,h,c,d[t+12],11,3873151461),c=i(c,u,_,h,d[t+15],16,530742520),_=n(_,h=i(h,c,u,_,d[t+2],23,3299628645),c,u,d[t+0],6,4096336452),u=n(u,_,h,c,d[t+7],10,1126891415),c=n(c,u,_,h,d[t+14],15,2878612391),h=n(h,c,u,_,d[t+5],21,4237533241),_=n(_,h,c,u,d[t+12],6,1700485571),u=n(u,_,h,c,d[t+3],10,2399980690),c=n(c,u,_,h,d[t+10],15,4293915773),h=n(h,c,u,_,d[t+1],21,2240044497),_=n(_,h,c,u,d[t+8],6,1873313359),u=n(u,_,h,c,d[t+15],10,4264355552),c=n(c,u,_,h,d[t+6],15,2734768916),h=n(h,c,u,_,d[t+13],21,1309151649),_=n(_,h,c,u,d[t+4],6,4149444226),u=n(u,_,h,c,d[t+11],10,3174756917),c=n(c,u,_,h,d[t+2],15,718787259),h=n(h,c,u,_,d[t+9],21,3951481745),_=e(_,x),h=e(h,o),c=e(c,f),u=e(u,l);return(s(_)+s(h)+s(c)+s(u)).toLowerCase()}(t)},t.publicKeyFromString=function(t){t=t.split("|")[0];var e=new yt;return e.setPublic(t,"10001"),e},t.encrypt=function(e,a,r){var i="";try{i+=t.publicKeyFromString(a).encrypt(e)+"?"}catch(t){return{status:"Invalid public key"}}return{status:"success",cipher:i}},t.decrypt=function(t,e){var a=t.split("?");return{status:"success",plaintext:e.decrypt(a[0]),signature:"unsigned"}},t}(),Mt=Mt||function(t){var e={},a=e.lib={},r=function(){},i=a.Base={extend:function(t){r.prototype=this;var e=new r;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},n=a.WordArray=i.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||x).stringify(this)},concat:function(t){var e=this.words,a=t.words,r=this.sigBytes;if(t=t.sigBytes,this.clamp(),r%4)for(var i=0;i<t;i++)e[r+i>>>2]|=(a[i>>>2]>>>24-i%4*8&255)<<24-(r+i)%4*8;else if(65535<a.length)for(i=0;i<t;i+=4)e[r+i>>>2]=a[i>>>2];else e.push.apply(e,a);return this.sigBytes+=t,this},clamp:function(){var e=this.words,a=this.sigBytes;e[a>>>2]&=4294967295<<32-a%4*8,e.length=t.ceil(a/4)},clone:function(){var t=i.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var a=[],r=0;r<e;r+=4)a.push(4294967296*t.random()|0);return new n.init(a,e)}}),s=e.enc={},x=s.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var a=[],r=0;r<t;r++){var i=e[r>>>2]>>>24-r%4*8&255;a.push((i>>>4).toString(16)),a.push((15&i).toString(16))}return a.join("")},parse:function(t){for(var e=t.length,a=[],r=0;r<e;r+=2)a[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new n.init(a,e/2)}},o=s.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var a=[],r=0;r<t;r++)a.push(String.fromCharCode(e[r>>>2]>>>24-r%4*8&255));return a.join("")},parse:function(t){for(var e=t.length,a=[],r=0;r<e;r++)a[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new n.init(a,e)}},f=s.Utf8={stringify:function(t){try{return decodeURIComponent(escape(o.stringify(t)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(t){return o.parse(unescape(encodeURIComponent(t)))}},l=a.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new n.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=f.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var a=this._data,r=a.words,i=a.sigBytes,s=this.blockSize,x=i/(4*s);if(e=(x=e?t.ceil(x):t.max((0|x)-this._minBufferSize,0))*s,i=t.min(4*e,i),e){for(var o=0;o<e;o+=s)this._doProcessBlock(r,o);o=r.splice(0,e),a.sigBytes-=i}return new n.init(o,i)},clone:function(){var t=i.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});a.Hasher=l.extend({cfg:i.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,a){return new t.init(a).finalize(e)}},_createHmacHelper:function(t){return function(e,a){return new _.HMAC.init(t,a).finalize(e)}}});var _=e.algo={};return e}(Math);Dt=(Tt=Mt).lib.WordArray,Tt.enc.Base64={stringify:function(t){var e=t.words,a=t.sigBytes,r=this._map;t.clamp(),t=[];for(var i=0;i<a;i+=3)for(var n=(e[i>>>2]>>>24-i%4*8&255)<<16|(e[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|e[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;4>s&&i+.75*s<a;s++)t.push(r.charAt(n>>>6*(3-s)&63));if(e=r.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var e=t.length,a=this._map;(r=a.charAt(64))&&-1!=(r=t.indexOf(r))&&(e=r);for(var r=[],i=0,n=0;n<e;n++)if(n%4){var s=a.indexOf(t.charAt(n-1))<<n%4*2,x=a.indexOf(t.charAt(n))>>>6-n%4*2;r[i>>>2]|=(s|x)<<24-i%4*8,i++}return Dt.create(r,i)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(t){function e(t,e,a,r,i,n,s){return((t=t+(e&a|~e&r)+i+s)<<n|t>>>32-n)+e}function a(t,e,a,r,i,n,s){return((t=t+(e&r|a&~r)+i+s)<<n|t>>>32-n)+e}function r(t,e,a,r,i,n,s){return((t=t+(e^a^r)+i+s)<<n|t>>>32-n)+e}function i(t,e,a,r,i,n,s){return((t=t+(a^(e|~r))+i+s)<<n|t>>>32-n)+e}for(var n=Mt,s=(o=n.lib).WordArray,x=o.Hasher,o=n.algo,f=[],l=0;64>l;l++)f[l]=4294967296*t.abs(t.sin(l+1))|0;o=o.MD5=x.extend({_doReset:function(){this._hash=new s.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,n){for(var s=0;16>s;s++){var x=t[o=n+s];t[o]=16711935&(x<<8|x>>>24)|4278255360&(x<<24|x>>>8)}s=this._hash.words;var o=t[n+0],l=(x=t[n+1],t[n+2]),_=t[n+3],h=t[n+4],c=t[n+5],u=t[n+6],d=t[n+7],p=t[n+8],m=t[n+9],S=t[n+10],R=t[n+11],P=t[n+12],y=t[n+13],b=t[n+14],E=t[n+15],g=e(g=s[0],v=s[1],C=s[2],F=s[3],o,7,f[0]),F=e(F,g,v,C,x,12,f[1]),C=e(C,F,g,v,l,17,f[2]),v=e(v,C,F,g,_,22,f[3]);g=e(g,v,C,F,h,7,f[4]),F=e(F,g,v,C,c,12,f[5]),C=e(C,F,g,v,u,17,f[6]),v=e(v,C,F,g,d,22,f[7]),g=e(g,v,C,F,p,7,f[8]),F=e(F,g,v,C,m,12,f[9]),C=e(C,F,g,v,S,17,f[10]),v=e(v,C,F,g,R,22,f[11]),g=e(g,v,C,F,P,7,f[12]),F=e(F,g,v,C,y,12,f[13]),C=e(C,F,g,v,b,17,f[14]),g=a(g,v=e(v,C,F,g,E,22,f[15]),C,F,x,5,f[16]),F=a(F,g,v,C,u,9,f[17]),C=a(C,F,g,v,R,14,f[18]),v=a(v,C,F,g,o,20,f[19]),g=a(g,v,C,F,c,5,f[20]),F=a(F,g,v,C,S,9,f[21]),C=a(C,F,g,v,E,14,f[22]),v=a(v,C,F,g,h,20,f[23]),g=a(g,v,C,F,m,5,f[24]),F=a(F,g,v,C,b,9,f[25]),C=a(C,F,g,v,_,14,f[26]),v=a(v,C,F,g,p,20,f[27]),g=a(g,v,C,F,y,5,f[28]),F=a(F,g,v,C,l,9,f[29]),C=a(C,F,g,v,d,14,f[30]),g=r(g,v=a(v,C,F,g,P,20,f[31]),C,F,c,4,f[32]),F=r(F,g,v,C,p,11,f[33]),C=r(C,F,g,v,R,16,f[34]),v=r(v,C,F,g,b,23,f[35]),g=r(g,v,C,F,x,4,f[36]),F=r(F,g,v,C,h,11,f[37]),C=r(C,F,g,v,d,16,f[38]),v=r(v,C,F,g,S,23,f[39]),g=r(g,v,C,F,y,4,f[40]),F=r(F,g,v,C,o,11,f[41]),C=r(C,F,g,v,_,16,f[42]),v=r(v,C,F,g,u,23,f[43]),g=r(g,v,C,F,m,4,f[44]),F=r(F,g,v,C,P,11,f[45]),C=r(C,F,g,v,E,16,f[46]),g=i(g,v=r(v,C,F,g,l,23,f[47]),C,F,o,6,f[48]),F=i(F,g,v,C,d,10,f[49]),C=i(C,F,g,v,b,15,f[50]),v=i(v,C,F,g,c,21,f[51]),g=i(g,v,C,F,P,6,f[52]),F=i(F,g,v,C,_,10,f[53]),C=i(C,F,g,v,S,15,f[54]),v=i(v,C,F,g,x,21,f[55]),g=i(g,v,C,F,p,6,f[56]),F=i(F,g,v,C,E,10,f[57]),C=i(C,F,g,v,u,15,f[58]),v=i(v,C,F,g,y,21,f[59]),g=i(g,v,C,F,h,6,f[60]),F=i(F,g,v,C,R,10,f[61]),C=i(C,F,g,v,l,15,f[62]),v=i(v,C,F,g,m,21,f[63]);s[0]=s[0]+g|0,s[1]=s[1]+v|0,s[2]=s[2]+C|0,s[3]=s[3]+F|0},_doFinalize:function(){var e=this._data,a=e.words,r=8*this._nDataBytes,i=8*e.sigBytes;a[i>>>5]|=128<<24-i%32;var n=t.floor(r/4294967296);for(a[15+(i+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),a[14+(i+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),e.sigBytes=4*(a.length+1),this._process(),a=(e=this._hash).words,r=0;4>r;r++)i=a[r],a[r]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return e},clone:function(){var t=x.clone.call(this);return t._hash=this._hash.clone(),t}}),n.MD5=x._createHelper(o),n.HmacMD5=x._createHmacHelper(o)}(Math),function(){var t,e=Mt,a=(t=e.lib).Base,r=t.WordArray,i=(t=e.algo).EvpKDF=a.extend({cfg:a.extend({keySize:4,hasher:t.MD5,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var a=(x=this.cfg).hasher.create(),i=r.create(),n=i.words,s=x.keySize,x=x.iterations;n.length<s;){o&&a.update(o);var o=a.update(t).finalize(e);a.reset();for(var f=1;f<x;f++)o=a.finalize(o),a.reset();i.concat(o)}return i.sigBytes=4*s,i}});e.EvpKDF=function(t,e,a){return i.create(a).compute(t,e)}}(),Mt.lib.Cipher||function(){var t=(h=Mt).lib,e=t.Base,a=t.WordArray,r=t.BufferedBlockAlgorithm,i=h.enc.Base64,n=h.algo.EvpKDF,s=t.Cipher=r.extend({cfg:e.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,a){this.cfg=this.cfg.extend(a),this._xformMode=t,this._key=e,this.reset()},reset:function(){r.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(e,a,r){return("string"==typeof a?c:_).encrypt(t,e,a,r)},decrypt:function(e,a,r){return("string"==typeof a?c:_).decrypt(t,e,a,r)}}}});t.StreamCipher=s.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var x=h.mode={},o=function(t,e,a){var r=this._iv;r?this._iv=undefined:r=this._prevBlock;for(var i=0;i<a;i++)t[e+i]^=r[i]},f=(t.BlockCipherMode=e.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}})).extend();f.Encryptor=f.extend({processBlock:function(t,e){var a=this._cipher,r=a.blockSize;o.call(this,t,e,r),a.encryptBlock(t,e),this._prevBlock=t.slice(e,e+r)}}),f.Decryptor=f.extend({processBlock:function(t,e){var a=this._cipher,r=a.blockSize,i=t.slice(e,e+r);a.decryptBlock(t,e),o.call(this,t,e,r),this._prevBlock=i}}),x=x.CBC=f,f=(h.pad={}).Pkcs7={pad:function(t,e){for(var r,i=(r=(r=4*e)-t.sigBytes%r)<<24|r<<16|r<<8|r,n=[],s=0;s<r;s+=4)n.push(i);r=a.create(n,r),t.concat(r)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},t.BlockCipher=s.extend({cfg:s.cfg.extend({mode:x,padding:f}),reset:function(){s.reset.call(this);var t=(e=this.cfg).iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var a=e.createEncryptor;else a=e.createDecryptor,this._minBufferSize=1;this._mode=a.call(e,this,t&&t.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var l=t.CipherParams=e.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),_=(x=(h.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return((t=t.salt)?a.create([1398893684,1701076831]).concat(t).concat(e):e).toString(i)},parse:function(t){var e=(t=i.parse(t)).words;if(1398893684==e[0]&&1701076831==e[1]){var r=a.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return l.create({ciphertext:t,salt:r})}},t.SerializableCipher=e.extend({cfg:e.extend({format:x}),encrypt:function(t,e,a,r){r=this.cfg.extend(r);var i=t.createEncryptor(a,r);return e=i.finalize(e),i=i.cfg,l.create({ciphertext:e,key:a,iv:i.iv,algorithm:t,mode:i.mode,padding:i.padding,blockSize:t.blockSize,formatter:r.format})},decrypt:function(t,e,a,r){return r=this.cfg.extend(r),e=this._parse(e,r.format),t.createDecryptor(a,r).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}})),h=(h.kdf={}).OpenSSL={execute:function(t,e,r,i){return i||(i=a.random(8)),t=n.create({keySize:e+r}).compute(t,i),r=a.create(t.words.slice(e),4*r),t.sigBytes=4*e,l.create({key:t,iv:r,salt:i})}},c=t.PasswordBasedCipher=_.extend({cfg:_.cfg.extend({kdf:h}),encrypt:function(t,e,a,r){return a=(r=this.cfg.extend(r)).kdf.execute(a,t.keySize,t.ivSize),r.iv=a.iv,(t=_.encrypt.call(this,t,e,a.key,r)).mixIn(a),t},decrypt:function(t,e,a,r){return r=this.cfg.extend(r),e=this._parse(e,r.format),a=r.kdf.execute(a,t.keySize,t.ivSize,e.salt),r.iv=a.iv,_.decrypt.call(this,t,e,a.key,r)}})}(),function(){for(var t=Mt,e=t.lib.BlockCipher,a=t.algo,r=[],i=[],n=[],s=[],x=[],o=[],f=[],l=[],_=[],h=[],c=[],u=0;256>u;u++)c[u]=128>u?u<<1:u<<1^283;var d=0,p=0;for(u=0;256>u;u++){var m=(m=p^p<<1^p<<2^p<<3^p<<4)>>>8^255&m^99;r[d]=m,i[m]=d;var S=c[d],R=c[S],P=c[R],y=257*c[m]^16843008*m;n[d]=y<<24|y>>>8,s[d]=y<<16|y>>>16,x[d]=y<<8|y>>>24,o[d]=y,y=16843009*P^65537*R^257*S^16843008*d,f[m]=y<<24|y>>>8,l[m]=y<<16|y>>>16,_[m]=y<<8|y>>>24,h[m]=y,d?(d=S^c[c[c[P^S]]],p^=c[c[p]]):d=p=1}var b=[0,1,2,4,8,16,32,64,128,27,54];a=a.AES=e.extend({_doReset:function(){for(var t=(a=this._key).words,e=a.sigBytes/4,a=4*((this._nRounds=e+6)+1),i=this._keySchedule=[],n=0;n<a;n++)if(n<e)i[n]=t[n];else{var s=i[n-1];n%e?6<e&&4==n%e&&(s=r[s>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s]):(s=r[(s=s<<8|s>>>24)>>>24]<<24|r[s>>>16&255]<<16|r[s>>>8&255]<<8|r[255&s],s^=b[n/e|0]<<24),i[n]=i[n-e]^s}for(t=this._invKeySchedule=[],e=0;e<a;e++)n=a-e,s=e%4?i[n]:i[n-4],t[e]=4>e||4>=n?s:f[r[s>>>24]]^l[r[s>>>16&255]]^_[r[s>>>8&255]]^h[r[255&s]]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,n,s,x,o,r)},decryptBlock:function(t,e){var a=t[e+1];t[e+1]=t[e+3],t[e+3]=a,this._doCryptBlock(t,e,this._invKeySchedule,f,l,_,h,i),a=t[e+1],t[e+1]=t[e+3],t[e+3]=a},_doCryptBlock:function(t,e,a,r,i,n,s,x){for(var o=this._nRounds,f=t[e]^a[0],l=t[e+1]^a[1],_=t[e+2]^a[2],h=t[e+3]^a[3],c=4,u=1;u<o;u++){var d=r[f>>>24]^i[l>>>16&255]^n[_>>>8&255]^s[255&h]^a[c++],p=r[l>>>24]^i[_>>>16&255]^n[h>>>8&255]^s[255&f]^a[c++],m=r[_>>>24]^i[h>>>16&255]^n[f>>>8&255]^s[255&l]^a[c++];h=r[h>>>24]^i[f>>>16&255]^n[l>>>8&255]^s[255&_]^a[c++],f=d,l=p,_=m}d=(x[f>>>24]<<24|x[l>>>16&255]<<16|x[_>>>8&255]<<8|x[255&h])^a[c++],p=(x[l>>>24]<<24|x[_>>>16&255]<<16|x[h>>>8&255]<<8|x[255&f])^a[c++],m=(x[_>>>24]<<24|x[h>>>16&255]<<16|x[f>>>8&255]<<8|x[255&l])^a[c++],h=(x[h>>>24]<<24|x[f>>>16&255]<<16|x[l>>>8&255]<<8|x[255&_])^a[c++],t[e]=d,t[e+1]=p,t[e+2]=m,t[e+3]=h},keySize:8});t.AES=e._createHelper(a)}();var Lt=function(){function t(){}var e=t.prototype;return e.createClientObject=function(t,e,a,r,i){var n=Mt.AES.encrypt((new Date).getTime().toString(),Mt.enc.Hex.parse("1234567891234567123456789123456712345678912345671234567891234567"),{mode:Mt.mode.CBC,iv:Mt.enc.Hex.parse("12345678912345671234567891234567"),padding:Mt.pad.Pkcs7}).ciphertext.toString();n.length<64&&(n+=n);var s=Mt.AES.encrypt((new Date).getTime().toString(),Mt.enc.Hex.parse("12345678912345671234567891234567"),{mode:Mt.mode.CBC,iv:Mt.enc.Hex.parse("12345678912345671234567891234567"),padding:Mt.pad.Pkcs7}).ciphertext.toString();return{socket:t,id:e,PKD:a,rand:r,playURL:i.playURL||"",auth:i.auth||"",token:i.token||"",key:n,iv:s,resolve:null,reject:null}},e.playCmd=function(t){var e={sequence:0,cmd:"realplay",url:t.playURL,key:It.encrypt(t.iv+":"+t.key,t.PKD).cipher.split("?")[0],authorization:Mt.AES.encrypt(t.rand+":"+t.auth,Mt.enc.Hex.parse(t.key),{mode:Mt.mode.CBC,iv:Mt.enc.Hex.parse(t.iv),padding:Mt.pad.Pkcs7}).ciphertext.toString(),token:Mt.AES.encrypt(t.token,Mt.enc.Hex.parse(t.key),{mode:Mt.mode.CBC,iv:Mt.enc.Hex.parse(t.iv),padding:Mt.pad.Pkcs7}).ciphertext.toString()};return JSON.stringify(e)},e.playbackCmd=function(t,e,a){var r={sequence:0,cmd:"playback",url:t.playURL,key:It.encrypt(t.iv+":"+t.key,t.PKD).cipher.split("?")[0],authorization:Mt.AES.encrypt(t.rand+":"+t.auth,Mt.enc.Hex.parse(t.key),{mode:Mt.mode.CBC,iv:Mt.enc.Hex.parse(t.iv),padding:Mt.pad.Pkcs7}).ciphertext.toString(),token:Mt.AES.encrypt(t.token,Mt.enc.Hex.parse(t.key),{mode:Mt.mode.CBC,iv:Mt.enc.Hex.parse(t.iv),padding:Mt.pad.Pkcs7}).ciphertext.toString(),startTime:e,endTime:a};return JSON.stringify(r)},e.seekCmd=function(t,e){var a={sequence:0,cmd:"seek",startTime:t,endTime:e};return JSON.stringify(a)},t}(),wt=function(){function t(){}var e=t.prototype;return e.createClientObject=function(t,e,a,r){return{socket:t,id:e,playURL:a,deviceSerial:r.deviceSerial||"",verificationCode:r.verificationCode||"",resolve:null,reject:null}},e.playCmd=function(t){var e={sequence:0,cmd:"realplay",deviceSerial:t.deviceSerial,verificationCode:t.verificationCode,url:t.playURL};return JSON.stringify(e)},e.playbackCmd=function(t,e,a){var r={sequence:0,cmd:"playback",deviceSerial:t.deviceSerial,verificationCode:t.verificationCode,url:t.playURL,startTime:e,endTime:a};return JSON.stringify(r)},t}(),Ot=Symbol("WEBSOCKET"),Bt=Symbol("GETINDEX"),kt=Symbol("PROTOCOLVERSION"),Nt=Symbol("CIPHERSUITES"),Vt=new V,Ut=new U,Ht=new Lt,Wt=new wt,Yt=function(){function t(){this[kt]="0.1",this[Nt]=0,this[Ot]=[],this.ERRORS={},this[Bt]=function(t){for(var e=-1,a=0,r=this[Ot].length;a<r;a++)if(this[Ot][a].id===t){e=a;break}return e}}var e=t.prototype;return e.openStream=function(t,e,a,r,i){var n=!1;t.indexOf("[")>-1&&(n=!0);var s=this,x=t.split("://"),o=x[0],f="",l=7681,_=1,h=0,c=!1;if(n)f=x[1].split("]:")[0]+"]",l=Math.floor(x[1].split("]:")[1].split("/")[0]),_=Math.floor(x[1].split("]:")[1].split("/")[1]/100),h=Math.floor(x[1].split("]:")[1].split("/")[1]%100)-1;else{f=x[1].split(":")[0],l=Math.floor(x[1].split(":")[1].split("/")[0]),_=Math.floor(x[1].split(":")[1].split("/")[1]/100),h=Math.floor(x[1].split(":")[1].split("/")[1]%100)-1;var u=x[1].split(":")[1].split("/")[2];""!==u&&"webSocketVideoCtrlProxy"===u&&(c=!0)}0===_&&(h=0);var d="&sessionID=";(e=e||{}).token&&!e.playURL&&(d="&token=");var p=e.sessionID||e.session||(e.playURL?"":e.token)||"",m=new window.WebSocket(o+"://"+f+":"+l+(e.mode?"/"+e.mode:"")+(c?"/webSocketVideoCtrlProxy":"")+"?version="+s[kt]+"&cipherSuites="+s[Nt]+d+p+(e.proxy?"&proxy="+e.proxy:""));m.binaryType="arraybuffer";var S=N(),R=-1;return new Promise((function(t,n){m.onopen=function(){e.playURL||e.sessionID||e.deviceSerial||e.token||(s[Ot].push(Vt.createClientObject(m,S,_,h)),t(S))},m.onmessage=function(r){if("string"==typeof r.data){var i=JSON.parse(r.data),x=s[Bt](S);if(i&&i.version&&i.cipherSuite){if(s[kt]=i.version,s[Nt]=parseInt(i.cipherSuite,10),i&&i.PKD&&i.rand)s[Ot].push(Ht.createClientObject(m,S,i.PKD,i.rand,e));else{var o="live://"+f+":"+l+"/"+_+"/"+h;-1===s[Nt]?s[Ot].push(Wt.createClientObject(m,S,o,e)):s[Ot].push(Ut.createClientObject(m,S,o))}return void t(S)}if(i&&i.sdp){var c=Ut.getMediaFromSdp(i.sdp);a({bHead:!0,buf:c})}if(i&&i.cmd&&"end"===i.cmd&&a({type:"exception",cmd:i.cmd}),i&&i.statusString&&("ok"===i.statusString.toLowerCase()&&s[Ot][x].resolve&&s[Ot][x].resolve(i),"ok"!==i.statusString.toLowerCase())){var u=Ut.getError(i);x>-1?s[Ot][x].reject&&s[Ot][x].reject(u):n(u)}i&&i.errorCode&&a(i)}else{var d={},p=new Uint8Array(r.data);if(R++,64===p.byteLength||40===p.byteLength){for(var P=-1,y=p.byteLength,b=0;b<y;b++)if(73===p[b]&&77===p[b+1]&&75===p[b+2]&&72===p[b+3]){P=b;break}if(-1!==P)d={bHead:!0,buf:p.slice(P,P+40)};else d={bHead:!1,buf:p};a(d)}else R>0&&a(d={bHead:!1,buf:p});p=null,d=null,r=null}},m.onclose=function(){for(var t=0,e=s[Ot].length;t<e;t++)if(s[Ot][t].id===S){s[Ot][t].resolve(),s[Ot].splice(t,1),setTimeout((function(){r(S)}),200);break}n()},m.onerror=function(t){var e,a;[null==(e=window.WebSocket)?void 0:e.CLOSED,null==(a=window.WebSocket)?void 0:a.CLOSING].includes(t.target.readyState)||i(S,t)}}))},e.startPlay=function(t,e,a){var r=this,i=this[Bt](t);return e&&a&&"0.1"===r[kt]&&(e=e.replace(/-/g,"").replace(/:/g,""),a=a.replace(/-/g,"").replace(/:/g,"")),new Promise((function(t,n){if(i>-1){r[Ot][i].resolve=t,r[Ot][i].reject=n;var s=null;e&&a?"0.1"!==r[kt]?0===r[Nt]?s=Ht.playbackCmd(r[Ot][i],e,a):1===r[Nt]?s=Ut.playbackCmd(e,a,r[Ot][i].playURL):-1===r[Nt]&&(s=Wt.playbackCmd(r[Ot][i],e,a)):s=Vt.playbackCmd(e,a,r[Ot][i].iCurChannel,r[Ot][i].iCurStream):0===r[Ot][i].iCurChannel&&"0.1"===r[kt]?s=Vt.zeroPlayCmd(r[Ot][i].iCurChannel,r[Ot][i].iCurStream):"0.1"!==r[kt]?0===r[Nt]?s=Ht.playCmd(r[Ot][i]):1===r[Nt]?s=Ut.playCmd(r[Ot][i].playURL):-1===r[Nt]&&(s=Wt.playCmd(r[Ot][i])):s=Vt.playCmd(r[Ot][i].iCurChannel,r[Ot][i].iCurStream),r[Ot][i].socket.send(s),"0.1"===r[kt]&&t()}else"0.1"===r[kt]&&n()}))},e.singleFrame=function(){},e.setPlayRate=function(t,e){var a=this;return new Promise((function(r,i){for(var n=0,s=a[Ot].length;n<s;n++)if(a[Ot][n].id===t){if("0.1"===a[kt]){var x=Vt.playRateCmd(e);a[Ot][n].socket.send(x),r();break}a[Ot][n].resolve=r,a[Ot][n].reject=i;var o=Ut.playRateCmd(e);a[Ot][n].socket.send(o)}}))},e.seek=function(t,e,a){var r=this;return new Promise((function(i,n){for(var s=0,x=r[Ot].length;s<x;s++)if(r[Ot][s].id===t){r[Ot][s].resolve=i,r[Ot][s].reject=n;var o=Ht.seekCmd(e,a);r[Ot][s].socket.send(o)}}))},e.pause=function(t){var e=this;return new Promise((function(a,r){for(var i=0,n=e[Ot].length;i<n;i++)if(e[Ot][i].id===t){if("0.1"===e[kt]){var s=Vt.pauseCmd();e[Ot][i].socket.send(s),a();break}e[Ot][i].resolve=a,e[Ot][i].reject=r;var x=Ut.pauseCmd();e[Ot][i].socket.send(x)}}))},e.transmission=function(t,e){var a=this;return new Promise((function(r,i){for(var n=0,s=a[Ot].length;n<s;n++)a[Ot][n].id===t&&(a[Ot][n].resolve=r,a[Ot][n].reject=i,a[Ot][n].socket.send(e))}))},e.resume=function(t){var e=this;return new Promise((function(a,r){for(var i=0,n=e[Ot].length;i<n;i++)if(e[Ot][i].id===t){if("0.1"===e[kt]){var s=Vt.resumeCmd();e[Ot][i].socket.send(s),a();break}e[Ot][i].resolve=a,e[Ot][i].reject=r;var x=Ut.resumeCmd();e[Ot][i].socket.send(x)}}))},e.stop=function(t){var e=this;return new Promise((function(a,r){if(t){for(var i=-1,n=0,s=e[Ot].length;n<s;n++)if(e[Ot][n].id===t){i=n,e[Ot][n].resolve=a,e[Ot][n].socket.close(1e3,"CLOSE");break}-1===i&&r()}else r()}))},e.stopAll=function(){var t=this;return new Promise((function(e,a){for(var r=0,i=t[Ot].length;r<i;r++){var n,s,x;if([null==(n=window.WebSocket)?void 0:n.CLOSING,null==(s=window.WebSocket)?void 0:s.CLOSED].includes(null==(x=t[Ot][r].socket)?void 0:x.readyState))e();else try{var o,f;null==(f=t[Ot][r])||null==(o=f.socket)||o.close(1e3,"CLOSE")}catch(t){}}e()}))},t}(),Gt=function(){function t(t){this._streamUUID=null,this._player=t,this._streamClient=new Yt}var e=t.prototype;return e.openStream=function(t,e,a,r,i){var n=this;return this._streamClient.openStream(t,e,a,r,i).then((function(a){var r;n._streamUUID=a;try{n._player.logger.log("["+A.SOCKET.openStream+"] url: ",t,"oParams: ",JSON.stringify(e))}catch(t){}return null==(r=n._player)||r.emit(""+A.SOCKET.openStream,F(a)),a}))},e.startPlay=function(t){var e=this;return t=null!=t?t:this._streamUUID,this._streamClient.startPlay(t).then((function(){var a,r,i;null==(r=e._player)||null==(a=r.logger)||a.log("["+A.SOCKET.startPlay+"] StreamUUID: ",t),null==(i=e._player)||i.emit(""+A.SOCKET.startPlay,F(t))}))},e.setPlayRate=function(t,e){var a=this;return e=null!=e?e:this._streamUUID,this._streamClient.setPlayRate(e,t).then((function(){var r,i,n;null==(i=a._player)||null==(r=i.logger)||r.log("["+A.SOCKET.setPlayRate+"] StreamUUID: ",e," rate: ",t),null==(n=a._player)||n.emit(""+A.SOCKET.startPlay,F({id:e,rate:t}))}))},e.seek=function(t,e,a){var r=this;return a=null!=a?a:this._streamUUID,this._streamClient.seek(a,t,e).then((function(){var i;r._player.logger.log("["+A.SOCKET.seek+"] StreamUUID: ",a," startTime: ",t," stopTime:",e),null==(i=r._player)||i.emit(""+A.SOCKET.seek,F({id:a,startTime:t,stopTime:e}))}))},e.stopAll=function(){var t=this;return this._streamClient.stopAll().then((function(){t._player.logger.log("["+A.SOCKET.stopAll+"]"),t._player.emit(A.SOCKET.stopAll,F(void 0)),t._streamUUID=null}))},e.destroy=function(){var t=this;this.stopAll().then((function(){t._streamUUID=null,t._streamClient=null}))},t}();function Xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function Jt(){return Jt=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},Jt.apply(this,arguments)}function Zt(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(a)return(a=a.call(t)).next.bind(a);if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return Xt(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Xt(t,e):void 0}}(t))||e){a&&(t=a);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var jt,zt,Kt=768,qt={port:0,start:{x:0,y:0},total:{x:0,y:0},diff:{x:0,y:0},startPTZPosition:{x:0,y:0},lastCorrdsY:0,param2d:{upDateType:4,fValue:0,fPTZParam:{fPTZPositionX:0,fPTZPositionY:0},fPTZZoom:0}},Qt=function(){function t(t){this._canvasFECSubPort=new Map,this._correctType=null,this._player=t,this.init()}var e=t.prototype;return e._supportFEC=function(){return this._player._decoderStatus.bSupHardOrSoft},e.init=function(){var t=this;this._player.logger.log("FECSplitIds.init"),this._player.on("JSPlayM4_Play_Before",(function(){t._player.logger.log("JSPlayM4_Play_Before event: _FECSplitIds =  ",t._FECSplitIds),t._FECSplitIds&&t._supportFEC()&&t._player.wasmplayer.JSPlayM4_FEC_SetCanvasID(t._FECSplitIds)})),this._player.on("JSPlayM4_Play_After",(function(){t._player.logger.log("JSPlayM4_Play_After event: _FECSplitIds =  ",t._FECSplitIds),t._FECSplitIds&&t._supportFEC()&&t._canvasFECSubPort.set(t._player._playerWindow.canvasId,Jt({},qt))})),this._player.on("PlayM4_openStream",(function(){t._FECSplitIds&&t._supportFEC()&&t._player.wasmplayer.JSPlayM4_SetDecodeEngine(0)})),this._player.on("JSPlayM4_Stop",(function(){t._closeFECAllSubWnd()})),this._player.on(A.API.destroy,(function(){t._closeFECAllSubWnd()})),this._player.logger.log("FECCorrect init")},e.setFECCorrectType=function(t,e){var a=this;return this._supportFEC()?(this._FECSplitIds=e,this._correctType=t,new Promise((function(r,i){var n=a._createSplitCanvas(t,e),s=n.find((function(t){return-1===t.code}));a._player.emit("FECCorrect.setFECCorrectType",F({type:t,ids:e})),s||0===n.length?i(n):r(n)}))):Promise.reject()},e.setFEC2DParam=function(t,e){if(this._supportFEC())return this._player.emit("FECCorrect.setFEC2DParam",F({port:t,param2d:e})),this._player.wasmplayer.JSPlayM4_FEC_SetParam(t,e)},e.setFEC3DViewParam=function(t){if(!this._supportFEC())return Promise.reject(!1);var e=this._player.wasmplayer;if(this._FECSplitIds&&this._canvasFECSubPort&&this._correctType){var a=e.JSPlayM4_FEC_SetViewParam(t.port,t.upDateType,t.fValue);return this._player.emit("FECCorrect.setFEC3DViewParam",F({param:t})),1===a?Promise.resolve(!0):Promise.reject(!1)}return Promise.reject(void 0)},e.get3DViewParam=function(t){var e=this;if(!this._supportFEC())return Promise.reject(!1);var a=this._player.wasmplayer;return new Promise((function(r,i){if(e._FECSplitIds&&e._canvasFECSubPort&&e._correctType&&1!==a.JSPlayM4_FEC_GetViewParam(t.port,t.upDateType,(function(a){e._player.emit("FECCorrect.get3DViewParam",F({param:t})),r(a)})))return i(!1);return i(void 0)}))},e.getFECSubPortMap=function(){var t=this._canvasFECSubPort;return this._player.emit("FECCorrect.getFECSubPortMap",F(t)),t},e._createSplitCanvas=function(t,e){var a=this._player._playerWindow.canvasId,r=(e=a+e?","+this._FECSplitIds:"")?e.split(","):[],i=this._player.wasmplayer,n=[],s=this;if(t.correctList&&t.correctList.length>0){for(var x=0;x<t.correctList.length;x++)if(0!==x||!t.correctList[x].hidden)if(0!==x){var o=document.getElementById(r[x]);if(!r[x]||!o||"CANVAS"!==o.nodeName)return this._player.logger.error("Canvas element is null"),[];var f=i.JSPlayM4_FEC_GetPort(t.place,t.correctList[x].correctType),l=i.JSPlayM4_FEC_Enable(f),_=i.JSPlayM4_FEC_SetWnd(f,r[x]),h={upDateType:this._matchUpDateType(t.correctList[x].correctType),fValue:0,fPTZParam:{fPTZPositionX:t.correctList[x].x||0,fPTZPositionY:t.correctList[x].y||0},fPTZZoom:1e-5};this.setFEC2DParam(f,h),0===l||0===_?n.push({code:-1,msg:"失败",port:f,id:r[x]}):(n.push({code:0,msg:"成功",port:f,id:r[x]}),this._canvasFECSubPort.set(r[x],Jt({},qt,{port:f,param2d:h,startPTZPosition:{x:h.fPTZParam.fPTZPositionX,y:h.fPTZParam.fPTZPositionY}})),o.setAttribute("data-port",f+""),this._spliceCanvasMouseEvents(r[x],t.correctList[x]))}else c(t.correctList[0])}else c(t);function c(e){var r={upDateType:s._matchUpDateType(e.correctType),fValue:0,fPTZParam:{fPTZPositionX:e.x||0,fPTZPositionY:e.y||0},fPTZZoom:1e-5},x=s._canvasFECSubPort.get(a).port;if(void 0===x)return n;1===i.JSPlayM4_FEC_ResetCorrectType(x,t.place,e.correctType)?(n.push({code:0,msg:"成功",port:x,id:a}),e.correctType<=Kt?s.setFEC2DParam(x,r):e.viewParam&&setTimeout((function(){"number"==typeof e.viewParam.x&&"number"==typeof e.viewParam.y&&(i.JSPlayM4_FEC_SetViewParam(x,2,e.viewParam.x),i.JSPlayM4_FEC_SetViewParam(x,1,e.viewParam.y)),"number"==typeof e.viewParam.zoom&&i.JSPlayM4_FEC_SetViewParam(x,3,e.viewParam.zoom)}),200),s._canvasFECSubPort.set(a,Jt({},qt,{port:x,param2d:r,startPTZPosition:{x:r.fPTZParam.fPTZPositionX,y:r.fPTZParam.fPTZPositionY}})),s._spliceCanvasMouseEvents(a,e)):n.push({code:-1,msg:"失败",port:x,id:a})}return n},e._matchUpDateType=function(t){switch(t){case Kt:return 4;case 256:return 8}return 2},e._spliceCanvasMouseEvents=function(t,e){if(void 0!==t){var a=document.getElementById(t);if(null!==a){var r=this._player.wasmplayer,i=a.getAttribute("id"),n=this._canvasFECSubPort.get(i);if(void 0!==n.port){var s=a.width,x=a.height,o=function(t){};a.addEventListener("mousedown",(function(t){n.start.x=t.pageX,n.start.y=t.pageY,n.lastCorrdsY=t.pageY,o=function(t){!function(t){var a=[t.clientX,t.clientY];n.diff.y=a[1]-n.start.y;var i=(n.total.y+n.diff.y)/x*2*Math.PI,o=(a[1]-n.lastCorrdsY)/(2*x),f=Math.atan2(n.startPTZPosition.y-.5,n.startPTZPosition.x-.5),l=n.startPTZPosition.x+o*Math.cos(f),_=n.startPTZPosition.y+o*Math.sin(f);n.diff.x=a[0]-n.start.x;var h=(n.total.x+n.diff.x)/s*2*Math.PI,c=Math.sqrt(Math.pow(l-.5,2)+Math.pow(_-.5,2)),u=-h,d=.5+c*Math.cos(u),p=.5+c*Math.sin(u);if(e.correctType<=Kt){switch(e.correctType){case Kt:case 512:n.param2d.upDateType=4;break;case 256:if(n.param2d.upDateType=8,Math.sqrt(Math.pow(d-.5,2)+Math.pow(p-.5,2))>.4)return}n.param2d.fValue=h,n.param2d.fPTZParam.fPTZPositionX=d,n.param2d.fPTZParam.fPTZPositionY=p,r.JSPlayM4_FEC_SetParam(n.port,n.param2d)}else 1536===e.correctType&&(r.JSPlayM4_FEC_SetViewParam(n.port,2,h),r.JSPlayM4_FEC_SetViewParam(n.port,1,i))}(t)},a.addEventListener("mousemove",o)}));var f=function(){null!==o&&(a.removeEventListener("mousemove",o),o=null,n.total.x+=n.diff.x,n.total.y+=n.diff.y)};a.addEventListener("mouseup",f),a.addEventListener("mouseleave",f),a.addEventListener("mouseout",f)}}}},e._closeFECAllSubWnd=function(){if(this._FECSplitIds&&this._canvasFECSubPort&&this._supportFEC())for(var t,e=Zt(this._FECSplitIds.split(","));!(t=e()).done;){var a=t.value;if(a){var r=this._canvasFECSubPort.get(a);if(void 0===r||void 0===r.port)continue;this._canvasFECSubPort.delete(a);var i=this._player.wasmplayer;i.JSPlayM4_FEC_Disable(r.port,!0),i.JSPlayM4_FEC_DelPort(r.port)}}},t}(),$t=(null==(zt=new o)||null==(jt=zt.getResult)?void 0:jt.call(zt))||{};function te(t,e){return new Promise((function(a,r){t.service.getVideoByTime(e).then((function(r){t.emit(A.NETWORK.videoFragmentFiles,F(r.data||[],"根据时间获取存储文件信息",e.recType+"")),a(r)})).catch((function(e){t.emit(A.NETWORK.error.error,F(e)),t.emit(A.NETWORK.error.videoFragmentFiles,F(e)),r(e)}))}))}function ee(i,n){if(i._options=t.all([{},m,i._options||{},n],{clone:!1}),!i._options.id)throw new Error("id is required");if(!document.getElementById(i._options.id))throw new Error("#"+i._options.id+" node does not exist");if(i.pluginManager||(i.pluginManager=new E(i)),"string"!=typeof i._options.id)throw new Error("id is required and only support string");if(i.$container=i._options.container||document.getElementById(i._options.id),i._options.width){var s="";/\d/.test(i._options.width+"")?s+=";width: "+i._options.width+"px;":s+=";width: "+i._options.width+";",i.$container&&(i.$container.style.cssText+=s)}if(i._options.height){var o="";/\d/.test(i._options.height+"")?o+=";height: "+i._options.height+"px;":o+=";height: "+i._options.height+";",i.$container&&(i.$container.style.cssText+=o)}if(i.$container.style.cssText+=";position: relative;",i._width=i.$container.clientWidth,i._height=i.$container.clientHeight,i._oStreamClient||(i._oStreamClient=new Gt(i)),i.logger||(i.logger=e(i._options.logger)),i.logger.log("[version] ",pa.version),i.logger.log("[Browser Info] ",JSON.stringify($t)),i.logger.log("[options] ",JSON.stringify(i._options)),i.i18n||(i.i18n=new a({en:u,zh:d})),i.fECCorrect||(i.fECCorrect=new Qt(i)),i._options.accessToken&&p(i._options.url)){var f,l,_,h=null==(f=i.urlInfo)?void 0:f.deviceSerial;if(i.urlInfo=r(i._options.url),!i.urlInfo.deviceSerial||!i._options.accessToken)throw new Error("deviceSerial is required!");i.service=new x({deviceSerial:i.urlInfo.deviceSerial,accessToken:i._options.accessToken,domain:null==(_=i._options)||null==(l=_.env)?void 0:l.domain,extraParams:i._options.extraParams}),h!==i.urlInfo.deviceSerial&&(function(t){t.service.getDeviceCapacity().then((function(e){200==+e.code?(t.deviceCapacity=e.data,t.emit(A.NETWORK.deviceCapacity,F(e.data))):t.logger.error("getDeviceCapacity error: ",e)})).catch((function(e){t.emit(A.NETWORK.error.error,F(e)),t.emit(A.NETWORK.error.deviceCapacity,F(e)),t.logger.error("getDeviceCapacity error: ",e)}))}(i),function(t){t.emit(A.NETWORK.deviceInfo,F({})),t.service.getDeviceInfo().then((function(e){200==+e.code?(t.deviceInfo=e.data,t.emit(A.NETWORK.deviceInfo,F(e.data))):t.logger.error("deviceInfo error: ",e)})).catch((function(e){t.emit(A.NETWORK.error.error,F(e)),t.emit(A.NETWORK.error.deviceInfo,F(e)),t.logger.error("deviceInfo error: ",e)}))}(i)),i&&h&&(i.logger.log("play url change "+i._options.url),i.emit(A.urlChange,F(i._options.url)))}}var ae={0:void 0,1:"H264",2:"MPEG2",3:"MPEG4",4:"MotionJpeg",5:"H265",256:"H264"},re={0:void 0,4096:"ADPCM",8192:"MPEG",8193:"AAC",8194:"AACLD",12290:"OPUS",28944:"G711U",28945:"G711A",29217:"G722.1",29233:"G723.1",29280:"G726U",29281:"G726A",29328:"G729"},ie={dpr:1},ne=function(){function e(e){this._options=t(ie,e,{clone:!1}),this._$container=e.container,this.dpr=this._options.dpr||1,this._player=this._options.player,this._canvasWidth=Math.floor(this._$container.clientWidth),this._canvasHeight=Math.floor(this._$container.clientHeight)}var a=e.prototype;return a._render=function(){var t;this._removeCanvas(),this.canvasId=this._options.id+"-player",this.$canvas=document.createElement("canvas"),this.$canvas.classList.add("ezplayer-canvas"),this.$canvas.style.cssText+="width: 100%; height: 100%; pointer-events: none; user-select: none;",this.$canvas.setAttribute("id",this.canvasId),this.$canvas.setAttribute("width",this._canvasWidth*this.dpr+"px"),this.$canvas.setAttribute("height",this._canvasHeight*this.dpr+"px"),null==(t=this._$container)||t.appendChild(this.$canvas)},a.hide=function(){var t,e=null==(t=this._$container)?void 0:t.querySelector("#"+this.canvasId);e&&(e.style.display="none")},a.destroy=function(){this._removeCanvas(),this.width=0,this.height=0},a._removeCanvas=function(){var t=this._$container.querySelector("#"+this.canvasId);t&&(t.remove(),t=null,this.$canvas.remove(),this.$canvas=null)},a.resize=function(t,e){var a=this._$container.querySelector("#"+this.canvasId);if(a&&(this._canvasWidth!==t||this._canvasHeight!==e)){var r,i,n,s;this._canvasWidth=t,this._canvasHeight=e;try{a.width=this._canvasWidth*this.dpr,a.height=this._canvasHeight*this.dpr}catch(t){}if(null==(r=this._player)?void 0:r.wasmplayer)null==(s=this._player)||null==(n=s.wasmplayer)||null==(i=n.JSPlayM4_SetCanvasSize)||i.call(n,this._canvasWidth*this.dpr,this._canvasHeight*this.dpr)}},a.reRenderCanvas=function(t){t&&this._render()},e}(),se={exports:{}};!function(t,e){function a(t,e,a,r,i,n,s){try{var x=t[n](s),o=x.value}catch(t){return void a(t)}x.done?e(o):Promise.resolve(o).then(r,i)}function r(t){return function(){var e=this,r=arguments;return new Promise((function(i,n){var s=t.apply(e,r);function x(t){a(s,i,n,x,o,"next",t)}function o(t){a(s,i,n,x,o,"throw",t)}x(void 0)}))}}function i(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function n(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}function s(t,e){var a,r,i,n,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return n={next:x(0),throw:x(1),return:x(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function x(n){return function(x){return function(n){if(a)throw new TypeError("Generator is already executing.");for(;s;)try{if(a=1,r&&(i=2&n[0]?r.return:n[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,n[1])).done)return i;switch(r=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,r=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){s.label=n[1];break}if(6===n[0]&&s.label<i[1]){s.label=i[1],i=n;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(n);break}i[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],r=0}finally{a=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,x])}}}!function(a,r){if("object"==n(e)&&"object"==n(t))t.exports=r();else{var i=r();for(var s in i)("object"==n(e)?e:a)[s]=i[s]}}(self,(function(){return function(){var t={477:function(t){t.exports=function(t,e,a,r){var i=self||window;try{try{var n;try{n=new i.Blob([t])}catch(e){(n=new(i.BlobBuilder||i.WebKitBlobBuilder||i.MozBlobBuilder||i.MSBlobBuilder)).append(t),n=n.getBlob()}var s=i.URL||i.webkitURL,x=s.createObjectURL(n),o=new i[e](x,a);return s.revokeObjectURL(x),o}catch(r){return new i[e]("data:application/javascript,".concat(encodeURIComponent(t)),a)}}catch(t){if(!r)throw Error("Inline worker is not supported");return new i[e](r,a)}}},61:function(t,e,a){var r=a(698).default;function n(){t.exports=n=function(){return e},t.exports.__esModule=!0,t.exports.default=t.exports;var e={},a=Object.prototype,s=a.hasOwnProperty,x="function"==typeof Symbol?Symbol:{},o=x.iterator||"@@iterator",f=x.asyncIterator||"@@asyncIterator",l=x.toStringTag||"@@toStringTag";function _(t,e,a){return Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{_({},"")}catch(t){_=function(t,e,a){return t[e]=a}}function h(t,e,a,r){var n,s,x,o,f=e&&i(e.prototype,d)?e:d,l=Object.create(f.prototype),_=new v(r||[]);return l._invoke=(n=t,s=a,x=_,o="suspendedStart",function(t,e){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===t)throw e;return{value:void 0,done:!0}}for(x.method=t,x.arg=e;;){var a=x.delegate;if(a){var r=g(a,x);if(r){if(r===u)continue;return r}}if("next"===x.method)x.sent=x._sent=x.arg;else if("throw"===x.method){if("suspendedStart"===o)throw o="completed",x.arg;x.dispatchException(x.arg)}else"return"===x.method&&x.abrupt("return",x.arg);o="executing";var i=c(n,s,x);if("normal"===i.type){if(o=x.done?"completed":"suspendedYield",i.arg===u)continue;return{value:i.arg,done:x.done}}"throw"===i.type&&(o="completed",x.method="throw",x.arg=i.arg)}}),l}function c(t,e,a){try{return{type:"normal",arg:t.call(e,a)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var u={};function d(){}function p(){}function m(){}var S={};_(S,o,(function(){return this}));var R=Object.getPrototypeOf,P=R&&R(R(T([])));P&&P!==a&&s.call(P,o)&&(S=P);var y=m.prototype=d.prototype=Object.create(S);function b(t){["next","throw","return"].forEach((function(e){_(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function a(i,n,x,o){var f=c(t[i],t,n);if("throw"!==f.type){var l=f.arg,_=l.value;return _&&"object"==r(_)&&s.call(_,"__await")?e.resolve(_.__await).then((function(t){a("next",t,x,o)}),(function(t){a("throw",t,x,o)})):e.resolve(_).then((function(t){l.value=t,x(l)}),(function(t){return a("throw",t,x,o)}))}o(f.arg)}var i;this._invoke=function(t,r){function n(){return new e((function(e,i){a(t,r,e,i)}))}return i=i?i.then(n,n):n()}}function g(t,e){var a=t.iterator[e.method];if(void 0===a){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,g(t,e),"throw"===e.method))return u;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=c(a,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,u;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,u):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,u)}function F(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function v(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(F,this),this.reset(!0)}function T(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,r=function e(){for(;++a<t.length;)if(s.call(t,a))return e.value=t[a],e.done=!1,e;return e.value=void 0,e.done=!0,e};return r.next=r}}return{next:D}}function D(){return{value:void 0,done:!0}}return p.prototype=m,_(y,"constructor",m),_(m,"constructor",p),p.displayName=_(m,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,_(t,l,"GeneratorFunction")),t.prototype=Object.create(y),t},e.awrap=function(t){return{__await:t}},b(E.prototype),_(E.prototype,f,(function(){return this})),e.AsyncIterator=E,e.async=function(t,a,r,i,n){void 0===n&&(n=Promise);var s=new E(h(t,a,r,i),n);return e.isGeneratorFunction(a)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},b(y),_(y,l,"Generator"),_(y,o,(function(){return this})),_(y,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=[];for(var a in t)e.push(a);return e.reverse(),function a(){for(;e.length;){var r=e.pop();if(r in t)return a.value=r,a.done=!1,a}return a.done=!0,a}},e.values=T,v.prototype={constructor:v,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!t)for(var e in this)"t"===e.charAt(0)&&s.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function a(a,r){return n.type="throw",n.arg=t,e.next=a,r&&(e.method="next",e.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],n=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var x=s.call(i,"catchLoc"),o=s.call(i,"finallyLoc");if(x&&o){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(x){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!o)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(t,e){for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a];if(r.tryLoc<=this.prev&&s.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var n=i?i.completion:{};return n.type=t,n.arg=e,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(n)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),u},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.finallyLoc===t)return this.complete(a.completion,a.afterLoc),C(a),u}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var a=this.tryEntries[e];if(a.tryLoc===t){var r=a.completion;if("throw"===r.type){var i=r.arg;C(a)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,a){return this.delegate={iterator:T(t),resultName:e,nextLoc:a},"next"===this.method&&(this.arg=void 0),u}},e}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},698:function(t){function e(a){return t.exports=e="function"==typeof Symbol&&"symbol"==n(Symbol.iterator)?function(t){return void 0===t?"undefined":n(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":n(t)},t.exports.__esModule=!0,t.exports.default=t.exports,e(a)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},687:function(t,e,a){var r=a(61)();t.exports=r;try{regeneratorRuntime=r}catch(t){"object"==("undefined"==typeof globalThis?"undefined":n(globalThis))?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}}},e={};function a(r){var i=e[r];if(void 0!==i)return i.exports;var n=e[r]={exports:{}};return t[r](n,n.exports,a),n.exports}a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,{a:e}),e},a.d=function(t,e){for(var r in e)a.o(e,r)&&!a.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var x={};return function(){var t=function(t,e){if(!i(t,e))throw new TypeError("Cannot call a class as a function")},e=function(t,e,a){return e&&function(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t},o=function(t,e,a,r,i,n,s){try{var x=t[n](s),o=x.value}catch(t){return void a(t)}x.done?e(o):Promise.resolve(o).then(r,i)},f=function(t){return function(){var e=this,a=arguments;return new Promise((function(r,i){var n=t.apply(e,a);function s(t){o(n,r,i,s,x,"next",t)}function x(t){o(n,r,i,s,x,"throw",t)}s(void 0)}))}},l=function(){return xt()("((()=>{var _0x45ac74={0x3d:(_0x2144fd,_0x28ca5f,_0x50f6f4)=>{var _0x1d28a1=_0x50f6f4(0x2ba)['default'];function _0x17c634(){'use strict';_0x2144fd['exports']=_0x17c634=function(){return _0x53438e;},_0x2144fd['exports']['__esModule']=!0x0,_0x2144fd['exports']['default']=_0x2144fd['exports'];var _0x53438e={},_0x78b5bb=Object['prototype'],_0x2c7571=_0x78b5bb['hasOwnProperty'],_0x5a5a56='function'==typeof Symbol?Symbol:{},_0x200ac5=_0x5a5a56['iterator']||'@@iterator',_0x417898=_0x5a5a56['asyncIterator']||'@@asyncIterator',_0x34d154=_0x5a5a56['toStringTag']||'@@toStringTag';function _0x27b818(_0x6231c1,_0xbdb480,_0x20f211){return Object['defineProperty'](_0x6231c1,_0xbdb480,{'value':_0x20f211,'enumerable':!0x0,'configurable':!0x0,'writable':!0x0}),_0x6231c1[_0xbdb480];}try{_0x27b818({},'');}catch(_0x5cd418){_0x27b818=function(_0x216935,_0x1ef0a0,_0x347ef0){return _0x216935[_0x1ef0a0]=_0x347ef0;};}function _0x42a278(_0x228de4,_0xa6fe16,_0x21f8c7,_0x53e737){var _0x4a0309=_0xa6fe16&&_0xa6fe16['prototype']instanceof _0x3bff6c?_0xa6fe16:_0x3bff6c,_0x4d051d=Object['create'](_0x4a0309['prototype']),_0x2efbfc=new _0x42cfe9(_0x53e737||[]);return _0x4d051d['_invoke']=function(_0x4dfafa,_0x3b3a08,_0x30bf18){var _0x5c9a04='suspendedStart';return function(_0x495aaa,_0x52c875){if('executing'===_0x5c9a04)throw new Error('Generator\\x20is\\x20already\\x20running');if('completed'===_0x5c9a04){if('throw'===_0x495aaa)throw _0x52c875;return _0x10685a();}for(_0x30bf18['method']=_0x495aaa,_0x30bf18['arg']=_0x52c875;;){var _0x53c64d=_0x30bf18['delegate'];if(_0x53c64d){var _0x14ee94=_0x4c1170(_0x53c64d,_0x30bf18);if(_0x14ee94){if(_0x14ee94===_0x56ea54)continue;return _0x14ee94;}}if('next'===_0x30bf18['method'])_0x30bf18['sent']=_0x30bf18['_sent']=_0x30bf18['arg'];else{if('throw'===_0x30bf18['method']){if('suspendedStart'===_0x5c9a04)throw _0x5c9a04='completed',_0x30bf18['arg'];_0x30bf18['dispatchException'](_0x30bf18['arg']);}else'return'===_0x30bf18['method']&&_0x30bf18['abrupt']('return',_0x30bf18['arg']);}_0x5c9a04='executing';var _0xe9c533=_0x44f43a(_0x4dfafa,_0x3b3a08,_0x30bf18);if('normal'===_0xe9c533['type']){if(_0x5c9a04=_0x30bf18['done']?'completed':'suspendedYield',_0xe9c533['arg']===_0x56ea54)continue;return{'value':_0xe9c533['arg'],'done':_0x30bf18['done']};}'throw'===_0xe9c533['type']&&(_0x5c9a04='completed',_0x30bf18['method']='throw',_0x30bf18['arg']=_0xe9c533['arg']);}};}(_0x228de4,_0x21f8c7,_0x2efbfc),_0x4d051d;}function _0x44f43a(_0x38db47,_0x4831af,_0x1d704d){try{return{'type':'normal','arg':_0x38db47['call'](_0x4831af,_0x1d704d)};}catch(_0x24fa37){return{'type':'throw','arg':_0x24fa37};}}_0x53438e['wrap']=_0x42a278;var _0x56ea54={};function _0x3bff6c(){}function _0xcd9dfe(){}function _0x55dc28(){}var _0xc48466={};_0x27b818(_0xc48466,_0x200ac5,function(){return this;});var _0x37c075=Object['getPrototypeOf'],_0x41ef67=_0x37c075&&_0x37c075(_0x37c075(_0x57af99([])));_0x41ef67&&_0x41ef67!==_0x78b5bb&&_0x2c7571['call'](_0x41ef67,_0x200ac5)&&(_0xc48466=_0x41ef67);var _0x331dd8=_0x55dc28['prototype']=_0x3bff6c['prototype']=Object['create'](_0xc48466);function _0x368c20(_0x44e09d){['next','throw','return']['forEach'](function(_0x572305){_0x27b818(_0x44e09d,_0x572305,function(_0x452df3){return this['_invoke'](_0x572305,_0x452df3);});});}function _0x5bd679(_0x46ef91,_0x32fef8){function _0x4e5ad3(_0x2d4e04,_0x34590b,_0x59a504,_0x5a1c97){var _0x1c7a9e=_0x44f43a(_0x46ef91[_0x2d4e04],_0x46ef91,_0x34590b);if('throw'!==_0x1c7a9e['type']){var _0x492e73=_0x1c7a9e['arg'],_0x3f2c1f=_0x492e73['value'];return _0x3f2c1f&&'object'==_0x1d28a1(_0x3f2c1f)&&_0x2c7571['call'](_0x3f2c1f,'__await')?_0x32fef8['resolve'](_0x3f2c1f['__await'])['then'](function(_0x46f965){_0x4e5ad3('next',_0x46f965,_0x59a504,_0x5a1c97);},function(_0x123aca){_0x4e5ad3('throw',_0x123aca,_0x59a504,_0x5a1c97);}):_0x32fef8['resolve'](_0x3f2c1f)['then'](function(_0x43407b){_0x492e73['value']=_0x43407b,_0x59a504(_0x492e73);},function(_0x2289ed){return _0x4e5ad3('throw',_0x2289ed,_0x59a504,_0x5a1c97);});}_0x5a1c97(_0x1c7a9e['arg']);}var _0x30e1ba;this['_invoke']=function(_0x5e4030,_0x2aa88){function _0x519e84(){return new _0x32fef8(function(_0x385028,_0x13e84d){_0x4e5ad3(_0x5e4030,_0x2aa88,_0x385028,_0x13e84d);});}return _0x30e1ba=_0x30e1ba?_0x30e1ba['then'](_0x519e84,_0x519e84):_0x519e84();};}function _0x4c1170(_0x2340b5,_0x43cb96){var _0x52f508=_0x2340b5['iterator'][_0x43cb96['method']];if(void 0x0===_0x52f508){if(_0x43cb96['delegate']=null,'throw'===_0x43cb96['method']){if(_0x2340b5['iterator']['return']&&(_0x43cb96['method']='return',_0x43cb96['arg']=void 0x0,_0x4c1170(_0x2340b5,_0x43cb96),'throw'===_0x43cb96['method']))return _0x56ea54;_0x43cb96['method']='throw',_0x43cb96['arg']=new TypeError('The\\x20iterator\\x20does\\x20not\\x20provide\\x20a\\x20\\x27throw\\x27\\x20method');}return _0x56ea54;}var _0x57e015=_0x44f43a(_0x52f508,_0x2340b5['iterator'],_0x43cb96['arg']);if('throw'===_0x57e015['type'])return _0x43cb96['method']='throw',_0x43cb96['arg']=_0x57e015['arg'],_0x43cb96['delegate']=null,_0x56ea54;var _0x4601ed=_0x57e015['arg'];return _0x4601ed?_0x4601ed['done']?(_0x43cb96[_0x2340b5['resultName']]=_0x4601ed['value'],_0x43cb96['next']=_0x2340b5['nextLoc'],'return'!==_0x43cb96['method']&&(_0x43cb96['method']='next',_0x43cb96['arg']=void 0x0),_0x43cb96['delegate']=null,_0x56ea54):_0x4601ed:(_0x43cb96['method']='throw',_0x43cb96['arg']=new TypeError('iterator\\x20result\\x20is\\x20not\\x20an\\x20object'),_0x43cb96['delegate']=null,_0x56ea54);}function _0x5a0a12(_0x3298d1){var _0x4e500c={'tryLoc':_0x3298d1[0x0]};0x1 in _0x3298d1&&(_0x4e500c['catchLoc']=_0x3298d1[0x1]),0x2 in _0x3298d1&&(_0x4e500c['finallyLoc']=_0x3298d1[0x2],_0x4e500c['afterLoc']=_0x3298d1[0x3]),this['tryEntries']['push'](_0x4e500c);}function _0xb92410(_0x6bc06a){var _0x56c967=_0x6bc06a['completion']||{};_0x56c967['type']='normal',delete _0x56c967['arg'],_0x6bc06a['completion']=_0x56c967;}function _0x42cfe9(_0x51ab78){this['tryEntries']=[{'tryLoc':'root'}],_0x51ab78['forEach'](_0x5a0a12,this),this['reset'](!0x0);}function _0x57af99(_0x47efa3){if(_0x47efa3){var _0x5a8321=_0x47efa3[_0x200ac5];if(_0x5a8321)return _0x5a8321['call'](_0x47efa3);if('function'==typeof _0x47efa3['next'])return _0x47efa3;if(!isNaN(_0x47efa3['length'])){var _0x54d3a9=-0x1,_0x25ba1d=function _0x5587ab(){for(;++_0x54d3a9<_0x47efa3['length'];)if(_0x2c7571['call'](_0x47efa3,_0x54d3a9))return _0x5587ab['value']=_0x47efa3[_0x54d3a9],_0x5587ab['done']=!0x1,_0x5587ab;return _0x5587ab['value']=void 0x0,_0x5587ab['done']=!0x0,_0x5587ab;};return _0x25ba1d['next']=_0x25ba1d;}}return{'next':_0x10685a};}function _0x10685a(){return{'value':void 0x0,'done':!0x0};}return _0xcd9dfe['prototype']=_0x55dc28,_0x27b818(_0x331dd8,'constructor',_0x55dc28),_0x27b818(_0x55dc28,'constructor',_0xcd9dfe),_0xcd9dfe['displayName']=_0x27b818(_0x55dc28,_0x34d154,'GeneratorFunction'),_0x53438e['isGeneratorFunction']=function(_0x25b606){var _0x216003='function'==typeof _0x25b606&&_0x25b606['constructor'];return!!_0x216003&&(_0x216003===_0xcd9dfe||'GeneratorFunction'===(_0x216003['displayName']||_0x216003['name']));},_0x53438e['mark']=function(_0x1dbe3b){return Object['setPrototypeOf']?Object['setPrototypeOf'](_0x1dbe3b,_0x55dc28):(_0x1dbe3b['__proto__']=_0x55dc28,_0x27b818(_0x1dbe3b,_0x34d154,'GeneratorFunction')),_0x1dbe3b['prototype']=Object['create'](_0x331dd8),_0x1dbe3b;},_0x53438e['awrap']=function(_0x178484){return{'__await':_0x178484};},_0x368c20(_0x5bd679['prototype']),_0x27b818(_0x5bd679['prototype'],_0x417898,function(){return this;}),_0x53438e['AsyncIterator']=_0x5bd679,_0x53438e['async']=function(_0x58b8e5,_0x4f8bf5,_0x32f547,_0x4da264,_0x55261c){void 0x0===_0x55261c&&(_0x55261c=Promise);var _0x414838=new _0x5bd679(_0x42a278(_0x58b8e5,_0x4f8bf5,_0x32f547,_0x4da264),_0x55261c);return _0x53438e['isGeneratorFunction'](_0x4f8bf5)?_0x414838:_0x414838['next']()['then'](function(_0x4b24d5){return _0x4b24d5['done']?_0x4b24d5['value']:_0x414838['next']();});},_0x368c20(_0x331dd8),_0x27b818(_0x331dd8,_0x34d154,'Generator'),_0x27b818(_0x331dd8,_0x200ac5,function(){return this;}),_0x27b818(_0x331dd8,'toString',function(){return'[object\\x20Generator]';}),_0x53438e['keys']=function(_0x1cbe9f){var _0x4900b9=[];for(var _0x138a34 in _0x1cbe9f)_0x4900b9['push'](_0x138a34);return _0x4900b9['reverse'](),function _0x1d1e6a(){for(;_0x4900b9['length'];){var _0x413e3a=_0x4900b9['pop']();if(_0x413e3a in _0x1cbe9f)return _0x1d1e6a['value']=_0x413e3a,_0x1d1e6a['done']=!0x1,_0x1d1e6a;}return _0x1d1e6a['done']=!0x0,_0x1d1e6a;};},_0x53438e['values']=_0x57af99,_0x42cfe9['prototype']={'constructor':_0x42cfe9,'reset':function(_0x41fe5d){if(this['prev']=0x0,this['next']=0x0,this['sent']=this['_sent']=void 0x0,this['done']=!0x1,this['delegate']=null,this['method']='next',this['arg']=void 0x0,this['tryEntries']['forEach'](_0xb92410),!_0x41fe5d){for(var _0x4416e2 in this)'t'===_0x4416e2['charAt'](0x0)&&_0x2c7571['call'](this,_0x4416e2)&&!isNaN(+_0x4416e2['slice'](0x1))&&(this[_0x4416e2]=void 0x0);}},'stop':function(){this['done']=!0x0;var _0x46be91=this['tryEntries'][0x0]['completion'];if('throw'===_0x46be91['type'])throw _0x46be91['arg'];return this['rval'];},'dispatchException':function(_0x5b3b2f){if(this['done'])throw _0x5b3b2f;var _0x59fa79=this;function _0x27577f(_0xe59b4a,_0x50b3aa){return _0x5aff33['type']='throw',_0x5aff33['arg']=_0x5b3b2f,_0x59fa79['next']=_0xe59b4a,_0x50b3aa&&(_0x59fa79['method']='next',_0x59fa79['arg']=void 0x0),!!_0x50b3aa;}for(var _0x5a95fe=this['tryEntries']['length']-0x1;_0x5a95fe>=0x0;--_0x5a95fe){var _0x19b255=this['tryEntries'][_0x5a95fe],_0x5aff33=_0x19b255['completion'];if('root'===_0x19b255['tryLoc'])return _0x27577f('end');if(_0x19b255['tryLoc']<=this['prev']){var _0x5399db=_0x2c7571['call'](_0x19b255,'catchLoc'),_0x19160d=_0x2c7571['call'](_0x19b255,'finallyLoc');if(_0x5399db&&_0x19160d){if(this['prev']<_0x19b255['catchLoc'])return _0x27577f(_0x19b255['catchLoc'],!0x0);if(this['prev']<_0x19b255['finallyLoc'])return _0x27577f(_0x19b255['finallyLoc']);}else{if(_0x5399db){if(this['prev']<_0x19b255['catchLoc'])return _0x27577f(_0x19b255['catchLoc'],!0x0);}else{if(!_0x19160d)throw new Error('try\\x20statement\\x20without\\x20catch\\x20or\\x20finally');if(this['prev']<_0x19b255['finallyLoc'])return _0x27577f(_0x19b255['finallyLoc']);}}}}},'abrupt':function(_0x3f82ed,_0x45800e){for(var _0x900385=this['tryEntries']['length']-0x1;_0x900385>=0x0;--_0x900385){var _0x4ed843=this['tryEntries'][_0x900385];if(_0x4ed843['tryLoc']<=this['prev']&&_0x2c7571['call'](_0x4ed843,'finallyLoc')&&this['prev']<_0x4ed843['finallyLoc']){var _0x139d19=_0x4ed843;break;}}_0x139d19&&('break'===_0x3f82ed||'continue'===_0x3f82ed)&&_0x139d19['tryLoc']<=_0x45800e&&_0x45800e<=_0x139d19['finallyLoc']&&(_0x139d19=null);var _0x2171ec=_0x139d19?_0x139d19['completion']:{};return _0x2171ec['type']=_0x3f82ed,_0x2171ec['arg']=_0x45800e,_0x139d19?(this['method']='next',this['next']=_0x139d19['finallyLoc'],_0x56ea54):this['complete'](_0x2171ec);},'complete':function(_0x4a1802,_0x5e4083){if('throw'===_0x4a1802['type'])throw _0x4a1802['arg'];return'break'===_0x4a1802['type']||'continue'===_0x4a1802['type']?this['next']=_0x4a1802['arg']:'return'===_0x4a1802['type']?(this['rval']=this['arg']=_0x4a1802['arg'],this['method']='return',this['next']='end'):'normal'===_0x4a1802['type']&&_0x5e4083&&(this['next']=_0x5e4083),_0x56ea54;},'finish':function(_0x36781c){for(var _0x44a35c=this['tryEntries']['length']-0x1;_0x44a35c>=0x0;--_0x44a35c){var _0x18796a=this['tryEntries'][_0x44a35c];if(_0x18796a['finallyLoc']===_0x36781c)return this['complete'](_0x18796a['completion'],_0x18796a['afterLoc']),_0xb92410(_0x18796a),_0x56ea54;}},'catch':function(_0x287466){for(var _0x188b32=this['tryEntries']['length']-0x1;_0x188b32>=0x0;--_0x188b32){var _0xe870d6=this['tryEntries'][_0x188b32];if(_0xe870d6['tryLoc']===_0x287466){var _0x347a63=_0xe870d6['completion'];if('throw'===_0x347a63['type']){var _0x18f300=_0x347a63['arg'];_0xb92410(_0xe870d6);}return _0x18f300;}}throw new Error('illegal\\x20catch\\x20attempt');},'delegateYield':function(_0x4d71f3,_0xa1d91e,_0x4a3781){return this['delegate']={'iterator':_0x57af99(_0x4d71f3),'resultName':_0xa1d91e,'nextLoc':_0x4a3781},'next'===this['method']&&(this['arg']=void 0x0),_0x56ea54;}},_0x53438e;}_0x2144fd['exports']=_0x17c634,_0x2144fd['exports']['__esModule']=!0x0,_0x2144fd['exports']['default']=_0x2144fd['exports'];},0x2ba:_0x2db7de=>{function _0x2682e8(_0x5d4970){return _0x2db7de['exports']=_0x2682e8='function'==typeof Symbol&&'symbol'==typeof Symbol['iterator']?function(_0x4acb73){return typeof _0x4acb73;}:function(_0x5df8e7){return _0x5df8e7&&'function'==typeof Symbol&&_0x5df8e7['constructor']===Symbol&&_0x5df8e7!==Symbol['prototype']?'symbol':typeof _0x5df8e7;},_0x2db7de['exports']['__esModule']=!0x0,_0x2db7de['exports']['default']=_0x2db7de['exports'],_0x2682e8(_0x5d4970);}_0x2db7de['exports']=_0x2682e8,_0x2db7de['exports']['__esModule']=!0x0,_0x2db7de['exports']['default']=_0x2db7de['exports'];},0x2af:(_0x3f761a,_0x5774b7,_0x5a2d16)=>{var _0x2a52b9=_0x5a2d16(0x3d)();_0x3f761a['exports']=_0x2a52b9;try{regeneratorRuntime=_0x2a52b9;}catch(_0x4156d5){'object'==typeof globalThis?globalThis['regeneratorRuntime']=_0x2a52b9:Function('r','regeneratorRuntime\\x20=\\x20r')(_0x2a52b9);}}},_0x5aff17={};function _0x13cc86(_0x4027ba){var _0x3602db=_0x5aff17[_0x4027ba];if(void 0x0!==_0x3602db)return _0x3602db['exports'];var _0x341419=_0x5aff17[_0x4027ba]={'exports':{}};return _0x45ac74[_0x4027ba](_0x341419,_0x341419['exports'],_0x13cc86),_0x341419['exports'];}_0x13cc86['n']=_0x3a85fe=>{var _0x20b594=_0x3a85fe&&_0x3a85fe['__esModule']?()=>_0x3a85fe['default']:()=>_0x3a85fe;return _0x13cc86['d'](_0x20b594,{'a':_0x20b594}),_0x20b594;},_0x13cc86['d']=(_0x47ab47,_0x35cb4d)=>{for(var _0x3cf12d in _0x35cb4d)_0x13cc86['o'](_0x35cb4d,_0x3cf12d)&&!_0x13cc86['o'](_0x47ab47,_0x3cf12d)&&Object['defineProperty'](_0x47ab47,_0x3cf12d,{'enumerable':!0x0,'get':_0x35cb4d[_0x3cf12d]});},_0x13cc86['o']=(_0x496d11,_0x4b82aa)=>Object['prototype']['hasOwnProperty']['call'](_0x496d11,_0x4b82aa),((()=>{'use strict';function _0x1113ff(_0x5884dd){return _0x1113ff='function'==typeof Symbol&&'symbol'==typeof Symbol['iterator']?function(_0x4ed87d){return typeof _0x4ed87d;}:function(_0x4b9b6c){return _0x4b9b6c&&'function'==typeof Symbol&&_0x4b9b6c['constructor']===Symbol&&_0x4b9b6c!==Symbol['prototype']?'symbol':typeof _0x4b9b6c;},_0x1113ff(_0x5884dd);}function _0x164e7b(_0x23408b,_0xc508b8,_0x136398,_0x4566e9,_0x2a483d,_0x1ce4f5,_0x1adc69){try{var _0x163e7b=_0x23408b[_0x1ce4f5](_0x1adc69),_0x393d5e=_0x163e7b['value'];}catch(_0x5cacf3){return void _0x136398(_0x5cacf3);}_0x163e7b['done']?_0xc508b8(_0x393d5e):Promise['resolve'](_0x393d5e)['then'](_0x4566e9,_0x2a483d);}function _0x290ca7(_0x32a396){return function(){var _0x4fe6fa=this,_0x1e8cb7=arguments;return new Promise(function(_0x2a052e,_0x1f5663){var _0x56d5d5=_0x32a396['apply'](_0x4fe6fa,_0x1e8cb7);function _0x4344c3(_0x5e379c){_0x164e7b(_0x56d5d5,_0x2a052e,_0x1f5663,_0x4344c3,_0x168bae,'next',_0x5e379c);}function _0x168bae(_0x35cd52){_0x164e7b(_0x56d5d5,_0x2a052e,_0x1f5663,_0x4344c3,_0x168bae,'throw',_0x35cd52);}_0x4344c3(void 0x0);});};}function _0x32f3fa(_0x26d156,_0x77d896){if(!(_0x26d156 instanceof _0x77d896))throw new TypeError('Cannot\\x20call\\x20a\\x20class\\x20as\\x20a\\x20function');}function _0x18d179(_0x56dd0a,_0x39f218){for(var _0x2f538a=0x0;_0x2f538a<_0x39f218['length'];_0x2f538a++){var _0x18476a=_0x39f218[_0x2f538a];_0x18476a['enumerable']=_0x18476a['enumerable']||!0x1,_0x18476a['configurable']=!0x0,'value'in _0x18476a&&(_0x18476a['writable']=!0x0),Object['defineProperty'](_0x56dd0a,_0x18476a['key'],_0x18476a);}}function _0x551f25(_0x30a7f8,_0x27220d,_0x39276a){return _0x27220d&&_0x18d179(_0x30a7f8['prototype'],_0x27220d),_0x39276a&&_0x18d179(_0x30a7f8,_0x39276a),Object['defineProperty'](_0x30a7f8,'prototype',{'writable':!0x1}),_0x30a7f8;}var _0x2cd591=_0x13cc86(0x2af),_0x5cd95a=_0x13cc86['n'](_0x2cd591),_0xd86f77=0x501,_0x32049a=0x502,_0xf71e92=0x505,_0x115f84=0x507,_0x489408=0x508,_0x53fb4d=0x509,_0x1f9ba7=0x512,_0x5e80ef=0x516,_0x527ccc=0x1,_0x36ed43=0x2,_0x51aa1d=0x3,_0x46d36d=0x0,_0x1053ee=0x100,_0x5195df=0x200,_0x5c6ecb=0x300,_0x100fbf=0x400,_0x13d414=0x500,_0x4baf73=0x600,_0x3aa96c=0x700,_0x5c3f8c=0x800,_0x867a32=0x900,_0x4401a6=0xa00,_0x5782f0=0x1,_0x207e41=0x2,_0xd7ec59=0x4,_0x12d349=0x8,_0x109884=0x10,_0x13bc33=0x20,_0xa828b9=0x15000001,_0x48ad0f=0x1f000001,_0x694ebe=0x1f800000;function _0x257702(_0x262760,_0x1b656c){(null==_0x1b656c||_0x1b656c>_0x262760['length'])&&(_0x1b656c=_0x262760['length']);for(var _0x29452a=0x0,_0x2c8d15=new Array(_0x1b656c);_0x29452a<_0x1b656c;_0x29452a++)_0x2c8d15[_0x29452a]=_0x262760[_0x29452a];return _0x2c8d15;}function _0x315c7e(_0x1b7271){return function(_0x2c7f99){if(Array['isArray'](_0x2c7f99))return _0x257702(_0x2c7f99);}(_0x1b7271)||function(_0x5a546a){if('undefined'!=typeof Symbol&&null!=_0x5a546a[Symbol['iterator']]||null!=_0x5a546a['@@iterator'])return Array['from'](_0x5a546a);}(_0x1b7271)||function(_0x19b382,_0x5c16c6){if(_0x19b382){if('string'==typeof _0x19b382)return _0x257702(_0x19b382,_0x5c16c6);var _0x2df305=Object['prototype']['toString']['call'](_0x19b382)['slice'](0x8,-0x1);return'Object'===_0x2df305&&_0x19b382['constructor']&&(_0x2df305=_0x19b382['constructor']['name']),'Map'===_0x2df305||'Set'===_0x2df305?Array['from'](_0x19b382):'Arguments'===_0x2df305||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/['test'](_0x2df305)?_0x257702(_0x19b382,_0x5c16c6):void 0x0;}}(_0x1b7271)||(function(){throw new TypeError('Invalid\\x20attempt\\x20to\\x20spread\\x20non-iterable\\x20instance.\\x0aIn\\x20order\\x20to\\x20be\\x20iterable,\\x20non-array\\x20objects\\x20must\\x20have\\x20a\\x20[Symbol.iterator]()\\x20method.');}());}var _0x5e0a45=(function(){function _0x913c91(){_0x32f3fa(this,_0x913c91),this['startTime']=0x0,this['curTime']=0x0,this['timeWalk']=0x0,this['preTimerStamp']=0x0;}return _0x551f25(_0x913c91,[{'key':'Init','value':function(){this['startTime']=this['GetCurTime']();}},{'key':'GetCurTime','value':function(){return this['curTime']=0x18*new Date()['getDate']()*0x3c*0x3c*0x3e8+0x3c*new Date()['getHours']()*0x3c*0x3e8+0x3c*new Date()['getMinutes']()*0x3e8+0x3e8*new Date()['getSeconds']()+new Date()['getMilliseconds'](),this['curTime'];}},{'key':'GetTimerWalk','value':function(){return this['timeWalk']=this['GetCurTime']()-this['startTime'],this['timeWalk']<0x0&&(this['timeWalk']=0x0),this['timeWalk'];}},{'key':'timerReset','value':function(){this['startTime']=0x0,this['curTime']=0x0,this['timeWalk']=0x0,this['preTimerStamp']=0x0;}}]),_0x913c91;}());function _0x1ff2c0(_0xeecf02,_0x130509){var _0x48b561='undefined'!=typeof Symbol&&_0xeecf02[Symbol['iterator']]||_0xeecf02['@@iterator'];if(!_0x48b561){if(Array['isArray'](_0xeecf02)||(_0x48b561=function(_0x3c1520,_0x30461c){if(!_0x3c1520)return;if('string'==typeof _0x3c1520)return _0x944d7(_0x3c1520,_0x30461c);var _0x1141d7=Object['prototype']['toString']['call'](_0x3c1520)['slice'](0x8,-0x1);'Object'===_0x1141d7&&_0x3c1520['constructor']&&(_0x1141d7=_0x3c1520['constructor']['name']);if('Map'===_0x1141d7||'Set'===_0x1141d7)return Array['from'](_0x3c1520);if('Arguments'===_0x1141d7||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/['test'](_0x1141d7))return _0x944d7(_0x3c1520,_0x30461c);}(_0xeecf02))||_0x130509&&_0xeecf02&&'number'==typeof _0xeecf02['length']){_0x48b561&&(_0xeecf02=_0x48b561);var _0x2262b5=0x0,_0x2491b7=function(){};return{'s':_0x2491b7,'n':function(){return _0x2262b5>=_0xeecf02['length']?{'done':!0x0}:{'done':!0x1,'value':_0xeecf02[_0x2262b5++]};},'e':function(_0x4bc3d1){throw _0x4bc3d1;},'f':_0x2491b7};}throw new TypeError('Invalid\\x20attempt\\x20to\\x20iterate\\x20non-iterable\\x20instance.\\x0aIn\\x20order\\x20to\\x20be\\x20iterable,\\x20non-array\\x20objects\\x20must\\x20have\\x20a\\x20[Symbol.iterator]()\\x20method.');}var _0x576c2c,_0x5d3327=!0x0,_0x583222=!0x1;return{'s':function(){_0x48b561=_0x48b561['call'](_0xeecf02);},'n':function(){var _0x445727=_0x48b561['next']();return _0x5d3327=_0x445727['done'],_0x445727;},'e':function(_0x3a44ae){_0x583222=!0x0,_0x576c2c=_0x3a44ae;},'f':function(){try{_0x5d3327||null==_0x48b561['return']||_0x48b561['return']();}finally{if(_0x583222)throw _0x576c2c;}}};}function _0x944d7(_0x3f3846,_0x24dd99){(null==_0x24dd99||_0x24dd99>_0x3f3846['length'])&&(_0x24dd99=_0x3f3846['length']);for(var _0x25c87f=0x0,_0x2089ce=new Array(_0x24dd99);_0x25c87f<_0x24dd99;_0x25c87f++)_0x2089ce[_0x25c87f]=_0x3f3846[_0x25c87f];return _0x2089ce;}var _0x5ae48a=(function(){function _0x5549fb(_0x2c2905,_0x218606,_0x6b32b5,_0x55abb3){_0x32f3fa(this,_0x5549fb),this['width']=0x0,this['height']=0x0,this['decoderObj']=null,this['FirstFrame']=!0x0,this['ready_frames']=[],this['underflow']=!0x0,this['sab']=_0x2c2905,this['frameRate']=0x1e,this['needSetPreSoft']=!0x1,this['decoderCurStatus']=0x2,this['decoderOutSuccess']=!0x1,this['decoderObjNeedReset']=!0x1,this['oVideoRenderHandle']=_0x218606,this['output']=this['output']['bind'](this),this['reportError']=this['reportError']['bind'](this),this['player']=null,null!=_0x6b32b5&&(this['player']=_0x6b32b5),this['curFrame']=null,this['printfFlag']=this['oVideoRenderHandle']['printfFlag'],this['nGetTotalFrameNum']=0x0,this['nAverageDecodeTime']=0x0,this['oDecodeTimer']=null,this['runtimeInfoCBFun']=null,this['pstRuntimeInfo']={'nRunTimeModule':0x0,'nStrVersion':0x0,'nFrameTimeStamp':0x0,'nFrameNum':0x0,'nErrorCode':0x0,'nInputDataInterval':0x0,'nFrameNumInterval':0x0,'nAverageDecodeTime':0x0,'nSystemFormat':0x0,'nDetectRes':0x0,'nMp4FileTime':0x0,'nMp4TotalFrameNum':0x0,'AbsTimeYear':0x0,'AbsTimeMonth':0x0,'AbsTimeDay':0x0,'AbsTimeHour':0x0,'AbsTimeMinute':0x0,'AbsTimeSecond':0x0,'AbsTimeMilliseconds':0x0},this['HardDecFrameCount']=0x0,this['canvas']=_0x55abb3,this['bSetStreamEnd']=!0x1,this['bVisibility']=!0x0,this['back_ready_frames']=[],this['StartFrameTime']=0x0,this['WaitForFrameFlag']=0x0;}return _0x551f25(_0x5549fb,[{'key':'initDecoder','value':function(){if(null==this['decoderObj'])try{var _0x48227a={'output':this['output'],'error':this['reportError']};this['decoderObj']=new VideoDecoder(_0x48227a);}catch(_0xec6d74){0x0==this['oVideoRenderHandle']['firstFrame']?this['decoderObjNeedReset']=!0x0:(this['oVideoRenderHandle']['HardDecodeError'](),console['log']('%cswitch\\x20hardVideoDecoder\\x20to\\x20softVideoDecoder','color:\\x20red'));}''!=this['canvas']&&null!=this['canvas']&&(this['underflow']&&(this['underflow']=!0x1,this['oVideoRenderHandle']['RenderFrame']()['then'](function(){})),this['oVideoRenderHandle']['displayRunning']=!0x0),this['decoderCurStatus']=0x2,this['FirstFrame']=!0x0;}},{'key':'inputData','value':function(_0x3621f0,_0x301610){null!=this['decoderObj']&&(this['printfFlag']>0x0&&console['log']('VideoDecoder.js\\x20inputData\\x20videoInfo.timeStamp:'+_0x301610['timeStamp']+',decodeQueueSize:'+this['decoderObj']['decodeQueueSize']+',frameLength:'+this['ready_frames']['length']),('configured'==this['decoderObj']['state']||this['FirstFrame'])&&this['decodeProcess'](_0x3621f0,_0x301610),(this['ready_frames']['length']>0x64||this['decoderObj']['decodeQueueSize']>0x64)&&(this['player']?this['player']['JSPlayM4_GetDecodeBufferSize'](this['decoderObj']['decodeQueueSize'],this['ready_frames']['length']):postMessage({'function':'GetDecodeBufferSize','rawSize':this['decoderObj']['decodeQueueSize'],'frameSize':this['ready_frames']['length']})),_0x301610['nStreamEnd']&&this['SetStreamEnd']());}},{'key':'concatenate','value':function(_0x5e4a58){for(var _0x502cab=0x0,_0x349719=arguments['length'],_0x2f10cf=new Array(_0x349719>0x1?_0x349719-0x1:0x0),_0x40f3e5=0x1;_0x40f3e5<_0x349719;_0x40f3e5++)_0x2f10cf[_0x40f3e5-0x1]=arguments[_0x40f3e5];for(var _0x4fe5d4=0x0,_0x1bff12=_0x2f10cf;_0x4fe5d4<_0x1bff12['length'];_0x4fe5d4++){var _0xdae0f7=_0x1bff12[_0x4fe5d4];_0x502cab+=_0xdae0f7['length'];}for(var _0x458d11=new _0x5e4a58(_0x502cab),_0x3851df=0x0,_0x2158c2=0x0,_0x53f609=_0x2f10cf;_0x2158c2<_0x53f609['length'];_0x2158c2++){var _0x57603b=_0x53f609[_0x2158c2];_0x458d11['set'](_0x57603b,_0x3851df),_0x3851df+=_0x57603b['length'];}return _0x458d11;}},{'key':'processData','value':function(_0x533b4c){for(var _0x1abfdd=null,_0x4fd3bd=null,_0x34d3ee=null,_0x3982cf=!0x1,_0x2e2924=!0x1,_0x14ca78=0x0,_0x50e1cb=0x0;_0x50e1cb<_0x533b4c['length']-0x4;_0x50e1cb++){if(0x0!=_0x533b4c[_0x50e1cb]||0x0!=_0x533b4c[_0x50e1cb+0x1]||0x0!=_0x533b4c[_0x50e1cb+0x2]||0x1!=_0x533b4c[_0x50e1cb+0x3]||0x67!=_0x533b4c[_0x50e1cb+0x4]&&0x27!=_0x533b4c[_0x50e1cb+0x4]||(0x0!=_0x50e1cb?(_0x2e2924=!0x0,_0x1abfdd=_0x533b4c['slice'](_0x50e1cb),_0x14ca78=_0x50e1cb):_0x1abfdd=_0x533b4c),0x0==_0x533b4c[_0x50e1cb]&&0x0==_0x533b4c[_0x50e1cb+0x1]&&0x0==_0x533b4c[_0x50e1cb+0x2]&&0x1==_0x533b4c[_0x50e1cb+0x3]&&(0x9==_0x533b4c[_0x50e1cb+0x4]||0x6==_0x533b4c[_0x50e1cb+0x4])){if(null==_0x1abfdd)continue;null==_0x4fd3bd&&(_0x4fd3bd=_0x533b4c['slice'](_0x14ca78,_0x50e1cb),_0x3982cf=!0x0);}if(0x0==_0x533b4c[_0x50e1cb]&&0x0==_0x533b4c[_0x50e1cb+0x1]&&0x0==_0x533b4c[_0x50e1cb+0x2]&&0x1==_0x533b4c[_0x50e1cb+0x3]&&(0x65==_0x533b4c[_0x50e1cb+0x4]||0x25==_0x533b4c[_0x50e1cb+0x4])){_0x3982cf&&(_0x34d3ee=_0x533b4c['slice'](_0x50e1cb));break;}}return _0x3982cf?this['concatenate'](Uint8Array,_0x4fd3bd,_0x34d3ee):_0x2e2924?_0x1abfdd:_0x533b4c;}},{'key':'processData1','value':function(_0x14e101){return 0x0!=_0x14e101[0x0]||0x0!=_0x14e101[0x1]||0x0!=_0x14e101[0x2]||0x1!=_0x14e101[0x3]||0x9!=_0x14e101[0x4]&&0x6!=_0x14e101[0x4]?_0x14e101:_0x14e101['slice'](0x5);}},{'key':'formatVideoDecoderConfigure','value':function(_0x428bd9,_0x13824b,_0x27bdaa,_0x1861e3){var _0x133aea='';0x5==_0x13824b?(_0x133aea='hvc1.1.6.L123.00',this['printfFlag']>=0x0&&console['log']('265\\x20hard\\x20decoder')):0x100==_0x13824b?(_0x133aea='avc1.42001f',this['printfFlag']>=0x0&&console['log']('264\\x20hard\\x20decoder')):console['log']('Support\\x20Error:\\x20hard\\x20decoder\\x20only\\x20support\\x20264\\x20and\\x20265\\x20!!!');var _0x22cda3={'codec':_0x133aea,'hardwareAcceleration':'prefer-hardware','optimizeForLatency':0x1};return 0x5!=_0x13824b&&this['needSetPreSoft']&&(_0x22cda3['hardwareAcceleration']='prefer-software'),_0x22cda3;}},{'key':'decodeProcess','value':function(_0x1f0a4f,_0x5bc485){this['frameRate']!=_0x5bc485['frameRate']&&(this['frameRate']=_0x5bc485['frameRate']),this['width']!=_0x5bc485['width']&&(this['width']=_0x5bc485['width']),this['height']!=_0x5bc485['height']&&(this['height']=_0x5bc485['height']),_0x5bc485['needSetPreSoft']&&(this['needSetPreSoft']=_0x5bc485['needSetPreSoft']);var _0x26f1be=_0x1f0a4f;if(0x4!=this['decoderCurStatus']&&null!=this['decoderObj']){if(this['printfFlag']>0x0&&console['log']('VideoDecoder.js\\x20Decoder\\x20this.decoderObj.state:'+this['decoderObj']['state']),'configured'==this['decoderObj']['state']){var _0x5b68a5=new EncodedVideoChunk({'data':_0x26f1be,'timestamp':_0x5bc485['timeStamp'],'type':_0x5bc485['isKeyFrame']?'key':'delta'});try{this['decoderObj']['decode'](_0x5b68a5);}catch(_0x419be9){0x0==this['oVideoRenderHandle']['firstFrame']?this['decoderObjNeedReset']=!0x0:(this['oVideoRenderHandle']['HardDecodeError'](),console['log']('%cswitch\\x20hardVideoDecoder\\x20to\\x20softVideoDecoder','color:\\x20red'));}_0x26f1be=null,_0x1f0a4f=null,_0x5b68a5=null,_0x5bc485['frameType'];}else{if(_0x5bc485['isKeyFrame']&&'unconfigured'==this['decoderObj']['state']){var _0x2d219d=this['formatVideoDecoderConfigure'](_0x1f0a4f,_0x5bc485['codecType'],_0x5bc485['width'],_0x5bc485['height']);if(''==_0x2d219d['codec'])return-0x1;if(null!==this['decoderObj']){try{this['decoderObj']['configure'](_0x2d219d);}catch(_0x74b526){0x0==this['oVideoRenderHandle']['firstFrame']?this['decoderObjNeedReset']=!0x0:(this['oVideoRenderHandle']['HardDecodeError'](),console['log']('%cswitch\\x20hardVideoDecoder\\x20to\\x20softVideoDecoder','color:\\x20red'));}_0x26f1be=this['processData'](_0x1f0a4f),this['FirstFrame']=!0x1;var _0x3fc64d=new EncodedVideoChunk({'data':_0x26f1be,'timestamp':_0x5bc485['timeStamp'],'type':_0x5bc485['isKeyFrame']?'key':'delta'});try{this['decoderObj']['decode'](_0x3fc64d);}catch(_0x43ea05){0x0==this['oVideoRenderHandle']['firstFrame']?this['decoderObjNeedReset']=!0x0:(this['oVideoRenderHandle']['HardDecodeError'](),console['log']('%cswitch\\x20hardVideoDecoder\\x20to\\x20softVideoDecoder','color:\\x20red'));}_0x2d219d=null,_0x26f1be=null,_0x1f0a4f=null;}}}}}},{'key':'checkY','value':function(_0x3e068f,_0xc0c346,_0x13a783){Uint8Array['prototype']['compare']=function(_0x5d62c6,_0x995ce9,_0x1871da){for(var _0x4d9eef=0x0;_0x4d9eef<_0x1871da;_0x4d9eef++)if(this[_0x5d62c6+_0x4d9eef]!==this[_0x995ce9+_0x4d9eef])return-0x1;return 0x0;};for(var _0x109ad5=0x0,_0x92731=new Uint8Array(_0x3e068f),_0x4c70b8=(_0x13a783-0x8)*_0xc0c346,_0xb5cf0d=0x0;_0xb5cf0d<0x8;_0xb5cf0d++)for(var _0x56afc7=_0x4c70b8+_0xb5cf0d*_0xc0c346,_0xd097a9=0x0;_0xd097a9<_0xc0c346-0x10;_0xd097a9+=0x18){var _0x375487=_0x92731['compare'](_0x56afc7+_0xd097a9,_0x56afc7+_0xd097a9+0x8,0x8),_0x5ae22e=_0x92731['compare'](_0x56afc7+_0xd097a9+0x8,_0x56afc7+_0xd097a9+0x10,0x8);0x0===_0x375487&&0x0===_0x5ae22e&&(_0x92731[_0x56afc7+_0xd097a9]>0x7a&&_0x92731[_0x56afc7+_0xd097a9]<=0x80||0x0===_0x92731[_0x56afc7+_0xd097a9])&&_0x109ad5++;}return!(_0x109ad5>0x64);}},{'key':'output','value':function(_0x5e2e98){var _0x895542=this;if(this['printfFlag']>0x0&&console['log']('VideoDecoder.js\\x20output\\x20frame:'+_0x5e2e98+',frame.timestamp:'+_0x5e2e98['timestamp']),null!==this['decoderObj']){if('configured'==this['decoderObj']['state']&&this['bVisibility']){var _0x40af74=_0x5e2e98['timestamp'];if(this['oVideoRenderHandle']['VideoPrivateInfoMap']['size']>0x0){var _0x1883ef=this['oVideoRenderHandle']['VideoPrivateInfoMap']['get'](_0x40af74);if(null!=_0x1883ef){for(;_0x1883ef['linesInfo']['length']>0x0||_0x1883ef['fontInfo']['length']>0x0||_0x1883ef['imageInfo']['length']>0x0;)this['oVideoRenderHandle']['oVideoRender']['InputPrivateInfo'](_0x1883ef['linesInfo']['shift'](),_0x1883ef['fontInfo']['shift'](),_0x1883ef['imageInfo']['shift']());this['oVideoRenderHandle']['VideoPrivateInfoMap']['delete'](_0x40af74);}}if(this['printfFlag']>0x0&&console['log']('output1\\x20cb\\x20decodeQueueSize:'+this['decoderObj']['decodeQueueSize']+',length:'+this['ready_frames']['length']+',timestamp:'+_0x40af74+',systime:'+new Date()['getHours']()+':'+new Date()['getMinutes']()+':'+new Date()['getSeconds']()+'.'+new Date()['getMilliseconds']()),this['oVideoRenderHandle']['DecodeTypeFlagMap']['size']>0x0){var _0x52c223,_0x4bca4f=_0x1ff2c0(this['oVideoRenderHandle']['DecodeTypeFlagMap']['keys']());try{for(_0x4bca4f['s']();!(_0x52c223=_0x4bca4f['n']())['done'];){var _0x4f01d0=_0x52c223['value'];if(_0x4f01d0==_0xa828b9){if(0x1==this['oVideoRenderHandle']['DecodeTypeFlagMap']['get'](_0x4f01d0)&&null!=this['runtimeInfoCBFun']&&null!=this['oDecodeTimer']){var _0x38c40a=this['oDecodeTimer']['GetTimerWalk']();_0x38c40a<=0x0||_0x38c40a>0x989680||this['nGetTotalFrameNum']>0x186a0?(this['nGetTotalFrameNum']=0x0,this['oDecodeTimer']['Init']()):(this['nGetTotalFrameNum']++,this['nAverageDecodeTime']=_0x38c40a/this['nGetTotalFrameNum'],null!=this['runtimeInfoCBFun']&&(this['pstRuntimeInfo']['nRunTimeModule']=0x2,this['pstRuntimeInfo']['nStrVersion']=0x1,this['pstRuntimeInfo']['nFrameTimeStamp']=_0x40af74,this['pstRuntimeInfo']['nFrameNum']=0x0,this['pstRuntimeInfo']['nErrorCode']=_0xa828b9,this['pstRuntimeInfo']['nInputDataInterval']=0x0,this['pstRuntimeInfo']['nFrameNumInterval']=0x0,this['pstRuntimeInfo']['nAverageDecodeTime']=this['nAverageDecodeTime'],this['runtimeInfoCBFun'](this['pstRuntimeInfo'])));}}}}catch(_0x45a80f){_0x4bca4f['e'](_0x45a80f);}finally{_0x4bca4f['f']();}}if(null!=this['player']&&null!=this['player']['HardDecToJpegCBFun']){++this['HardDecFrameCount'];var _0xfa4389=_0x5e2e98['displayWidth'],_0x554b11=_0x5e2e98['displayHeight'];(this['HardDecFrameCount']-0x1)%this['player']['HardDecToJpegInterval']==0x0&&createImageBitmap(_0x5e2e98)['then'](function(_0x392331){_0x895542['player']?_0x895542['player']['_GetImage'](_0x392331,'jpeg',0x0,0x0,_0xfa4389,_0x554b11,_0x895542['HardDecFrameCount']):postMessage({'function':'bitmap','value':_0x392331,'type':'jpeg','sx':0x0,'sy':0x0,'sw':_0x5e2e98['displayWidth'],'sh':_0x5e2e98['displayHeight'],'framenum':_0x895542['HardDecFrameCount']});});}if(''!=this['canvas']&&null!=this['canvas']){if(this['printfFlag']>0x0&&console['log']('VideoDecoder.js\\x20WaitForFrameFlag:'+this['WaitForFrameFlag']+',frame.timestamp:'+_0x5e2e98['timestamp']+',StartFrameTime:'+this['StartFrameTime']),0x2==this['WaitForFrameFlag']&&_0x5e2e98['timestamp']>this['StartFrameTime']&&0x0!=this['StartFrameTime'])return _0x5e2e98['close'](),0x1;if(0x1==this['WaitForFrameFlag']&&_0x5e2e98['timestamp']<this['StartFrameTime']&&0x0!=this['StartFrameTime'])return _0x5e2e98['close'](),0x1;if(0x6==this['decoderCurStatus']){if(this['back_ready_frames']['length']>0xc8)_0x5e2e98['close']();else{var _0x4ede0f;new Object();if(this['oVideoRenderHandle']['findFramebyTime'](_0x5e2e98['timestamp'],0x0)['isKeyFrame'])this['back_ready_frames']['reverse'](),(_0x4ede0f=this['ready_frames'])['push']['apply'](_0x4ede0f,_0x315c7e(this['back_ready_frames'])),this['back_ready_frames']['splice'](0x0,this['back_ready_frames']['length']),createImageBitmap(_0x5e2e98)['then'](function(_0x525db1){_0x895542['back_ready_frames']['push']({'image':_0x525db1,'timestamp':_0x5e2e98['timestamp'],'displayWidth':_0x5e2e98['displayWidth'],'displayHeight':_0x5e2e98['displayHeight']}),_0x5e2e98['close']();});else createImageBitmap(_0x5e2e98)['then'](function(_0x5d541d){_0x895542['back_ready_frames']['push']({'image':_0x5d541d,'timestamp':_0x5e2e98['timestamp'],'displayWidth':_0x5e2e98['displayWidth'],'displayHeight':_0x5e2e98['displayHeight']}),_0x5e2e98['close']();}),this['decoderOutSuccess']||(this['decoderOutSuccess']=!0x0),this['decoderObj']['decodeQueueSize']<=0x1&&this['back_ready_frames']['length']<=0x1&&(this['player']?this['player']['JSPlayM4_GetRawData']():postMessage({'function':'GetRawData'}));}}else this['ready_frames']['length']>0x64?_0x5e2e98['close']():(this['ready_frames']['push'](_0x5e2e98),this['decoderOutSuccess']||(this['decoderOutSuccess']=!0x0),this['decoderObj']['decodeQueueSize']<=0x1&&this['ready_frames']['length']<=0x1&&(this['player']?this['player']['JSPlayM4_GetRawData']():postMessage({'function':'GetRawData'})));}else{if(_0x5e2e98['close'](),null!=this['player']&&null!=this['player']['runtimeCBFun']&&0x1==this['GetStreamEnd']()&&0x1==this['bSetStreamEnd']){var _0x226d25={'nRunTimeModule':0x0,'nStrVersion':0x0,'nFrameTimeStamp':0x0,'nFrameNum':0x0,'nErrorCode':0x9};this['player']['runtimeCBFun'](_0x226d25),this['bSetStreamEnd']=!0x1;}}}else _0x5e2e98['close']();}}},{'key':'output2','value':function(_0x4fabe9){var _0x5ed2ee=this;_0x4fabe9['timestamp'],createImageBitmap(_0x4fabe9)['then'](function(_0x141353){_0x4fabe9['close'](),_0x5ed2ee['ready_frames']['push'](_0x141353);});}},{'key':'reportError','value':function(_0xa1222e){if(this['oVideoRenderHandle']['DecodeTypeFlagMap']['size']>0x0){var _0x5df667,_0x1cc0da=_0x1ff2c0(this['oVideoRenderHandle']['DecodeTypeFlagMap']['keys']());try{for(_0x1cc0da['s']();!(_0x5df667=_0x1cc0da['n']())['done'];){var _0x4f5cef=_0x5df667['value'];if(0x80==_0x4f5cef)0x1==this['oVideoRenderHandle']['DecodeTypeFlagMap']['get'](_0x4f5cef)&&null!=this['runtimeInfoCBFun']&&(this['pstRuntimeInfo']['nRunTimeModule']=0x2,this['pstRuntimeInfo']['nStrVersion']=0x1,this['pstRuntimeInfo']['nFrameTimeStamp']=timestamp,this['pstRuntimeInfo']['nFrameNum']=0x0,this['pstRuntimeInfo']['nErrorCode']=0x80,this['runtimeInfoCBFun'](this['pstRuntimeInfo']));}}catch(_0x2d0b77){_0x1cc0da['e'](_0x2d0b77);}finally{_0x1cc0da['f']();}}console['log']('hardDecode\\x20reportError:'+_0xa1222e['message']+',state:'+this['decoderObj']['state']+',frameRate:'+this['frameRate']+'this.ready_frames.length:'+this['ready_frames']['length']),0x0==this['oVideoRenderHandle']['firstFrame']?this['decoderObjNeedReset']=!0x0:(this['oVideoRenderHandle']['HardDecodeError'](),console['log']('%cswitch\\x20hardVideoDecoder\\x20to\\x20softVideoDecoder','color:\\x20red'));}},{'key':'destroyDecoder','value':function(){var _0x54f724=this;return new Promise(function(_0x4eb0e4,_0x2613c6){_0x54f724['clearDecoderObjBuffer'](),null!=_0x54f724['decoderObj']&&('closed'!=_0x54f724['decoderObj']['state']&&_0x54f724['decoderObj']['close'](),_0x54f724['printfFlag']>=0x0&&console['log']('>>>JS\\x2001\\x20destroy\\x20decoderObj'),_0x54f724['decoderObj']=null),_0x54f724['decoderCurStatus']=0x4,_0x54f724['decoderOutSuccess']=!0x1,_0x54f724['FirstFrame']=!0x0,_0x54f724['needSetPreSoft']=!0x1,_0x54f724['decoderObjNeedReset']=!0x1,_0x54f724['curFrame']=null,null!==_0x54f724['oDecodeTimer']&&(_0x54f724['oDecodeTimer']['timerReset'](),_0x54f724['oDecodeTimer']=null),_0x4eb0e4();});}},{'key':'resetDecoder','value':function(){var _0x2fd403=this;return new Promise(function(_0x4adda3,_0x3bd99a){_0x2fd403['destroyDecoder']()['then'](function(){_0x2fd403['initDecoder'](),console['log']('%c\\x20reset\\x20hard\\x20decoder','color:red'),_0x4adda3();},function(){_0x3bd99a();});});}},{'key':'clearDecoderObjBuffer','value':function(){if(0x6==this['decoderCurStatus']){for(var _0x5d2308=this['ready_frames']['length'],_0x49c72e=0x0;_0x49c72e<_0x5d2308;_0x49c72e++){var _0xdf126d=this['ready_frames']['shift']();null!=_0xdf126d['image']&&null!=_0xdf126d['image']&&_0xdf126d['image']['close']();}this['ready_frames']['splice'](0x0,this['ready_frames']['length']);for(var _0x4f0e77=this['back_ready_frames']['length'],_0x2f62c8=0x0;_0x2f62c8<_0x4f0e77;_0x2f62c8++){var _0x2affad=this['back_ready_frames']['shift']();null!=_0x2affad['image']&&null!=_0x2affad['image']&&_0x2affad['image']['close']();}this['back_ready_frames']['splice'](0x0,this['back_ready_frames']['length']);}else{for(var _0x4c065b=this['ready_frames']['length'],_0x296d87=0x0;_0x296d87<_0x4c065b;_0x296d87++){this['ready_frames']['shift']()['close']();}this['ready_frames']['splice'](0x0,this['ready_frames']['length']);}this['resetDecoderObj']();}},{'key':'resetDecoderObj','value':function(){null!=this['decoderObj']&&'configured'==this['decoderObj']['state']&&(this['decoderObj']['reset'](),this['FirstFrame']=!0x0);}},{'key':'SetStreamEnd','value':function(){return null!=this['decoderObj']&&0x0==this['decoderObj']['decodeQueueSize']&&0x0==this['ready_frames']['length']&&(this['decoderObj']['flush'](),console['log']('flush')),this['bSetStreamEnd']=!0x0,0x1;}},{'key':'GetStreamEnd','value':function(){return null!=this['decoderObj']&&(0x0==this['decoderObj']['decodeQueueSize']&&0x0==this['ready_frames']['length']||void 0x0);}},{'key':'NotifyBackPlay','value':function(_0x161df5,_0x21b240,_0x352d6f){var _0x13b3fa=this;return 0x0!=_0x21b240?this['resetDecoder']()['then'](function(){_0x13b3fa['decoderCurStatus']=_0x161df5?0x6:0x2,_0x13b3fa['StartFrameTime']=_0x21b240,_0x13b3fa['WaitForFrameFlag']=_0x352d6f;}):(this['decoderCurStatus']=_0x161df5?0x6:0x2,this['StartFrameTime']=_0x21b240,this['WaitForFrameFlag']=_0x352d6f),0x1;}},{'key':'GetFrame','value':function(){var _0x3a40d3=this;return new Promise(function(_0x1f8afb,_0x562282){if(null!=_0x3a40d3['curFrame']){var _0x193f8f=_0x3a40d3['ready_frames']['shift']();0x6==_0x3a40d3['decoderCurStatus']?null!=_0x193f8f['image']&&null!=_0x193f8f['image']&&_0x193f8f['image']['close']():_0x193f8f['close'](),_0x193f8f=null,_0x3a40d3['curFrame']=null;}0x0!=_0x3a40d3['ready_frames']['length']?(_0x3a40d3['curFrame']=_0x3a40d3['ready_frames'][0x0],_0x1f8afb(_0x3a40d3['curFrame'])):(_0x3a40d3['curFrame']=null,_0x1f8afb(null));});}},{'key':'GetFrameBufferLength','value':function(){return this['ready_frames']['length'];}},{'key':'GetImageYUV','value':function(_0x4d3242,_0x2955d9,_0x5773ee,_0x1c3e30,_0x4667c1){var _0x16fbdd=this;return new Promise(function(_0x29621b,_0x146319){var _0x59a351=null;if(null!=_0x16fbdd['curFrame']?_0x59a351=_0x16fbdd['curFrame']:0x0!=_0x16fbdd['ready_frames']['length']&&(_0x59a351=_0x16fbdd['ready_frames'][0x0]),null!=_0x59a351){var _0x136d5f=_0x59a351['displayWidth'],_0x5328e0=_0x59a351['displayHeight'];new Uint8Array(_0x136d5f*_0x5328e0*0x3/0x2),_0x59a351['format'],(0x0==_0x2955d9&&0x0==_0x5773ee&&0x0==_0x1c3e30&&0x0==_0x4667c1&&(_0x1c3e30=_0x136d5f,_0x4667c1=_0x5328e0),createImageBitmap(_0x59a351)['then'](function(_0x4f7072){_0x16fbdd['player']?_0x16fbdd['player']['_GetImage'](_0x4f7072,_0x4d3242,_0x2955d9,_0x5773ee,_0x1c3e30,_0x4667c1,0x0):postMessage({'function':'bitmap','value':_0x4f7072,'type':_0x4d3242,'sx':_0x2955d9,'sy':_0x5773ee,'sw':_0x1c3e30,'sh':_0x4667c1,'framenum':0x0});}),_0x146319());}else _0x29621b({'yuvFrameBuffer':-0x1,'yuvLength':-0x1,'displayWidth':-0x1,'displayHeight':-0x1,'yuvType':-0x1});});}},{'key':'SetPrintLogFlag','value':function(_0x3b4a03){return this['printfFlag']=_0x3b4a03,0x1;}},{'key':'SetRunTimeInfoCallBackFun','value':function(_0x21076b,_0x592ede){return this['runtimeInfoCBFun']=_0x592ede,0x1;}},{'key':'SetRunTimeInfoCallbackType','value':function(_0x4df16e,_0x542aa3,_0x259e10){return _0x542aa3==_0xa828b9&&(this['nGetTotalFrameNum']=0x0,_0x259e10?null==this['oDecodeTimer']&&(this['oDecodeTimer']=new _0x5e0a45(),this['oDecodeTimer']['Init']()):null!==this['oDecodeTimer']&&(this['oDecodeTimer']['timerReset'](),this['oDecodeTimer']=null)),0x1;}},{'key':'IsVisible','value':function(_0x4f99e5){return this['bVisibility']=_0x4f99e5,0x1;}}]),_0x5549fb;}());function _0x180d2d(_0x301563,_0x452987,_0x5848d1){return _0x452987 in _0x301563?Object['defineProperty'](_0x301563,_0x452987,{'value':_0x5848d1,'enumerable':!0x0,'configurable':!0x0,'writable':!0x0}):_0x301563[_0x452987]=_0x5848d1,_0x301563;}var _0x1e3866={'d':function(_0x40f4b5,_0x47c7f9){for(var _0x1d011e in _0x47c7f9)_0x1e3866['o'](_0x47c7f9,_0x1d011e)&&!_0x1e3866['o'](_0x40f4b5,_0x1d011e)&&Object['defineProperty'](_0x40f4b5,_0x1d011e,{'enumerable':!0x0,'get':_0x47c7f9[_0x1d011e]});},'o':function(_0x4dc45f,_0x4b3a24){return Object['prototype']['hasOwnProperty']['call'](_0x4dc45f,_0x4b3a24);},'r':function(_0x2cc607){'undefined'!=typeof Symbol&&Symbol['toStringTag']&&Object['defineProperty'](_0x2cc607,Symbol['toStringTag'],{'value':'Module'}),Object['defineProperty'](_0x2cc607,'__esModule',{'value':!0x0});}},_0x42e492={};_0x1e3866['d'](_0x42e492,{'Dv':function(){return _0x331e43;},'CF':function(){return _0x51973c;},'bC':function(){return _0x5bf8a7;}});var _0x5bf8a7={};function _0x1d5976(_0x28fe2e,_0x31930e){if(!(_0x28fe2e instanceof _0x31930e))throw new TypeError('Cannot\\x20call\\x20a\\x20class\\x20as\\x20a\\x20function');}function _0x361761(_0x44ab18,_0x5148d3){for(var _0x45dc37=0x0;_0x45dc37<_0x5148d3['length'];_0x45dc37++){var _0x3ea43d=_0x5148d3[_0x45dc37];_0x3ea43d['enumerable']=_0x3ea43d['enumerable']||!0x1,_0x3ea43d['configurable']=!0x0,'value'in _0x3ea43d&&(_0x3ea43d['writable']=!0x0),Object['defineProperty'](_0x44ab18,_0x3ea43d['key'],_0x3ea43d);}}function _0x2d31ab(_0x2ee124,_0x5358d9,_0x5e9fdb){return _0x5358d9&&_0x361761(_0x2ee124['prototype'],_0x5358d9),_0x5e9fdb&&_0x361761(_0x2ee124,_0x5e9fdb),Object['defineProperty'](_0x2ee124,'prototype',{'writable':!0x1}),_0x2ee124;}_0x1e3866['r'](_0x5bf8a7),_0x1e3866['d'](_0x5bf8a7,{'ERRCODE':function(){return _0x2ffc1c;},'SRCALLBACKTYPE':function(){return _0x18ef32;},'SRDISPLAYEFFECT':function(){return _0x5dc8af;},'SRFISHPARAMTYPE':function(){return _0x34f5da;},'SRIMAGEROTATEANGLE':function(){return _0x185fa4;},'SRPIXELFORMAT':function(){return _0x444828;},'SRPOSTPROCTYPE':function(){return _0x3063cc;},'SRPTZDISPLAYMODE':function(){return _0x280409;},'SRRENDERSTATETYPE':function(){return _0x453ff1;},'SRSETRECTTYPE':function(){return _0x20e142;},'SRVIEWTYPE':function(){return _0x2fc4ee;}});var _0x238eca=3.1415926,_0x22bf32=0.78539815,_0x2ffc1c={'SR_OK':0x1,'SR_ERR_NOT_SUPPORT':0x80000001,'SR_ERR_SUBPORT':0x80000002,'SR_ERR_ALLOC_MEMORY':0x80000003,'SR_ERR_CALL_ORDER':0x80000004,'SR_ERR_PARAM':0x80000005,'SR_ERR_CAPTURE':0x80000006,'SR_ERR_SUBPORT_FULL':0x80000007,'SR_ERR_SHADER':0x80000008,'SR_ERR_3D_MODEL':0x80000009,'SR_ERR_FONT':0x8000000a,'SR_ERR_MEMORY_LIMIT':0x8000000b,'SR_ERR_WEBGPU_RESOURCE':0x8000000c,'SR_ERR_WEBGL_RESOURCE':0x8000000d,'SR_ERR_CANVAS':0x8000000e},_0x20e142={'SR_SRT_NULL':0x0,'SR_SRT_SRC':0x1,'SR_SRT_DST':0x2},_0x5dc8af={'SR_DE_NULL':0x0,'SR_DE_FISH_ORIGINAL':0x1,'SR_DE_FISH_PTZ_CEILING':0x2,'SR_DE_FISH_PTZ_FLOOR':0x3,'SR_DE_FISH_PTZ_WALL':0x4,'SR_DE_FISH_PANORAMA_CEILING_360':0x5,'SR_DE_FISH_PANORAMA_CEILING_180':0x6,'SR_DE_FISH_PANORAMA_FLOOR_360':0x7,'SR_DE_FISH_PANORAMA_FLOOR_180':0x8,'SR_DE_FISH_PANORAMA_WALL':0x9,'SR_DE_FISH_SEMISPHERE':0xa,'SR_DE_EAGLEEYE_SEMISPHERE':0xb,'SR_DE_EAGLEEYE_PLANE':0xc,'SR_DE_FISH_CYLINDER_CEILING':0xd,'SR_DE_FISH_CYLINDER_FLOOR':0xe,'SR_DE_FISH_CYLINDER_SPLIT_CEILING':0xf,'SR_DE_FISH_CYLINDER_SPLIT_FLOOR':0x10,'SR_DE_FISH_PLANET':0x11,'SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL':0x12,'SR_DE_FISH_ARCSPHERE_VERTICAL_WALL':0x13,'SR_DE_FISH_ANIMATION_SWITCH_CEILING':0x14,'SR_DE_FISH_ANIMATION_SWITCH_FLOOR':0x15,'SR_DE_PANORAMA_SPHERE':0x16,'SR_DE_PANORAMA_PLANET':0x17},_0x444828={'SR_PF_NULL':0x0,'SR_PF_YV12':0x1,'SR_PF_NV12':0x2,'SR_PF_I420':0x3,'SR_PF_RGB565':0x4,'SR_PF_RGBA32':0x5,'SR_PF_NV21':0x6,'SR_PF_SURFACE':0x100},_0x34f5da={'SR_FPT_NULL':0x0,'SR_FPT_CENTER':0x1,'SR_FPT_ANGLE':0x2,'SR_FPT_ZOOM':0x3,'SR_FPT_PTZ':0x4},_0x280409={'SR_DM_NULL':0x0,'SR_DM_RECT':0x1,'SR_DM_RANGE':0x2},_0x2fc4ee={'SR_VT_NULL':0x0,'SR_VT_ROTATION_X':0x1,'SR_VT_ROTATION_Y':0x2,'SR_VT_SCALE':0x3},_0x18ef32={'SR_CBT_NULL':0x0,'SR_CBT_OUT':0x1},_0x453ff1={'SR_RST_NULL':0x0,'SR_RST_VERTICALFLIP':0x1,'SR_RST_BACK_CULL':0x2,'SR_RST_IMAGE_ROTATE':0x3},_0x3063cc={'SR_PPT_NULL':0x0,'SR_PPT_BRIGHTNESS':0x1,'SR_PPT_HUE':0x2,'SR_PPT_SATURATION':0x3,'SR_PPT_CONTRAST':0x4,'SR_PPT_SHARPNESS':0x5},_0x185fa4={'SR_IRA_0':0x1,'SR_IRA_90':0x2,'SR_IRA_180':0x3,'SR_IRA_270':0x4},_0x2b6a7c=0.000001,_0x5a4621='undefined'!=typeof Float32Array?Float32Array:Array;function _0x110b84(){var _0x42c143=new _0x5a4621(0x10);return _0x5a4621!=Float32Array&&(_0x42c143[0x1]=0x0,_0x42c143[0x2]=0x0,_0x42c143[0x3]=0x0,_0x42c143[0x4]=0x0,_0x42c143[0x6]=0x0,_0x42c143[0x7]=0x0,_0x42c143[0x8]=0x0,_0x42c143[0x9]=0x0,_0x42c143[0xb]=0x0,_0x42c143[0xc]=0x0,_0x42c143[0xd]=0x0,_0x42c143[0xe]=0x0),_0x42c143[0x0]=0x1,_0x42c143[0x5]=0x1,_0x42c143[0xa]=0x1,_0x42c143[0xf]=0x1,_0x42c143;}function _0x327e19(_0x49daa1){return _0x49daa1[0x0]=0x1,_0x49daa1[0x1]=0x0,_0x49daa1[0x2]=0x0,_0x49daa1[0x3]=0x0,_0x49daa1[0x4]=0x0,_0x49daa1[0x5]=0x1,_0x49daa1[0x6]=0x0,_0x49daa1[0x7]=0x0,_0x49daa1[0x8]=0x0,_0x49daa1[0x9]=0x0,_0x49daa1[0xa]=0x1,_0x49daa1[0xb]=0x0,_0x49daa1[0xc]=0x0,_0x49daa1[0xd]=0x0,_0x49daa1[0xe]=0x0,_0x49daa1[0xf]=0x1,_0x49daa1;}function _0x1ae1d4(_0x2ed481,_0x5669fb,_0x53d7b2){var _0x36d23b=_0x5669fb[0x0],_0x2058af=_0x5669fb[0x1],_0x2a3284=_0x5669fb[0x2],_0x5f508a=_0x5669fb[0x3],_0x18257b=_0x5669fb[0x4],_0x55d6a1=_0x5669fb[0x5],_0x433a56=_0x5669fb[0x6],_0x4eddf8=_0x5669fb[0x7],_0x5e7419=_0x5669fb[0x8],_0x40c63c=_0x5669fb[0x9],_0x11a796=_0x5669fb[0xa],_0x593445=_0x5669fb[0xb],_0x400915=_0x5669fb[0xc],_0x5d6bce=_0x5669fb[0xd],_0x389c51=_0x5669fb[0xe],_0x4e9439=_0x5669fb[0xf],_0x2a5661=_0x53d7b2[0x0],_0x61f876=_0x53d7b2[0x1],_0x1194b5=_0x53d7b2[0x2],_0x176286=_0x53d7b2[0x3];return _0x2ed481[0x0]=_0x2a5661*_0x36d23b+_0x61f876*_0x18257b+_0x1194b5*_0x5e7419+_0x176286*_0x400915,_0x2ed481[0x1]=_0x2a5661*_0x2058af+_0x61f876*_0x55d6a1+_0x1194b5*_0x40c63c+_0x176286*_0x5d6bce,_0x2ed481[0x2]=_0x2a5661*_0x2a3284+_0x61f876*_0x433a56+_0x1194b5*_0x11a796+_0x176286*_0x389c51,_0x2ed481[0x3]=_0x2a5661*_0x5f508a+_0x61f876*_0x4eddf8+_0x1194b5*_0x593445+_0x176286*_0x4e9439,_0x2a5661=_0x53d7b2[0x4],_0x61f876=_0x53d7b2[0x5],_0x1194b5=_0x53d7b2[0x6],_0x176286=_0x53d7b2[0x7],_0x2ed481[0x4]=_0x2a5661*_0x36d23b+_0x61f876*_0x18257b+_0x1194b5*_0x5e7419+_0x176286*_0x400915,_0x2ed481[0x5]=_0x2a5661*_0x2058af+_0x61f876*_0x55d6a1+_0x1194b5*_0x40c63c+_0x176286*_0x5d6bce,_0x2ed481[0x6]=_0x2a5661*_0x2a3284+_0x61f876*_0x433a56+_0x1194b5*_0x11a796+_0x176286*_0x389c51,_0x2ed481[0x7]=_0x2a5661*_0x5f508a+_0x61f876*_0x4eddf8+_0x1194b5*_0x593445+_0x176286*_0x4e9439,_0x2a5661=_0x53d7b2[0x8],_0x61f876=_0x53d7b2[0x9],_0x1194b5=_0x53d7b2[0xa],_0x176286=_0x53d7b2[0xb],_0x2ed481[0x8]=_0x2a5661*_0x36d23b+_0x61f876*_0x18257b+_0x1194b5*_0x5e7419+_0x176286*_0x400915,_0x2ed481[0x9]=_0x2a5661*_0x2058af+_0x61f876*_0x55d6a1+_0x1194b5*_0x40c63c+_0x176286*_0x5d6bce,_0x2ed481[0xa]=_0x2a5661*_0x2a3284+_0x61f876*_0x433a56+_0x1194b5*_0x11a796+_0x176286*_0x389c51,_0x2ed481[0xb]=_0x2a5661*_0x5f508a+_0x61f876*_0x4eddf8+_0x1194b5*_0x593445+_0x176286*_0x4e9439,_0x2a5661=_0x53d7b2[0xc],_0x61f876=_0x53d7b2[0xd],_0x1194b5=_0x53d7b2[0xe],_0x176286=_0x53d7b2[0xf],_0x2ed481[0xc]=_0x2a5661*_0x36d23b+_0x61f876*_0x18257b+_0x1194b5*_0x5e7419+_0x176286*_0x400915,_0x2ed481[0xd]=_0x2a5661*_0x2058af+_0x61f876*_0x55d6a1+_0x1194b5*_0x40c63c+_0x176286*_0x5d6bce,_0x2ed481[0xe]=_0x2a5661*_0x2a3284+_0x61f876*_0x433a56+_0x1194b5*_0x11a796+_0x176286*_0x389c51,_0x2ed481[0xf]=_0x2a5661*_0x5f508a+_0x61f876*_0x4eddf8+_0x1194b5*_0x593445+_0x176286*_0x4e9439,_0x2ed481;}function _0x8f2f21(_0xc541ce,_0x184ae2,_0x2d798a,_0x5af359){var _0x26228c,_0x2662bc,_0x1ab763,_0x520eab,_0x5c75d4,_0x40f46e,_0xe9de23,_0x858be3,_0x4c7b0d,_0x5df921,_0x53fa82,_0x4f9470,_0x3b1f17,_0x3cb6fd,_0x123905,_0x1f44b8,_0x7fa1fc,_0x1c7175,_0x3faf6a,_0x32d9a0,_0x43a1e2,_0x37a854,_0x26238b,_0x104fb2,_0x555bfc=_0x5af359[0x0],_0x4916ae=_0x5af359[0x1],_0x4911f6=_0x5af359[0x2],_0x1d8054=Math['hypot'](_0x555bfc,_0x4916ae,_0x4911f6);return _0x1d8054<_0x2b6a7c?null:(_0x555bfc*=_0x1d8054=0x1/_0x1d8054,_0x4916ae*=_0x1d8054,_0x4911f6*=_0x1d8054,_0x26228c=Math['sin'](_0x2d798a),_0x1ab763=0x1-(_0x2662bc=Math['cos'](_0x2d798a)),_0x520eab=_0x184ae2[0x0],_0x5c75d4=_0x184ae2[0x1],_0x40f46e=_0x184ae2[0x2],_0xe9de23=_0x184ae2[0x3],_0x858be3=_0x184ae2[0x4],_0x4c7b0d=_0x184ae2[0x5],_0x5df921=_0x184ae2[0x6],_0x53fa82=_0x184ae2[0x7],_0x4f9470=_0x184ae2[0x8],_0x3b1f17=_0x184ae2[0x9],_0x3cb6fd=_0x184ae2[0xa],_0x123905=_0x184ae2[0xb],_0x1f44b8=_0x555bfc*_0x555bfc*_0x1ab763+_0x2662bc,_0x7fa1fc=_0x4916ae*_0x555bfc*_0x1ab763+_0x4911f6*_0x26228c,_0x1c7175=_0x4911f6*_0x555bfc*_0x1ab763-_0x4916ae*_0x26228c,_0x3faf6a=_0x555bfc*_0x4916ae*_0x1ab763-_0x4911f6*_0x26228c,_0x32d9a0=_0x4916ae*_0x4916ae*_0x1ab763+_0x2662bc,_0x43a1e2=_0x4911f6*_0x4916ae*_0x1ab763+_0x555bfc*_0x26228c,_0x37a854=_0x555bfc*_0x4911f6*_0x1ab763+_0x4916ae*_0x26228c,_0x26238b=_0x4916ae*_0x4911f6*_0x1ab763-_0x555bfc*_0x26228c,_0x104fb2=_0x4911f6*_0x4911f6*_0x1ab763+_0x2662bc,_0xc541ce[0x0]=_0x520eab*_0x1f44b8+_0x858be3*_0x7fa1fc+_0x4f9470*_0x1c7175,_0xc541ce[0x1]=_0x5c75d4*_0x1f44b8+_0x4c7b0d*_0x7fa1fc+_0x3b1f17*_0x1c7175,_0xc541ce[0x2]=_0x40f46e*_0x1f44b8+_0x5df921*_0x7fa1fc+_0x3cb6fd*_0x1c7175,_0xc541ce[0x3]=_0xe9de23*_0x1f44b8+_0x53fa82*_0x7fa1fc+_0x123905*_0x1c7175,_0xc541ce[0x4]=_0x520eab*_0x3faf6a+_0x858be3*_0x32d9a0+_0x4f9470*_0x43a1e2,_0xc541ce[0x5]=_0x5c75d4*_0x3faf6a+_0x4c7b0d*_0x32d9a0+_0x3b1f17*_0x43a1e2,_0xc541ce[0x6]=_0x40f46e*_0x3faf6a+_0x5df921*_0x32d9a0+_0x3cb6fd*_0x43a1e2,_0xc541ce[0x7]=_0xe9de23*_0x3faf6a+_0x53fa82*_0x32d9a0+_0x123905*_0x43a1e2,_0xc541ce[0x8]=_0x520eab*_0x37a854+_0x858be3*_0x26238b+_0x4f9470*_0x104fb2,_0xc541ce[0x9]=_0x5c75d4*_0x37a854+_0x4c7b0d*_0x26238b+_0x3b1f17*_0x104fb2,_0xc541ce[0xa]=_0x40f46e*_0x37a854+_0x5df921*_0x26238b+_0x3cb6fd*_0x104fb2,_0xc541ce[0xb]=_0xe9de23*_0x37a854+_0x53fa82*_0x26238b+_0x123905*_0x104fb2,_0x184ae2!==_0xc541ce&&(_0xc541ce[0xc]=_0x184ae2[0xc],_0xc541ce[0xd]=_0x184ae2[0xd],_0xc541ce[0xe]=_0x184ae2[0xe],_0xc541ce[0xf]=_0x184ae2[0xf]),_0xc541ce);}Math['random'],Math['PI'],Math['hypot']||(Math['hypot']=function(){for(var _0x40d27e=0x0,_0x393479=arguments['length'];_0x393479--;)_0x40d27e+=arguments[_0x393479]*arguments[_0x393479];return Math['sqrt'](_0x40d27e);});var _0x37b57e=function(_0xd3a02f,_0x10626d,_0x4fa205,_0x58961d,_0x29e88d){var _0x25e425=0x1/Math['tan'](_0x10626d/0x2);if(_0xd3a02f[0x0]=_0x25e425/_0x4fa205,_0xd3a02f[0x1]=0x0,_0xd3a02f[0x2]=0x0,_0xd3a02f[0x3]=0x0,_0xd3a02f[0x4]=0x0,_0xd3a02f[0x5]=_0x25e425,_0xd3a02f[0x6]=0x0,_0xd3a02f[0x7]=0x0,_0xd3a02f[0x8]=0x0,_0xd3a02f[0x9]=0x0,_0xd3a02f[0xb]=-0x1,_0xd3a02f[0xc]=0x0,_0xd3a02f[0xd]=0x0,_0xd3a02f[0xf]=0x0,null!=_0x29e88d&&_0x29e88d!==0x1/0x0){var _0x4a60cf=0x1/(_0x58961d-_0x29e88d);_0xd3a02f[0xa]=(_0x29e88d+_0x58961d)*_0x4a60cf,_0xd3a02f[0xe]=0x2*_0x29e88d*_0x58961d*_0x4a60cf;}else _0xd3a02f[0xa]=-0x1,_0xd3a02f[0xe]=-0x2*_0x58961d;return _0xd3a02f;};function _0x444554(_0x42d6a6,_0x1a3a32,_0x31ca97,_0x1978a2){var _0x4b27ea,_0x359d78,_0x44ef4f,_0x3453b0,_0x14fea8,_0x3cdb17,_0x201dc2,_0x42e8ac,_0xef2679,_0x866e64,_0x4508b8=_0x1a3a32[0x0],_0x8fceea=_0x1a3a32[0x1],_0x556a5e=_0x1a3a32[0x2],_0x37bfab=_0x1978a2[0x0],_0x44aa34=_0x1978a2[0x1],_0x1186ac=_0x1978a2[0x2],_0x27abd2=_0x31ca97[0x0],_0x49d966=_0x31ca97[0x1],_0x81f881=_0x31ca97[0x2];return Math['abs'](_0x4508b8-_0x27abd2)<_0x2b6a7c&&Math['abs'](_0x8fceea-_0x49d966)<_0x2b6a7c&&Math['abs'](_0x556a5e-_0x81f881)<_0x2b6a7c?_0x327e19(_0x42d6a6):(_0x201dc2=_0x4508b8-_0x27abd2,_0x42e8ac=_0x8fceea-_0x49d966,_0xef2679=_0x556a5e-_0x81f881,_0x4b27ea=_0x44aa34*(_0xef2679*=_0x866e64=0x1/Math['hypot'](_0x201dc2,_0x42e8ac,_0xef2679))-_0x1186ac*(_0x42e8ac*=_0x866e64),_0x359d78=_0x1186ac*(_0x201dc2*=_0x866e64)-_0x37bfab*_0xef2679,_0x44ef4f=_0x37bfab*_0x42e8ac-_0x44aa34*_0x201dc2,(_0x866e64=Math['hypot'](_0x4b27ea,_0x359d78,_0x44ef4f))?(_0x4b27ea*=_0x866e64=0x1/_0x866e64,_0x359d78*=_0x866e64,_0x44ef4f*=_0x866e64):(_0x4b27ea=0x0,_0x359d78=0x0,_0x44ef4f=0x0),_0x3453b0=_0x42e8ac*_0x44ef4f-_0xef2679*_0x359d78,_0x14fea8=_0xef2679*_0x4b27ea-_0x201dc2*_0x44ef4f,_0x3cdb17=_0x201dc2*_0x359d78-_0x42e8ac*_0x4b27ea,(_0x866e64=Math['hypot'](_0x3453b0,_0x14fea8,_0x3cdb17))?(_0x3453b0*=_0x866e64=0x1/_0x866e64,_0x14fea8*=_0x866e64,_0x3cdb17*=_0x866e64):(_0x3453b0=0x0,_0x14fea8=0x0,_0x3cdb17=0x0),_0x42d6a6[0x0]=_0x4b27ea,_0x42d6a6[0x1]=_0x3453b0,_0x42d6a6[0x2]=_0x201dc2,_0x42d6a6[0x3]=0x0,_0x42d6a6[0x4]=_0x359d78,_0x42d6a6[0x5]=_0x14fea8,_0x42d6a6[0x6]=_0x42e8ac,_0x42d6a6[0x7]=0x0,_0x42d6a6[0x8]=_0x44ef4f,_0x42d6a6[0x9]=_0x3cdb17,_0x42d6a6[0xa]=_0xef2679,_0x42d6a6[0xb]=0x0,_0x42d6a6[0xc]=-(_0x4b27ea*_0x4508b8+_0x359d78*_0x8fceea+_0x44ef4f*_0x556a5e),_0x42d6a6[0xd]=-(_0x3453b0*_0x4508b8+_0x14fea8*_0x8fceea+_0x3cdb17*_0x556a5e),_0x42d6a6[0xe]=-(_0x201dc2*_0x4508b8+_0x42e8ac*_0x8fceea+_0xef2679*_0x556a5e),_0x42d6a6[0xf]=0x1,_0x42d6a6);}function _0x36d598(){var _0x259b3b=new _0x5a4621(0x3);return _0x5a4621!=Float32Array&&(_0x259b3b[0x0]=0x0,_0x259b3b[0x1]=0x0,_0x259b3b[0x2]=0x0),_0x259b3b;}function _0x54263a(_0x3e9c40,_0x5cde71,_0xde849e){var _0x399f6d=new _0x5a4621(0x3);return _0x399f6d[0x0]=_0x3e9c40,_0x399f6d[0x1]=_0x5cde71,_0x399f6d[0x2]=_0xde849e,_0x399f6d;}function _0xf89014(){var _0x115df8=new _0x5a4621(0x4);return _0x5a4621!=Float32Array&&(_0x115df8[0x0]=0x0,_0x115df8[0x1]=0x0,_0x115df8[0x2]=0x0),_0x115df8[0x3]=0x1,_0x115df8;}_0x36d598(),(function(){var _0x1bda3f;_0x1bda3f=new _0x5a4621(0x4),_0x5a4621!=Float32Array&&(_0x1bda3f[0x0]=0x0,_0x1bda3f[0x1]=0x0,_0x1bda3f[0x2]=0x0,_0x1bda3f[0x3]=0x0);}());var _0x29f5bf;_0x36d598(),_0x54263a(0x1,0x0,0x0),_0x54263a(0x0,0x1,0x0),_0xf89014(),_0xf89014(),_0x29f5bf=new _0x5a4621(0x9),_0x5a4621!=Float32Array&&(_0x29f5bf[0x1]=0x0,_0x29f5bf[0x2]=0x0,_0x29f5bf[0x3]=0x0,_0x29f5bf[0x5]=0x0,_0x29f5bf[0x6]=0x0,_0x29f5bf[0x7]=0x0),_0x29f5bf[0x0]=0x1,_0x29f5bf[0x4]=0x1,_0x29f5bf[0x8]=0x1,(function(){var _0x589737=new _0x5a4621(0x2);_0x5a4621!=Float32Array&&(_0x589737[0x0]=0x0,_0x589737[0x1]=0x0);}());var _0x7944d4='\\x0aattribute\\x20vec4\\x20position;\\x20\\x0aattribute\\x20vec4\\x20texCoord;\\x20\\x0avarying\\x20vec4\\x20pp;\\x20\\x0auniform\\x20int\\x20bCapture;\\x20\\x0a\\x0avoid\\x20main(void)\\x20{\\x0a\\x20\\x20if(bCapture\\x20==\\x201)\\x0a\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20gl_Position\\x20=\\x20position;\\x0a\\x20\\x20\\x20\\x20gl_Position.y\\x20=\\x20-position.y;\\x0a\\x20\\x20}\\x0a\\x20\\x20else\\x0a\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20gl_Position\\x20=\\x20position;\\x0a\\x20\\x20}\\x0a\\x20\\x20pp\\x20=\\x20texCoord;\\x0a}\\x0a',_0x5810c2='\\x0aprecision\\x20mediump\\x20float;\\x0avarying\\x20vec4\\x20pp;\\x0auniform\\x20sampler2D\\x20Ytexture;\\x0auniform\\x20sampler2D\\x20Utexture;\\x0auniform\\x20sampler2D\\x20Vtexture;\\x0auniform\\x20int\\x20bDataFormat;\\x0auniform\\x20float\\x20fAlpha;\\x0auniform\\x20int\\x20bDrawImage;\\x0a\\x0avoid\\x20main(void)\\x0a{\\x0a\\x20\\x20\\x20\\x20float\\x20r,g,b,y,u,v;\\x0a\\x20\\x20\\x20\\x20if(bDataFormat\\x20==\\x200)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y\\x20=\\x20texture2D(Ytexture,\\x20pp.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u\\x20=\\x20texture2D(Utexture,\\x20pp.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v\\x20=\\x20texture2D(Vtexture,\\x20pp.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y=1.1643*(y-0.0625);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u=u-0.5;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v=v-0.5;\\x20\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r=y+1.5958*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g=y-0.39173*u-0.81290*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b=y+2.017*u;\\x20\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor=vec4(r,\\x20g,\\x20b,\\x201.0);\\x0a\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20else\\x20if(bDataFormat\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor\\x20=\\x20texture2D(Ytexture,\\x20pp.st);\\x0a\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20if(bDrawImage\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor.a\\x20*=\\x20fAlpha;\\x20\\x0a\\x20\\x20\\x20\\x20}\\x0a}\\x0a',_0x27b6a6='\\x0a\\x20\\x20\\x20\\x20varying\\x20\\x20mediump\\x20float\\x20pp;\\x0a\\x20\\x20\\x20\\x20varying\\x20\\x20lowp\\x20vec4\\x20\\x20colorOut;\\x0a\\x20\\x20\\x20\\x20void\\x20main()\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor\\x20=\\x20colorOut;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20mediump\\x20float\\x20fx\\x20=\\x20abs(pp);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if\\x20(fx\\x20>\\x200.2)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor.a\\x20=\\x20colorOut.a*(1.25\\x20-\\x201.25*fx);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x20\\x0a\\x20\\x20\\x20\\x20}\\x20\\x0a',_0x5580fc='\\x0a\\x20\\x20\\x20\\x20attribute\\x20vec4\\x20\\x20position;\\x0a\\x20\\x20\\x20\\x20attribute\\x20vec4\\x20\\x20texCoord;\\x0a\\x20\\x20\\x20\\x20varying\\x20vec4\\x20\\x20pp;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20int\\x20bCapture;\\x0a\\x20\\x20\\x20\\x20uniform\\x20\\x20\\x20mat4\\x20\\x20\\x20matRotate;\\x0a\\x0a\\x20\\x20\\x20\\x20void\\x20main()\\x0a\\x20\\x20\\x20\\x20{\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position.x\\x20\\x20=\\x20position.x;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position.y\\x20\\x20=\\x20position.y;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(bCapture\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position.y\\x20=\\x20-position.y;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position.z\\x20\\x20=\\x200.1;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position.w\\x20\\x20=\\x201.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20pp\\x20=\\x20matRotate\\x20*\\x20texCoord;\\x20\\x0a\\x20\\x20\\x20\\x20}\\x0a',_0xf24101='\\x0a\\x20\\x20\\x20\\x20varying\\x20lowp\\x20vec4\\x20pp;\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20texture;\\x0a\\x0a\\x20\\x20\\x20\\x20void\\x20main(void)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor\\x20=\\x20texture2D(texture,\\x20pp.st);\\x0a\\x20\\x20\\x20\\x20}\\x0a',_0x291446='\\x0a\\x20\\x20\\x20\\x20attribute\\x20vec4\\x20position;\\x20\\x0a\\x20\\x20\\x20\\x20attribute\\x20vec4\\x20texCoord;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20\\x20\\x20mat4\\x20\\x20\\x20matRotate;\\x20\\x0a\\x20\\x20\\x20\\x20varying\\x20vec4\\x20pp;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20int\\x20bCapture;\\x0a\\x0a\\x20\\x20\\x20\\x20void\\x20main()\\x20\\x0a\\x20\\x20\\x20\\x20{\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position\\x20=\\x20position\\x20*\\x20matRotate;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(bCapture\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position.y\\x20=\\x20\\x20-gl_Position.y;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20pp\\x20=\\x20texCoord;\\x20\\x0a\\x20\\x20\\x20\\x20}\\x20\\x0a',_0x41417f='\\x0a\\x20\\x20\\x20\\x20precision\\x20mediump\\x20float;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20texture;\\x0a\\x20\\x20\\x20\\x20varying\\x20lowp\\x20vec4\\x20pp;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fAlpha;\\x0a\\x20\\x20\\x20\\x20void\\x20main(void)\\x20\\x0a\\x20\\x20\\x20\\x20{\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor\\x20=\\x20texture2D(texture,\\x20pp.st);\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor.a\\x20*=\\x20fAlpha;\\x20\\x0a\\x20\\x20\\x20\\x20}\\x20\\x0a',_0x2c1c95=(function(){function _0x17b1f6(){_0x1d5976(this,_0x17b1f6),this['fFov']=1.57,this['fAspect']=0x1,this['fNear']=0.1,this['fFar']=0x3e8,this['fTheta']=0x0,this['fAlpha']=0x0,this['fBeta']=0x0,this['fScale']=0x1,this['bOrtho']=!0x1,this['matView']=_0x110b84(),this['matProj']=_0x110b84(),this['vecEye']=_0x54263a(0x0,0x0,0x0),this['vecCenter']=_0x54263a(0x0,0x0,0x64),this['vecUp']=_0x54263a(0x0,0x1,0x0);}return _0x2d31ab(_0x17b1f6,[{'key':'SetYaw','value':function(_0x2fcb68){this['fTheta']=_0x2fcb68;}},{'key':'GetYaw','value':function(){return this['fTheta'];}},{'key':'SetPitch','value':function(_0x1fc5f9){this['fAlpha']=_0x1fc5f9;}},{'key':'GetPitch','value':function(){return this['fAlpha'];}},{'key':'SetRoll','value':function(_0x4cb2fd){this['fBeta']=_0x4cb2fd;}},{'key':'GetRoll','value':function(){return this['fBeta'];}},{'key':'SetScale','value':function(_0x9f9eaa){this['fScale']=_0x9f9eaa;}},{'key':'GetScale','value':function(){return this['fScale'];}},{'key':'SetFov','value':function(_0x109bde){this['fFov']=_0x109bde;}},{'key':'SetAspect','value':function(_0x213d72){this['fAspect']=_0x213d72;}},{'key':'SetNear','value':function(_0x5c77de){this['fNear']=_0x5c77de;}},{'key':'SetFar','value':function(_0x1d4891){this['fFar']=_0x1d4891;}},{'key':'SetOrtho','value':function(_0x46cee9){this['bOrtho']=_0x46cee9;}},{'key':'UpdateCamera','value':function(_0x32b43b,_0xdefd37){if(!(_0x32b43b<=0x0||_0xdefd37<=0x0)){0x1==this['bOrtho']?(function(_0x290720,_0x9e380a,_0x3398a3,_0x536fc0,_0x3fba3c,_0x28d393,_0x30f2a3){var _0x18264c=0x1/(_0x9e380a-_0x3398a3),_0x33434a=0x1/(_0x536fc0-_0x3fba3c),_0x5aa433=0x1/(_0x28d393-_0x30f2a3);_0x290720[0x0]=-0x2*_0x18264c,_0x290720[0x1]=0x0,_0x290720[0x2]=0x0,_0x290720[0x3]=0x0,_0x290720[0x4]=0x0,_0x290720[0x5]=-0x2*_0x33434a,_0x290720[0x6]=0x0,_0x290720[0x7]=0x0,_0x290720[0x8]=0x0,_0x290720[0x9]=0x0,_0x290720[0xa]=0x2*_0x5aa433,_0x290720[0xb]=0x0,_0x290720[0xc]=(_0x9e380a+_0x3398a3)*_0x18264c,_0x290720[0xd]=(_0x3fba3c+_0x536fc0)*_0x33434a,_0x290720[0xe]=(_0x30f2a3+_0x28d393)*_0x5aa433,_0x290720[0xf]=0x1;}(this['matProj'],0x0,(0x2-1.5*this['fAlpha'])*(_0x32b43b/_0xdefd37),0x0,0x2-1.5*this['fAlpha'],this['fNear'],this['fFar']),this['matProj'][0xc]=0x0,this['matProj'][0xd]=0x0):_0x37b57e(this['matProj'],this['fFov'],_0x32b43b/_0xdefd37,this['fNear'],this['fFar']),this['vecEye']=_0x54263a(0x0,0x0,this['fScale']),this['vecCenter']=_0x54263a(0x0,0x0,-0x64),this['vecUp']=_0x54263a(0x0,0x1,0x0);var _0x5edafd=_0x54263a(0x1,0x0,0x0),_0x4733ec=_0x54263a(0x0,0x1,0x0),_0x225df2=_0x54263a(0x0,0x0,0x1),_0x1a2959=_0x110b84();_0x444554(_0x1a2959,this['vecEye'],this['vecCenter'],this['vecUp']);var _0x373dda=_0x110b84(),_0x3a345d=_0x110b84(),_0x128107=_0x110b84(),_0x70389c=_0x110b84();_0x8f2f21(_0x3a345d,_0x373dda,-this['fAlpha'],_0x5edafd),_0x8f2f21(_0x128107,_0x3a345d,-this['fTheta'],_0x4733ec),_0x8f2f21(_0x70389c,_0x128107,-this['fBeta'],_0x225df2),_0x1ae1d4(this['matView'],_0x1a2959,_0x70389c);}}},{'key':'GetView','value':function(){return this['matView'];}},{'key':'GetProj','value':function(){return this['matProj'];}}]),_0x17b1f6;}()),_0x2b90ab=(function(){function _0x54fff7(){_0x1d5976(this,_0x54fff7),this['fFov']=1.57,this['fAspect']=0x1,this['fNear']=0.1,this['fFar']=0x3e8,this['fAlpha']=0x0,this['fTheta']=0x0,this['fScale']=0x1,this['bPano']=!0x1,this['matView']=_0x110b84(),this['matProj']=_0x110b84(),this['vecEye']=_0x54263a(0x0,0x0,0.99),this['vecCenter']=_0x54263a(0x0,0x0,-0x64),this['vecUp']=_0x54263a(0x0,0x1,0x0);}return _0x2d31ab(_0x54fff7,[{'key':'SetPitch','value':function(_0x5d8578){this['fAlpha']=_0x5d8578;}},{'key':'GetPitch','value':function(){return this['fAlpha'];}},{'key':'SetYaw','value':function(_0x152166){this['fTheta']=_0x152166;}},{'key':'GetYaw','value':function(){return this['fTheta'];}},{'key':'SetScale','value':function(_0x1de337){this['fScale']=_0x1de337;}},{'key':'GetScale','value':function(){return this['fScale'];}},{'key':'SetFov','value':function(_0xca7bbc){this['fFov']=_0xca7bbc;}},{'key':'SetAspect','value':function(_0x1bac57){this['fAspect']=_0x1bac57;}},{'key':'SetNear','value':function(_0x57ec19){this['fNear']=_0x57ec19;}},{'key':'SetPano','value':function(_0x34c746){this['bPano']=_0x34c746;}},{'key':'SetFar','value':function(_0x27d1c4){this['fFar']=_0x27d1c4;}},{'key':'UpdateCamera','value':function(_0x3995cb,_0x4a227a){if(!(_0x3995cb<=0x0||_0x4a227a<=0x0)){var _0x3ce37e=_0x3995cb/_0x4a227a;0x1==this['bPano']?(_0x37b57e(this['matProj'],this['fScale'],_0x3ce37e,this['fNear'],this['fFar']),this['matProj'][0x0]=-0x1*this['matProj'][0x0],this['matProj'][0x5]*=-0x1):(_0x37b57e(this['matProj'],this['fFov']+this['fScale']-0x1,_0x3ce37e,this['fNear'],this['fFar']),this['matProj'][0x0]=this['matProj'][0x0]*((this['fAlpha']- -1.57)/_0x238eca*0.5-0x1),this['matProj'][0x5]=this['matProj'][0x0]*_0x3ce37e);var _0x1d7e0e=_0x54263a(0x1,0x0,0x0),_0x8c2881=_0x54263a(0x0,0x1,0x0),_0x3de3c5=_0x110b84();_0x444554(_0x3de3c5,this['vecEye'],this['vecCenter'],this['vecUp']);var _0x1ef3a9=_0x110b84(),_0x6c143e=_0x110b84(),_0x1d5c6e=_0x110b84();_0x8f2f21(_0x6c143e,_0x1ef3a9,-this['fAlpha'],_0x1d7e0e),_0x8f2f21(_0x1d5c6e,_0x6c143e,-this['fTheta'],_0x8c2881),_0x1ae1d4(this['matView'],_0x3de3c5,_0x1d5c6e);}}},{'key':'GetView','value':function(){return this['matView'];}},{'key':'GetProj','value':function(){return this['matProj'];}}]),_0x54fff7;}()),_0x5c3dde=(function(){function _0x51185b(){_0x1d5976(this,_0x51185b),this['onlySupportedWebGL1']=!0x1,this['videoShaderProgram']=0x0,this['vertexPosBuffer']=0x0,this['texturePosBuffer']=0x0,this['indicesPosBuffer']=0x0,this['ctx']=null,this['enPixelFormat']=_0x444828['SR_PF_NULL'],this['nTextureNum']=0x0,this['nSurfaceTexture']=[],this['nSurfaceTexture'][0x0]=0x0,this['nSurfaceTexture'][0x1]=0x0,this['nSurfaceTexture'][0x2]=0x0,this['frameDisplayWidth']=0x0,this['frameDisplayHeight']=0x0,this['bSrcRect']=!0x1,this['fSrcUseLeft']=0x0,this['fSrcUseRight']=0x1,this['fSrcUseTop']=0x0,this['fSrcUseBottom']=0x1,this['fDstUseLeft']=0x0,this['fDstUseRight']=0x1,this['fDstUseTop']=0x0,this['fDstUseBottom']=0x1,this['nPostProc']=0x0,this['fBrightness']=0x0,this['fHue']=0x0,this['fSaturation']=0x0,this['fContrast']=0x0,this['fSharpness']=0x0,this['nWndWidth']=0x0,this['nWndHeight']=0x0,this['bCullBack']=!0x1,this['nImageRotateAngle']=_0x185fa4['SR_IRA_0'],this['matRotate']=_0x110b84(),this['bIsCapturing']=!0x1,this['nCaptureWidth']=0x0,this['nCaptureHeight']=0x0,this['nCaptureRTTex']=0x0,this['nCaptureFBO']=0x0,this['nCaptureFBOWidth']=0x0,this['nCaptureFBOHeight']=0x0,this['nCaptureDepthbuffer']=0x0,this['bCaptureResInit']=!0x1,this['pFishParamManager']=null,this['nFECPort']=-0x1,this['pstFishParam']=[],this['fRX1']=0x0,this['fRX2']=0x1,this['fRY1']=0x0,this['fRY2']=0x1,this['b3DPort']=!0x1,this['pCamera']=null,this['fRotateX']=0x0,this['fRotateY']=0x0,this['fScale']=0x0,this['fRotateLimitX']=0x0,this['fRotateLimitY']=0x0,this['pSemiSpherePos']=null,this['pSemiSphereTex']=null,this['nSemiSpherePosNum']=0x0,this['nSemiSpherePosSize']=0x0,this['nSemiSphereTexSize']=0x0,this['pSpherePos']=null,this['pSphereTex']=null,this['pSphereInd']=null,this['nSpherePosNum']=0x0,this['nSpherePosSize']=0x0,this['nSphereTexSize']=0x0,this['pCylinderPos']=null,this['pCylinderTex']=null,this['nCylinderPosNum']=0x0,this['nCylinderPosSize']=0x0,this['nCylinderTexSize']=0x0,this['fCylinderHeight']=0x0,this['fCylinderRadius']=0x0,this['pArcSpherePos']=null,this['pArcSphereTex']=null,this['nArcSpherePosNum']=0x0,this['nArcSpherePosSize']=0x0,this['nArcSphereTexSize']=0x0,this['fImageWidth']=0x1,this['fImageHeight']=0x1,this['fTexCenterX']=0.5,this['fTexCenterY']=0.5,this['fTexRadius']=0.5,this['pfuncCBIn']=null,this['pUserIn']=null,this['pfuncCBOut']=null,this['pUserOut']=null,this['nMosaicShaderProgram']=0x0,this['nLineShaderProgram']=0x0,this['nMaxPointNum']=0x0,this['pLinePosVertices']=null,this['pLineClrVertices']=null,this['glLinePosBuffer']=0x0,this['glLineClrBuffer']=0x0,this['nLineTriangleNum']=0x0,this['pFillBlockPosVertices']=null,this['pFillBlockClrVertices']=null,this['nMaxFillBlockTriNum']=0x0,this['glBlockPosBuffer']=0x0,this['glBlockClrBuffer']=0x0,this['nBlockShaderProgram']=0x0,this['textCanvas']=null,this['textCanvasCtx']=null,this['nDrawFontWidth']=0x0,this['nDrawFontHeight']=0x0,this['nFontColorTexture']=0x0,this['pFontColorBuffer']=0x0,this['nFontShaderProgram']=0x0,this['nFontBGNum']=0x0,this['pstFontBGLines']=[],this['pFontPosVertices']=null,this['glFontVertexPosBuffer']=0x0,this['glFontTexturePosBuffer']=0x0,this['nImageShaderProgram']=0x0,this['pImagePosVertices']=null,this['pImageClrVertices']=null,this['glImagePosBuffer']=0x0,this['glImageClrBuffer']=0x0,this['nImageColorTexture']=null,this['nDrawImageWidth']=0x0,this['nDrawImageHeight']=0x0,this['nImageColorTextures']=[],this['nImageColorTextures'][0x0]=0x0,this['nImageColorTextures'][0x1]=0x0,this['nImageColorTextures'][0x2]=0x0,this['bFirstDrawImage']=!0x0,this['bAntialias']=!0x1,this['bRenderToTex']=!0x1,this['msaaFrameBuffer']=0x0,this['renderBuffer']=0x0,this['stOriginalDisplayRect']={},this['bCaptureOriginal']=!0x1;}return _0x2d31ab(_0x51185b,[{'key':'SetCanvasSize','value':function(_0x4eb604,_0x47ddd0){return _0x4eb604<=0x0||_0x47ddd0<=0x0?_0x2ffc1c['SR_ERR_PARAM']:(this['nWndWidth']=_0x4eb604,this['nWndHeight']=_0x47ddd0,_0x2ffc1c['SR_OK']);}},{'key':'Init','value':function(_0x269d54,_0x213e64,_0x8db7aa,_0x52d132){if(null==_0x269d54)return _0x2ffc1c['SR_ERR_PARAM'];if(null==this['ctx']&&(this['ctx']=_0x269d54),_0x213e64==_0x444828['SR_PF_NULL'])return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];var _0xc078eb=_0x2ffc1c['SR_OK'];return _0x8db7aa!=_0x5dc8af['SR_DE_FISH_SEMISPHERE']&&_0x8db7aa!=_0x5dc8af['SR_DE_PANORAMA_SPHERE']&&_0x8db7aa!=_0x5dc8af['SR_DE_PANORAMA_PLANET']&&_0x8db7aa!=_0x5dc8af['SR_DE_FISH_CYLINDER_CEILING']&&_0x8db7aa!=_0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']&&_0x8db7aa!=_0x5dc8af['SR_DE_FISH_PLANET']&&_0x8db7aa!=_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_CEILING']&&_0x8db7aa!=_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR']&&_0x8db7aa!=_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']&&_0x8db7aa!=_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']||(this['b3DPort']=!0x0,this['ctx']['enable'](this['ctx']['DEPTH_TEST']),this['ctx']['depthFunc'](this['ctx']['LESS']),this['ctx']['depthMask'](!0x0)),_0xc078eb=this['_InitVideoVertex'](_0x213e64,_0x8db7aa,_0x52d132),_0x2ffc1c['SR_OK']!=_0xc078eb?_0xc078eb:(_0xc078eb=this['_InitVideoShader'](_0x213e64,_0x8db7aa),_0x2ffc1c['SR_OK']!=_0xc078eb?_0xc078eb:(_0xc078eb=this['_InitCamera'](_0x8db7aa),_0x2ffc1c['SR_OK']!=_0xc078eb?_0xc078eb:(this['enPixelFormat']=_0x213e64,this['enDisplayEffect']=_0x8db7aa,_0x8db7aa!=_0x5dc8af['SR_DE_FISH_SEMISPHERE']&&_0x8db7aa!=_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']&&_0x8db7aa!=_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']||this['ctx']['enable'](this['ctx']['CULL_FACE']),_0x2ffc1c['SR_OK'])));}},{'key':'DeInit','value':function(){}},{'key':'SetTextureNum','value':function(_0x5c967c){return this['nTextureNum']=_0x5c967c,_0x2ffc1c['SR_OK'];}},{'key':'SetTextures','value':function(_0x51bee7,_0xc6b20f){return this['nSurfaceTexture'][_0x51bee7]=_0xc6b20f,_0x2ffc1c['SR_OK'];}},{'key':'SetWndResolution','value':function(_0x1cc2c1,_0x8445f0){return _0x1cc2c1<=0x0||_0x8445f0<=0x0?_0x2ffc1c['SR_ERR_PARAM']:(this['nWndWidth']=_0x1cc2c1,this['nWndHeight']=_0x8445f0,_0x2ffc1c['SR_OK']);}},{'key':'GetWndResolution','value':function(_0x1c866a){return _0x1c866a['nWndWidth']=this['nWndWidth'],_0x1c866a['nWndHeight']=this['nWndHeight'],_0x2ffc1c['SR_OK'];}},{'key':'SetDisplayRect','value':function(_0x21bdc4,_0x303858,_0x4beb02,_0x17b1e9,_0x4a3d4a){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(this['b3DPort'])return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];var _0x42d273=_0x21bdc4,_0x56669b=_0x303858,_0x1e74b6=_0x21bdc4+_0x4beb02,_0x1b49a0=_0x303858+_0x17b1e9,_0x5ae508=null,_0x56fcde=null;switch(_0x4a3d4a){case _0x20e142['SR_SRT_SRC']:if(this['frameDisplayWidth']>0x0&&this['frameDisplayHeight']>0x0){if(this['fSrcUseLeft']=_0x42d273/this['frameDisplayWidth'],this['fSrcUseLeft']<0x0?this['fSrcUseLeft']=0x0:this['fSrcUseLeft']>0x1&&(this['fSrcUseLeft']=0x1),this['fSrcUseTop']=_0x56669b/this['frameDisplayHeight'],this['fSrcUseTop']<0x0?this['fSrcUseTop']=0x0:this['fSrcUseTop']>0x1&&(this['fSrcUseTop']=0x1),this['fSrcUseRight']=_0x1e74b6/this['frameDisplayWidth'],this['fSrcUseRight']<0x0?this['fSrcUseRight']=0x0:this['fSrcUseRight']>0x1&&(this['fSrcUseRight']=0x1),this['fSrcUseBottom']=_0x1b49a0/this['frameDisplayHeight'],this['fSrcUseBottom']<0x0?this['fSrcUseBottom']=0x0:this['fSrcUseBottom']>0x1&&(this['fSrcUseBottom']=0x1),this['fSrcUseLeft']>=this['fSrcUseRight']||this['fSrcUseTop']>=this['fSrcUseBottom'])return _0x2ffc1c['SR_ERR_PARAM'];if(_0x185fa4['SR_IRA_0']==this['nImageRotateAngle'])_0x5ae508=new Float32Array([this['fSrcUseLeft'],this['fSrcUseTop'],this['fSrcUseLeft'],this['fSrcUseBottom'],this['fSrcUseRight'],this['fSrcUseTop'],this['fSrcUseRight'],this['fSrcUseTop'],this['fSrcUseLeft'],this['fSrcUseBottom'],this['fSrcUseRight'],this['fSrcUseBottom']]);else{if(_0x185fa4['SR_IRA_90']==this['nImageRotateAngle']){var _0x42ef7b=this['fSrcUseTop'],_0xd7aba4=this['fSrcUseBottom'],_0x505771=0x1-this['fSrcUseRight'],_0x4f48db=0x1-this['fSrcUseLeft'];this['fSrcUseLeft']=_0x42ef7b,this['fSrcUseRight']=_0xd7aba4,this['fSrcUseTop']=_0x505771,this['fSrcUseBottom']=_0x4f48db,_0x5ae508=new Float32Array([this['fSrcUseLeft'],this['fSrcUseBottom'],this['fSrcUseRight'],this['fSrcUseBottom'],this['fSrcUseLeft'],this['fSrcUseTop'],this['fSrcUseLeft'],this['fSrcUseTop'],this['fSrcUseRight'],this['fSrcUseBottom'],this['fSrcUseRight'],this['fSrcUseTop']]);}else{if(_0x185fa4['SR_IRA_180']==this['nImageRotateAngle']){var _0x2c7787=0x1-this['fSrcUseRight'],_0x1760a0=0x1-this['fSrcUseLeft'],_0x24198f=0x1-this['fSrcUseBottom'],_0xd9630e=0x1-this['fSrcUseTop'];this['fSrcUseLeft']=_0x2c7787,this['fSrcUseRight']=_0x1760a0,this['fSrcUseTop']=_0x24198f,this['fSrcUseBottom']=_0xd9630e,_0x5ae508=new Float32Array([this['fSrcUseRight'],this['fSrcUseBottom'],this['fSrcUseRight'],this['fSrcUseTop'],this['fSrcUseLeft'],this['fSrcUseBottom'],this['fSrcUseLeft'],this['fSrcUseBottom'],this['fSrcUseRight'],this['fSrcUseTop'],this['fSrcUseLeft'],this['fSrcUseTop']]);}else{if(_0x185fa4['SR_IRA_270']==this['nImageRotateAngle']){var _0x2fc2dd=0x1-this['fSrcUseBottom'],_0x12b6f2=0x1-this['fSrcUseTop'],_0x84f826=this['fSrcUseLeft'],_0x3570c3=this['fSrcUseRight'];this['fSrcUseLeft']=_0x2fc2dd,this['fSrcUseRight']=_0x12b6f2,this['fSrcUseTop']=_0x84f826,this['fSrcUseBottom']=_0x3570c3,_0x5ae508=new Float32Array([this['fSrcUseRight'],this['fSrcUseTop'],this['fSrcUseLeft'],this['fSrcUseTop'],this['fSrcUseRight'],this['fSrcUseBottom'],this['fSrcUseRight'],this['fSrcUseBottom'],this['fSrcUseLeft'],this['fSrcUseTop'],this['fSrcUseLeft'],this['fSrcUseBottom']]);}}}}this['bSrcRect']=!0x0;}else _0x5ae508=new Float32Array([this['fSrcUseLeft'],this['fSrcUseTop'],this['fSrcUseLeft'],this['fSrcUseBottom'],this['fSrcUseRight'],this['fSrcUseTop'],this['fSrcUseRight'],this['fSrcUseTop'],this['fSrcUseLeft'],this['fSrcUseBottom'],this['fSrcUseRight'],this['fSrcUseBottom']]),this['bSrcRect']=!0x1;this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['texturePosBuffer']),this['ctx']['bufferSubData'](this['ctx']['ARRAY_BUFFER'],0x0,_0x5ae508),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],null),_0x5ae508=null;break;case _0x20e142['SR_SRT_DST']:if(this['frameDisplayWidth']>0x0&&this['frameDisplayHeight']>0x0){if(this['fDstUseLeft']=_0x42d273/this['frameDisplayWidth'],this['fDstUseLeft']<0x0?this['fDstUseLeft']=0x0:this['fDstUseLeft']>0x1&&(this['fDstUseLeft']=0x1),this['fDstUseTop']=_0x56669b/this['frameDisplayHeight'],this['fDstUseTop']<0x0?this['fDstUseTop']=0x0:this['fDstUseTop']>0x1&&(this['fDstUseTop']=0x1),this['fDstUseRight']=_0x1e74b6/this['frameDisplayWidth'],this['fDstUseRight']<0x0?this['fDstUseRight']=0x0:this['fDstUseRight']>0x1&&(this['fDstUseRight']=0x1),this['fDstUseBottom']=_0x1b49a0/this['frameDisplayHeight'],this['fDstUseBottom']<0x0?this['fDstUseBottom']=0x0:this['fDstUseBottom']>0x1&&(this['fDstUseBottom']=0x1),this['fDstUseLeft']>=this['fDstUseRight']||this['fDstUseTop']>=this['fDstUseBottom'])return _0x2ffc1c['SR_ERR_PARAM'];(_0x56fcde=new Float32Array(0xc))[0x0]=0x2*this['fDstUseLeft']-0x1,_0x56fcde[0x1]=0x1-0x2*this['fDstUseTop'],_0x56fcde[0x2]=0x2*this['fDstUseLeft']-0x1,_0x56fcde[0x3]=0x1-0x2*this['fDstUseBottom'],_0x56fcde[0x4]=0x2*this['fDstUseRight']-0x1,_0x56fcde[0x5]=0x1-0x2*this['fDstUseTop'],_0x56fcde[0x6]=0x2*this['fDstUseRight']-0x1,_0x56fcde[0x7]=0x1-0x2*this['fDstUseTop'],_0x56fcde[0x8]=0x2*this['fDstUseLeft']-0x1,_0x56fcde[0x9]=0x1-0x2*this['fDstUseBottom'],_0x56fcde[0xa]=0x2*this['fDstUseRight']-0x1,_0x56fcde[0xb]=0x1-0x2*this['fDstUseBottom'],this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['vertexPosBuffer']),this['ctx']['bufferSubData'](this['ctx']['ARRAY_BUFFER'],0x0,_0x56fcde),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],null),_0x56fcde=null;}break;default:return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}return _0x2ffc1c['SR_OK'];}},{'key':'SetImagePostProcess','value':function(_0x565f63,_0x608ac4){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(_0x3063cc['SR_PPT_SHARPNESS']==_0x565f63||_0x3063cc['SR_PPT_HUE']==_0x565f63){if(0x0-_0x608ac4>0.000001||_0x608ac4-0x1>0.000001)return _0x2ffc1c['SR_ERR_PARAM'];}else{if((_0x3063cc['SR_PPT_BRIGHTNESS']==_0x565f63||_0x3063cc['SR_PPT_SATURATION']==_0x565f63||_0x3063cc['SR_PPT_CONTRAST']==_0x565f63)&&(-0x1-_0x608ac4>0.000001||_0x608ac4-0x1>0.000001))return _0x2ffc1c['SR_ERR_PARAM'];}switch(_0x565f63){case _0x3063cc['SR_PPT_BRIGHTNESS']:this['fBrightness']=_0x608ac4;break;case _0x3063cc['SR_PPT_HUE']:this['fHue']=_0x608ac4;break;case _0x3063cc['SR_PPT_SATURATION']:this['fSaturation']=_0x608ac4;break;case _0x3063cc['SR_PPT_CONTRAST']:this['fContrast']=_0x608ac4;break;case _0x3063cc['SR_PPT_SHARPNESS']:this['fSharpness']=_0x608ac4;break;default:return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}return Math['abs'](this['fBrightness']-0x0)<0.000001&&Math['abs'](this['fHue']-0x0)<0.000001&&Math['abs'](this['fSaturation']-0x0)<0.000001&&Math['abs'](this['fContrast']-0x0)<0.000001&&Math['abs'](this['fSharpness']-0x0)<0.000001?this['nPostProc']=0x0:this['nPostProc']=0x1,_0x2ffc1c['SR_OK'];}},{'key':'SetRenderState','value':function(_0x2ed76f,_0xf35883){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];switch(_0x2ed76f){case _0x453ff1['SR_RST_VERTICALFLIP']:if(this['b3DPort'])return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];break;case _0x453ff1['SR_RST_BACK_CULL']:if(!this['b3DPort'])return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];Math['abs'](_0xf35883-0x0)<0.000001?this['bCullBack']=!0x1:this['bCullBack']=!0x0;break;case _0x453ff1['SR_RST_IMAGE_ROTATE']:if(this['b3DPort'])return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];var _0x4c148e=null,_0x3464d7=_0x185fa4['SR_IRA_0'],_0x2fca83=_0x54263a(0x0,0x0,0x1),_0x543a6f=_0x110b84();if(Math['abs'](_0xf35883-0x0)<0.000001){if(this['nImageRotateAngle']==_0x3464d7)break;_0x4c148e=this['bSrcRect']?new Float32Array([this['fSrcUseLeft'],this['fSrcUseTop'],this['fSrcUseLeft'],this['fSrcUseBottom'],this['fSrcUseRight'],this['fSrcUseTop'],this['fSrcUseRight'],this['fSrcUseTop'],this['fSrcUseLeft'],this['fSrcUseBottom'],this['fSrcUseRight'],this['fSrcUseBottom']]):new Float32Array([0x0,0x0,0x0,0x1,0x1,0x0,0x1,0x0,0x0,0x1,0x1,0x1]),_0x327e19(this['matRotate']);}else{if(Math['abs'](_0xf35883-0x5a)<0.000001){if(_0x3464d7=_0x185fa4['SR_IRA_90'],this['nImageRotateAngle']==_0x3464d7)break;_0x4c148e=this['bSrcRect']?new Float32Array([this['fSrcUseLeft'],this['fSrcUseBottom'],this['fSrcUseRight'],this['fSrcUseBottom'],this['fSrcUseLeft'],this['fSrcUseTop'],this['fSrcUseLeft'],this['fSrcUseTop'],this['fSrcUseRight'],this['fSrcUseBottom'],this['fSrcUseRight'],this['fSrcUseTop']]):new Float32Array([0x0,0x1,0x1,0x1,0x0,0x0,0x0,0x0,0x1,0x1,0x1,0x0]),_0x8f2f21(this['matRotate'],_0x543a6f,1.5707963,_0x2fca83);}else{if(Math['abs'](_0xf35883-0xb4)<0.000001){if(_0x3464d7=_0x185fa4['SR_IRA_180'],this['nImageRotateAngle']==_0x3464d7)break;_0x4c148e=this['bSrcRect']?new Float32Array([this['fSrcUseRight'],this['fSrcUseBottom'],this['fSrcUseRight'],this['fSrcUseTop'],this['fSrcUseLeft'],this['fSrcUseBottom'],this['fSrcUseLeft'],this['fSrcUseBottom'],this['fSrcUseRight'],this['fSrcUseTop'],this['fSrcUseLeft'],this['fSrcUseTop']]):new Float32Array([0x1,0x1,0x1,0x0,0x0,0x1,0x0,0x1,0x1,0x0,0x0,0x0]),_0x8f2f21(this['matRotate'],_0x543a6f,_0x238eca,_0x2fca83);}else{if(!(Math['abs'](_0xf35883-0x10e)<0.000001))return _0x2ffc1c['SR_ERR_PARAM'];if(_0x3464d7=_0x185fa4['SR_IRA_270'],this['nImageRotateAngle']==_0x3464d7)break;_0x4c148e=this['bSrcRect']?new Float32Array([this['fSrcUseRight'],this['fSrcUseTop'],this['fSrcUseLeft'],this['fSrcUseTop'],this['fSrcUseRight'],this['fSrcUseBottom'],this['fSrcUseRight'],this['fSrcUseBottom'],this['fSrcUseLeft'],this['fSrcUseTop'],this['fSrcUseLeft'],this['fSrcUseBottom']]):new Float32Array([0x1,0x0,0x0,0x0,0x1,0x1,0x1,0x1,0x0,0x0,0x0,0x1]),_0x8f2f21(this['matRotate'],_0x543a6f,0x3*_0x238eca/0x2,_0x2fca83);}}}if(null==_0x4c148e)return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];var _0x4297c1=this['ctx']['createBuffer']();this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],_0x4297c1),this['ctx']['bufferData'](this['ctx']['ARRAY_BUFFER'],_0x4c148e,this['ctx']['STATIC_DRAW']),this['texturePosBuffer']=_0x4297c1,this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],null),this['nImageRotateAngle']=_0x3464d7;break;default:return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}return _0x2ffc1c['SR_OK'];}},{'key':'SetVideoResolution','value':function(_0x1c6614,_0x105d93){return null==this['ctx']||_0x1c6614<=0x0||_0x105d93<=0x0?_0x2ffc1c['SR_ERR_CALL_ORDER']:(this['frameDisplayWidth']=_0x1c6614,this['frameDisplayHeight']=_0x105d93,_0x2ffc1c['SR_OK']);}},{'key':'GetCaptureSize','value':function(_0x4a532b){var _0x449ec6=arguments['length']>0x1&&void 0x0!==arguments[0x1]&&arguments[0x1];if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==_0x4a532b['nWidth']||null==_0x4a532b['nWidth']||null==_0x4a532b['nHeight']||null==_0x4a532b['nHeight'])return _0x2ffc1c['SR_ERR_PARAM'];if(0x1==_0x449ec6&&this['b3DPort'])return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];var _0x5ad708=0x0,_0x59970c=0x0;if(0x0==_0x4a532b['nWidth']&&0x0==_0x4a532b['nHeight'])switch(this['enDisplayEffect']){case _0x5dc8af['SR_DE_FISH_PTZ_WALL']:case _0x5dc8af['SR_DE_FISH_PTZ_CEILING']:case _0x5dc8af['SR_DE_FISH_PTZ_FLOOR']:_0x5ad708=Math['round'](0x5*this['frameDisplayHeight']/0x8),_0x59970c=Math['round'](0x3*_0x5ad708/0x4);break;case _0x5dc8af['SR_DE_NULL']:_0x449ec6?(_0x5ad708=Math['round'](this['frameDisplayWidth']),_0x59970c=Math['round'](this['frameDisplayHeight'])):(_0x5ad708=Math['round']((this['fSrcUseRight']-this['fSrcUseLeft'])*this['frameDisplayWidth']),_0x59970c=Math['round']((this['fSrcUseBottom']-this['fSrcUseTop'])*this['frameDisplayHeight']));break;case _0x5dc8af['SR_DE_FISH_ORIGINAL']:case _0x5dc8af['SR_DE_FISH_SEMISPHERE']:case _0x5dc8af['SR_DE_PANORAMA_SPHERE']:case _0x5dc8af['SR_DE_PANORAMA_PLANET']:case _0x5dc8af['SR_DE_FISH_CYLINDER_CEILING']:case _0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']:case _0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']:case _0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']:case _0x5dc8af['SR_DE_FISH_PLANET']:case _0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_CEILING']:case _0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR']:_0x5ad708=Math['round'](this['frameDisplayWidth']),_0x59970c=Math['round'](this['frameDisplayHeight']);break;case _0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_360']:case _0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_360']:this['frameDisplayHeight']>=0x800?(_0x5ad708=0x1800,_0x59970c=0x360):this['frameDisplayHeight']>=0x600&&0x800>this['frameDisplayHeight']?(_0x5ad708=0x1000,_0x59970c=0x240):(_0x5ad708=Math['round'](3.14*this['frameDisplayHeight']/1.6),_0x59970c=Math['round'](0x9*this['frameDisplayWidth']/0x10),_0x5ad708=Math['round'](0x2*_0x5ad708),_0x59970c=Math['round'](_0x59970c/0x2));break;case _0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_180']:case _0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_180']:this['frameDisplayHeight']>=0xc00?(_0x5ad708=0x1000,_0x59970c=0x900):this['frameDisplayHeight']>=0x800&&0xc00>this['frameDisplayHeight']?(_0x5ad708=0xc00,_0x59970c=0x6c0):this['frameDisplayHeight']>=0x600&&0x800>this['frameDisplayHeight']?(_0x5ad708=0x800,_0x59970c=0x480):(_0x5ad708=Math['round'](3.14*this['frameDisplayHeight']/1.6),_0x59970c=Math['round'](0x9*_0x5ad708/0x10));break;case _0x5dc8af['SR_DE_FISH_PANORAMA_WALL']:_0x5ad708=Math['round'](this['frameDisplayHeight']),_0x59970c=Math['round'](0x9*_0x5ad708/0x10);break;default:return _0x2ffc1c['SR_ERR_PARAM'];}else _0x5ad708=Math['round'](_0x4a532b['nWidth']),_0x59970c=Math['round'](_0x4a532b['nHeight']);return _0x5ad708<0x10||_0x59970c<0x10?_0x2ffc1c['SR_ERR_PARAM']:(this['nCaptureWidth']=0x4*Math['round'](_0x5ad708/0x4),this['nCaptureHeight']=Math['round'](_0x59970c),_0x4a532b['nWidth']=this['nCaptureWidth'],_0x4a532b['nHeight']=this['nCaptureHeight'],_0x4a532b['nBufferLen']=this['nCaptureWidth']*this['nCaptureHeight']*0x4,this['bCaptureOriginal']=_0x449ec6,_0x2ffc1c['SR_OK']);}},{'key':'CaptureScreen','value':function(_0x14b8d3,_0x7acd90){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x5ebc36=_0x2ffc1c['SR_OK'];if(_0x5ebc36=this['_BeginCapture'](),_0x2ffc1c['SR_OK']!=_0x5ebc36)return this['bIsCapturing']=!0x1,_0x5ebc36;if(0x1==this['bCaptureOriginal']&&(this['stOriginalDisplayRect']['fLeft']=this['fSrcUseLeft']*this['frameDisplayWidth'],this['stOriginalDisplayRect']['fTop']=this['fSrcUseTop']*this['frameDisplayHeight'],this['stOriginalDisplayRect']['fWidth']=(this['fSrcUseRight']-this['fSrcUseLeft'])*this['frameDisplayWidth'],this['stOriginalDisplayRect']['fHeight']=(this['fSrcUseBottom']-this['fSrcUseTop'])*this['frameDisplayHeight'],_0x5ebc36=this['SetDisplayRect'](0x0,0x0,this['frameDisplayWidth'],this['frameDisplayHeight'],_0x20e142['SR_SRT_SRC']),_0x2ffc1c['SR_OK']!=_0x5ebc36))return this['bIsCapturing']=!0x1,_0x5ebc36;if(0x0==this['videoShaderProgram']||0x0==this['vertexPosBuffer']||0x0==this['texturePosBuffer'])return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_CALL_ORDER'];this['ctx']['useProgram'](this['videoShaderProgram']),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['vertexPosBuffer']);var _0x5b24e9=this['ctx']['getAttribLocation'](this['videoShaderProgram'],'position');if(_0x5b24e9<0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['b3DPort']?this['ctx']['vertexAttribPointer'](_0x5b24e9,0x3,this['ctx']['FLOAT'],!0x1,0x0,0x0):this['ctx']['vertexAttribPointer'](_0x5b24e9,0x2,this['ctx']['FLOAT'],!0x1,0x0,0x0),this['ctx']['enableVertexAttribArray'](_0x5b24e9),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['texturePosBuffer']);var _0x532527=this['ctx']['getAttribLocation'](this['videoShaderProgram'],'texCoord');if(_0x532527<0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['vertexAttribPointer'](_0x532527,0x2,this['ctx']['FLOAT'],!0x1,0x0,0x0),this['ctx']['enableVertexAttribArray'](_0x532527),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],null);var _0xf84fbc=this['enDisplayEffect'],_0x19a9ad=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'bCapture');if(_0x19a9ad<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1i'](_0x19a9ad,0x1);var _0x1d5e39=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'bDataFormat');if(_0x1d5e39<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];switch(this['enPixelFormat']){case _0x444828['SR_PF_YV12']:case _0x444828['SR_PF_I420']:this['ctx']['uniform1i'](_0x1d5e39,0x0);break;case _0x444828['SR_PF_NV12']:break;case _0x444828['SR_PF_RGBA32']:case _0x444828['SR_PF_SURFACE']:this['ctx']['uniform1i'](_0x1d5e39,0x1);break;default:return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}var _0x497213=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'bDrawImage');this['ctx']['uniform1i'](_0x497213,0x0);var _0x40166d=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fAlpha');switch(this['ctx']['uniform1f'](_0x40166d,0x0),_0xf84fbc){case _0x5dc8af['SR_DE_NULL']:break;case _0x5dc8af['SR_DE_FISH_ORIGINAL']:case _0x5dc8af['SR_DE_FISH_PTZ_CEILING']:case _0x5dc8af['SR_DE_FISH_PTZ_FLOOR']:case _0x5dc8af['SR_DE_FISH_PTZ_WALL']:case _0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_360']:case _0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_180']:case _0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_360']:case _0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_180']:case _0x5dc8af['SR_DE_FISH_PANORAMA_WALL']:if(null==this['pFishParamManager'])return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x12d29e={},_0x33e543=_0x2ffc1c['SR_OK'];if(_0x33e543=this['pFishParamManager']['GetRenderParam'](this['nFECPort'],_0x12d29e),_0x2ffc1c['SR_OK']!=_0x33e543)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x33e543;if(_0x5dc8af['SR_DE_FISH_ORIGINAL']==_0xf84fbc){var _0x3b4e09=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'bBlack');if(_0x3b4e09<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1i'](_0x3b4e09,_0x12d29e['bBlack']);var _0x264a78=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'bCut');if(_0x264a78<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1i'](_0x264a78,_0x12d29e['bCut']);}if(_0x5dc8af['SR_DE_FISH_PTZ_CEILING']==_0xf84fbc||_0x5dc8af['SR_DE_FISH_PTZ_FLOOR']==_0xf84fbc||_0x5dc8af['SR_DE_FISH_PTZ_WALL']==_0xf84fbc){var _0x470a35=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fHAngleCos');if(_0x470a35<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x470a35,_0x12d29e['fCosH']);var _0x5c2c5e=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fHAngleSin');if(_0x5c2c5e<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x5c2c5e,_0x12d29e['fSinH']);var _0x3579ba=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fVAngleCos');if(_0x3579ba<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x3579ba,_0x12d29e['fCosV']);var _0xd10f09=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fVAngleSin');if(_0xd10f09<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0xd10f09,_0x12d29e['fSinV']);var _0x58ebbe=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fZoom');if(_0x58ebbe<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x58ebbe,_0x12d29e['fZoom']);}if(_0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_360']==_0xf84fbc||_0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_180']==_0xf84fbc||_0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_360']==_0xf84fbc||_0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_180']==_0xf84fbc){var _0x49fcc1=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fAngle');if(_0x49fcc1<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x49fcc1,_0x12d29e['fAngle']);}var _0x41a29b=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fRX1');if(_0x41a29b<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x41a29b,_0x12d29e['fRXLeft']);var _0x28d23f=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fRX2');if(_0x28d23f<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x28d23f,_0x12d29e['fRXRight']);var _0x2eb08b=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fRY1');if(_0x2eb08b<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x2eb08b,_0x12d29e['fRYTop']);var _0x398454=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fRY2');if(_0x398454<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x398454,_0x12d29e['fRYBottom']);break;case _0x5dc8af['SR_DE_FISH_SEMISPHERE']:this['pCamera']['SetScale'](this['fScale']),this['pCamera']['SetPitch'](3.14-this['fRotateX']),this['pCamera']['SetYaw'](-this['fRotateY']),this['pCamera']['UpdateCamera'](this['nWndWidth'],this['nWndHeight']);var _0x186d8b=this['pCamera']['GetView'](),_0xf72516=this['pCamera']['GetProj'](),_0x4086bb=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matView');if(_0x4086bb<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x4086bb,!0x1,_0x186d8b);var _0x14fb88=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matProj');if(_0x14fb88<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x14fb88,!0x1,_0xf72516);break;case _0x5dc8af['SR_DE_PANORAMA_SPHERE']:this['pCamera']['SetScale'](this['fScale']),this['pCamera']['SetPitch'](3.14-this['fRotateX']),this['pCamera']['SetYaw'](this['fRotateY']),this['pCamera']['UpdateCamera'](this['nWndWidth'],this['nWndHeight']);var _0x5f0963=this['pCamera']['GetView'](),_0x25991f=this['pCamera']['GetProj'](),_0x4d0f6e=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matView');if(_0x4d0f6e<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x4d0f6e,!0x1,_0x5f0963);var _0x767520=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matProj');if(_0x767520<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x767520,!0x1,_0x25991f);break;case _0x5dc8af['SR_DE_FISH_CYLINDER_CEILING']:case _0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']:case _0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']:case _0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']:this['pCamera']['SetScale'](this['fScale']),this['pCamera']['SetPitch'](-this['fRotateX']),this['pCamera']['SetYaw'](-this['fRotateY']),this['pCamera']['UpdateCamera'](this['nWndWidth'],this['nWndHeight']);var _0xd178bd=this['pCamera']['GetView'](),_0x1570da=this['pCamera']['GetProj'](),_0x3afe73=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matView');if(_0x3afe73<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x3afe73,!0x1,_0xd178bd);var _0x3fd3f7=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matProj');if(_0x3fd3f7<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x3fd3f7,!0x1,_0x1570da);break;case _0x5dc8af['SR_DE_FISH_PLANET']:case _0x5dc8af['SR_DE_PANORAMA_PLANET']:this['pCamera']['SetScale'](this['fScale']),this['pCamera']['SetPitch'](this['fRotateX']),this['pCamera']['SetYaw'](3.14+this['fRotateY']),this['pCamera']['UpdateCamera'](this['nWndWidth'],this['nWndHeight']);var _0x4bf119=this['pCamera']['GetView'](),_0x42e322=this['pCamera']['GetProj'](),_0x28cd9f=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matView');if(_0x28cd9f<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x28cd9f,!0x1,_0x4bf119);var _0x46f8f1=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matProj');if(_0x46f8f1<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x46f8f1,!0x1,_0x42e322);break;case _0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_CEILING']:case _0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR']:if(null==this['pFishParamManager'])return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x4dedae={},_0x5fcf3=_0x2ffc1c['SR_OK'];if(_0x5fcf3=this['pFishParamManager']['GetRenderParam'](this['nFECPort'],_0x4dedae),_0x2ffc1c['SR_OK']!=_0x5fcf3)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x5fcf3;this['pCamera']['SetScale'](this['fScale']),this['pCamera']['SetPitch'](-this['fRotateX']),this['pCamera']['UpdateCamera'](this['nWndWidth'],this['nWndHeight']);var _0x12bf3a=this['pCamera']['GetView'](),_0x3b4da2=this['pCamera']['GetProj'](),_0x3dea69=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matView');if(_0x3dea69<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x3dea69,!0x1,_0x12bf3a);var _0x57f348=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matProj');if(_0x57f348<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x57f348,!0x1,_0x3b4da2);var _0x302db8;_0x302db8=Math['abs'](0.785-this['fRotateX'])<0.0025?0.785:this['fRotateX'];var _0x528e4a=new Float32Array([0x0,0x1,0x0,0x2*-_0x302db8]),_0x539c54=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'vecCylinderParam');if(_0x539c54<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];if(this['ctx']['uniform4f'](_0x539c54,_0x528e4a[0x0],_0x528e4a[0x1],_0x528e4a[0x2],_0x528e4a[0x3]),_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_CEILING']==this['enDisplayEffect']){var _0x296550=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fTextureOffset');if(_0x296550<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x296550,this['fRotateY']);}else{var _0x5585a0=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fTextureOffset');if(_0x5585a0<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x5585a0,-this['fRotateY']);}var _0x40b623=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fRX1');if(_0x40b623<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x40b623,_0x4dedae['fRXLeft']);var _0x50f31c=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fRX2');if(_0x50f31c<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x50f31c,_0x4dedae['fRXRight']);var _0x2c8935=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fRY1');if(_0x2c8935<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x2c8935,_0x4dedae['fRYTop']);var _0x3986b1=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fRY2');if(_0x3986b1<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x3986b1,_0x4dedae['fRYBottom']);break;default:return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_NOT_SUPPORT'];}if(this['nCaptureWidth']<=0x0||this['nCaptureHeight']<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_CANVAS'];if(this['ctx']['viewport'](0x0,0x0,this['nCaptureWidth'],this['nCaptureHeight']),this['ctx']['clearColor'](0x0,0x0,0x0,0x1),this['ctx']['clear'](this['ctx']['COLOR_BUFFER_BIT']|this['ctx']['DEPTH_BUFFER_BIT']),this['b3DPort']&&(this['ctx']['enable'](this['ctx']['DEPTH_TEST']),this['ctx']['depthFunc'](this['ctx']['LESS']),this['ctx']['depthMask'](!0x0),0x1==this['bCullBack']?this['ctx']['enable'](this['ctx']['CULL_FACE']):this['ctx']['disable'](this['ctx']['CULL_FACE'])),this['enPixelFormat']==_0x444828['SR_PF_RGBA32']||this['enPixelFormat']==_0x444828['SR_PF_SURFACE']){this['ctx']['activeTexture'](this['ctx']['TEXTURE0']),this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nSurfaceTexture'][0x0]),!this['onlySupportedWebGL1']&&this['bAntialias']&&this['ctx']['generateMipmap'](this['ctx']['TEXTURE_2D']);var _0x204f47=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'Ytexture');this['ctx']['uniform1i'](_0x204f47,0x0);}else{if(this['enPixelFormat']!=_0x444828['SR_PF_YV12']&&this['enPixelFormat']!=_0x444828['SR_PF_I420'])return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nSurfaceTexture'][0x0]),!this['onlySupportedWebGL1']&&this['bAntialias']&&this['ctx']['generateMipmap'](this['ctx']['TEXTURE_2D']);var _0x594c13=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'Ytexture');this['ctx']['uniform1i'](_0x594c13,0x0),this['ctx']['activeTexture'](this['ctx']['TEXTURE1']),this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nSurfaceTexture'][0x1]),!this['onlySupportedWebGL1']&&this['bAntialias']&&this['ctx']['generateMipmap'](this['ctx']['TEXTURE_2D']);var _0x31cdb3=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'Utexture');this['ctx']['uniform1i'](_0x31cdb3,0x1),this['ctx']['activeTexture'](this['ctx']['TEXTURE2']),this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nSurfaceTexture'][0x2]),!this['onlySupportedWebGL1']&&this['bAntialias']&&this['ctx']['generateMipmap'](this['ctx']['TEXTURE_2D']);var _0xd9f9b4=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'Vtexture');this['ctx']['uniform1i'](_0xd9f9b4,0x2);}if(this['onlySupportedWebGL1']||this['ctx']['clearBufferfi'](this['ctx']['DEPTH_STENCIL'],0x0,0x1,0x0),0x0==this['b3DPort'])this['ctx']['drawArrays'](this['ctx']['TRIANGLES'],0x0,0x6);else{if(this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_SEMISPHERE']||this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_PLANET']){if(this['nSemiSpherePosNum']<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_CALL_ORDER'];this['ctx']['drawArrays'](this['ctx']['TRIANGLES'],0x0,this['nSemiSpherePosNum']);}else{if(this['enDisplayEffect']==_0x5dc8af['SR_DE_PANORAMA_SPHERE']||this['enDisplayEffect']==_0x5dc8af['SR_DE_PANORAMA_PLANET']){if(this['nSpherePosNum']<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_CALL_ORDER'];this['ctx']['bindBuffer'](this['ctx']['ELEMENT_ARRAY_BUFFER'],this['indicesPosBuffer']),this['ctx']['drawElements'](this['ctx']['TRIANGLES'],0x6*this['nSpherePosNum'],this['ctx']['UNSIGNED_SHORT'],0x0),this['ctx']['bindBuffer'](this['ctx']['ELEMENT_ARRAY_BUFFER'],null);}else{if(this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_CYLINDER_CEILING']||this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']||this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_CEILING']||this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR']){if(this['nCylinderPosNum']<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_CALL_ORDER'];this['ctx']['drawArrays'](this['ctx']['TRIANGLES'],0x0,this['nCylinderPosNum']);}else{if(this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']||this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']){if(this['nArcSpherePosNum']<=0x0)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_CALL_ORDER'];this['ctx']['drawArrays'](this['ctx']['TRIANGLES'],0x0,this['nArcSpherePosNum']);}}}}}if(this['ctx']['useProgram'](null),_0x7acd90||this['DoCallBack'](),0x1==this['bCaptureOriginal']){var _0x53131d=this['nImageRotateAngle'];if(this['bSrcRect']=!0x1,_0x5ebc36=this['SetRenderState'](_0x453ff1['SR_RST_IMAGE_ROTATE'],0x0),_0x2ffc1c['SR_OK']!=_0x5ebc36)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x5ebc36;if(_0x5ebc36=this['SetDisplayRect'](this['stOriginalDisplayRect']['fLeft'],this['stOriginalDisplayRect']['fTop'],this['stOriginalDisplayRect']['fWidth'],this['stOriginalDisplayRect']['fHeight'],_0x20e142['SR_SRT_SRC']),_0x2ffc1c['SR_OK']!=_0x5ebc36)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x5ebc36;switch(this['bSrcRect']=!0x0,_0x53131d){case _0x185fa4['SR_IRA_0']:_0x5ebc36=this['SetRenderState'](_0x453ff1['SR_RST_IMAGE_ROTATE'],0x0);break;case _0x185fa4['SR_IRA_90']:_0x5ebc36=this['SetRenderState'](_0x453ff1['SR_RST_IMAGE_ROTATE'],0x5a);break;case _0x185fa4['SR_IRA_180']:_0x5ebc36=this['SetRenderState'](_0x453ff1['SR_RST_IMAGE_ROTATE'],0xb4);break;case _0x185fa4['SR_IRA_270']:_0x5ebc36=this['SetRenderState'](_0x453ff1['SR_RST_IMAGE_ROTATE'],0x10e);break;default:return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_NOT_SUPPORT'];}if(_0x2ffc1c['SR_OK']!=_0x5ebc36)return this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x5ebc36;}return _0x5ebc36=this['_EndCapture'](_0x14b8d3),_0x2ffc1c['SR_OK']!=_0x5ebc36?_0x5ebc36:_0x2ffc1c['SR_OK'];}},{'key':'SetWebGL2Support','value':function(_0x3e93dd){return this['onlySupportedWebGL1']=_0x3e93dd,_0x2ffc1c['SR_OK'];}},{'key':'SetFishParamManager','value':function(_0x2f83de){return this['pFishParamManager']=_0x2f83de,_0x2ffc1c['SR_OK'];}},{'key':'SetFECPort','value':function(_0x520a5c){return this['nFECPort']=_0x520a5c,_0x2ffc1c['SR_OK'];}},{'key':'Render','value':function(_0x38e286){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];switch(this['ctx']['useProgram'](this['videoShaderProgram']),this['enPixelFormat']){case _0x444828['SR_PF_YV12']:case _0x444828['SR_PF_I420']:this['ctx']['activeTexture'](this['ctx']['TEXTURE0']),this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nSurfaceTexture'][0x0]),!this['onlySupportedWebGL1']&&this['bAntialias']&&this['ctx']['generateMipmap'](this['ctx']['TEXTURE_2D']);var _0xb8a444=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'Ytexture');this['ctx']['uniform1i'](_0xb8a444,0x0),this['ctx']['activeTexture'](this['ctx']['TEXTURE1']),this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nSurfaceTexture'][0x1]),!this['onlySupportedWebGL1']&&this['bAntialias']&&this['ctx']['generateMipmap'](this['ctx']['TEXTURE_2D']);var _0x3808ec=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'Utexture');this['ctx']['uniform1i'](_0x3808ec,0x1),this['ctx']['activeTexture'](this['ctx']['TEXTURE2']),this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nSurfaceTexture'][0x2]),!this['onlySupportedWebGL1']&&this['bAntialias']&&this['ctx']['generateMipmap'](this['ctx']['TEXTURE_2D']);var _0x499879=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'Vtexture');this['ctx']['uniform1i'](_0x499879,0x2);break;case _0x444828['SR_PF_SURFACE']:this['ctx']['activeTexture'](this['ctx']['TEXTURE0']),this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nSurfaceTexture'][0x0]),!this['onlySupportedWebGL1']&&this['bAntialias']&&this['ctx']['generateMipmap'](this['ctx']['TEXTURE_2D']);var _0x2ed136=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'Ytexture');this['ctx']['uniform1i'](_0x2ed136,0x0);break;default:return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}var _0x458d2e=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'bCapture');if(_0x458d2e<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1i'](_0x458d2e,0x0);var _0x15246a=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'bDataFormat');if(_0x15246a<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];switch(this['enPixelFormat']){case _0x444828['SR_PF_YV12']:case _0x444828['SR_PF_I420']:this['ctx']['uniform1i'](_0x15246a,0x0);break;case _0x444828['SR_PF_NV12']:break;case _0x444828['SR_PF_RGBA32']:case _0x444828['SR_PF_SURFACE']:this['ctx']['uniform1i'](_0x15246a,0x1);}switch(this['enDisplayEffect']){case _0x5dc8af['SR_DE_NULL']:if(this['nPostProc']){var _0x3dd725=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fBrightness');if(_0x3dd725<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x3dd725,this['fBrightness']);var _0x55820f=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fHue');if(_0x55820f<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x55820f,this['fHue']);var _0x4d8fd3=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fSaturation');if(_0x4d8fd3<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x4d8fd3,this['fSaturation']);var _0x1a874e=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fContrast');if(_0x1a874e<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x1a874e,this['fContrast']);var _0x33f4e5=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fSharpness');if(_0x33f4e5<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x33f4e5,this['fSharpness']);var _0x35d667=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fWndWidth');if(_0x35d667<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x35d667,this['nWndWidth']);var _0x22378e=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fWndHeight');if(_0x22378e<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x22378e,this['nWndHeight']);}var _0x1a5f7=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'nPostProc');this['ctx']['uniform1i'](_0x1a5f7,this['nPostProc']);break;case _0x5dc8af['SR_DE_FISH_ORIGINAL']:case _0x5dc8af['SR_DE_FISH_PTZ_CEILING']:case _0x5dc8af['SR_DE_FISH_PTZ_FLOOR']:case _0x5dc8af['SR_DE_FISH_PTZ_WALL']:case _0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_360']:case _0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_180']:case _0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_360']:case _0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_180']:case _0x5dc8af['SR_DE_FISH_PANORAMA_WALL']:if(_0x5dc8af['SR_DE_FISH_ORIGINAL']==this['enDisplayEffect']){var _0x2da618=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'bBlack');if(_0x2da618<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1i'](_0x2da618,this['pstFishParam']['bBlack']);var _0x4caeab=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'bCut');if(_0x4caeab<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1i'](_0x4caeab,this['pstFishParam']['bCut']);}if(_0x5dc8af['SR_DE_FISH_PTZ_CEILING']==this['enDisplayEffect']||_0x5dc8af['SR_DE_FISH_PTZ_FLOOR']==this['enDisplayEffect']||_0x5dc8af['SR_DE_FISH_PTZ_WALL']==this['enDisplayEffect']){var _0x29e773=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fHAngleCos');if(_0x29e773<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x29e773,this['pstFishParam']['fCosH']);var _0x291896=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fHAngleSin');if(_0x291896<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x291896,this['pstFishParam']['fSinH']);var _0x2a027c=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fVAngleCos');if(_0x2a027c<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x2a027c,this['pstFishParam']['fCosV']);var _0x4b9137=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fVAngleSin');if(_0x4b9137<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x4b9137,this['pstFishParam']['fSinV']);var _0x41f63f=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fZoom');if(_0x41f63f<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x41f63f,this['pstFishParam']['fZoom']);}if(_0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_360']==this['enDisplayEffect']||_0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_180']==this['enDisplayEffect']||_0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_360']==this['enDisplayEffect']||_0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_180']==this['enDisplayEffect']){var _0xa01e72=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fAngle');if(_0xa01e72<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0xa01e72,this['pstFishParam']['fAngle']);}var _0x1fcf18=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fRX1');if(_0x1fcf18<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x1fcf18,this['pstFishParam']['fRXLeft']);var _0x1c07fb=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fRX2');if(_0x1c07fb<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x1c07fb,this['pstFishParam']['fRXRight']);var _0x59d6da=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fRY1');if(_0x59d6da<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x59d6da,this['pstFishParam']['fRYTop']);var _0xff0368=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fRY2');if(_0xff0368<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0xff0368,this['pstFishParam']['fRYBottom']);break;case _0x5dc8af['SR_DE_FISH_SEMISPHERE']:this['pCamera']['SetScale'](this['fScale']),this['pCamera']['SetPitch'](3.14-this['fRotateX']),this['pCamera']['SetYaw'](-this['fRotateY']),this['pCamera']['UpdateCamera'](this['nWndWidth'],this['nWndHeight']);var _0x4aa586=this['pCamera']['GetView'](),_0x2835ef=this['pCamera']['GetProj'](),_0x45cc02=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matView');if(_0x45cc02<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x45cc02,!0x1,_0x4aa586);var _0x484746=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matProj');if(_0x484746<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x484746,!0x1,_0x2835ef);break;case _0x5dc8af['SR_DE_PANORAMA_SPHERE']:this['pCamera']['SetScale'](this['fScale']),this['pCamera']['SetPitch'](3.14-this['fRotateX']),this['pCamera']['SetYaw'](this['fRotateY']),this['pCamera']['UpdateCamera'](this['nWndWidth'],this['nWndHeight']);var _0x23f38b=this['pCamera']['GetView'](),_0x7fc914=this['pCamera']['GetProj'](),_0x238a42=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matView');if(_0x238a42<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x238a42,!0x1,_0x23f38b);var _0x3805e3=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matProj');if(_0x3805e3<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x3805e3,!0x1,_0x7fc914);break;case _0x5dc8af['SR_DE_FISH_CYLINDER_CEILING']:case _0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']:case _0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']:case _0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']:this['pCamera']['SetScale'](this['fScale']),this['pCamera']['SetPitch'](-this['fRotateX']),this['pCamera']['SetYaw'](-this['fRotateY']),this['pCamera']['UpdateCamera'](this['nWndWidth'],this['nWndHeight']);var _0x178c07=this['pCamera']['GetView'](),_0x3a34aa=this['pCamera']['GetProj'](),_0x43f354=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matView');if(_0x43f354<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x43f354,!0x1,_0x178c07);var _0x314075=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matProj');if(_0x314075<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x314075,!0x1,_0x3a34aa);break;case _0x5dc8af['SR_DE_FISH_PLANET']:case _0x5dc8af['SR_DE_PANORAMA_PLANET']:this['pCamera']['SetScale'](this['fScale']),this['pCamera']['SetPitch'](this['fRotateX']),this['pCamera']['SetYaw'](3.14+this['fRotateY']),this['pCamera']['UpdateCamera'](this['nWndWidth'],this['nWndHeight']);var _0x591123=this['pCamera']['GetView'](),_0x440844=this['pCamera']['GetProj'](),_0x7c2a3d=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matView');if(_0x7c2a3d<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x7c2a3d,!0x1,_0x591123);var _0x40ea19=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matProj');if(_0x40ea19<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x40ea19,!0x1,_0x440844);var _0x463b5e=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'bDrawImage');if(_0x463b5e<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1i'](_0x463b5e,0x0);var _0x1772ed=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fAlpha');if(_0x1772ed<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x1772ed,0x0);break;case _0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_CEILING']:case _0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR']:if(null==this['pFishParamManager'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];this['pCamera']['SetScale'](this['fScale']),this['pCamera']['SetPitch'](-this['fRotateX']),this['pCamera']['UpdateCamera'](this['nWndWidth'],this['nWndHeight']);var _0x3f3627=this['pCamera']['GetView'](),_0x38e0db=this['pCamera']['GetProj'](),_0x2162fd=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matView');if(_0x2162fd<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x2162fd,!0x1,_0x3f3627);var _0x49d22d=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'matProj');if(_0x49d22d<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x49d22d,!0x1,_0x38e0db);var _0x353dea;_0x353dea=Math['abs'](0.785-this['fRotateX'])<0.0025?0.785:this['fRotateX'];var _0x1756e2=new Float32Array([0x0,0x1,0x0,0x2*-_0x353dea]),_0x6aa661=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'vecCylinderParam');if(_0x6aa661<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];if(this['ctx']['uniform4f'](_0x6aa661,_0x1756e2[0x0],_0x1756e2[0x1],_0x1756e2[0x2],_0x1756e2[0x3]),_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_CEILING']==this['enDisplayEffect']){var _0xbc042c=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fTextureOffset');if(_0xbc042c<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0xbc042c,this['fRotateY']);}else{var _0x30ce82=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fTextureOffset');if(_0x30ce82<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x30ce82,-this['fRotateY']);}var _0x21e8c6={},_0x1ca1a7=_0x2ffc1c['SR_OK'];if(_0x1ca1a7=this['pFishParamManager']['GetRenderParam'](this['nFECPort'],_0x21e8c6),_0x2ffc1c['SR_OK']!=_0x1ca1a7)return _0x1ca1a7;var _0x26965f=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fRX1');if(_0x26965f<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x26965f,_0x21e8c6['fRXLeft']);var _0x64189b=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fRX2');if(_0x64189b<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x64189b,_0x21e8c6['fRXRight']);var _0x4f7df2=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fRY1');if(_0x4f7df2<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x4f7df2,_0x21e8c6['fRYTop']);var _0x49e7bc=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fRY2');if(_0x49e7bc<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x49e7bc,_0x21e8c6['fRYBottom']);var _0x19f7e2=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'bDrawImage');if(_0x19f7e2<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1i'](_0x19f7e2,0x0);var _0x914014=this['ctx']['getUniformLocation'](this['videoShaderProgram'],'fAlpha');if(_0x914014<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x914014,0x0);break;default:return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['vertexPosBuffer']);var _0x2aa5fd=this['ctx']['getAttribLocation'](this['videoShaderProgram'],'position');if(_0x2aa5fd<0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['b3DPort']?this['ctx']['vertexAttribPointer'](_0x2aa5fd,0x3,this['ctx']['FLOAT'],!0x1,0x0,0x0):this['ctx']['vertexAttribPointer'](_0x2aa5fd,0x2,this['ctx']['FLOAT'],!0x1,0x0,0x0),this['ctx']['enableVertexAttribArray'](_0x2aa5fd),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['texturePosBuffer']);var _0x2f14ba=this['ctx']['getAttribLocation'](this['videoShaderProgram'],'texCoord');if(_0x2f14ba<0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];if(this['ctx']['vertexAttribPointer'](_0x2f14ba,0x2,this['ctx']['FLOAT'],!0x1,0x0,0x0),this['ctx']['enableVertexAttribArray'](_0x2f14ba),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],null),this['ctx']['viewport'](0x0,0x0,this['nWndWidth'],this['nWndHeight']),this['onlySupportedWebGL1']||this['ctx']['clearBufferfi'](this['ctx']['DEPTH_STENCIL'],0x0,0x1,0x0),this['ctx']['clearColor'](0x0,0x0,0x0,0x1),this['ctx']['clear'](this['ctx']['COLOR_BUFFER_BIT']|this['ctx']['DEPTH_BUFFER_BIT']),this['b3DPort']&&(this['ctx']['enable'](this['ctx']['DEPTH_TEST']),this['ctx']['depthFunc'](this['ctx']['LESS']),this['ctx']['depthMask'](!0x0),0x1==this['bCullBack']?this['ctx']['enable'](this['ctx']['CULL_FACE']):this['ctx']['disable'](this['ctx']['CULL_FACE'])),0x0==this['b3DPort'])this['ctx']['drawArrays'](this['ctx']['TRIANGLES'],0x0,0x6);else{if(this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_SEMISPHERE']||this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_PLANET']){if(this['nSemiSpherePosNum']<=0x0)return _0x2ffc1c['SR_ERR_CALL_ORDER'];this['ctx']['drawArrays'](this['ctx']['TRIANGLES'],0x0,this['nSemiSpherePosNum']);}else{if(this['enDisplayEffect']==_0x5dc8af['SR_DE_PANORAMA_SPHERE']||this['enDisplayEffect']==_0x5dc8af['SR_DE_PANORAMA_PLANET']){if(this['nSpherePosNum']<=0x0)return _0x2ffc1c['SR_ERR_CALL_ORDER'];this['ctx']['bindBuffer'](this['ctx']['ELEMENT_ARRAY_BUFFER'],this['indicesPosBuffer']),this['ctx']['drawElements'](this['ctx']['TRIANGLES'],0x6*this['nSpherePosNum'],this['ctx']['UNSIGNED_SHORT'],0x0),this['ctx']['bindBuffer'](this['ctx']['ELEMENT_ARRAY_BUFFER'],null);}else{if(this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_CYLINDER_CEILING']||this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']||this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_CEILING']||this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR']){if(this['nCylinderPosNum']<=0x0)return _0x2ffc1c['SR_ERR_CALL_ORDER'];this['ctx']['drawArrays'](this['ctx']['TRIANGLES'],0x0,this['nCylinderPosNum']);}else{if(this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']||this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']){if(this['nArcSpherePosNum']<=0x0)return _0x2ffc1c['SR_ERR_CALL_ORDER'];this['ctx']['drawArrays'](this['ctx']['TRIANGLES'],0x0,this['nArcSpherePosNum']);}}}}}return this['ctx']['useProgram'](null),_0x2ffc1c['SR_OK'];}},{'key':'SetAntialias','value':function(_0x580765){return null==this['ctx']?_0x2ffc1c['SR_ERR_CALL_ORDER']:(this['bAntialias']=_0x580765,_0x2ffc1c['SR_OK']);}},{'key':'DelSubPort','value':function(){return null==this['ctx']?_0x2ffc1c['SR_ERR_CALL_ORDER']:(0x0!=this['videoShaderProgram']&&null!=this['ctx']&&(this['ctx']['deleteProgram'](this['videoShaderProgram']),this['videoShaderProgram']=0x0),0x0!=this['vertexPosBuffer']&&null!=this['ctx']&&(this['ctx']['deleteBuffer'](this['vertexPosBuffer']),this['vertexPosBuffer']=0x0),0x0!=this['texturePosBuffer']&&null!=this['ctx']&&(this['ctx']['deleteBuffer'](this['texturePosBuffer']),this['texturePosBuffer']=0x0),0x0!=this['indicesPosBuffer']&&null!=this['ctx']&&(this['ctx']['deleteBuffer'](this['indicesPosBuffer']),this['indicesPosBuffer']=0x0),this['nMaxPointNum']=0x0,this['pLinePosVertices']=null,this['pLineClrVertices']=null,0x0!=this['glLinePosBuffer']&&null!=this['ctx']&&(this['ctx']['deleteBuffer'](this['glLinePosBuffer']),this['glLinePosBuffer']=0x0),this['nLineTriangleNum']=0x0,0x0!=this['nLineShaderProgram']&&null!=this['ctx']&&(this['ctx']['deleteProgram'](this['nLineShaderProgram']),this['nLineShaderProgram']=0x0),this['pFillBlockPosVertices']=null,this['pFillBlockClrVertices']=null,this['nMaxFillBlockTriNum']=0x0,0x0!=this['glBlockPosBuffer']&&null!=this['ctx']&&(this['ctx']['deleteBuffer'](this['glBlockPosBuffer']),this['glBlockPosBuffer']=0x0),0x0!=this['glBlockClrBuffer']&&null!=this['ctx']&&(this['ctx']['deleteBuffer'](this['glBlockClrBuffer']),this['glBlockClrBuffer']=0x0),0x0!=this['nBlockShaderProgram']&&null!=this['ctx']&&(this['ctx']['deleteProgram'](this['nBlockShaderProgram']),this['nBlockShaderProgram']=0x0),this['nDrawFontWidth']=0x0,this['nDrawFontHeight']=0x0,0x0!=this['nFontColorTexture']&&null!=this['ctx']&&(this['ctx']['deleteTexture'](this['nFontColorTexture']),this['nFontColorTexture']=0x0),this['pFontColorBuffer']=0x0,0x0!=this['nFontShaderProgram']&&null!=this['ctx']&&(this['ctx']['deleteProgram'](this['nFontShaderProgram']),this['nFontShaderProgram']=0x0),this['pFontPosVertices']=null,0x0!=this['glFontTexturePosBuffer']&&null!=this['ctx']&&(this['ctx']['deleteBuffer'](this['glFontTexturePosBuffer']),this['glFontTexturePosBuffer']=0x0),0x0!=this['glFontVertexPosBuffer']&&null!=this['ctx']&&(this['ctx']['deleteBuffer'](this['glFontVertexPosBuffer']),this['glFontVertexPosBuffer']=0x0),0x0!=this['nCaptureRTTex']&&(this['ctx']['deleteTexture'](this['nCaptureRTTex']),this['nCaptureRTTex']=0x0),0x0!=this['nCaptureFBO']&&(this['ctx']['deleteFramebuffer'](this['nCaptureFBO']),this['nCaptureFBO']=0x0),0x0!=this['nCaptureDepthbuffer']&&(this['ctx']['deleteRenderbuffer'](this['nCaptureDepthbuffer']),this['nCaptureDepthbuffer']=0x0),this['bCaptureResInit']=!0x1,this['pSemiSpherePos']=null,this['pSemiSphereTex']=null,this['nSemiSpherePosNum']=0x0,this['nSemiSpherePosSize']=0x0,this['nSemiSphereTexSize']=0x0,this['pSpherePos']=null,this['pSphereTex']=null,this['pSphereInd']=null,this['nSpherePosNum']=0x0,this['nSpherePosSize']=0x0,this['nSphereTexSize']=0x0,this['pCylinderPos']=null,this['pCylinderTex']=null,this['nCylinderPosNum']=0x0,this['nCylinderPosSize']=0x0,this['nCylinderTexSize']=0x0,this['fCylinderHeight']=0x0,this['fCylinderRadius']=0x0,this['pArcSpherePos']=null,this['pArcSphereTex']=null,this['nArcSpherePosNum']=0x0,this['nArcSpherePosSize']=0x0,this['nArcSphereTexSize']=0x0,this['b3DPort']=!0x1,this['pCamera']=null,this['fRotateX']=0x0,this['fRotateY']=0x0,this['fScale']=0x0,this['pfuncCBIn']=null,this['pfuncCBOut']=null,this['pUserIn']=null,this['pUserOut']=null,this['ctx']['disable'](this['ctx']['CULL_FACE']),this['ctx']['disable'](this['ctx']['DEPTH_TEST']),_0x2ffc1c['SR_OK']);}},{'key':'SetFishParam','value':function(_0x3cfd71){return null==_0x3cfd71?_0x2ffc1c['SR_ERR_PARAM']:(this['pstFishParam']=_0x3cfd71,_0x2ffc1c['SR_OK']);}},{'key':'DrawLines','value':function(_0x235c91,_0xf79e70,_0x59c1f7,_0x3d47b1,_0x10a26c,_0x4f582d){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x4a78e6=[],_0x441efd={};return _0x441efd['pstPoints']=_0x235c91,_0x441efd['nPointNum']=_0xf79e70,_0x441efd['bLoop']=_0x59c1f7,_0x441efd['pstColor']=_0x3d47b1,_0x441efd['nLineWidth']=_0x10a26c,_0x4a78e6['push'](_0x441efd),this['DrawLinesEx'](_0x4a78e6,0x1,_0xf79e70,_0x4f582d);}},{'key':'DrawLinesEx','value':function(_0x32bdd4,_0x4cd66f,_0x2dcfe0,_0xf542d7){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==_0x32bdd4||_0x4cd66f<0x1||_0x2dcfe0<0x2)return _0x2ffc1c['SR_ERR_PARAM'];if(0x0==this['nLineShaderProgram']){var _0x2919a0=this['CompileProgram']('\\x0a\\x20\\x20\\x20\\x20attribute\\x20vec3\\x20position;\\x0a\\x20\\x20\\x20\\x20attribute\\x20vec4\\x20\\x20\\x20color;\\x0a\\x20\\x20\\x20\\x20varying\\x20\\x20\\x20float\\x20\\x20pp;\\x0a\\x20\\x20\\x20\\x20varying\\x20\\x20\\x20vec4\\x20\\x20colorOut;\\x0a\\x20\\x20\\x20\\x20uniform\\x20int\\x20bCapture;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20\\x20\\x20mat4\\x20\\x20\\x20matRotate;\\x0a\\x0a\\x20\\x20\\x20\\x20void\\x20main()\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(bCapture\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position\\x20=\\x20vec4(position.x,\\x20position.y,\\x200.0,\\x201.0)\\x20*\\x20matRotate;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position.y\\x20=\\x20-gl_Position.y;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20else\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position\\x20=\\x20vec4(position.x,\\x20position.y,\\x200.0,\\x201.0)\\x20*\\x20matRotate;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20pp\\x20=\\x20position.z;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20colorOut\\x20=\\x20color;\\x0a\\x20\\x20\\x20\\x20}\\x0a',_0x27b6a6);if(_0x2919a0<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['nLineShaderProgram']=_0x2919a0;}if(0x1==_0xf542d7)return this['DrawFillBlock'](_0x32bdd4,_0x4cd66f,_0x2dcfe0);for(var _0x4bfdcd=0x0,_0x3afab0=0x0;_0x3afab0<_0x4cd66f;++_0x3afab0){if(null==_0x32bdd4[_0x3afab0]['pstPoints']||_0x32bdd4[_0x3afab0]['nPointNum']<=0x1||_0x32bdd4[_0x3afab0]['nPointNum']>=0x400||_0x32bdd4[_0x3afab0]['nLineWidth']<=0x0||null==_0x32bdd4[_0x3afab0]['pstColor'])return _0x2ffc1c['SR_ERR_PARAM'];_0x4bfdcd+=_0x32bdd4[_0x3afab0]['nPointNum'];}if(_0x4bfdcd!=_0x2dcfe0)return _0x2ffc1c['SR_ERR_PARAM'];if((_0x4bfdcd+=_0x4cd66f)>this['nMaxPointNum']&&(this['nMaxPointNum']=_0x4bfdcd,this['pLinePosVertices']=null,this['pLineClrVertices']=null),null==this['pLinePosVertices']&&(this['pLinePosVertices']=new Float32Array(0x6*this['nMaxPointNum']*0x3),null==this['pLinePosVertices']))return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];if(this['pLinePosVertices']['fill'](0x0),null==this['pLineClrVertices']&&(this['pLineClrVertices']=new Float32Array(0x6*this['nMaxPointNum']*0x4),null==this['pLineClrVertices']))return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];if(this['pLineClrVertices']['fill'](0x0),0x0==this['glLinePosBuffer']&&(this['glLinePosBuffer']=this['ctx']['createBuffer'](),0x0==this['glLinePosBuffer']))return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];if(0x0==this['glLineClrBuffer']&&(this['glLineClrBuffer']=this['ctx']['createBuffer'](),0x0==this['glLineClrBuffer']))return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];var _0x14d763=this['ComputeLinePoint'](_0x32bdd4,_0x4cd66f);if(_0x2ffc1c['SR_OK']!=_0x14d763)return _0x14d763;this['ctx']['enable'](this['ctx']['BLEND']),this['ctx']['blendFuncSeparate'](this['ctx']['SRC_ALPHA'],this['ctx']['ONE_MINUS_SRC_ALPHA'],this['ctx']['ONE'],this['ctx']['ONE_MINUS_SRC_ALPHA']);var _0xa2f7e3=this['nLineShaderProgram'];this['ctx']['useProgram'](_0xa2f7e3);var _0x13521a=this['ctx']['getUniformLocation'](this['nLineShaderProgram'],'bCapture');if(_0x13521a<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];0x1==this['bIsCapturing']?this['ctx']['uniform1i'](_0x13521a,0x1):this['ctx']['uniform1i'](_0x13521a,0x0);var _0xd5a89a=this['glLinePosBuffer'],_0x27a519=this['glLineClrBuffer'],_0xe93101=this['nLineTriangleNum'],_0x30d029=this['pLinePosVertices'],_0x4f439e=this['pLineClrVertices'];this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],_0xd5a89a),this['ctx']['bufferData'](this['ctx']['ARRAY_BUFFER'],_0x30d029,this['ctx']['STATIC_DRAW']);var _0x214d58=this['ctx']['getAttribLocation'](_0xa2f7e3,'position');this['ctx']['enableVertexAttribArray'](_0x214d58),this['ctx']['vertexAttribPointer'](_0x214d58,0x3,this['ctx']['FLOAT'],!0x1,0x0,0x0),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],_0x27a519),this['ctx']['bufferData'](this['ctx']['ARRAY_BUFFER'],_0x4f439e,this['ctx']['STATIC_DRAW']);var _0x3ae9ae=this['ctx']['getAttribLocation'](_0xa2f7e3,'color');this['ctx']['enableVertexAttribArray'](_0x3ae9ae),this['ctx']['vertexAttribPointer'](_0x3ae9ae,0x4,this['ctx']['FLOAT'],!0x1,0x0,0x0),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],null);var _0x503e30=this['ctx']['getUniformLocation'](_0xa2f7e3,'matRotate');return _0x503e30<=0x0?_0x2ffc1c['SR_ERR_WEBGL_RESOURCE']:(this['ctx']['uniformMatrix4fv'](_0x503e30,!0x1,this['matRotate']),0x1==this['bIsCapturing']?this['ctx']['viewport'](0x0,0x0,this['nCaptureWidth'],this['nCaptureHeight']):this['ctx']['viewport'](0x0,0x0,this['nWndWidth'],this['nWndHeight']),this['ctx']['disable'](this['ctx']['DEPTH_TEST']),this['ctx']['drawArrays'](this['ctx']['TRIANGLES'],0x0,0x3*_0xe93101),this['ctx']['useProgram'](null),this['ctx']['disable'](this['ctx']['BLEND']),this['b3DPort']&&(this['ctx']['enable'](this['ctx']['DEPTH_TEST']),this['ctx']['depthFunc'](this['ctx']['LESS']),this['ctx']['depthMask'](!0x0),0x1==this['bCullBack']?this['ctx']['enable'](this['ctx']['CULL_FACE']):this['ctx']['disable'](this['ctx']['CULL_FACE'])),_0x2ffc1c['SR_OK']);}},{'key':'DrawFillBlock','value':function(_0x455fc1,_0x360475,_0x457876){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==_0x455fc1||_0x360475<0x1||_0x457876<0x2)return _0x2ffc1c['SR_ERR_PARAM'];for(var _0x179bfe=0x0,_0x330526=0x0;_0x330526<_0x360475;++_0x330526){if(null==_0x455fc1[_0x330526]['pstPoints']||_0x455fc1[_0x330526]['nPointNum']<0x3||0x1!=_0x455fc1[_0x330526]['bLoop']||null==_0x455fc1[_0x330526]['pstColor'])return _0x2ffc1c['SR_ERR_PARAM'];_0x179bfe+=_0x455fc1[_0x330526]['nPointNum'];}if(_0x179bfe!==_0x457876)return _0x2ffc1c['SR_ERR_PARAM'];var _0x31642c=_0x457876-0x2*_0x360475;if(_0x31642c>this['nMaxFillBlockTriNum']&&(this['pFillBlockPosVertices']=null,this['pFillBlockClrVertices']=null,this['nMaxFillBlockTriNum']=_0x31642c),0x0==this['glBlockPosBuffer']&&(this['glBlockPosBuffer']=this['ctx']['createBuffer'](),0x0==this['glBlockPosBuffer']))return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];if(0x0==this['glBlockClrBuffer']&&(this['glBlockClrBuffer']=this['ctx']['createBuffer'](),0x0==this['glBlockClrBuffer']))return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];if(null==this['pFillBlockPosVertices']){var _0x37d9a3=this['nMaxFillBlockTriNum'];if(this['pFillBlockPosVertices']=new Float32Array(0x3*_0x37d9a3*0x3),null==this['pFillBlockPosVertices'])return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];}if(this['pFillBlockPosVertices']['fill'](0x0),null==this['pFillBlockClrVertices']){var _0x884b3=this['nMaxFillBlockTriNum'];if(this['pFillBlockClrVertices']=new Float32Array(0x4*_0x884b3*0x3),null==this['pFillBlockClrVertices'])return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];}this['pFillBlockClrVertices']['fill'](0x0);for(var _0xd4f367=0x0,_0x120a96=0x0,_0x21374f=0x0,_0x1d02eb=null,_0x57f4f0=null,_0x3cf824={},_0xf32b7a={},_0x2d9bcc={},_0x18b6b1=0x0;_0x18b6b1<_0x360475;++_0x18b6b1){_0x21374f=_0x455fc1[_0x18b6b1]['nPointNum'],_0x1d02eb=_0x455fc1[_0x18b6b1]['pstPoints'],_0x57f4f0=_0x455fc1[_0x18b6b1]['pstColor'],_0x3cf824['fX']=(_0x1d02eb[0x0]['fX']-this['fSrcUseLeft'])/(this['fSrcUseRight']-this['fSrcUseLeft']),_0x3cf824['fX']=this['fDstUseLeft']+_0x3cf824['fX']*(this['fDstUseRight']-this['fDstUseLeft']),_0x3cf824['fX']=0x2*_0x3cf824['fX']-0x1,_0x3cf824['fY']=(_0x1d02eb[0x0]['fY']-this['fSrcUseTop'])/(this['fSrcUseBottom']-this['fSrcUseTop']),_0x3cf824['fY']=this['fDstUseTop']+_0x3cf824['fY']*(this['fDstUseBottom']-this['fDstUseTop']),_0x3cf824['fY']=0x1-0x2*_0x3cf824['fY'];for(var _0x115476=0x1;_0x115476<_0x21374f-0x1;_0x115476++)_0xf32b7a['fX']=(_0x1d02eb[_0x115476]['fX']-this['fSrcUseLeft'])/(this['fSrcUseRight']-this['fSrcUseLeft']),_0xf32b7a['fX']=this['fDstUseLeft']+_0xf32b7a['fX']*(this['fDstUseRight']-this['fDstUseLeft']),_0xf32b7a['fX']=0x2*_0xf32b7a['fX']-0x1,_0xf32b7a['fY']=(_0x1d02eb[_0x115476]['fY']-this['fSrcUseTop'])/(this['fSrcUseBottom']-this['fSrcUseTop']),_0xf32b7a['fY']=this['fDstUseTop']+_0xf32b7a['fY']*(this['fDstUseBottom']-this['fDstUseTop']),_0xf32b7a['fY']=0x1-0x2*_0xf32b7a['fY'],_0x2d9bcc['fX']=(_0x1d02eb[_0x115476+0x1]['fX']-this['fSrcUseLeft'])/(this['fSrcUseRight']-this['fSrcUseLeft']),_0x2d9bcc['fX']=this['fDstUseLeft']+_0x2d9bcc['fX']*(this['fDstUseRight']-this['fDstUseLeft']),_0x2d9bcc['fX']=0x2*_0x2d9bcc['fX']-0x1,_0x2d9bcc['fY']=(_0x1d02eb[_0x115476+0x1]['fY']-this['fSrcUseTop'])/(this['fSrcUseBottom']-this['fSrcUseTop']),_0x2d9bcc['fY']=this['fDstUseTop']+_0x2d9bcc['fY']*(this['fDstUseBottom']-this['fDstUseTop']),_0x2d9bcc['fY']=0x1-0x2*_0x2d9bcc['fY'],this['pFillBlockPosVertices'][_0xd4f367++]=_0x3cf824['fX'],this['pFillBlockPosVertices'][_0xd4f367++]=_0x3cf824['fY'],this['pFillBlockPosVertices'][_0xd4f367++]=0x0,this['pFillBlockClrVertices'][_0x120a96++]=_0x57f4f0['fR'],this['pFillBlockClrVertices'][_0x120a96++]=_0x57f4f0['fG'],this['pFillBlockClrVertices'][_0x120a96++]=_0x57f4f0['fB'],this['pFillBlockClrVertices'][_0x120a96++]=_0x57f4f0['fA'],this['pFillBlockPosVertices'][_0xd4f367++]=_0xf32b7a['fX'],this['pFillBlockPosVertices'][_0xd4f367++]=_0xf32b7a['fY'],this['pFillBlockPosVertices'][_0xd4f367++]=0x0,this['pFillBlockClrVertices'][_0x120a96++]=_0x57f4f0['fR'],this['pFillBlockClrVertices'][_0x120a96++]=_0x57f4f0['fG'],this['pFillBlockClrVertices'][_0x120a96++]=_0x57f4f0['fB'],this['pFillBlockClrVertices'][_0x120a96++]=_0x57f4f0['fA'],this['pFillBlockPosVertices'][_0xd4f367++]=_0x2d9bcc['fX'],this['pFillBlockPosVertices'][_0xd4f367++]=_0x2d9bcc['fY'],this['pFillBlockPosVertices'][_0xd4f367++]=0x0,this['pFillBlockClrVertices'][_0x120a96++]=_0x57f4f0['fR'],this['pFillBlockClrVertices'][_0x120a96++]=_0x57f4f0['fG'],this['pFillBlockClrVertices'][_0x120a96++]=_0x57f4f0['fB'],this['pFillBlockClrVertices'][_0x120a96++]=_0x57f4f0['fA'];}if(0x0==this['nBlockShaderProgram']&&(this['nBlockShaderProgram']=this['CompileProgram']('\\x0a\\x20\\x20\\x20\\x20attribute\\x20vec3\\x20position;\\x0a\\x20\\x20\\x20\\x20attribute\\x20vec4\\x20\\x20\\x20color;\\x0a\\x20\\x20\\x20\\x20varying\\x20\\x20\\x20float\\x20\\x20pp;\\x0a\\x20\\x20\\x20\\x20varying\\x20\\x20\\x20vec4\\x20\\x20colorOut;\\x0a\\x20\\x20\\x20\\x20uniform\\x20int\\x20bCapture;\\x20\\x0a\\x0a\\x20\\x20\\x20\\x20void\\x20main()\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(bCapture\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position\\x20=\\x20vec4(position.x,\\x20position.y,\\x200.0,\\x201.0);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position.y\\x20=\\x20-gl_Position.y;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20else\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position\\x20=\\x20vec4(position.x,\\x20position.y,\\x200.0,\\x201.0);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20pp\\x20=\\x20position.z;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20colorOut\\x20=\\x20color;\\x0a\\x20\\x20\\x20\\x20}\\x0a',_0x27b6a6),this['nBlockShaderProgram']<=0x0))return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['enable'](this['ctx']['BLEND']),this['ctx']['blendFuncSeparate'](this['ctx']['SRC_ALPHA'],this['ctx']['ONE_MINUS_SRC_ALPHA'],this['ctx']['ONE'],this['ctx']['ONE_MINUS_SRC_ALPHA']),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['glBlockPosBuffer']),this['ctx']['bufferData'](this['ctx']['ARRAY_BUFFER'],this['pFillBlockPosVertices'],this['ctx']['STATIC_DRAW']),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],null),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['glBlockClrBuffer']),this['ctx']['bufferData'](this['ctx']['ARRAY_BUFFER'],this['pFillBlockClrVertices'],this['ctx']['STATIC_DRAW']),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],null),this['ctx']['useProgram'](this['nBlockShaderProgram']);var _0x54014e=this['ctx']['getUniformLocation'](this['nBlockShaderProgram'],'bCapture');if(_0x54014e<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];0x1==this['bIsCapturing']?this['ctx']['uniform1i'](_0x54014e,0x1):this['ctx']['uniform1i'](_0x54014e,0x0),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['glBlockPosBuffer']);var _0x4c6c0a=this['ctx']['getAttribLocation'](this['nBlockShaderProgram'],'position');this['ctx']['enableVertexAttribArray'](_0x4c6c0a),this['ctx']['vertexAttribPointer'](_0x4c6c0a,0x3,this['ctx']['FLOAT'],!0x1,0x0,0x0),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],null),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['glBlockClrBuffer']);var _0x3e1ebb=this['ctx']['getAttribLocation'](this['nBlockShaderProgram'],'color');return this['ctx']['enableVertexAttribArray'](_0x3e1ebb),this['ctx']['vertexAttribPointer'](_0x3e1ebb,0x4,this['ctx']['FLOAT'],!0x1,0x0,0x0),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],null),this['ctx']['drawArrays'](this['ctx']['TRIANGLES'],0x0,0x3*_0x31642c),this['ctx']['useProgram'](null),this['ctx']['disable'](this['ctx']['BLEND']),_0x2ffc1c['SR_OK'];}},{'key':'ComputeLinePoint','value':function(_0x9e5279,_0x253e02){if(null==_0x9e5279||_0x253e02<0x1)return _0x2ffc1c['SR_ERR_PARAM'];if(null==this['pLinePosVertices']||null==this['pLineClrVertices'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x2f2637=0x0,_0x52e469=0x0;0x1==this['bIsCapturing']?(_0x2f2637=(this['fDstUseRight']-this['fDstUseLeft'])*this['nCaptureWidth'],_0x52e469=(this['fDstUseBottom']-this['fDstUseTop'])*this['nCaptureHeight']):(_0x2f2637=(this['fDstUseRight']-this['fDstUseLeft'])*this['nWndWidth'],_0x52e469=(this['fDstUseBottom']-this['fDstUseTop'])*this['nWndHeight']);for(var _0x2ca0ce=0x0,_0x30c12a=0x0,_0x6519a5=0x0,_0x26a944=0x0,_0x38aa5e=0x0,_0x4b3fcb=0x0,_0x43a4c3=0x0,_0x588e72=0x0,_0x494a9f=0x0,_0x1dd1b5=0x0,_0x24a8fc=0x0,_0x2be773=0x0;_0x2be773<_0x253e02;++_0x2be773){var _0xa17c62=[];if(!((_0x24a8fc=_0x9e5279[_0x2be773]['nPointNum'])<=0x0)){for(var _0x5b7fa0=0x0;_0x5b7fa0<_0x24a8fc;++_0x5b7fa0){var _0x4f1a01={};_0x4f1a01['fX']=(_0x9e5279[_0x2be773]['pstPoints'][_0x5b7fa0]['fX']-this['fSrcUseLeft'])/(this['fSrcUseRight']-this['fSrcUseLeft']),_0x4f1a01['fX']=this['fDstUseLeft']+_0x4f1a01['fX']*(this['fDstUseRight']-this['fDstUseLeft']),_0x4f1a01['fX']=0x2*_0x4f1a01['fX']-0x1,_0x4f1a01['fY']=(_0x9e5279[_0x2be773]['pstPoints'][_0x5b7fa0]['fY']-this['fSrcUseTop'])/(this['fSrcUseBottom']-this['fSrcUseTop']),_0x4f1a01['fY']=this['fDstUseTop']+_0x4f1a01['fY']*(this['fDstUseBottom']-this['fDstUseTop']),_0x4f1a01['fY']=0x1-0x2*_0x4f1a01['fY'],_0xa17c62['push'](_0x4f1a01);}if(this['nWndWidth']<=0x0||this['nWndHeight']<=0x0)return _0x2ffc1c['SR_ERR_CANVAS'];if(_0x4b3fcb=3.5*_0x9e5279[_0x2be773]['nLineWidth']/_0x2f2637,_0x43a4c3=3.5*_0x9e5279[_0x2be773]['nLineWidth']/_0x52e469,_0x4b3fcb<=0x0||_0x43a4c3<=0x0)return _0x2ffc1c['SR_ERR_PARAM'];var _0xdccc82=_0x9e5279[_0x2be773]['pstColor'];if(null==_0xdccc82||null==_0xdccc82)return _0x2ffc1c['SR_ERR_PARAM'];for(var _0x816825=0x0;_0x816825<_0x24a8fc-0x1;++_0x816825)_0x30c12a=_0xa17c62[_0x816825+0x1]['fX']-_0xa17c62[_0x816825]['fX'],_0x6519a5=_0xa17c62[_0x816825+0x1]['fY']-_0xa17c62[_0x816825]['fY'],_0x2ca0ce=Math['sqrt'](_0x30c12a*_0x30c12a+_0x6519a5*_0x6519a5),Math['abs'](_0x2ca0ce-0x0)<0.000001||(_0x26a944=-_0x4b3fcb*_0x6519a5/_0x2ca0ce/0x2,_0x38aa5e=_0x43a4c3*_0x30c12a/_0x2ca0ce/0x2,this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[_0x816825]['fX']+_0x26a944,this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[_0x816825]['fY']+_0x38aa5e,this['pLinePosVertices'][_0x494a9f++]=-0x1,this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fR'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fG'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fB'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fA'],this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[_0x816825+0x1]['fX']-_0x26a944,this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[_0x816825+0x1]['fY']-_0x38aa5e,this['pLinePosVertices'][_0x494a9f++]=0x1,this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fR'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fG'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fB'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fA'],this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[_0x816825]['fX']-_0x26a944,this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[_0x816825]['fY']-_0x38aa5e,this['pLinePosVertices'][_0x494a9f++]=0x1,this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fR'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fG'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fB'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fA'],this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[_0x816825]['fX']+_0x26a944,this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[_0x816825]['fY']+_0x38aa5e,this['pLinePosVertices'][_0x494a9f++]=-0x1,this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fR'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fG'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fB'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fA'],this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[_0x816825+0x1]['fX']+_0x26a944,this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[_0x816825+0x1]['fY']+_0x38aa5e,this['pLinePosVertices'][_0x494a9f++]=-0x1,this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fR'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fG'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fB'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fA'],this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[_0x816825+0x1]['fX']-_0x26a944,this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[_0x816825+0x1]['fY']-_0x38aa5e,this['pLinePosVertices'][_0x494a9f++]=0x1,this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fR'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fG'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fB'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fA'],_0x588e72+=0x2);0x1==_0x9e5279[_0x2be773]['bLoop']&&0x2<_0x24a8fc&&(_0x30c12a=_0xa17c62[_0x24a8fc-0x1]['fX']-_0xa17c62[0x0]['fX'],_0x6519a5=_0xa17c62[_0x24a8fc-0x1]['fY']-_0xa17c62[0x0]['fY'],_0x2ca0ce=Math['sqrt'](_0x30c12a*_0x30c12a+_0x6519a5*_0x6519a5),Math['abs'](_0x2ca0ce-0x0)>0.000001&&(_0x26a944=-_0x4b3fcb*_0x6519a5/_0x2ca0ce/0x2,_0x38aa5e=_0x43a4c3*_0x30c12a/_0x2ca0ce/0x2,this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[0x0]['fX']+_0x26a944,this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[0x0]['fY']+_0x38aa5e,this['pLinePosVertices'][_0x494a9f++]=-0x1,this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fR'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fG'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fB'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fA'],this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[_0x24a8fc-0x1]['fX']-_0x26a944,this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[_0x24a8fc-0x1]['fY']-_0x38aa5e,this['pLinePosVertices'][_0x494a9f++]=0x1,this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fR'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fG'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fB'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fA'],this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[0x0]['fX']-_0x26a944,this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[0x0]['fY']-_0x38aa5e,this['pLinePosVertices'][_0x494a9f++]=0x1,this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fR'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fG'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fB'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fA'],this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[0x0]['fX']+_0x26a944,this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[0x0]['fY']+_0x38aa5e,this['pLinePosVertices'][_0x494a9f++]=-0x1,this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fR'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fG'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fB'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fA'],this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[_0x24a8fc-0x1]['fX']+_0x26a944,this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[_0x24a8fc-0x1]['fY']+_0x38aa5e,this['pLinePosVertices'][_0x494a9f++]=-0x1,this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fR'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fG'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fB'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fA'],this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[_0x24a8fc-0x1]['fX']-_0x26a944,this['pLinePosVertices'][_0x494a9f++]=_0xa17c62[_0x24a8fc-0x1]['fY']-_0x38aa5e,this['pLinePosVertices'][_0x494a9f++]=0x1,this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fR'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fG'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fB'],this['pLineClrVertices'][_0x1dd1b5++]=_0xdccc82['fA'],_0x588e72+=0x2));}}return 0x0==_0x588e72?_0x2ffc1c['SR_ERR_PARAM']:(this['nLineTriangleNum']=_0x588e72,_0x2ffc1c['SR_OK']);}},{'key':'DrawFont','value':function(_0x38853a,_0x179442,_0x10366e,_0x538e8a,_0x5429ac,_0x24b3eb,_0x5e3a70,_0x1fb5a2,_0x277eef,_0x483788,_0xd01266){return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}},{'key':'DrawFontEx','value':function(_0x9109ce,_0xbec7fe){var _0x44e9f1=arguments['length']>0x2&&void 0x0!==arguments[0x2]?arguments[0x2]:0x0,_0x517450=arguments['length']>0x3?arguments[0x3]:void 0x0;if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(0x0>_0xbec7fe||null==_0x9109ce)return _0x2ffc1c['SR_ERR_PARAM'];var _0x3f7796,_0x56c233,_0xe14d7a=0x0,_0x33a915=0x0;if(0x1==this['bIsCapturing']){if(0x0==this['nCaptureWidth']||0x0==this['nCaptureHeight'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];_0xe14d7a=Math['round']((this['fDstUseRight']-this['fDstUseLeft'])*this['nCaptureWidth']),_0x33a915=Math['round']((this['fDstUseBottom']-this['fDstUseTop'])*this['nCaptureHeight']);}else _0xe14d7a=Math['round']((this['fDstUseRight']-this['fDstUseLeft'])*this['nWndWidth']),_0x33a915=Math['round']((this['fDstUseBottom']-this['fDstUseTop'])*this['nWndHeight']);if(this['nDrawFontWidth']==_0xe14d7a&&this['nDrawFontHeight']==_0x33a915||(this['pFontColorBuffer']=null,this['nFontColorTexture']=0x0,this['nDrawFontWidth']=_0xe14d7a,this['nDrawFontHeight']=_0x33a915),0x0==this['nFontColorTexture']){if(this['nFontColorTexture']=this['ctx']['createTexture'](),0x0==this['nFontColorTexture'])return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nFontColorTexture']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MAG_FILTER'],this['ctx']['LINEAR']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_WRAP_S'],this['ctx']['CLAMP_TO_EDGE']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_WRAP_T'],this['ctx']['CLAMP_TO_EDGE']);}if(null==this['textCanvas']){if(this['textCanvas']=_0x517450,null==this['textCanvas'])return _0x2ffc1c['SR_ERR_FONT'];if(this['textCanvasCtx']=this['textCanvas']['getContext']('2d'),null==this['textCanvasCtx'])return _0x2ffc1c['SR_ERR_FONT'];}this['textCanvasCtx']['canvas']['width']=this['nDrawFontWidth'],this['textCanvasCtx']['canvas']['height']=this['nDrawFontHeight'],this['textCanvasCtx']['clearRect'](0x0,0x0,this['nDrawFontWidth'],this['nDrawFontHeight']);for(var _0x532c83=0x0;_0x532c83<_0xbec7fe;++_0x532c83){var _0x429672=_0x9109ce[_0x532c83]['nFontWidth'],_0x5b2564=_0x9109ce[_0x532c83]['nFontHeight'];0x1==this['bIsCapturing']&&(_0x429672=Math['round'](this['nCaptureWidth']/this['nWndWidth']*_0x429672),_0x5b2564=Math['round'](this['nCaptureHeight']/this['nWndHeight']*_0x5b2564));var _0xdbc74d=_0x429672<_0x5b2564?_0x429672:_0x5b2564;this['textCanvasCtx']['font']=''['concat'](_0xdbc74d,'px\\x20')['concat'](_0x9109ce[_0x532c83]['pFontFamily']),this['textCanvasCtx']['textAlign']=_0x9109ce[_0x532c83]['textAlign']||'left',this['textCanvasCtx']['textBaseline']=_0x9109ce[_0x532c83]['textBaseline']||'top',this['textCanvasCtx']['save']();var _0x50043c=_0x9109ce[_0x532c83]['pstStartPos']['fX']*this['nDrawFontWidth'],_0x5d5bd5=_0x9109ce[_0x532c83]['pstStartPos']['fY']*this['nDrawFontHeight'];if(this['textCanvasCtx']['translate'](_0x50043c,_0x5d5bd5),this['textCanvasCtx']['rotate'](_0x9109ce[_0x532c83]['fRotateAngle']*Math['PI']/0xb4),_0x9109ce[_0x532c83]['bBackGround']){var _0x14dbb2=_0x9109ce[_0x532c83]['pstStartPos']['fX'],_0x54e2ac=_0x9109ce[_0x532c83]['pstStartPos']['fY'],_0x35cfaf=this['textCanvasCtx']['measureText'](_0x9109ce[_0x532c83]['pString'])['width'],_0x24e028=_0xdbc74d;switch(this['textCanvasCtx']['textAlign']){case'center':_0x14dbb2-=_0x35cfaf/0x2;break;case'right':case'end':_0x14dbb2-=_0x35cfaf;}switch(this['textCanvasCtx']['textBaseline']){case'top':case'hanging':break;case'middle':_0x54e2ac-=_0x24e028/0x2;break;default:_0x54e2ac-=_0x24e028;}var _0x47a8fe=_0x9109ce[_0x532c83]['pstBGColor'];this['textCanvasCtx']['fillStyle']='rgb('['concat'](0xff*_0x47a8fe['fR'],',\\x20')['concat'](0xff*_0x47a8fe['fG'],',\\x20')['concat'](0xff*_0x47a8fe['fB'],')'),this['textCanvasCtx']['globalAlpha']=_0x47a8fe['fA'],this['textCanvasCtx']['fillRect'](_0x14dbb2,_0x54e2ac,_0x35cfaf,_0x24e028);}var _0x4c7a00=_0x9109ce[_0x532c83]['pstFontColor'];this['textCanvasCtx']['fillStyle']='rgb('['concat'](0xff*_0x4c7a00['fR'],',\\x20')['concat'](0xff*_0x4c7a00['fG'],',\\x20')['concat'](0xff*_0x4c7a00['fB'],')'),this['textCanvasCtx']['globalAlpha']=_0x9109ce[_0x532c83]['pstFontColor']['fA'],this['textCanvasCtx']['fillText'](_0x9109ce[_0x532c83]['pString'],0x0,0x0),this['textCanvasCtx']['restore']();}if(this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nFontColorTexture']),this['ctx']['texImage2D'](this['ctx']['TEXTURE_2D'],0x0,this['ctx']['RGBA'],this['ctx']['RGBA'],this['ctx']['UNSIGNED_BYTE'],this['textCanvasCtx']['canvas']),0x0==this['nFontShaderProgram']&&(this['nFontShaderProgram']=this['CompileProgram'](_0x5580fc,_0xf24101),this['nFontShaderProgram']<=0x0))return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];if(0x1==this['bIsCapturing']?(_0x3f7796=this['nCaptureWidth'],_0x56c233=this['nCaptureHeight']):(_0x3f7796=this['nWndWidth'],_0x56c233=this['nWndHeight']),0x1==_0x44e9f1){if(0x0==this['glFontVertexPosBuffer']){var _0x8f15c5=new Float32Array([-0x1,-0x1,0x0,0x1,-0x1,0x0,0x1,0x1,0x0,-0x1,0x1,0x0]),_0x5dcbce=this['ctx']['createBuffer']();this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],_0x5dcbce),this['ctx']['bufferData'](this['ctx']['ARRAY_BUFFER'],_0x8f15c5,this['ctx']['STATIC_DRAW']),this['glFontVertexPosBuffer']=_0x5dcbce,_0x8f15c5=0x0;}if(0x0==this['glFontTexturePosBuffer']){var _0xb1d968=new Float32Array([0x0,0x1,0x1,0x1,0x1,0x0,0x0,0x0]),_0x578901=this['ctx']['createBuffer']();this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],_0x578901),this['ctx']['bufferData'](this['ctx']['ARRAY_BUFFER'],_0xb1d968,this['ctx']['STATIC_DRAW']),this['glFontTexturePosBuffer']=_0x578901,_0xb1d968=0x0;}}this['ctx']['viewport'](0x0,0x0,_0x3f7796,_0x56c233),this['ctx']['enable'](this['ctx']['BLEND']),this['ctx']['blendFuncSeparate'](this['ctx']['SRC_ALPHA'],this['ctx']['ONE_MINUS_SRC_ALPHA'],this['ctx']['ONE'],this['ctx']['ONE_MINUS_SRC_ALPHA']),this['ctx']['useProgram'](this['nFontShaderProgram']);var _0x3b3400=this['ctx']['getUniformLocation'](this['nFontShaderProgram'],'bCapture');if(_0x3b3400<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];0x1==this['bIsCapturing']?this['ctx']['uniform1i'](_0x3b3400,0x1):this['ctx']['uniform1i'](_0x3b3400,0x0),this['ctx']['activeTexture'](this['ctx']['TEXTURE0']),this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nFontColorTexture']);var _0x345abd=this['ctx']['getUniformLocation'](this['nFontShaderProgram'],'texture');this['ctx']['uniform1i'](_0x345abd,0x0);var _0x3bd723=_0x110b84(),_0x56329c=_0x110b84(),_0x1be60b=_0x110b84();_0x1ae1d4(_0x1be60b,_0x3bd723,_0x56329c);var _0x11db01=this['ctx']['getUniformLocation'](this['nFontShaderProgram'],'matRotate');if(_0x11db01<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x11db01,!0x1,_0x1be60b),0x1==_0x44e9f1?this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['glFontVertexPosBuffer']):this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['vertexPosBuffer']);var _0x4a235c=this['ctx']['getAttribLocation'](this['nFontShaderProgram'],'position');this['ctx']['enableVertexAttribArray'](_0x4a235c),0x1==_0x44e9f1?this['ctx']['vertexAttribPointer'](_0x4a235c,0x3,this['ctx']['FLOAT'],!0x1,0x0,0x0):this['ctx']['vertexAttribPointer'](_0x4a235c,0x2,this['ctx']['FLOAT'],!0x1,0x0,0x0),0x1==_0x44e9f1?this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['glFontTexturePosBuffer']):this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['texturePosBuffer']);var _0x27df8f=this['ctx']['getAttribLocation'](this['nFontShaderProgram'],'texCoord');return this['ctx']['enableVertexAttribArray'](_0x27df8f),this['ctx']['vertexAttribPointer'](_0x27df8f,0x2,this['ctx']['FLOAT'],!0x1,0x0,0x0),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],null),this['ctx']['disable'](this['ctx']['DEPTH_TEST']),0x1==_0x44e9f1?this['ctx']['drawArrays'](this['ctx']['TRIANGLE_FAN'],0x0,0x4):this['ctx']['drawArrays'](this['ctx']['TRIANGLES'],0x0,0x6),this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],null),this['ctx']['useProgram'](null),this['ctx']['disable'](this['ctx']['BLEND']),this['b3DPort']&&(this['ctx']['enable'](this['ctx']['DEPTH_TEST']),this['ctx']['depthFunc'](this['ctx']['LESS']),this['ctx']['depthMask'](!0x0),0x1==this['bCullBack']?this['ctx']['enable'](this['ctx']['CULL_FACE']):this['ctx']['disable'](this['ctx']['CULL_FACE'])),_0x2ffc1c['SR_OK'];}},{'key':'DrawImage','value':function(_0x276d42,_0x3fbb6b,_0x4db4a6,_0x554f46,_0x1e97ff,_0x4c8a02){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==_0x276d42||_0x3fbb6b<=0x0||_0x4db4a6<=0x0||null==_0x554f46||_0x4c8a02<0x0||_0x4c8a02>0x1)return _0x2ffc1c['SR_ERR_PARAM'];if(this['nDrawImageWidth']=_0x3fbb6b,this['nDrawImageHeight']=_0x4db4a6,0x0==this['glImagePosBuffer']&&(this['glImagePosBuffer']=this['ctx']['createBuffer'](),0x0==this['glImagePosBuffer']))return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];if(0x0==this['glImageClrBuffer']&&(this['glImageClrBuffer']=this['ctx']['createBuffer'](),0x0==this['glImageClrBuffer']))return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];if(null==this['pImageClrVertices']){if(this['pImageClrVertices']=new Float32Array(0xc),null==this['pImageClrVertices'])return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];this['pImageClrVertices'][0x0]=0x0,this['pImageClrVertices'][0x1]=0x0,this['pImageClrVertices'][0x2]=0x0,this['pImageClrVertices'][0x3]=0x1,this['pImageClrVertices'][0x4]=0x1,this['pImageClrVertices'][0x5]=0x0,this['pImageClrVertices'][0x6]=0x1,this['pImageClrVertices'][0x7]=0x0,this['pImageClrVertices'][0x8]=0x0,this['pImageClrVertices'][0x9]=0x1,this['pImageClrVertices'][0xa]=0x1,this['pImageClrVertices'][0xb]=0x1;}var _0x850ed2={},_0x3b8ccb={};if(_0x850ed2['fLeft']=(_0x554f46['fLeft']-this['fSrcUseLeft'])/(this['fSrcUseRight']-this['fSrcUseLeft']),_0x850ed2['fRight']=(_0x554f46['fRight']-this['fSrcUseLeft'])/(this['fSrcUseRight']-this['fSrcUseLeft']),_0x850ed2['fTop']=(_0x554f46['fTop']-this['fSrcUseTop'])/(this['fSrcUseBottom']-this['fSrcUseTop']),_0x850ed2['fBottom']=(_0x554f46['fBottom']-this['fSrcUseTop'])/(this['fSrcUseBottom']-this['fSrcUseTop']),_0x3b8ccb['fLeft']=this['fDstUseLeft']+_0x850ed2['fLeft']*(this['fDstUseRight']-this['fDstUseLeft']),_0x3b8ccb['fRight']=this['fDstUseLeft']+_0x850ed2['fRight']*(this['fDstUseRight']-this['fDstUseLeft']),_0x3b8ccb['fTop']=this['fDstUseTop']+_0x850ed2['fTop']*(this['fDstUseBottom']-this['fDstUseTop']),_0x3b8ccb['fBottom']=this['fDstUseTop']+_0x850ed2['fBottom']*(this['fDstUseBottom']-this['fDstUseTop']),null==this['pImagePosVertices']&&(this['pImagePosVertices']=new Float32Array(0xc),null==this['pImagePosVertices']))return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];switch(this['pImagePosVertices']['fill'](0x0),this['pImagePosVertices'][0x0]=0x2*_0x3b8ccb['fLeft']-0x1,this['pImagePosVertices'][0x1]=0x1-0x2*_0x3b8ccb['fTop'],this['pImagePosVertices'][0x2]=0x2*_0x3b8ccb['fLeft']-0x1,this['pImagePosVertices'][0x3]=0x1-0x2*_0x3b8ccb['fBottom'],this['pImagePosVertices'][0x4]=0x2*_0x3b8ccb['fRight']-0x1,this['pImagePosVertices'][0x5]=0x1-0x2*_0x3b8ccb['fTop'],this['pImagePosVertices'][0x6]=0x2*_0x3b8ccb['fRight']-0x1,this['pImagePosVertices'][0x7]=0x1-0x2*_0x3b8ccb['fTop'],this['pImagePosVertices'][0x8]=0x2*_0x3b8ccb['fLeft']-0x1,this['pImagePosVertices'][0x9]=0x1-0x2*_0x3b8ccb['fBottom'],this['pImagePosVertices'][0xa]=0x2*_0x3b8ccb['fRight']-0x1,this['pImagePosVertices'][0xb]=0x1-0x2*_0x3b8ccb['fBottom'],0x1==this['bIsCapturing']?this['ctx']['viewport'](0x0,0x0,this['nCaptureWidth'],this['nCaptureHeight']):this['ctx']['viewport'](0x0,0x0,this['nWndWidth'],this['nWndHeight']),this['ctx']['enable'](this['ctx']['BLEND']),this['ctx']['blendFuncSeparate'](this['ctx']['SRC_ALPHA'],this['ctx']['ONE_MINUS_SRC_ALPHA'],this['ctx']['ONE'],this['ctx']['ONE_MINUS_SRC_ALPHA']),_0x1e97ff){case _0x444828['SR_PF_SURFACE']:if(null==this['nImageColorTexture']){if(this['nImageColorTexture']=this['ctx']['createTexture'](),0x0==this['nImageColorTexture'])return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nImageColorTexture']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MAG_FILTER'],this['ctx']['LINEAR']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_WRAP_S'],this['ctx']['CLAMP_TO_EDGE']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_WRAP_T'],this['ctx']['CLAMP_TO_EDGE']);}this['ctx']['useProgram'](this['videoShaderProgram']),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['vertexPosBuffer']);var _0xd4e8b2=this['ctx']['getAttribLocation'](this['videoShaderProgram'],'position');if(_0xd4e8b2<0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['vertexAttribPointer'](_0xd4e8b2,0x3,this['ctx']['FLOAT'],!0x1,0x0,0x0),this['ctx']['enableVertexAttribArray'](_0xd4e8b2),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['texturePosBuffer']);var _0x37313e=this['ctx']['getAttribLocation'](this['videoShaderProgram'],'texCoord');if(_0x37313e<0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];if(this['ctx']['vertexAttribPointer'](_0x37313e,0x2,this['ctx']['FLOAT'],!0x1,0x0,0x0),this['ctx']['enableVertexAttribArray'](_0x37313e),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],null),this['ctx']['useProgram'](null),this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nImageColorTexture']),this['ctx']['texImage2D'](this['ctx']['TEXTURE_2D'],0x0,this['ctx']['RGBA'],this['nDrawImageWidth'],this['nDrawImageHeight'],0x0,this['ctx']['RGBA'],this['ctx']['UNSIGNED_BYTE'],_0x276d42),0x0==this['nImageShaderProgram']){var _0x4c9d94=this['CompileProgram'](_0x291446,_0x41417f);if(_0x4c9d94<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['nImageShaderProgram']=_0x4c9d94;}break;case _0x444828['SR_PF_RGBA32']:if(null==this['nImageColorTexture']){if(this['nImageColorTexture']=this['ctx']['createTexture'](),0x0==this['nImageColorTexture'])return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nImageColorTexture']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MAG_FILTER'],this['ctx']['LINEAR']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_WRAP_S'],this['ctx']['CLAMP_TO_EDGE']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_WRAP_T'],this['ctx']['CLAMP_TO_EDGE']);}if(this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nImageColorTexture']),this['ctx']['texImage2D'](this['ctx']['TEXTURE_2D'],0x0,this['ctx']['RGBA'],this['nDrawImageWidth'],this['nDrawImageHeight'],0x0,this['ctx']['RGBA'],this['ctx']['UNSIGNED_BYTE'],_0x276d42),0x0==this['nImageShaderProgram']){var _0x340243=this['CompileProgram'](_0x291446,_0x41417f);if(_0x340243<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['nImageShaderProgram']=_0x340243;}break;case _0x444828['SR_PF_RGB565']:if(null==this['nImageColorTexture']){if(this['nImageColorTexture']=this['ctx']['createTexture'](),0x0==this['nImageColorTexture'])return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nImageColorTexture']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MAG_FILTER'],this['ctx']['LINEAR']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_WRAP_S'],this['ctx']['CLAMP_TO_EDGE']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_WRAP_T'],this['ctx']['CLAMP_TO_EDGE']);}if(this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nImageColorTexture']),this['ctx']['texImage2D'](this['ctx']['TEXTURE_2D'],0x0,this['ctx']['RGB'],this['nDrawImageWidth'],this['nDrawImageHeight'],0x0,this['ctx']['RGB'],this['ctx']['UNSIGNED_SHORT_5_6_5'],_0x276d42),0x0==this['nImageShaderProgram']){var _0x94b886=this['CompileProgram'](_0x291446,'\\x0a\\x20\\x20\\x20\\x20precision\\x20mediump\\x20float;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20texture;\\x20\\x0a\\x20\\x20\\x20\\x20varying\\x20lowp\\x20vec4\\x20pp;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fAlpha;\\x0a\\x20\\x20\\x20\\x20void\\x20main(void)\\x20\\x0a\\x20\\x20\\x20\\x20{\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor\\x20=\\x20texture2D(texture,\\x20pp.st);\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor.a\\x20*=\\x20fAlpha;\\x20\\x0a\\x20\\x20\\x20\\x20}\\x20\\x0a');if(_0x94b886<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['nImageShaderProgram']=_0x94b886;}break;default:return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}var _0xe19954=this['nImageShaderProgram'];this['ctx']['useProgram'](_0xe19954);var _0x16e371=this['ctx']['getUniformLocation'](this['nImageShaderProgram'],'bCapture');if(_0x16e371<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];0x1==this['bIsCapturing']?this['ctx']['uniform1i'](_0x16e371,0x1):this['ctx']['uniform1i'](_0x16e371,0x0),this['ctx']['activeTexture'](this['ctx']['TEXTURE0']),this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nImageColorTexture']);var _0x484e6f=this['ctx']['getUniformLocation'](this['nImageShaderProgram'],'texture');this['ctx']['uniform1i'](_0x484e6f,0x0),_0x484e6f=this['ctx']['getUniformLocation'](this['nImageShaderProgram'],'fAlpha'),this['ctx']['uniform1f'](_0x484e6f,_0x4c8a02);var _0x54471a=this['ctx']['getUniformLocation'](this['nImageShaderProgram'],'matRotate');if(_0x54471a<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniformMatrix4fv'](_0x54471a,!0x1,this['matRotate']),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['glImagePosBuffer']),this['ctx']['bufferData'](this['ctx']['ARRAY_BUFFER'],this['pImagePosVertices'],this['ctx']['STATIC_DRAW']);var _0x330d86=this['ctx']['getAttribLocation'](this['nImageShaderProgram'],'position');this['ctx']['enableVertexAttribArray'](_0x330d86),this['ctx']['vertexAttribPointer'](_0x330d86,0x2,this['ctx']['FLOAT'],!0x1,0x0,0x0),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['glImageClrBuffer']),this['ctx']['bufferData'](this['ctx']['ARRAY_BUFFER'],this['pImageClrVertices'],this['ctx']['STATIC_DRAW']);var _0x5b70a0=this['ctx']['getAttribLocation'](this['nImageShaderProgram'],'texCoord');return this['ctx']['enableVertexAttribArray'](_0x5b70a0),this['ctx']['vertexAttribPointer'](_0x5b70a0,0x2,this['ctx']['FLOAT'],!0x1,0x0,0x0),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],null),this['ctx']['disable'](this['ctx']['DEPTH_TEST']),this['ctx']['drawArrays'](this['ctx']['TRIANGLES'],0x0,0x6),this['ctx']['useProgram'](null),this['ctx']['disable'](this['ctx']['BLEND']),this['b3DPort']&&(this['ctx']['enable'](this['ctx']['DEPTH_TEST']),this['ctx']['depthFunc'](this['ctx']['LESS']),this['ctx']['depthMask'](!0x0),0x1==this['bCullBack']?this['ctx']['enable'](this['ctx']['CULL_FACE']):this['ctx']['disable'](this['ctx']['CULL_FACE'])),_0x2ffc1c['SR_OK'];}},{'key':'DrawMosaic','value':function(_0xb0bf7a,_0x222600,_0x4861bc,_0x51169c,_0x3e98c1){if(_0xb0bf7a<0x0||_0x222600<0x0||_0x4861bc<0x0||_0x51169c<0x0||_0xb0bf7a>0x1||_0x222600>0x1||_0x4861bc>0x1||_0x51169c>0x1||_0x3e98c1<=0x0)return _0x2ffc1c['SR_ERR_PARAM'];if(0x0==this['nMosaicShaderProgram']){var _0x64927=this['CompileProgram']('\\x0a\\x20\\x20\\x20\\x20attribute\\x20vec4\\x20\\x20position;\\x20\\x0a\\x20\\x20\\x20\\x20attribute\\x20vec4\\x20\\x20texCoord;\\x20\\x0a\\x20\\x20\\x20\\x20varying\\x20vec4\\x20\\x20out_texCoord;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20int\\x20bCapture;\\x0a\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20void\\x20main()\\x20\\x0a\\x20\\x20\\x20\\x20{\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position\\x20\\x20=\\x20position;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(bCapture\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position.y\\x20=\\x20\\x20-gl_Position.y;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20out_texCoord\\x20=\\x20texCoord;\\x20\\x0a\\x20\\x20\\x20\\x20}\\x20\\x0a','\\x0a\\x20\\x20\\x20\\x20varying\\x20lowp\\x20vec4\\x20out_texCoord;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20texture;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20mediump\\x20float\\x20videoWidth;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20mediump\\x20float\\x20videoHeight;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20mediump\\x20float\\x20mosaicSize;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20mediump\\x20float\\x20left;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20mediump\\x20float\\x20right;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20mediump\\x20float\\x20top;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20mediump\\x20float\\x20bottom;\\x20\\x0a\\x0a\\x20\\x20\\x20\\x20void\\x20main(void)\\x20\\x0a\\x20\\x20\\x20\\x20{\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20lowp\\x20vec2\\x20uv;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20uv.x\\x20=\\x20floor(out_texCoord.x\\x20*\\x20videoWidth\\x20/\\x20mosaicSize)\\x20*\\x20mosaicSize\\x20/\\x20videoWidth;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20uv.y\\x20=\\x20floor(out_texCoord.y\\x20*\\x20videoHeight\\x20/\\x20mosaicSize)\\x20*\\x20mosaicSize\\x20/\\x20videoHeight;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor\\x20=\\x20texture2D(texture,\\x20uv);\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(out_texCoord.x\\x20<\\x20left\\x20||\\x20out_texCoord.x\\x20>\\x20right\\x20||\\x20out_texCoord.y\\x20<\\x20top\\x20||\\x20out_texCoord.y\\x20>\\x20bottom)\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor.a\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20else\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor.a\\x20=\\x201.0;\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x20\\x0a\\x20\\x20\\x20\\x20}\\x20\\x0a');if(_0x64927<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['nMosaicShaderProgram']=_0x64927;}this['ctx']['viewport'](0x0,0x0,this['nWndWidth'],this['nWndHeight']),this['ctx']['enable'](this['ctx']['BLEND']),this['ctx']['blendFuncSeparate'](this['ctx']['SRC_ALPHA'],this['ctx']['ONE_MINUS_SRC_ALPHA'],this['ctx']['ONE'],this['ctx']['ONE_MINUS_SRC_ALPHA']);var _0x3558e3=this['nMosaicShaderProgram'];this['ctx']['useProgram'](_0x3558e3);var _0x1dc0be=this['ctx']['getUniformLocation'](_0x3558e3,'bCapture');if(_0x1dc0be<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];0x1==this['bIsCapturing']?this['ctx']['uniform1i'](_0x1dc0be,0x1):this['ctx']['uniform1i'](_0x1dc0be,0x0),this['ctx']['activeTexture'](this['ctx']['TEXTURE0']),this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nSurfaceTexture'][0x0]);var _0x2f48a1=this['ctx']['getUniformLocation'](_0x3558e3,'texture');this['ctx']['uniform1i'](_0x2f48a1,0x0);var _0x564e2a=this['ctx']['getUniformLocation'](_0x3558e3,'videoWidth');if(_0x564e2a<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x564e2a,this['frameDisplayWidth']);var _0x2e5141=this['ctx']['getUniformLocation'](_0x3558e3,'videoHeight');if(_0x2e5141<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x2e5141,this['frameDisplayHeight']);var _0xfbcb1a=this['ctx']['getUniformLocation'](_0x3558e3,'mosaicSize');if(_0xfbcb1a<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0xfbcb1a,_0x3e98c1);var _0x1c9e8c=this['ctx']['getUniformLocation'](_0x3558e3,'left');if(_0x1c9e8c<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x1c9e8c,_0xb0bf7a);var _0x1f0345=this['ctx']['getUniformLocation'](_0x3558e3,'right');if(_0x1f0345<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x1f0345,_0x222600);var _0xfdb4d9=this['ctx']['getUniformLocation'](_0x3558e3,'top');if(_0xfdb4d9<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0xfdb4d9,_0x4861bc);var _0x4a89a0=this['ctx']['getUniformLocation'](_0x3558e3,'bottom');if(_0x4a89a0<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['uniform1f'](_0x4a89a0,_0x51169c);var _0x553ba8=this['ctx']['getAttribLocation'](_0x3558e3,'position');this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['vertexPosBuffer']),this['ctx']['vertexAttribPointer'](_0x553ba8,0x2,this['ctx']['FLOAT'],!0x1,0x0,0x0),this['ctx']['enableVertexAttribArray'](_0x553ba8);var _0x344e68=this['ctx']['getAttribLocation'](_0x3558e3,'texCoord');return this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],this['texturePosBuffer']),this['ctx']['vertexAttribPointer'](_0x344e68,0x2,this['ctx']['FLOAT'],!0x1,0x0,0x0),this['ctx']['enableVertexAttribArray'](_0x344e68),this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],null),this['ctx']['drawArrays'](this['ctx']['TRIANGLES'],0x0,0x6),this['ctx']['useProgram'](null),this['ctx']['disable'](this['ctx']['BLEND']),_0x2ffc1c['SR_OK'];}},{'key':'SetCallBack','value':function(_0x53759b,_0x5a7215,_0x496278){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];switch(_0x496278){case _0x18ef32['SR_CBT_NULL']:this['pfuncCBIn']=_0x53759b,this['pUserIn']=_0x5a7215;break;case _0x18ef32['SR_CBT_OUT']:this['pfuncCBOut']=_0x53759b,this['pUserOut']=_0x5a7215;break;default:return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}return _0x2ffc1c['SR_OK'];}},{'key':'DoCallBack','value':function(){return null==this['ctx']?_0x2ffc1c['SR_ERR_CALL_ORDER']:(null!=this['pfuncCBIn']&&this['pfuncCBIn'](this['pUserIn']),null!=this['pfuncCBOut']&&this['pfuncCBOut'](this['pUserOut']),_0x2ffc1c['SR_OK']);}},{'key':'SetViewParam','value':function(_0x33d65e,_0x4b389e){if(!this['b3DPort'])return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];switch(_0x33d65e){case _0x2fc4ee['SR_VT_ROTATION_X']:if((this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_PLANET']||this['enDisplayEffect']==_0x5dc8af['SR_DE_PANORAMA_PLANET'])&&(_0x4b389e>1.57||_0x4b389e<-1.57))return _0x2ffc1c['SR_ERR_PARAM'];if((this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_CEILING']||this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR'])&&(_0x4b389e>0.78539815||_0x4b389e<0x0))return _0x2ffc1c['SR_ERR_PARAM'];if((this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']||this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL'])&&(_0x4b389e>this['fRotateLimitX']||_0x4b389e<-this['fRotateLimitX']))return _0x2ffc1c['SR_ERR_PARAM'];this['fRotateX']=_0x4b389e;break;case _0x2fc4ee['SR_VT_ROTATION_Y']:if((this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']||this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL'])&&(_0x4b389e>this['fRotateLimitY']||_0x4b389e<-this['fRotateLimitY']))return _0x2ffc1c['SR_ERR_PARAM'];this['fRotateY']=_0x4b389e;break;case _0x2fc4ee['SR_VT_SCALE']:if(this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_PLANET']&&(_0x4b389e>1.2||_0x4b389e<-0.3))return _0x2ffc1c['SR_ERR_PARAM'];if(this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_SEMISPHERE']){if(_0x4b389e<-0.8||_0x4b389e>0x384)return _0x2ffc1c['SR_ERR_PARAM'];}else{if(this['enDisplayEffect']==_0x5dc8af['SR_DE_PANORAMA_SPHERE']){if(_0x4b389e<-0.95||_0x4b389e>0.95)return _0x2ffc1c['SR_ERR_PARAM'];}else{if(this['enDisplayEffect']==_0x5dc8af['SR_DE_PANORAMA_PLANET']){if(_0x4b389e<0.1||_0x4b389e>2.6)return _0x2ffc1c['SR_ERR_PARAM'];}else{if(this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']||this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_CYLINDER_CEILING']){if(_0x4b389e<0x0||_0x4b389e>0x384)return _0x2ffc1c['SR_ERR_PARAM'];}else{if(this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']||this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']){if(_0x4b389e<-0.3||_0x4b389e>0x5)return _0x2ffc1c['SR_ERR_PARAM'];this['_ComputeRotateLimits']();}else{if(this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_CEILING']||this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR'])return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}}}}}this['fScale']=_0x4b389e;break;default:return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}return _0x2ffc1c['SR_OK'];}},{'key':'GetViewParam','value':function(_0x2a2139,_0x3938d2){if(!this['b3DPort'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x175eec=0x0;switch(_0x2a2139){case _0x2fc4ee['SR_VT_ROTATION_X']:_0x175eec=this['fRotateX'];break;case _0x2fc4ee['SR_VT_ROTATION_Y']:_0x175eec=this['fRotateY'];break;case _0x2fc4ee['SR_VT_SCALE']:_0x175eec=this['fScale'];break;default:return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}return _0x3938d2['fValue']=_0x175eec,_0x2ffc1c['SR_OK'];}},{'key':'SetRenderMode','value':function(_0x399f46){return this['bRenderToTex']=_0x399f46,_0x2ffc1c['SR_OK'];}},{'key':'_InitVideoShader','value':function(_0x56c16c,_0x114b76){var _0x3a4b4e,_0x264a44;switch(_0x114b76){case _0x5dc8af['SR_DE_NULL']:_0x3a4b4e=_0x7944d4,_0x264a44='\\x0aprecision\\x20mediump\\x20float;\\x0avarying\\x20highp\\x20vec4\\x20pp;\\x0auniform\\x20sampler2D\\x20Ytexture;\\x0auniform\\x20sampler2D\\x20Utexture;\\x0auniform\\x20sampler2D\\x20Vtexture;\\x0auniform\\x20float\\x20fWndWidth;\\x0auniform\\x20float\\x20fWndHeight;\\x0auniform\\x20float\\x20fBrightness;\\x0auniform\\x20float\\x20fHue;\\x0auniform\\x20float\\x20fSaturation;\\x0auniform\\x20float\\x20fContrast;\\x0auniform\\x20float\\x20fSharpness;\\x0auniform\\x20int\\x20nPostProc;\\x0auniform\\x20int\\x20bDataFormat;\\x0a\\x0avec3\\x20rgb;\\x0avec3\\x20yuv2rgb(float\\x20y,\\x20float\\x20u,\\x20float\\x20v)\\x0a{\\x0a\\x20\\x20\\x20\\x20float\\x20r,g,b;\\x20\\x0a\\x20\\x20\\x20\\x20y\\x20=\\x201.1643\\x20*\\x20(y\\x20-\\x200.0625);\\x20\\x0a\\x20\\x20\\x20\\x20u\\x20=\\x20u\\x20-\\x200.5;\\x20\\x0a\\x20\\x20\\x20\\x20v\\x20=\\x20v\\x20-\\x200.5;\\x20\\x0a\\x20\\x20\\x20\\x20r\\x20=\\x20y\\x20+\\x201.5958\\x20*\\x20v;\\x20\\x0a\\x20\\x20\\x20\\x20g\\x20=\\x20y\\x20-\\x200.39173\\x20*\\x20u\\x20-\\x200.81290\\x20*\\x20v;\\x20\\x0a\\x20\\x20\\x20\\x20b\\x20=\\x20y\\x20+\\x202.017\\x20*\\x20u;\\x20\\x0a\\x20\\x20\\x20\\x20return\\x20vec3(r,\\x20g,\\x20b);\\x0a}\\x0avec3\\x20rgb2hsv(vec3\\x20c)\\x20\\x0a{\\x20\\x0a\\x20\\x20\\x20\\x20vec4\\x20K\\x20=\\x20vec4(0.0,\\x20-1.0\\x20/\\x203.0,\\x202.0\\x20/\\x203.0,\\x20-1.0);\\x20\\x0a\\x20\\x20\\x20\\x20vec4\\x20p\\x20=\\x20c.g\\x20<\\x20c.b\\x20?\\x20vec4(c.bg,\\x20K.wz)\\x20:\\x20vec4(c.gb,\\x20K.xy);\\x20\\x0a\\x20\\x20\\x20\\x20vec4\\x20q\\x20=\\x20c.r\\x20<\\x20p.x\\x20?\\x20vec4(p.xyw,\\x20c.r)\\x20:\\x20vec4(c.r,\\x20p.yzx);\\x20\\x0a\\x0a\\x20\\x20\\x20\\x20float\\x20d\\x20=\\x20q.x\\x20-\\x20min(q.w,\\x20q.y);\\x20\\x0a\\x20\\x20\\x20\\x20float\\x20e\\x20=\\x201.0e-10;\\x20\\x0a\\x20\\x20\\x20\\x20return\\x20vec3(abs(q.z\\x20+\\x20(q.w\\x20-\\x20q.y)\\x20/\\x20(6.0\\x20*\\x20d\\x20+\\x20e)),\\x20d\\x20/\\x20(q.x\\x20+\\x20e),\\x20q.x);\\x20\\x0a}\\x20\\x0a\\x0avec3\\x20hsv2rgb(vec3\\x20c)\\x20\\x0a{\\x20\\x0a\\x20\\x20\\x20\\x20vec4\\x20K\\x20=\\x20vec4(1.0,\\x202.0\\x20/\\x203.0,\\x201.0\\x20/\\x203.0,\\x203.0);\\x20\\x0a\\x20\\x20\\x20\\x20vec3\\x20p\\x20=\\x20abs(fract(c.xxx\\x20+\\x20K.xyz)\\x20*\\x206.0\\x20-\\x20K.www);\\x20\\x0a\\x20\\x20\\x20\\x20return\\x20c.z\\x20*\\x20mix(K.xxx,\\x20clamp(p\\x20-\\x20K.xxx,\\x200.0,\\x201.0),\\x20c.y);\\x20\\x0a}\\x20\\x0a\\x0avec3\\x20sharpen(vec3\\x20c)\\x20\\x0a{\\x20\\x0a\\x20\\x20\\x20\\x20vec3\\x20sharpenColor;\\x20\\x0a\\x0a\\x20\\x20\\x20\\x20if(bDataFormat\\x20==\\x200)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20sharpenColorY;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20sharpenColorU;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20sharpenColorV;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20offWidth\\x20\\x20=\\x201.0\\x20/\\x20fWndWidth;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20offHeight\\x20=\\x201.0\\x20/\\x20fWndHeight;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20tempSharpness\\x20=\\x20fSharpness\\x20*\\x20100.0;\\x20\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColor\\x20=\\x20(1.0\\x20+\\x204.0\\x20*\\x20tempSharpness)\\x20*\\x20c;\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20vec2\\x20uv\\x20\\x20\\x20\\x20\\x20\\x20\\x20=\\x20pp.st\\x20+\\x20vec2(offWidth,\\x200);\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColorY\\x20=\\x20texture2D(Ytexture,\\x20uv).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColorU\\x20=\\x20texture2D(Utexture,\\x20uv).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColorV\\x20=\\x20texture2D(Vtexture,\\x20uv).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColor\\x20-=\\x20tempSharpness\\x20*\\x20yuv2rgb(sharpenColorY,\\x20sharpenColorU,\\x20sharpenColorV);\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20uv\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20=\\x20pp.st\\x20+\\x20vec2(-offWidth,\\x200);\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColorY\\x20=\\x20texture2D(Ytexture,\\x20uv).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColorU\\x20=\\x20texture2D(Utexture,\\x20uv).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColorV\\x20=\\x20texture2D(Vtexture,\\x20uv).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColor\\x20-=\\x20tempSharpness\\x20*\\x20yuv2rgb(sharpenColorY,\\x20sharpenColorU,\\x20sharpenColorV);\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20uv\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20=\\x20pp.st\\x20+\\x20vec2(0,\\x20offHeight);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColorY\\x20=\\x20texture2D(Ytexture,\\x20uv).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColorU\\x20=\\x20texture2D(Utexture,\\x20uv).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColorV\\x20=\\x20texture2D(Vtexture,\\x20uv).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColor\\x20-=\\x20tempSharpness\\x20*\\x20yuv2rgb(sharpenColorY,\\x20sharpenColorU,\\x20sharpenColorV);\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20uv\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20=\\x20pp.st\\x20+\\x20vec2(0,\\x20-offHeight);\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColorY\\x20=\\x20texture2D(Ytexture,\\x20uv).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColorU\\x20=\\x20texture2D(Utexture,\\x20uv).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColorV\\x20=\\x20texture2D(Vtexture,\\x20uv).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColor\\x20-=\\x20tempSharpness\\x20*\\x20yuv2rgb(sharpenColorY,\\x20sharpenColorU,\\x20sharpenColorV);\\x0a\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20else\\x20if(bDataFormat\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20vec3\\x20sharpenColorY;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20offWidth\\x20\\x20=\\x201.0\\x20/\\x20fWndWidth;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20offHeight\\x20=\\x201.0\\x20/\\x20fWndHeight;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20tempSharpness\\x20=\\x20fSharpness\\x20*\\x20100.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20vec2\\x20uv\\x20=\\x20pp.st;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColorY\\x20=\\x20(1.0\\x20+\\x204.0\\x20*\\x20tempSharpness)\\x20*\\x20texture2D(Ytexture,\\x20uv).rgb;\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20uv\\x20\\x20\\x20\\x20\\x20\\x20\\x20=\\x20pp.st\\x20+\\x20vec2(offWidth,\\x200);\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColorY\\x20-=\\x20tempSharpness\\x20*\\x20texture2D(Ytexture,\\x20uv).rgb;\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20uv\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20=\\x20pp.st\\x20+\\x20vec2(-offWidth,\\x200);\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColorY\\x20-=\\x20tempSharpness\\x20*\\x20texture2D(Ytexture,\\x20uv).rgb;\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20uv\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20=\\x20pp.st\\x20+\\x20vec2(0,\\x20offHeight);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColorY\\x20-=\\x20tempSharpness\\x20*\\x20texture2D(Ytexture,\\x20uv).rgb;\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20uv\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20=\\x20pp.st\\x20+\\x20vec2(0,\\x20-offHeight);\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColorY\\x20-=\\x20tempSharpness\\x20*\\x20texture2D(Ytexture,\\x20uv).rgb;\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20sharpenColor\\x20=\\x20sharpenColorY;\\x0a\\x20\\x20\\x20\\x20}\\x0a\\x0a\\x20\\x20\\x20\\x20return\\x20sharpenColor;\\x20\\x0a}\\x20\\x0avoid\\x20main(void)\\x0a{\\x0a\\x20\\x20\\x20\\x20float\\x20r,\\x20g,\\x20b,\\x20y,\\x20u,\\x20v;\\x0a\\x20\\x20\\x20\\x20if(bDataFormat\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r\\x20=\\x20texture2D(Ytexture,\\x20pp.st).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g\\x20=\\x20texture2D(Ytexture,\\x20pp.st).g;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\\x20=\\x20texture2D(Ytexture,\\x20pp.st).b;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20rgb\\x20=\\x20vec3(r,\\x20g,\\x20b);\\x0a\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20else\\x20if(bDataFormat\\x20==\\x200)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y\\x20=\\x20texture2D(Ytexture,\\x20pp.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u\\x20=\\x20texture2D(Utexture,\\x20pp.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v\\x20=\\x20texture2D(Vtexture,\\x20pp.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20rgb\\x20=\\x20yuv2rgb(y,\\x20u,\\x20v);\\x0a\\x20\\x20\\x20\\x20}\\x0a\\x0a\\x20\\x20\\x20\\x20if(1\\x20==\\x20nPostProc)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20vec3\\x20fragRGB\\x20=\\x20sharpen(rgb);\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20//sharpen\\x20锐度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20vec3\\x20fragHSV\\x20=\\x20rgb2hsv(fragRGB);\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fragHSV.x\\x20=\\x20fragHSV.x\\x20+\\x20fHue;\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20//hue\\x20色度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fragHSV.y\\x20=\\x20fragHSV.y\\x20*\\x20(fSaturation\\x20+\\x201.0);\\x20\\x20\\x20\\x20//saturation\\x20饱和度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fragRGB\\x20=\\x20hsv2rgb(fragHSV);\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if\\x20(fBrightness\\x20>\\x200.0)\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20//brightness\\x20亮度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fragRGB\\x20=\\x20fragRGB\\x20+\\x20(1.0\\x20-\\x20fragRGB)\\x20*\\x20fBrightness;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20else\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fragRGB\\x20=\\x20fragRGB\\x20+\\x20fragRGB\\x20*\\x20fBrightness;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x20\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20tempContrast\\x20=\\x20fContrast\\x20>\\x200.0\\x20?\\x20fContrast\\x20*\\x2010.0\\x20:\\x20fContrast;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fragRGB\\x20=\\x20((fragRGB\\x20-\\x200.5)\\x20*\\x20max(tempContrast\\x20+\\x201.0,\\x200.0))\\x20+\\x200.5;\\x20\\x20\\x20\\x20\\x20\\x20//contrast\\x20对比度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor\\x20=\\x20vec4(fragRGB,\\x201.0);\\x20\\x0a\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20else\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor\\x20=\\x20vec4(rgb,\\x201.0);\\x0a\\x20\\x20\\x20\\x20}\\x0a}\\x0a';break;case _0x5dc8af['SR_DE_FISH_ORIGINAL']:_0x3a4b4e=_0x7944d4,_0x264a44='\\x0aprecision\\x20mediump\\x20float;\\x0avarying\\x20vec4\\x20pp;\\x0auniform\\x20sampler2D\\x20Ytexture;\\x0auniform\\x20sampler2D\\x20Utexture;\\x0auniform\\x20sampler2D\\x20Vtexture;\\x0auniform\\x20float\\x20fRX1;\\x0auniform\\x20float\\x20fRX2;\\x0auniform\\x20float\\x20fRY1;\\x0auniform\\x20float\\x20fRY2;\\x0auniform\\x20int\\x20bBlack;\\x20\\x0auniform\\x20int\\x20bCut;\\x0auniform\\x20int\\x20bDataFormat;\\x0a\\x0avoid\\x20main()\\x0a{\\x20\\x0a\\x09float\\x20r,g,b,y,u,v;\\x0a\\x09vec4\\x20origin;\\x0a\\x0a\\x09float\\x20\\x20w;\\x0a\\x09float\\x20\\x20h;\\x0a\\x09float\\x20\\x20fCenterX;\\x0a\\x09float\\x20\\x20fCenterY;\\x0a\\x09float\\x20\\x20fRadius;\\x0a\\x09w\\x20=\\x201.0;\\x0a\\x09h\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x20(fRY2\\x20-\\x20fRY1);\\x0a\\x09fCenterX\\x20=\\x20(fRX1\\x20+\\x20fRX2)\\x20/\\x202.0\\x20*\\x20w;\\x20\\x20\\x20\\x20///<圆心实际坐标\\x0a\\x09fCenterY\\x20=\\x20(fRY1\\x20+\\x20fRY2)\\x20/\\x202.0\\x20*\\x20h;\\x0a\\x09fRadius\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x202.0\\x20*\\x20w;\\x20\\x20\\x20\\x20\\x20///<半径实际长度\\x0a\\x09float\\x20\\x20leftCut\\x20=\\x200.0;\\x0a\\x09float\\x20\\x20rightCut\\x20=\\x201.0;\\x0a\\x09float\\x20\\x20topCut\\x20=\\x200.0;\\x0a\\x09float\\x20\\x20bottomCut\\x20=\\x201.0;\\x0a\\x09if(bCut\\x20==\\x201)\\x0a\\x09{\\x0a\\x09\\x09if(fRX1\\x20>\\x200.0)\\x0a\\x09\\x09{\\x0a\\x09\\x09\\x09leftCut\\x20=\\x20fRX1;\\x0a\\x09\\x09}\\x0a\\x09\\x09if(fRX2\\x20<\\x201.0)\\x0a\\x09\\x09{\\x0a\\x09\\x09\\x09rightCut\\x20=\\x20fRX2;\\x0a\\x09\\x09}\\x0a\\x09\\x09if(fRY1\\x20>\\x200.0)\\x0a\\x09\\x09{\\x0a\\x09\\x09\\x09topCut\\x20=\\x20fRY1;\\x0a\\x09\\x09}\\x0a\\x09\\x09if(fRY2\\x20<\\x201.0)\\x0a\\x09\\x09{\\x0a\\x09\\x09\\x09bottomCut\\x20=\\x20fRY2;\\x0a\\x09\\x09}\\x0a\\x09}\\x0a\\x09origin.s\\x20=\\x20pp.s\\x20*\\x20(rightCut-leftCut)\\x20+\\x20leftCut;\\x0a\\x09origin.t\\x20=\\x20pp.t\\x20*\\x20(bottomCut-topCut)\\x20+\\x20topCut;\\x0a\\x0a\\x20\\x20\\x20\\x20if(bDataFormat\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r\\x20=\\x20texture2D(Ytexture,\\x20origin.st).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g\\x20=\\x20texture2D(Ytexture,\\x20origin.st).g;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\\x20=\\x20texture2D(Ytexture,\\x20origin.st).b;\\x20\\x0a\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20else\\x20if(bDataFormat\\x20==\\x200)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y\\x20=\\x20texture2D(Ytexture,\\x20origin.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u\\x20=\\x20texture2D(Utexture,\\x20origin.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v\\x20=\\x20texture2D(Vtexture,\\x20origin.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y=1.1643*(y-0.0625);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u=u-0.5;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v=v-0.5;\\x20\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r=y+1.5958*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g=y-0.39173*u-0.81290*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b=y+2.017*u;\\x20\\x0a\\x20\\x20\\x20\\x20}\\x0a\\x0a\\x09if(bBlack\\x20==\\x201)\\x0a\\x09{\\x0a\\x09\\x09float\\x20tmpX,\\x20tmpY;\\x0a\\x09\\x09tmpX\\x20=\\x20origin.s\\x20*\\x20w;\\x20\\x0a\\x09\\x09tmpY\\x20=\\x20origin.t\\x20*\\x20h;\\x20\\x0a\\x09\\x09float\\x20d2\\x20=\\x20(tmpX-fCenterX)*(tmpX-fCenterX)\\x20+\\x20(tmpY-fCenterY)*(tmpY-fCenterY);\\x0a\\x09\\x09if(d2\\x20>\\x20fRadius*fRadius)\\x0a\\x09\\x09{\\x0a\\x09\\x09\\x09r\\x20=\\x200.0;\\x20\\x0a\\x09\\x09\\x09g\\x20=\\x200.0;\\x20\\x0a\\x09\\x09\\x09b\\x20=\\x200.0;\\x20\\x0a\\x09\\x09}\\x0a\\x09}\\x0a\\x0a\\x09gl_FragColor\\x20=\\x20vec4(r\\x20,g\\x20,b\\x20,\\x201.0);\\x0a}\\x0a';break;case _0x5dc8af['SR_DE_FISH_PTZ_CEILING']:_0x3a4b4e=_0x7944d4,_0x264a44='\\x0aprecision\\x20mediump\\x20float;\\x0avarying\\x20vec4\\x20pp;\\x20\\x0auniform\\x20sampler2D\\x20Ytexture;\\x0auniform\\x20sampler2D\\x20Utexture;\\x0auniform\\x20sampler2D\\x20Vtexture;\\x0auniform\\x20float\\x20fHAngleCos;\\x0auniform\\x20float\\x20fHAngleSin;\\x0auniform\\x20float\\x20fVAngleCos;\\x0auniform\\x20float\\x20fVAngleSin;\\x0auniform\\x20float\\x20fZoom;\\x0auniform\\x20float\\x20fRX1;\\x20\\x0auniform\\x20float\\x20fRX2;\\x20\\x0auniform\\x20float\\x20fRY1;\\x20\\x0auniform\\x20float\\x20fRY2;\\x20\\x0auniform\\x20int\\x20bDataFormat;\\x0a\\x0avoid\\x20main()\\x0a{\\x0a\\x09float\\x20r,g,b,y,u,v;\\x0a\\x0a\\x20\\x20\\x20\\x20vec4\\x20origin1;\\x0a\\x20\\x20\\x20\\x20vec4\\x20origin2;\\x0a\\x20\\x20\\x20\\x20vec4\\x20result;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20z1;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20z2;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20dnew;\\x0a\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20w;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20h;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20fCenterX;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20fCenterY;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20fRadius;\\x0a\\x20\\x20\\x20\\x20w\\x20=\\x201.0;\\x0a\\x20\\x20\\x20\\x20h\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x20(fRY2\\x20-\\x20fRY1);\\x0a\\x20\\x20\\x20\\x20fCenterX\\x20=\\x20(fRX1\\x20+\\x20fRX2)\\x20/\\x202.0\\x20*\\x20w;\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20fCenterY\\x20=\\x20(fRY1\\x20+\\x20fRY2)\\x20/\\x202.0\\x20*\\x20h;\\x0a\\x20\\x20\\x20\\x20fRadius\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x202.0\\x20*\\x20w;\\x20\\x0a\\x0a\\x20\\x20\\x20\\x20origin1.s\\x20=\\x20pp.s\\x20-\\x200.5;\\x0a\\x20\\x20\\x20\\x20origin1.t\\x20=\\x200.5\\x20-\\x20pp.t;\\x0a\\x20\\x20\\x20\\x20z1\\x20=\\x20fZoom\\x20;\\x0a\\x0a\\x20\\x20\\x20\\x20origin2.s\\x20=\\x20origin1.s\\x20;\\x0a\\x20\\x20\\x20\\x20origin2.t\\x20=\\x20(origin1.t*fVAngleCos\\x20+\\x20z1*fVAngleSin);\\x0a\\x20\\x20\\x20\\x20z2\\x20=\\x20z1*fVAngleCos\\x20-\\x20origin1.t*fVAngleSin;\\x0a\\x0a\\x20\\x20\\x20\\x20dnew\\x20=\\x20sqrt(origin2.s*origin2.s\\x20+\\x20origin2.t*origin2.t)\\x20;\\x0a\\x20\\x20\\x20\\x20float\\x20d\\x20=\\x20sqrt(origin2.s*origin2.s\\x20+\\x20origin2.t*origin2.t\\x20+\\x20z2*z2);\\x0a\\x20\\x20\\x20\\x20float\\x20theta\\x20=\\x20asin(dnew/d);\\x0a\\x20\\x20\\x20\\x20float\\x20tmp\\x20=\\x20theta\\x20/\\x201.5707963\\x20*\\x200.5;\\x0a\\x20\\x20\\x20\\x20origin2.s\\x20=\\x20tmp*origin2.s\\x20/\\x20dnew\\x20;\\x0a\\x20\\x20\\x20\\x20origin2.t\\x20=\\x20tmp*origin2.t\\x20/\\x20dnew\\x20;\\x0a\\x0a\\x20\\x20\\x20\\x20result.s\\x20=\\x20((origin2.s*fHAngleCos\\x20-\\x20origin2.t*fHAngleSin)*fRadius*2.0+fCenterX)/w;\\x0a\\x20\\x20\\x20\\x20result.t\\x20=\\x20(-(origin2.s*fHAngleSin\\x20+\\x20origin2.t*fHAngleCos)*fRadius*2.0+fCenterY)/h;\\x0a\\x0a\\x20\\x20\\x20\\x20if(bDataFormat\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r\\x20=\\x20texture2D(Ytexture,\\x20result.st).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g\\x20=\\x20texture2D(Ytexture,\\x20result.st).g;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\\x20=\\x20texture2D(Ytexture,\\x20result.st).b;\\x20\\x0a\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20else\\x20if(bDataFormat\\x20==\\x200)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y\\x20=\\x20texture2D(Ytexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u\\x20=\\x20texture2D(Utexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v\\x20=\\x20texture2D(Vtexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y=1.1643*(y-0.0625);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u=u-0.5;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v=v-0.5;\\x20\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r=y+1.5958*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g=y-0.39173*u-0.81290*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b=y+2.017*u;\\x20\\x0a\\x20\\x20\\x20\\x20}\\x0a\\x0a\\x20\\x20\\x20\\x20if(result.s\\x20>\\x201.0\\x20||\\x20result.t\\x20>\\x201.0\\x20||\\x20result.s\\x20<\\x200.0\\x20||\\x20result.t\\x20<\\x200.0)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20gl_FragColor\\x20=\\x20vec4(r\\x20,g\\x20,b\\x20,\\x201.0);\\x0a}\\x20\\x0a';break;case _0x5dc8af['SR_DE_FISH_PTZ_FLOOR']:_0x3a4b4e=_0x7944d4,_0x264a44='\\x0aprecision\\x20mediump\\x20float;\\x0avarying\\x20vec4\\x20pp;\\x20\\x0auniform\\x20sampler2D\\x20Ytexture;\\x0auniform\\x20sampler2D\\x20Utexture;\\x0auniform\\x20sampler2D\\x20Vtexture;\\x0auniform\\x20float\\x20fHAngleCos;\\x20\\x20\\x0auniform\\x20float\\x20fHAngleSin;\\x20\\x0auniform\\x20float\\x20fVAngleCos;\\x20\\x20\\x0auniform\\x20float\\x20fVAngleSin;\\x20\\x20\\x0auniform\\x20float\\x20fZoom;\\x0auniform\\x20float\\x20fRX1;\\x20\\x0auniform\\x20float\\x20fRX2;\\x20\\x0auniform\\x20float\\x20fRY1;\\x20\\x0auniform\\x20float\\x20fRY2;\\x20\\x0auniform\\x20int\\x20bDataFormat;\\x0a\\x0avoid\\x20main()\\x0a{\\x0a\\x09float\\x20r,g,b,y,u,v;\\x0a\\x0a\\x20\\x20\\x20\\x20vec4\\x20origin1;\\x0a\\x20\\x20\\x20\\x20vec4\\x20origin2;\\x0a\\x20\\x20\\x20\\x20vec4\\x20result;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20z1;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20z2;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20dnew;\\x0a\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20w;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20h;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20fCenterX;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20fCenterY;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20fRadius;\\x0a\\x20\\x20\\x20\\x20w\\x20=\\x201.0;\\x0a\\x20\\x20\\x20\\x20h\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x20(fRY2\\x20-\\x20fRY1);\\x0a\\x20\\x20\\x20\\x20fCenterX\\x20=\\x20(fRX1\\x20+\\x20fRX2)\\x20/\\x202.0\\x20*\\x20w;\\x0a\\x20\\x20\\x20\\x20fCenterY\\x20=\\x20(fRY1\\x20+\\x20fRY2)\\x20/\\x202.0\\x20*\\x20h;\\x0a\\x20\\x20\\x20\\x20fRadius\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x202.0\\x20*\\x20w;\\x0a\\x20\\x20\\x20\\x20origin1.s\\x20=\\x20pp.s\\x20-\\x200.5;\\x0a\\x20\\x20\\x20\\x20origin1.t\\x20=\\x20pp.t\\x20-\\x200.5;\\x0a\\x20\\x20\\x20\\x20z1\\x20=\\x20fZoom\\x20;\\x0a\\x0a\\x20\\x20\\x20\\x20origin2.s\\x20=\\x20origin1.s\\x20;\\x0a\\x20\\x20\\x20\\x20origin2.t\\x20=\\x20(origin1.t*fVAngleCos\\x20+\\x20z1*fVAngleSin);\\x0a\\x20\\x20\\x20\\x20z2\\x20=\\x20z1*fVAngleCos\\x20-\\x20origin1.t*fVAngleSin;\\x0a\\x0a\\x20\\x20\\x20\\x20dnew\\x20=\\x20sqrt(origin2.s*origin2.s\\x20+\\x20origin2.t*origin2.t)\\x20;\\x0a\\x20\\x20\\x20\\x20float\\x20d\\x20=\\x20sqrt(origin2.s*origin2.s\\x20+\\x20origin2.t*origin2.t\\x20+\\x20z2*z2);\\x0a\\x20\\x20\\x20\\x20float\\x20theta\\x20=\\x20asin(dnew/d);\\x0a\\x20\\x20\\x20\\x20float\\x20tmp\\x20=\\x20theta\\x20/\\x201.5707963\\x20*\\x200.5;\\x0a\\x20\\x20\\x20\\x20origin2.s\\x20=\\x20tmp*origin2.s\\x20/\\x20dnew\\x20;\\x0a\\x20\\x20\\x20\\x20origin2.t\\x20=\\x20tmp*origin2.t\\x20/\\x20dnew\\x20;\\x0a\\x0a\\x20\\x20\\x20\\x20result.s\\x20=\\x20((origin2.s*fHAngleCos\\x20-\\x20origin2.t*fHAngleSin)*fRadius*2.0+fCenterX)/w;\\x0a\\x20\\x20\\x20\\x20result.t\\x20=\\x20((origin2.s*fHAngleSin\\x20+\\x20origin2.t*fHAngleCos)*fRadius*2.0+fCenterY)/h;\\x0a\\x0a\\x20\\x20\\x20\\x20if(bDataFormat\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r\\x20=\\x20texture2D(Ytexture,\\x20result.st).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g\\x20=\\x20texture2D(Ytexture,\\x20result.st).g;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\\x20=\\x20texture2D(Ytexture,\\x20result.st).b;\\x20\\x0a\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20else\\x20if(bDataFormat\\x20==\\x200)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y\\x20=\\x20texture2D(Ytexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u\\x20=\\x20texture2D(Utexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v\\x20=\\x20texture2D(Vtexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y=1.1643*(y-0.0625);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u=u-0.5;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v=v-0.5;\\x20\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r=y+1.5958*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g=y-0.39173*u-0.81290*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b=y+2.017*u;\\x20\\x0a\\x20\\x20\\x20\\x20}\\x0a\\x0a\\x20\\x20\\x20\\x20if(result.s\\x20>\\x201.0\\x20||\\x20result.t\\x20>\\x201.0\\x20||\\x20result.s\\x20<\\x200.0\\x20||\\x20result.t\\x20<\\x200.0)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r\\x20=\\x200.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20gl_FragColor\\x20=\\x20vec4(r\\x20,g\\x20,b\\x20,\\x201.0);\\x0a}\\x20\\x0a';break;case _0x5dc8af['SR_DE_FISH_PTZ_WALL']:_0x3a4b4e=_0x7944d4,_0x264a44='\\x0aprecision\\x20mediump\\x20float;\\x0avarying\\x20vec4\\x20pp;\\x20\\x0auniform\\x20sampler2D\\x20Ytexture;\\x0auniform\\x20sampler2D\\x20Utexture;\\x0auniform\\x20sampler2D\\x20Vtexture;\\x0auniform\\x20float\\x20fHAngleCos;\\x0auniform\\x20float\\x20fHAngleSin;\\x20\\x20\\x0auniform\\x20float\\x20fVAngleCos;\\x20\\x20\\x0auniform\\x20float\\x20fVAngleSin;\\x20\\x20\\x0auniform\\x20float\\x20fZoom;\\x0auniform\\x20float\\x20fRX1;\\x20\\x0auniform\\x20float\\x20fRX2;\\x20\\x0auniform\\x20float\\x20fRY1;\\x20\\x0auniform\\x20float\\x20fRY2;\\x20\\x0auniform\\x20int\\x20bDataFormat;\\x0a\\x0avoid\\x20main()\\x0a{\\x0a\\x09float\\x20r,g,b,y,u,v;\\x0a\\x0a\\x20\\x20\\x20\\x20vec4\\x20origin1;\\x0a\\x20\\x20\\x20\\x20vec4\\x20origin2;\\x0a\\x20\\x20\\x20\\x20vec4\\x20origin3;\\x0a\\x20\\x20\\x20\\x20vec4\\x20result;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20z1;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20z2;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20z3;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20dnew;\\x0a\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20w;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20h;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20fCenterX;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20fCenterY;\\x0a\\x20\\x20\\x20\\x20float\\x20\\x20fRadius;\\x0a\\x20\\x20\\x20\\x20w\\x20=\\x201.0;\\x0a\\x20\\x20\\x20\\x20h\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x20(fRY2\\x20-\\x20fRY1);\\x0a\\x20\\x20\\x20\\x20fCenterX\\x20=\\x20(fRX1\\x20+\\x20fRX2)\\x20/\\x202.0\\x20*\\x20w;\\x0a\\x20\\x20\\x20\\x20fCenterY\\x20=\\x20(fRY1\\x20+\\x20fRY2)\\x20/\\x202.0\\x20*\\x20h;\\x0a\\x20\\x20\\x20\\x20fRadius\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x202.0\\x20*\\x20w;\\x0a\\x0a\\x20\\x20\\x20\\x20origin1.s\\x20=\\x20pp.s\\x20-\\x200.5;\\x0a\\x20\\x20\\x20\\x20origin1.t\\x20=\\x20pp.t\\x20-\\x200.5;\\x0a\\x20\\x20\\x20\\x20z1\\x20=\\x20fZoom\\x20;\\x0a\\x0a\\x20\\x20\\x20\\x20origin2.s\\x20=\\x20origin1.s\\x20;\\x0a\\x20\\x20\\x20\\x20origin2.t\\x20=\\x20(origin1.t*fVAngleCos\\x20+\\x20z1*fVAngleSin);\\x0a\\x20\\x20\\x20\\x20z2\\x20=\\x20z1*fVAngleCos\\x20-\\x20origin1.t*fVAngleSin;\\x0a\\x0a\\x20\\x20\\x20\\x20origin3.s\\x20=\\x20origin2.s*fHAngleCos\\x20+\\x20z2*fHAngleSin\\x20;\\x0a\\x20\\x20\\x20\\x20origin3.t\\x20=\\x20origin2.y;\\x0a\\x20\\x20\\x20\\x20z3\\x20=\\x20z2*fHAngleCos\\x20-\\x20origin2.x*fHAngleSin;\\x0a\\x0a\\x20\\x20\\x20\\x20dnew\\x20=\\x20sqrt(origin3.s*origin3.s\\x20+\\x20origin3.t*origin3.t)\\x20;\\x0a\\x20\\x20\\x20\\x20float\\x20d\\x20=\\x20sqrt(origin3.s*origin3.s\\x20+\\x20origin3.t*origin3.t\\x20+\\x20z3*z3);\\x0a\\x20\\x20\\x20\\x20float\\x20theta\\x20=\\x20asin(dnew/d);\\x0a\\x20\\x20\\x20\\x20float\\x20tmp\\x20=\\x20theta\\x20/\\x201.5707963\\x20*\\x200.5;\\x0a\\x20\\x20\\x20\\x20result.s\\x20=\\x20(tmp*origin3.s\\x20/\\x20dnew\\x20*\\x20fRadius\\x20*\\x202.0\\x20+\\x20fCenterX)/w;\\x0a\\x20\\x20\\x20\\x20result.t\\x20=\\x20(tmp*origin3.t\\x20/\\x20dnew\\x20*\\x20fRadius\\x20*\\x202.0\\x20+\\x20fCenterY)/h;\\x0a\\x0a\\x20\\x20\\x20\\x20if(bDataFormat\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r\\x20=\\x20texture2D(Ytexture,\\x20result.st).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g\\x20=\\x20texture2D(Ytexture,\\x20result.st).g;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\\x20=\\x20texture2D(Ytexture,\\x20result.st).b;\\x20\\x0a\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20else\\x20if(bDataFormat\\x20==\\x200)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y\\x20=\\x20texture2D(Ytexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u\\x20=\\x20texture2D(Utexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v\\x20=\\x20texture2D(Vtexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y=1.1643*(y-0.0625);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u=u-0.5;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v=v-0.5;\\x20\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r=y+1.5958*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g=y-0.39173*u-0.81290*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b=y+2.017*u;\\x20\\x0a\\x20\\x20\\x20\\x20}\\x0a\\x0a\\x20\\x20\\x20\\x20if(result.s\\x20>\\x201.0\\x20||\\x20result.t\\x20>\\x201.0\\x20||\\x20result.s\\x20<\\x200.0\\x20||\\x20result.t\\x20<\\x200.0)\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20gl_FragColor\\x20=\\x20vec4(r\\x20,g\\x20,b\\x20,\\x201.0);\\x0a}\\x20\\x0a';break;case _0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_360']:_0x3a4b4e=_0x7944d4,_0x264a44='\\x0a\\x20\\x20\\x20\\x20precision\\x20highp\\x20float;\\x0a\\x20\\x20\\x20\\x20varying\\x20vec4\\x20pp;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20Ytexture;\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20Utexture;\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20Vtexture;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fAngle;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRX1;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRX2;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRY1;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRY2;\\x0a\\x20\\x20\\x20\\x20uniform\\x20int\\x20bDataFormat;\\x0a\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20void\\x20main()\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20r,g,b,y,u,v;\\x0a\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20vec4\\x20origin;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20vec4\\x20result;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20thetabase;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20d;\\x0a\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20w;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20h;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20fCenterX;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20fCenterY;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20fRadius;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20w\\x20=\\x201.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20h\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x20(fRY2\\x20-\\x20fRY1);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fCenterX\\x20=\\x20(fRX1\\x20+\\x20fRX2)\\x20/\\x202.0\\x20*\\x20w;\\x20\\x20\\x20\\x20///<圆心实际坐标\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fCenterY\\x20=\\x20(fRY1\\x20+\\x20fRY2)\\x20/\\x202.0\\x20*\\x20h;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fRadius\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x202.0\\x20*\\x20w;\\x20\\x20\\x20\\x20///<半径实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20fMax\\x20=\\x200.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRX2\\x20>\\x201.0\\x20||\\x20fRY2\\x20>\\x201.0\\x20||\\x20fRX1\\x20<\\x200.0\\x20||\\x20fRY1\\x20<\\x200.0)\\x20///<如果不是一个完整的圆\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRX1\\x20<\\x200.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20-fRX1\\x20*\\x20w;\\x20///<左边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(tmp\\x20>\\x20fMax)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fMax\\x20=\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRX2\\x20>\\x201.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20(fRX2\\x20-\\x201.0)\\x20*\\x20w;\\x20///<右边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(tmp\\x20>\\x20fMax)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fMax\\x20=\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRY1\\x20<\\x200.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20-fRY1\\x20*\\x20h;\\x20///<上边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(tmp\\x20>\\x20fMax)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fMax\\x20=\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRY2\\x20>\\x201.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20(fRY2\\x20-\\x201.0)\\x20*\\x20h;\\x20///<下边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(tmp\\x20>\\x20fMax)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fMax\\x20=\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20topCut\\x20=\\x20fMax\\x20/\\x20fRadius;\\x20\\x20///<如果不是一个完整的圆,最终矫正图需要切掉上面无图像部分,否则无需切\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20bottomCut\\x20=\\x200.8;\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20///<为矫正效果,最终矫正图固定切掉下面一部分\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20origin.s\\x20=\\x20pp.s;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20origin.t\\x20=\\x20(bottomCut\\x20-\\x20topCut)\\x20*\\x20pp.t\\x20+\\x20topCut;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20thetabase\\x20=\\x206.2831853\\x20*\\x20origin.s\\x20+\\x20fAngle;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20d\\x20=\\x20fRadius\\x20*\\x20(1.0\\x20-\\x20origin.t);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20result.s\\x20=\\x20(fCenterX\\x20-\\x20d*sin(thetabase))\\x20/\\x20w;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20result.t\\x20=\\x20(fCenterY\\x20+\\x20d*cos(thetabase))\\x20/\\x20h;\\x0a\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(bDataFormat\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r\\x20=\\x20texture2D(Ytexture,\\x20result.st).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g\\x20=\\x20texture2D(Ytexture,\\x20result.st).g;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\\x20=\\x20texture2D(Ytexture,\\x20result.st).b;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20else\\x20if(bDataFormat\\x20==\\x200)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y\\x20=\\x20texture2D(Ytexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u\\x20=\\x20texture2D(Utexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v\\x20=\\x20texture2D(Vtexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y=1.1643*(y-0.0625);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u=u-0.5;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v=v-0.5;\\x20\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r=y+1.5958*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g=y-0.39173*u-0.81290*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b=y+2.017*u;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(result.s\\x20>\\x201.0\\x20||\\x20result.t\\x20>\\x201.0\\x20||\\x20result.s\\x20<\\x200.0\\x20||\\x20result.t\\x20<\\x200.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\\x20=\\x200.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor\\x20=\\x20vec4(r,\\x20g,\\x20b,\\x201.0);\\x0a\\x20\\x20\\x20\\x20}\\x0a';break;case _0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_180']:_0x3a4b4e=_0x7944d4,_0x264a44='\\x0a\\x20\\x20\\x20\\x20precision\\x20highp\\x20float;\\x0a\\x20\\x20\\x20\\x20varying\\x20vec4\\x20pp;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20Ytexture;\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20Utexture;\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20Vtexture;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fAngle;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRX1;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRX2;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRY1;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRY2;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20int\\x20bDataFormat;\\x0a\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20void\\x20main()\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20r,g,b,y,u,v;\\x0a\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20vec4\\x20origin;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20vec4\\x20result;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20thetabase;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20d;\\x0a\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20vec4\\x20newpp;\\x20\\x20///<180矫正pp纹理坐标的点对应360矫正newpp纹理坐标对应的点\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if\\x20(pp.t\\x20\\x20<=\\x200.5)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20newpp.s\\x20=\\x20\\x20pp.s\\x20/\\x202.0\\x20+\\x200.5;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20newpp.t\\x20=\\x20\\x20pp.t\\x20*\\x202.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20else\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20newpp.s\\x20=\\x20\\x20pp.s\\x20/\\x202.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20newpp.t\\x20=\\x20\\x20(pp.t\\x20-\\x200.5)\\x20*\\x202.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20w;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20h;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20fCenterX;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20fCenterY;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20fRadius;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20w\\x20=\\x201.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20h\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x20(fRY2\\x20-\\x20fRY1);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fCenterX\\x20=\\x20(fRX1\\x20+\\x20fRX2)\\x20/\\x202.0\\x20*\\x20w;\\x20\\x20\\x20\\x20\\x20///<圆心实际坐标\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fCenterY\\x20=\\x20(fRY1\\x20+\\x20fRY2)\\x20/\\x202.0\\x20*\\x20h;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fRadius\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x202.0\\x20*\\x20w;\\x20\\x20\\x20\\x20\\x20///<半径实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20fMax\\x20=\\x200.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRX2\\x20>\\x201.0\\x20||\\x20fRY2\\x20>\\x201.0\\x20||\\x20fRX1\\x20<\\x200.0\\x20||\\x20fRY1\\x20<\\x200.0)\\x20///<如果不是一个完整的圆\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRX1\\x20<\\x200.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20-fRX1\\x20*\\x20w;\\x20///<左边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(tmp\\x20>\\x20fMax)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fMax\\x20=\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRX2\\x20>\\x201.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20(fRX2\\x20-\\x201.0)\\x20*\\x20w;\\x20///<右边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(tmp\\x20>\\x20fMax)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fMax\\x20=\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRY1\\x20<\\x200.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20-fRY1\\x20*\\x20h;\\x20///<上边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(tmp\\x20>\\x20fMax)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fMax\\x20=\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRY2\\x20>\\x201.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20(fRY2\\x20-\\x201.0)\\x20*\\x20h;\\x20///<下边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(tmp\\x20>\\x20fMax)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fMax\\x20=\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20topCut\\x20=\\x20fMax\\x20/\\x20fRadius;\\x20\\x20\\x20///<如果不是一个完整的圆,最终矫正图需要切掉上面无图像部分,否则无需切\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20bottomCut\\x20=\\x200.8;\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20///<为矫正效果,最终矫正图固定切掉下面一部分\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20origin.s\\x20=\\x20newpp.s;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20origin.t\\x20=\\x20(bottomCut\\x20-\\x20topCut)\\x20*\\x20newpp.t\\x20+\\x20topCut;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20thetabase\\x20=\\x206.2831853\\x20*\\x20origin.s\\x20+\\x20fAngle;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20d\\x20=\\x20fRadius\\x20*\\x20(1.0\\x20-\\x20origin.t);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20result.s\\x20=\\x20(fCenterX\\x20-\\x20d*sin(thetabase))\\x20/\\x20w;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20result.t\\x20=\\x20(fCenterY\\x20+\\x20d*cos(thetabase))\\x20/\\x20h;\\x0a\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(bDataFormat\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r\\x20=\\x20texture2D(Ytexture,\\x20result.st).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g\\x20=\\x20texture2D(Ytexture,\\x20result.st).g;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\\x20=\\x20texture2D(Ytexture,\\x20result.st).b;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20else\\x20if(bDataFormat\\x20==\\x200)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y\\x20=\\x20texture2D(Ytexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u\\x20=\\x20texture2D(Utexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v\\x20=\\x20texture2D(Vtexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y=1.1643*(y-0.0625);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u=u-0.5;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v=v-0.5;\\x20\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r=y+1.5958*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g=y-0.39173*u-0.81290*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b=y+2.017*u;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(result.s\\x20>\\x201.0\\x20||\\x20result.t\\x20>\\x201.0\\x20||\\x20result.s\\x20<\\x200.0\\x20||\\x20result.t\\x20<\\x200.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r\\x20=\\x200.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g\\x20=\\x200.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\\x20=\\x200.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor\\x20=\\x20vec4(r\\x20,g\\x20,b\\x20,\\x201.0);\\x0a\\x20\\x20\\x20\\x20}\\x0a';break;case _0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_360']:_0x3a4b4e=_0x7944d4,_0x264a44='\\x0a\\x20\\x20\\x20\\x20precision\\x20highp\\x20float;\\x0a\\x20\\x20\\x20\\x20varying\\x20vec4\\x20pp;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20Ytexture;\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20Utexture;\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20Vtexture;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fAngle;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRX1;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRX2;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRY1;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRY2;\\x0a\\x20\\x20\\x20\\x20uniform\\x20int\\x20bDataFormat;\\x0a\\x0a\\x20\\x20\\x20\\x20void\\x20main()\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20r,g,b,y,u,v;\\x0a\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20vec4\\x20origin;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20vec4\\x20result;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20thetabase;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20d;\\x0a\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20w;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20h;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20fCenterX;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20fCenterY;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20fRadius;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20w\\x20=\\x201.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20h\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x20(fRY2\\x20-\\x20fRY1);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fCenterX\\x20=\\x20(fRX1\\x20+\\x20fRX2)\\x20/\\x202.0\\x20*\\x20w;\\x20\\x20\\x20\\x20///<圆心实际坐标\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fCenterY\\x20=\\x20(fRY1\\x20+\\x20fRY2)\\x20/\\x202.0\\x20*\\x20h;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fRadius\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x202.0\\x20*\\x20w;\\x20\\x20\\x20\\x20///<半径实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20fMax\\x20=\\x200.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRX2\\x20>\\x201.0\\x20||\\x20fRY2\\x20>\\x201.0\\x20||\\x20fRX1\\x20<\\x200.0\\x20||\\x20fRY1\\x20<\\x200.0)\\x20///<如果不是一个完整的圆\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRX1\\x20<\\x200.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20-fRX1\\x20*\\x20w;\\x20///<左边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(tmp\\x20>\\x20fMax)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fMax\\x20=\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRX2\\x20>\\x201.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20(fRX2\\x20-\\x201.0)\\x20*\\x20w;\\x20///<右边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(tmp\\x20>\\x20fMax)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fMax\\x20=\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRY1\\x20<\\x200.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20-fRY1\\x20*\\x20h;\\x20///<上边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(tmp\\x20>\\x20fMax)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fMax\\x20=\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRY2\\x20>\\x201.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20(fRY2\\x20-\\x201.0)\\x20*\\x20h;\\x20///<下边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(tmp\\x20>\\x20fMax)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fMax\\x20=\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20topCut\\x20=\\x20fMax\\x20/\\x20fRadius;\\x20\\x20\\x20///<如果不是一个完整的圆,最终矫正图需要切掉上面无图像部分,否则无需切\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20bottomCut\\x20=\\x200.8;\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20///<为矫正效果,最终矫正图固定切掉下面一部分\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20origin.s\\x20=\\x201.0\\x20-\\x20pp.s;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20origin.t\\x20=\\x20(bottomCut\\x20-\\x20topCut)\\x20*\\x20(1.0\\x20-\\x20pp.t)\\x20+\\x20topCut;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20thetabase\\x20=\\x206.2831853\\x20*\\x20origin.s\\x20+\\x20fAngle;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20d\\x20=\\x20fRadius\\x20*\\x20(1.0\\x20-\\x20origin.t);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20result.s\\x20=\\x20(fCenterX\\x20-\\x20d*sin(thetabase))\\x20/\\x20w;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20result.t\\x20=\\x20(fCenterY\\x20+\\x20d*cos(thetabase))\\x20/\\x20h;\\x0a\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(bDataFormat\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r\\x20=\\x20texture2D(Ytexture,\\x20result.st).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g\\x20=\\x20texture2D(Ytexture,\\x20result.st).g;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\\x20=\\x20texture2D(Ytexture,\\x20result.st).b;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20else\\x20if(bDataFormat\\x20==\\x200)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y\\x20=\\x20texture2D(Ytexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u\\x20=\\x20texture2D(Utexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v\\x20=\\x20texture2D(Vtexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y=1.1643*(y-0.0625);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u=u-0.5;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v=v-0.5;\\x20\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r=y+1.5958*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g=y-0.39173*u-0.81290*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b=y+2.017*u;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(result.s\\x20>\\x201.0\\x20||\\x20result.t\\x20>\\x201.0\\x20||\\x20result.s\\x20<\\x200.0\\x20||\\x20result.t\\x20<\\x200.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor\\x20=\\x20vec4(r\\x20,g\\x20,b\\x20,\\x201.0);\\x0a\\x20\\x20\\x20\\x20}\\x0a';break;case _0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_180']:_0x3a4b4e=_0x7944d4,_0x264a44='\\x0a\\x20\\x20\\x20\\x20precision\\x20highp\\x20float;\\x0a\\x20\\x20\\x20\\x20varying\\x20vec4\\x20pp;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20Ytexture;\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20Utexture;\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20Vtexture;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fAngle;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRX1;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRX2;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRY1;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRY2;\\x0a\\x20\\x20\\x20\\x20uniform\\x20int\\x20bDataFormat;\\x0a\\x0a\\x20\\x20\\x20\\x20void\\x20main()\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20r,g,b,y,u,v;\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20vec4\\x20origin;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20vec4\\x20result;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20thetabase;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20d;\\x0a\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20vec4\\x20newpp;\\x20\\x20///<180矫正pp纹理坐标的点对应360矫正newpp纹理坐标对应的点\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if\\x20(pp.t\\x20\\x20<=\\x200.5)\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20newpp.s\\x20=\\x20\\x20pp.s\\x20/\\x202.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20newpp.t\\x20=\\x20\\x20pp.t\\x20*\\x202.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20else\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20newpp.s\\x20=\\x20\\x20pp.s\\x20/\\x202.0\\x20+\\x200.5;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20newpp.t\\x20=\\x20\\x20(pp.t\\x20-\\x200.5)\\x20*\\x202.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20w;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20h;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20fCenterX;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20fCenterY;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20fRadius;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20w\\x20=\\x201.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20h\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x20(fRY2\\x20-\\x20fRY1);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fCenterX\\x20=\\x20(fRX1\\x20+\\x20fRX2)\\x20/\\x202.0\\x20*\\x20w;\\x20\\x20\\x20\\x20///<圆心实际坐标\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fCenterY\\x20=\\x20(fRY1\\x20+\\x20fRY2)\\x20/\\x202.0\\x20*\\x20h;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fRadius\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x202.0\\x20*\\x20w;\\x20\\x20\\x20\\x20\\x20///<半径实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20fMax\\x20=\\x200.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRX2\\x20>\\x201.0\\x20||\\x20fRY2\\x20>\\x201.0\\x20||\\x20fRX1\\x20<\\x200.0\\x20||\\x20fRY1\\x20<\\x200.0)\\x20///<如果不是一个完整的圆\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRX1\\x20<\\x200.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20-fRX1\\x20*\\x20w;\\x20///<左边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(tmp\\x20>\\x20fMax)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fMax\\x20=\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRX2\\x20>\\x201.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20(fRX2\\x20-\\x201.0)\\x20*\\x20w;\\x20///<右边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(tmp\\x20>\\x20fMax)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fMax\\x20=\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRY1\\x20<\\x200.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20-fRY1\\x20*\\x20h;\\x20///<上边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(tmp\\x20>\\x20fMax)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fMax\\x20=\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRY2\\x20>\\x201.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20(fRY2\\x20-\\x201.0)\\x20*\\x20h;\\x20///<下边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(tmp\\x20>\\x20fMax)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fMax\\x20=\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20topCut\\x20=\\x20fMax\\x20/\\x20fRadius;\\x20\\x20\\x20///<如果不是一个完整的圆,最终矫正图需要切掉上面无图像部分,否则无需切\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20bottomCut\\x20=\\x200.8;\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20///<为矫正效果,最终矫正图固定切掉下面一部分\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20origin.s\\x20=\\x201.0\\x20-\\x20newpp.s;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20origin.t\\x20=\\x20(bottomCut\\x20-\\x20topCut)\\x20*\\x20(1.0\\x20-\\x20newpp.t)\\x20+\\x20topCut;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20thetabase\\x20=\\x206.2831853\\x20*\\x20origin.s\\x20+\\x20fAngle;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20d\\x20=\\x20fRadius\\x20*\\x20(1.0\\x20-\\x20origin.t);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20result.s\\x20=\\x20(fCenterX\\x20-\\x20d*sin(thetabase))\\x20/\\x20w;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20result.t\\x20=\\x20(fCenterY\\x20+\\x20d*cos(thetabase))\\x20/\\x20h;\\x0a\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(bDataFormat\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r\\x20=\\x20texture2D(Ytexture,\\x20result.st).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g\\x20=\\x20texture2D(Ytexture,\\x20result.st).g;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\\x20=\\x20texture2D(Ytexture,\\x20result.st).b;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20else\\x20if(bDataFormat\\x20==\\x200)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y\\x20=\\x20texture2D(Ytexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u\\x20=\\x20texture2D(Utexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v\\x20=\\x20texture2D(Vtexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y=1.1643*(y-0.0625);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u=u-0.5;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v=v-0.5;\\x20\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r=y+1.5958*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g=y-0.39173*u-0.81290*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b=y+2.017*u;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(result.s\\x20>\\x201.0\\x20||\\x20result.t\\x20>\\x201.0\\x20||\\x20result.s\\x20<\\x200.0\\x20||\\x20result.t\\x20<\\x200.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor\\x20=\\x20vec4(r\\x20,g\\x20,b\\x20,\\x201.0);\\x0a\\x20\\x20\\x20\\x20}\\x20\\x0a';break;case _0x5dc8af['SR_DE_FISH_PANORAMA_WALL']:_0x3a4b4e=_0x7944d4,_0x264a44='\\x0a\\x20\\x20\\x20\\x20precision\\x20highp\\x20float;\\x0a\\x20\\x20\\x20\\x20varying\\x20vec4\\x20pp;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20Ytexture;\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20Utexture;\\x0a\\x20\\x20\\x20\\x20uniform\\x20sampler2D\\x20Vtexture;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRX1;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRX2;\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRY1;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20float\\x20fRY2;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20int\\x20bDataFormat;\\x0a\\x0a\\x20\\x20\\x20\\x20void\\x20main()\\x0a\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20r,g,b,y,u,v;\\x0a\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20vec4\\x20origin;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20vec4\\x20result;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20d;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20w;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20h;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20fCenterX;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20fCenterY;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20fRadius;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20w\\x20=\\x201.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20h\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x20(fRY2\\x20-\\x20fRY1);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fCenterX\\x20=\\x20(fRX1\\x20+\\x20fRX2)\\x20/\\x202.0\\x20*\\x20w;\\x20\\x20\\x20\\x20\\x20///<圆心实际坐标\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fCenterY\\x20=\\x20(fRY1\\x20+\\x20fRY2)\\x20/\\x202.0\\x20*\\x20h;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fRadius\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x202.0\\x20*\\x20w;\\x20\\x20\\x20\\x20\\x20///<半径实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20defaultTopCut\\x20=\\x200.1;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20defaultBottomCut\\x20=\\x200.9;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20leftCut\\x20=\\x200.0;\\x20\\x20\\x20\\x20///<当图像中圆不完整时需要切掉无图像部分,即使图像完整,为了效果,也要切掉上下固定的一部分\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20rightCut\\x20=\\x201.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20topCut\\x20=\\x20defaultTopCut;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20\\x20bottomCut\\x20=\\x20defaultBottomCut;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRX1\\x20<\\x200.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20-fRX1\\x20*\\x20w;\\x20///<左边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20tmp\\x20/\\x20(2.0*fRadius);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20leftCut\\x20=\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRX2\\x20>\\x201.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20(fRX2\\x20-\\x201.0)\\x20*\\x20w;\\x20///<右边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20tmp\\x20/\\x20(2.0*fRadius);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20rightCut\\x20=\\x201.0\\x20-\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRY1\\x20<\\x200.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20-fRY1\\x20*\\x20h;\\x20///<上边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20tmp\\x20/\\x20(2.0*fRadius);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(tmp\\x20>\\x20defaultTopCut)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20topCut\\x20=\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20else\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20topCut\\x20=\\x20defaultTopCut;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(fRY2\\x20>\\x201.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20(fRY2\\x20-\\x201.0)\\x20*\\x20h;\\x20///<下边超出图像部分最大实际长度\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20tmp\\x20=\\x20tmp\\x20/\\x20(2.0*fRadius);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(tmp\\x20>\\x201.0\\x20-\\x20defaultBottomCut)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20bottomCut\\x20=\\x201.0\\x20-\\x20tmp;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20else\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20bottomCut\\x20=\\x20defaultBottomCut;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20origin.s\\x20=\\x20pp.s\\x20*\\x20(rightCut-leftCut)\\x20+\\x20leftCut;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20origin.t\\x20=\\x20pp.t\\x20*\\x20(bottomCut-topCut)\\x20+\\x20topCut;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20tmpx\\x20=\\x20origin.s\\x20*\\x202.0\\x20*\\x20fRadius\\x20+\\x20fCenterX\\x20-\\x20fRadius;\\x20///<纹理坐标转化为原图上的实际坐标\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20float\\x20tmpy\\x20=\\x20origin.t\\x20*\\x202.0\\x20*\\x20fRadius\\x20+\\x20fCenterY\\x20-\\x20fRadius;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20d\\x20=\\x20sqrt(fRadius*fRadius\\x20-\\x20(tmpy-fCenterY)*(tmpy-fCenterY));\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20result.s\\x20=\\x20((tmpx-fCenterX)\\x20*\\x20d\\x20/\\x20fRadius\\x20+\\x20fCenterX)\\x20/\\x20w;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20result.t\\x20=\\x20tmpy\\x20/\\x20h;\\x0a\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(bDataFormat\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r\\x20=\\x20texture2D(Ytexture,\\x20result.st).r;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g\\x20=\\x20texture2D(Ytexture,\\x20result.st).g;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\\x20=\\x20texture2D(Ytexture,\\x20result.st).b;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20else\\x20if(bDataFormat\\x20==\\x200)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y\\x20=\\x20texture2D(Ytexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u\\x20=\\x20texture2D(Utexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v\\x20=\\x20texture2D(Vtexture,\\x20result.st).r;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20y=1.1643*(y-0.0625);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20u=u-0.5;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20v=v-0.5;\\x20\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r=y+1.5958*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g=y-0.39173*u-0.81290*v;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b=y+2.017*u;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(result.s\\x20>\\x201.0\\x20||\\x20result.t\\x20>\\x201.0\\x20||\\x20result.s\\x20<\\x200.0\\x20||\\x20result.t\\x20<\\x200.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20r\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20g\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20b\\x20=\\x200.0;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_FragColor\\x20=\\x20vec4(r\\x20,g\\x20,b\\x20,\\x201.0);\\x0a\\x20\\x20\\x20\\x20}\\x0a';break;case _0x5dc8af['SR_DE_FISH_SEMISPHERE']:case _0x5dc8af['SR_DE_PANORAMA_SPHERE']:case _0x5dc8af['SR_DE_PANORAMA_PLANET']:case _0x5dc8af['SR_DE_FISH_CYLINDER_CEILING']:case _0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']:case _0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']:case _0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']:case _0x5dc8af['SR_DE_FISH_PLANET']:_0x3a4b4e='\\x0a\\x20\\x20\\x20\\x20precision\\x20lowp\\x20\\x20float;\\x0a\\x20\\x20\\x20\\x20attribute\\x20vec4\\x20\\x20position;\\x0a\\x20\\x20\\x20\\x20attribute\\x20vec4\\x20\\x20texCoord;\\x0a\\x20\\x20\\x20\\x20varying\\x20vec4\\x20\\x20\\x20\\x20pp;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20int\\x20bCapture;\\x0a\\x0a\\x20\\x20\\x20\\x20uniform\\x20mat4\\x20matProj;\\x0a\\x20\\x20\\x20\\x20uniform\\x20mat4\\x20matView;\\x0a\\x20\\x20\\x20\\x20void\\x20main(void)\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position\\x20=\\x20matProj\\x20*\\x20matView\\x20*\\x20position;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20pp\\x20=\\x20texCoord;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(bCapture\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position.y\\x20=\\x20-\\x20gl_Position.y;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20}\\x0a',_0x264a44=_0x5810c2;break;case _0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_CEILING']:case _0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR']:_0x3a4b4e='\\x0a\\x20\\x20\\x20\\x20attribute\\x20vec4\\x20\\x20position;\\x0a\\x20\\x20\\x20\\x20attribute\\x20vec4\\x20\\x20texCoord;\\x0a\\x20\\x20\\x20\\x20varying\\x20vec4\\x20\\x20\\x20\\x20pp;\\x20\\x0a\\x20\\x20\\x20\\x20uniform\\x20int\\x20bCapture;\\x0a\\x0a\\x20\\x20\\x20\\x20uniform\\x20mat4\\x20matProj;\\x0a\\x20\\x20\\x20\\x20uniform\\x20mat4\\x20matView;\\x0a\\x20\\x20\\x20\\x20uniform\\x20highp\\x20vec4\\x20\\x20\\x20\\x20vecCylinderParam;\\x0a\\x20\\x20\\x20\\x20uniform\\x20highp\\x20float\\x20\\x20\\x20fTextureOffset;\\x0a\\x20\\x20\\x20\\x20uniform\\x20mediump\\x20float\\x20fRX1;\\x0a\\x20\\x20\\x20\\x20uniform\\x20mediump\\x20float\\x20fRX2;\\x0a\\x20\\x20\\x20\\x20uniform\\x20mediump\\x20float\\x20fRY1;\\x0a\\x20\\x20\\x20\\x20uniform\\x20mediump\\x20float\\x20fRY2;\\x0a\\x20\\x20\\x20\\x20void\\x20main(void)\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20highp\\x20float\\x20\\x20w;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20highp\\x20float\\x20\\x20h;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20highp\\x20float\\x20\\x20fCenterX;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20highp\\x20float\\x20\\x20fCenterY;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20w\\x20=\\x201.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20h\\x20=\\x20(fRX2\\x20-\\x20fRX1)\\x20/\\x20(fRY2\\x20-\\x20fRY1);\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fCenterX\\x20=\\x20(fRX1\\x20+\\x20fRX2)\\x20/\\x202.0\\x20*\\x20w;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fCenterY\\x20=\\x20(fRY1\\x20+\\x20fRY2)\\x20/\\x202.0\\x20*\\x20h;\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20highp\\x20float\\x20dx\\x20\\x20\\x20\\x20\\x20=\\x20position.x\\x20-\\x20vecCylinderParam.x;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20highp\\x20float\\x20dz\\x20\\x20\\x20\\x20\\x20=\\x20position.z\\x20-\\x20(vecCylinderParam.z\\x20+\\x20vecCylinderParam.y);\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20highp\\x20float\\x20theta\\x20\\x20=\\x20atan(abs(dx/dz));\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20highp\\x20float\\x20fDis\\x20\\x20\\x20=\\x20(3.1415926\\x20-\\x202.0\\x20*\\x20theta)\\x20*\\x201.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20highp\\x20float\\x20fdx\\x20\\x20\\x20\\x20=\\x200.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if\\x20(dx\\x20>\\x200.0)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fdx\\x20=\\x201.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20else\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fdx\\x20=\\x20-1.0;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20fDis\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20=\\x20fdx\\x20*\\x20fDis;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20highp\\x20float\\x20lx\\x20\\x20\\x20\\x20\\x20=\\x20fDis;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20highp\\x20float\\x20lz\\x20\\x20\\x20\\x20\\x20=\\x20vecCylinderParam.z\\x20+\\x20vecCylinderParam.y;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20highp\\x20float\\x20fRate\\x20\\x20=\\x20(3.1415926\\x20/\\x202.0\\x20+\\x20vecCylinderParam.w)\\x20/\\x203.1415926\\x20*\\x202.0;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20highp\\x20vec4\\x20newPos\\x20\\x20=\\x20position;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20newPos.x\\x20\\x20\\x20\\x20\\x20=\\x20fRate\\x20*\\x20(lx\\x20-\\x20newPos.x)\\x20+\\x20newPos.x;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20newPos.z\\x20\\x20\\x20\\x20\\x20=\\x20fRate\\x20*\\x20(lz\\x20-\\x20newPos.z)\\x20+\\x20newPos.z;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position\\x20\\x20=\\x20matProj\\x20*\\x20matView\\x20*\\x20newPos;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20if(bCapture\\x20==\\x201)\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20{\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20gl_Position.y\\x20=\\x20-\\x20gl_Position.y;\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20}\\x0a\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20highp\\x20float\\x20s\\x20=\\x20texCoord.s\\x20*\\x20w\\x20-\\x20fCenterX;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20highp\\x20float\\x20t\\x20=\\x20fCenterY\\x20-\\x20texCoord.t\\x20*\\x20h;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20pp.s\\x20=\\x20(s*cos(fTextureOffset)\\x20-\\x20t*sin(fTextureOffset)\\x20+\\x20fCenterX)\\x20/\\x20w;\\x20\\x0a\\x20\\x20\\x20\\x20\\x20\\x20\\x20\\x20pp.t\\x20=\\x20(fCenterY\\x20-\\x20(s*sin(fTextureOffset)\\x20+\\x20t*cos(fTextureOffset)))\\x20/\\x20h;\\x0a\\x20\\x20\\x20\\x20}\\x0a',_0x264a44=_0x5810c2;break;default:return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}var _0x312dbd=this['CompileProgram'](_0x3a4b4e,_0x264a44);return _0x312dbd<=0x0?_0x2ffc1c['SR_ERR_WEBGL_RESOURCE']:(this['videoShaderProgram']=_0x312dbd,_0x2ffc1c['SR_OK']);}},{'key':'_InitVideoVertex','value':function(_0x59d694,_0x267063,_0x297e43){var _0x191b2a=null,_0x4ed4d8=null,_0xcc7f06=null,_0x1eeb48=_0x2ffc1c['SR_OK'];if(0x0==this['b3DPort'])_0x191b2a=new Float32Array([-0x1,0x1,-0x1,-0x1,0x1,0x1,0x1,0x1,-0x1,-0x1,0x1,-0x1]),_0x4ed4d8=new Float32Array([0x0,0x0,0x0,0x1,0x1,0x0,0x1,0x0,0x0,0x1,0x1,0x1]);else{if(this['fRX1']=_0x297e43['fRXLeft'],this['fRX2']=_0x297e43['fRXRight'],this['fRY1']=_0x297e43['fRYTop'],this['fRY2']=_0x297e43['fRYBottom'],_0x267063==_0x5dc8af['SR_DE_FISH_SEMISPHERE']||_0x267063==_0x5dc8af['SR_DE_FISH_PLANET'])_0x1eeb48=this['_CreateSemiSphere'](this['fRX1'],this['fRX2'],this['fRY1'],this['fRY2']),_0x191b2a=this['pSemiSpherePos'],_0x4ed4d8=this['pSemiSphereTex'];else{if(_0x267063==_0x5dc8af['SR_DE_PANORAMA_SPHERE']||_0x267063==_0x5dc8af['SR_DE_PANORAMA_PLANET'])_0x1eeb48=this['_CreateSphere'](this['fRX1'],this['fRX2'],this['fRY1'],this['fRY2']),_0x191b2a=this['pSpherePos'],_0x4ed4d8=this['pSphereTex'],_0xcc7f06=this['pSphereInd'];else{if(_0x267063==_0x5dc8af['SR_DE_FISH_CYLINDER_CEILING']||_0x267063==_0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']||_0x267063==_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_CEILING']||_0x267063==_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR'])_0x1eeb48=this['_CreateCylinder'](_0x267063,this['fRX1'],this['fRX2'],this['fRY1'],this['fRY2'],0x0,0x0),_0x191b2a=this['pCylinderPos'],_0x4ed4d8=this['pCylinderTex'];else{if(_0x267063!=_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']&&_0x267063!=_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL'])return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];_0x1eeb48=_0x267063==_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']?this['_CreateArcSphere'](_0x267063,0.05,0.95,-0.3,1.3):this['_CreateArcSphere'](_0x267063,-0.16,1.16,0.005,0.995),_0x191b2a=this['pArcSpherePos'],_0x4ed4d8=this['pArcSphereTex'];}}}if(_0x1eeb48!=_0x2ffc1c['SR_OK'])return _0x1eeb48;}if(null==_0x191b2a||null==_0x4ed4d8)return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];var _0x3f4435=this['ctx']['createBuffer']();if(this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],_0x3f4435),this['ctx']['bufferData'](this['ctx']['ARRAY_BUFFER'],_0x191b2a,this['ctx']['STATIC_DRAW']),this['vertexPosBuffer']=_0x3f4435,_0x267063==_0x5dc8af['SR_DE_PANORAMA_SPHERE']||_0x267063==_0x5dc8af['SR_DE_PANORAMA_PLANET']){var _0x3aeddb=this['ctx']['createBuffer']();this['ctx']['bindBuffer'](this['ctx']['ELEMENT_ARRAY_BUFFER'],_0x3aeddb),this['ctx']['bufferData'](this['ctx']['ELEMENT_ARRAY_BUFFER'],_0xcc7f06,this['ctx']['STATIC_DRAW']),this['indicesPosBuffer']=_0x3aeddb;}var _0x5b4283=this['ctx']['createBuffer']();return this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],_0x5b4283),this['ctx']['bufferData'](this['ctx']['ARRAY_BUFFER'],_0x4ed4d8,this['ctx']['STATIC_DRAW']),this['texturePosBuffer']=_0x5b4283,this['ctx']['bindBuffer'](this['ctx']['ARRAY_BUFFER'],null),_0x191b2a=null,_0x4ed4d8=null,_0x2ffc1c['SR_OK'];}},{'key':'_InitCamera','value':function(_0x58ef65){if(null!=this['pCamera'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];switch(_0x58ef65){case _0x5dc8af['SR_DE_NULL']:case _0x5dc8af['SR_DE_FISH_ORIGINAL']:case _0x5dc8af['SR_DE_FISH_PTZ_CEILING']:case _0x5dc8af['SR_DE_FISH_PTZ_FLOOR']:case _0x5dc8af['SR_DE_FISH_PTZ_WALL']:case _0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_360']:case _0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_180']:case _0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_360']:case _0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_180']:case _0x5dc8af['SR_DE_FISH_PANORAMA_WALL']:return _0x2ffc1c['SR_OK'];case _0x5dc8af['SR_DE_FISH_SEMISPHERE']:if(this['pCamera']=new _0x2c1c95(),null==this['pCamera'])return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];this['pCamera']['SetFov'](_0x22bf32),this['pCamera']['SetNear'](0.02),this['pCamera']['SetFar'](0x3e8),this['fRotateX']=4.71,this['pCamera']['SetPitch'](3.14-this['fRotateX']),this['fScale']=0x3,this['pCamera']['SetScale'](this['fScale']);break;case _0x5dc8af['SR_DE_PANORAMA_SPHERE']:if(this['pCamera']=new _0x2c1c95(),null==this['pCamera'])return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];this['pCamera']['SetFov'](_0x22bf32),this['pCamera']['SetNear'](0.02),this['pCamera']['SetFar'](0x3e8),this['fRotateX']=0x0,this['pCamera']['SetPitch'](3.14-this['fRotateX']),this['fScale']=0x0,this['pCamera']['SetScale'](this['fScale']);break;case _0x5dc8af['SR_DE_FISH_CYLINDER_CEILING']:case _0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']:if(this['pCamera']=new _0x2c1c95(),null==this['pCamera'])return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];this['pCamera']['SetFov'](_0x22bf32),this['pCamera']['SetNear'](0.02),this['pCamera']['SetFar'](0x3e8),this['fRotateX']=0.785,this['pCamera']['SetPitch'](-this['fRotateX']),this['fScale']=0x6,this['pCamera']['SetScale'](this['fScale']);break;case _0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_CEILING']:case _0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR']:if(this['pCamera']=new _0x2c1c95(),null==this['pCamera'])return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];this['pCamera']['SetOrtho'](!0x0),this['pCamera']['SetNear'](0.02),this['pCamera']['SetFar'](0x3e8),this['fScale']=0x3,this['pCamera']['SetScale'](this['fScale']);break;case _0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']:case _0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']:if(this['pCamera']=new _0x2c1c95(),null==this['pCamera'])return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];this['pCamera']['SetFov'](1.25663704),this['pCamera']['SetNear'](0.02),this['pCamera']['SetFar'](0x3e8),this['fScale']=0x2,this['pCamera']['SetScale'](this['fScale']),_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']==_0x58ef65?(this['fRotateLimitX']=0.17453292222222222,this['fRotateLimitY']=1.0471975333333334):(this['fRotateLimitX']=0.5235987666666667,this['fRotateLimitY']=0.34906584444444444);break;case _0x5dc8af['SR_DE_FISH_PLANET']:if(this['pCamera']=new _0x2b90ab(),null==this['pCamera'])return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];this['pCamera']['SetFov'](2.16),this['pCamera']['SetNear'](0.02),this['pCamera']['SetFar'](0x3e8),this['fRotateX']=1.57,this['pCamera']['SetPitch'](this['fRotateX']),this['pCamera']['SetYaw'](_0x238eca+this['fRotateY']),this['fScale']=0x1,this['pCamera']['SetScale'](this['fScale']);break;case _0x5dc8af['SR_DE_PANORAMA_PLANET']:if(this['pCamera']=new _0x2b90ab(),null==this['pCamera'])return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];this['pCamera']['SetPano'](!0x0),this['pCamera']['SetNear'](0.02),this['pCamera']['SetFar'](0x3e8),this['fRotateX']=1.57,this['pCamera']['SetPitch'](this['fRotateX']),this['fRotateY']=-1.57,this['pCamera']['SetYaw'](_0x238eca+this['fRotateY']),this['fScale']=2.6,this['pCamera']['SetScale'](this['fScale']);break;default:return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}return _0x2ffc1c['SR_OK'];}},{'key':'CompileProgram','value':function(_0x594a76,_0x4dd7a1){var _0x2bf6fb=this['ctx'];if(null==_0x2bf6fb||null==_0x594a76||null==_0x4dd7a1)return-0x1;var _0x1aeeee=_0x2bf6fb['createShader'](_0x2bf6fb['VERTEX_SHADER']);if(_0x2bf6fb['shaderSource'](_0x1aeeee,_0x594a76),_0x2bf6fb['compileShader'](_0x1aeeee),!_0x2bf6fb['getShaderParameter'](_0x1aeeee,_0x2bf6fb['COMPILE_STATUS']))return-0x1;var _0x7d550f=_0x2bf6fb['createShader'](_0x2bf6fb['FRAGMENT_SHADER']);if(_0x2bf6fb['shaderSource'](_0x7d550f,_0x4dd7a1),_0x2bf6fb['compileShader'](_0x7d550f),!_0x2bf6fb['getShaderParameter'](_0x7d550f,_0x2bf6fb['COMPILE_STATUS']))return-0x1;var _0x2a7501=_0x2bf6fb['createProgram']();return _0x2bf6fb['attachShader'](_0x2a7501,_0x1aeeee),_0x2bf6fb['attachShader'](_0x2a7501,_0x7d550f),_0x2bf6fb['linkProgram'](_0x2a7501),_0x2bf6fb['getProgramParameter'](_0x2a7501,_0x2bf6fb['LINK_STATUS'])?(_0x2bf6fb['deleteShader'](_0x1aeeee),_0x2bf6fb['deleteShader'](_0x7d550f),_0x2a7501):-0x1;}},{'key':'_CreateSemiSphere','value':function(_0x3fd727,_0x3344fd,_0x59be8a,_0x52aa31){if(null!=this['pSemiSpherePos']||null!=this['pSemiSphereTex'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];this['pSemiSpherePos']=new Float32Array(0xa8c0),this['pSemiSphereTex']=new Float32Array(0x7080);for(var _0x110927=(_0x3344fd-_0x3fd727)/(_0x52aa31-_0x59be8a),_0x34b5ed=(_0x3344fd-_0x3fd727)/0x2*0x1,_0x4bf889=6.2831852/0x3c,_0x5779df=0.0392699075,_0x1a7c8a=0x0,_0x4d4a45=0x0,_0xdcd8e5=0x0,_0x15cefe=0x0;_0x15cefe<0x3c;++_0x15cefe)for(var _0x1561bb=0x0;_0x1561bb<0x28;++_0x1561bb){var _0x1a6f70=_0x15cefe*_0x4bf889;0x0==_0x15cefe&&(_0x1a7c8a=_0x1a6f70);var _0x3d5773=0x3b==_0x15cefe?_0x1a7c8a:(_0x15cefe+0x1)*_0x4bf889,_0x11a77e=-_0x1561bb*_0x5779df,_0x296907=-(_0x1561bb+0x1)*_0x5779df,_0x2c70fd=void 0x0,_0x1a2a20=void 0x0;this['pSemiSpherePos'][_0x4d4a45]=-0x1*Math['cos'](_0x11a77e)*Math['cos'](_0x1a6f70),this['pSemiSpherePos'][_0x4d4a45+0x1]=0x1*Math['sin'](_0x11a77e),this['pSemiSpherePos'][_0x4d4a45+0x2]=-0x1*Math['cos'](_0x11a77e)*Math['sin'](_0x1a6f70),_0x1a2a20=0.5-0.5*(0x1+_0x11a77e/1.5707963)*Math['sin'](_0x1a6f70),_0x2c70fd=0.5-0.5*(0x1+_0x11a77e/1.5707963)*Math['cos'](_0x1a6f70),this['pSemiSphereTex'][_0xdcd8e5++]=(0x2*_0x2c70fd*_0x34b5ed+0x1*_0x3fd727)/0x1,this['pSemiSphereTex'][_0xdcd8e5++]=(0x2*_0x1a2a20*_0x34b5ed+_0x59be8a*_0x110927)/_0x110927,_0x4d4a45+=0x3,this['pSemiSpherePos'][_0x4d4a45]=-0x1*Math['cos'](_0x296907)*Math['cos'](_0x1a6f70),this['pSemiSpherePos'][_0x4d4a45+0x1]=0x1*Math['sin'](_0x296907),this['pSemiSpherePos'][_0x4d4a45+0x2]=-0x1*Math['cos'](_0x296907)*Math['sin'](_0x1a6f70),_0x1a2a20=0.5-0.5*(0x1+_0x296907/1.5707963)*Math['sin'](_0x1a6f70),_0x2c70fd=0.5-0.5*(0x1+_0x296907/1.5707963)*Math['cos'](_0x1a6f70),this['pSemiSphereTex'][_0xdcd8e5++]=(0x2*_0x2c70fd*_0x34b5ed+0x1*_0x3fd727)/0x1,this['pSemiSphereTex'][_0xdcd8e5++]=(0x2*_0x1a2a20*_0x34b5ed+_0x59be8a*_0x110927)/_0x110927,_0x4d4a45+=0x3,this['pSemiSpherePos'][_0x4d4a45]=-0x1*Math['cos'](_0x11a77e)*Math['cos'](_0x3d5773),this['pSemiSpherePos'][_0x4d4a45+0x1]=0x1*Math['sin'](_0x11a77e),this['pSemiSpherePos'][_0x4d4a45+0x2]=-0x1*Math['cos'](_0x11a77e)*Math['sin'](_0x3d5773),_0x1a2a20=0.5-0.5*(0x1+_0x11a77e/1.5707963)*Math['sin'](_0x3d5773),_0x2c70fd=0.5-0.5*(0x1+_0x11a77e/1.5707963)*Math['cos'](_0x3d5773),this['pSemiSphereTex'][_0xdcd8e5++]=(0x2*_0x2c70fd*_0x34b5ed+0x1*_0x3fd727)/0x1,this['pSemiSphereTex'][_0xdcd8e5++]=(0x2*_0x1a2a20*_0x34b5ed+_0x59be8a*_0x110927)/_0x110927,_0x4d4a45+=0x3,this['pSemiSpherePos'][_0x4d4a45]=-0x1*Math['cos'](_0x11a77e)*Math['cos'](_0x3d5773),this['pSemiSpherePos'][_0x4d4a45+0x1]=0x1*Math['sin'](_0x11a77e),this['pSemiSpherePos'][_0x4d4a45+0x2]=-0x1*Math['cos'](_0x11a77e)*Math['sin'](_0x3d5773),_0x1a2a20=0.5-0.5*(0x1+_0x11a77e/1.5707963)*Math['sin'](_0x3d5773),_0x2c70fd=0.5-0.5*(0x1+_0x11a77e/1.5707963)*Math['cos'](_0x3d5773),this['pSemiSphereTex'][_0xdcd8e5++]=(0x2*_0x2c70fd*_0x34b5ed+0x1*_0x3fd727)/0x1,this['pSemiSphereTex'][_0xdcd8e5++]=(0x2*_0x1a2a20*_0x34b5ed+_0x59be8a*_0x110927)/_0x110927,_0x4d4a45+=0x3,this['pSemiSpherePos'][_0x4d4a45]=-0x1*Math['cos'](_0x296907)*Math['cos'](_0x1a6f70),this['pSemiSpherePos'][_0x4d4a45+0x1]=0x1*Math['sin'](_0x296907),this['pSemiSpherePos'][_0x4d4a45+0x2]=-0x1*Math['cos'](_0x296907)*Math['sin'](_0x1a6f70),_0x1a2a20=0.5-0.5*(0x1+_0x296907/1.5707963)*Math['sin'](_0x1a6f70),_0x2c70fd=0.5-0.5*(0x1+_0x296907/1.5707963)*Math['cos'](_0x1a6f70),this['pSemiSphereTex'][_0xdcd8e5++]=(0x2*_0x2c70fd*_0x34b5ed+0x1*_0x3fd727)/0x1,this['pSemiSphereTex'][_0xdcd8e5++]=(0x2*_0x1a2a20*_0x34b5ed+_0x59be8a*_0x110927)/_0x110927,_0x4d4a45+=0x3,this['pSemiSpherePos'][_0x4d4a45]=-0x1*Math['cos'](_0x296907)*Math['cos'](_0x3d5773),this['pSemiSpherePos'][_0x4d4a45+0x1]=0x1*Math['sin'](_0x296907),this['pSemiSpherePos'][_0x4d4a45+0x2]=-0x1*Math['cos'](_0x296907)*Math['sin'](_0x3d5773),_0x1a2a20=0.5-0.5*(0x1+_0x296907/1.5707963)*Math['sin'](_0x3d5773),_0x2c70fd=0.5-0.5*(0x1+_0x296907/1.5707963)*Math['cos'](_0x3d5773),this['pSemiSphereTex'][_0xdcd8e5++]=(0x2*_0x2c70fd*_0x34b5ed+0x1*_0x3fd727)/0x1,this['pSemiSphereTex'][_0xdcd8e5++]=(0x2*_0x1a2a20*_0x34b5ed+_0x59be8a*_0x110927)/_0x110927,_0x4d4a45+=0x3;}return this['nSemiSpherePosNum']=_0x4d4a45/0x3,this['nSemiSpherePosSize']=0x3,this['nSemiSphereTexSize']=0x2,_0x2ffc1c['SR_OK'];}},{'key':'_CreateSphere','value':function(){if(null!=this['pSpherePos']||null!=this['pSphereTex'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];this['pSpherePos']=new Float32Array(0x1e7b),this['pSphereTex']=new Float32Array(0x1452),this['pSphereInd']=new Uint16Array(0x3a98);for(var _0x42d718=0x0,_0x4dfe14=0x0,_0x588fd3=0x0;_0x588fd3<=0x32;++_0x588fd3)for(var _0x165dfb=_0x588fd3*_0x238eca/0x32-1.5707963,_0x23debd=Math['sin'](_0x165dfb),_0x35026b=Math['cos'](_0x165dfb),_0x216dc5=0x0;_0x216dc5<=0x32;++_0x216dc5){var _0xa96e63=0x2*_0x216dc5*_0x238eca/0x32-_0x238eca,_0x33cb88=Math['sin'](_0xa96e63),_0x4df524=0x1*_0x35026b*Math['cos'](_0xa96e63),_0x115d0f=0x1*_0x23debd,_0x2c55d2=0x1*_0x35026b*_0x33cb88;this['pSpherePos'][_0x42d718]=-_0x4df524,this['pSpherePos'][_0x42d718+0x1]=_0x115d0f,this['pSpherePos'][_0x42d718+0x2]=_0x2c55d2;var _0x5107b0=_0x216dc5/0x32,_0x3a0d46=_0x588fd3/0x32;this['pSphereTex'][_0x4dfe14++]=_0x5107b0,this['pSphereTex'][_0x4dfe14++]=_0x3a0d46,_0x42d718+=0x3;}for(var _0x5bdf7d=0x0,_0x28e129=0x0;_0x28e129<0x32;++_0x28e129)for(var _0x1a4802=0x0;_0x1a4802<0x32;++_0x1a4802){var _0x1ca0b0=0x33*_0x28e129+_0x1a4802,_0x631161=_0x1ca0b0+0x32+0x1;this['pSphereInd'][_0x5bdf7d+0x0]=_0x1ca0b0,this['pSphereInd'][_0x5bdf7d+0x1]=_0x631161,this['pSphereInd'][_0x5bdf7d+0x2]=_0x1ca0b0+0x1,this['pSphereInd'][_0x5bdf7d+0x3]=_0x631161,this['pSphereInd'][_0x5bdf7d+0x4]=_0x631161+0x1,this['pSphereInd'][_0x5bdf7d+0x5]=_0x1ca0b0+0x1,_0x5bdf7d+=0x6;}return this['nSpherePosNum']=0x9c4,this['nSpherePosSize']=0x3,this['nSphereTexSize']=0x2,_0x2ffc1c['SR_OK'];}},{'key':'_CreateCylinder','value':function(_0x447b9c,_0x1fa41f,_0x3d7fb5,_0x54c204,_0x42f84a,_0x2302f6,_0xd88ee7){if(null!=this['pCylinderPos']||null!=this['pCylinderTex'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(Math['abs'](_0x2302f6-0x0)<0.000001)this['fCylinderHeight']=0x2;else{if(_0x2302f6<0.5||_0x2302f6>0x6)return _0x2ffc1c['SR_ERR_PARAM'];this['fCylinderHeight']=_0x2302f6;}if(Math['abs'](_0xd88ee7-0x0)<0.000001)_0x447b9c==_0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']||_0x447b9c==_0x5dc8af['SR_DE_FISH_CYLINDER_CEILING']?this['fCylinderRadius']=0x2:this['fCylinderRadius']=0x1;else{if(_0xd88ee7<0.5||_0xd88ee7>0x4)return _0x2ffc1c['SR_ERR_PARAM'];this['fCylinderRadius']=_0xd88ee7;}if(this['pCylinderPos']=new Float32Array(0xa8c0),this['pCylinderTex']=new Float32Array(0x7080),null==this['pCylinderPos']||null==this['pCylinderTex'])return this['pCylinderPos']=null,this['pCylinderTex']=null,_0x2ffc1c['SR_ERR_ALLOC_MEMORY'];for(var _0x5d92a7=(_0x3d7fb5-_0x1fa41f)/(_0x42f84a-_0x54c204),_0x33d5cd=(_0x3d7fb5-_0x1fa41f)/0x2*0x1,_0x14e46a=6.2831852/0x3c,_0x364e86=this['fCylinderHeight']/0x28,_0x46bed3=0x0,_0xcbeb02=0x0,_0x3432e6=0x0;_0x3432e6<0x3c;++_0x3432e6)for(var _0x3f67dd=0x0;_0x3f67dd<0x28;++_0x3f67dd){var _0x4817e3=_0x3432e6*_0x14e46a,_0x2407b4=(_0x3432e6+0x1)*_0x14e46a,_0x2273d7=void 0x0,_0x30b35e=void 0x0;this['pCylinderPos'][_0x46bed3]=-this['fCylinderRadius']*Math['sin'](_0x4817e3),this['pCylinderPos'][_0x46bed3+0x1]=this['fCylinderHeight']/0x2-_0x3f67dd*_0x364e86,this['pCylinderPos'][_0x46bed3+0x2]=-this['fCylinderRadius']*Math['cos'](_0x4817e3),_0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']==_0x447b9c||_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR']==_0x447b9c?(_0x2273d7=0.5+(0.1+0.01*_0x3f67dd)*Math['sin'](_0x4817e3),_0x30b35e=0.5+(0.1+0.01*_0x3f67dd)*Math['cos'](_0x4817e3)):(_0x2273d7=0.5-(0.5-0.01*_0x3f67dd)*Math['sin'](_0x4817e3),_0x30b35e=0.5+(0.5-0.01*_0x3f67dd)*Math['cos'](_0x4817e3)),this['pCylinderTex'][_0xcbeb02++]=(0x2*_0x2273d7*_0x33d5cd+0x1*_0x1fa41f)/0x1,this['pCylinderTex'][_0xcbeb02++]=(0x2*_0x30b35e*_0x33d5cd+_0x54c204*_0x5d92a7)/_0x5d92a7,_0x46bed3+=0x3,this['pCylinderPos'][_0x46bed3]=-this['fCylinderRadius']*Math['sin'](_0x4817e3),this['pCylinderPos'][_0x46bed3+0x1]=this['fCylinderHeight']/0x2-(_0x3f67dd+0x1)*_0x364e86,this['pCylinderPos'][_0x46bed3+0x2]=-this['fCylinderRadius']*Math['cos'](_0x4817e3),_0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']==_0x447b9c||_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR']==_0x447b9c?(_0x2273d7=0.5+(0.1+0.01*(_0x3f67dd+0x1))*Math['sin'](_0x4817e3),_0x30b35e=0.5+(0.1+0.01*(_0x3f67dd+0x1))*Math['cos'](_0x4817e3)):(_0x2273d7=0.5-(0.5-0.01*(_0x3f67dd+0x1))*Math['sin'](_0x4817e3),_0x30b35e=0.5+(0.5-0.01*(_0x3f67dd+0x1))*Math['cos'](_0x4817e3)),this['pCylinderTex'][_0xcbeb02++]=(0x2*_0x2273d7*_0x33d5cd+0x1*_0x1fa41f)/0x1,this['pCylinderTex'][_0xcbeb02++]=(0x2*_0x30b35e*_0x33d5cd+_0x54c204*_0x5d92a7)/_0x5d92a7,_0x46bed3+=0x3,this['pCylinderPos'][_0x46bed3]=-this['fCylinderRadius']*Math['sin'](_0x2407b4),this['pCylinderPos'][_0x46bed3+0x1]=this['fCylinderHeight']/0x2-_0x3f67dd*_0x364e86,this['pCylinderPos'][_0x46bed3+0x2]=-this['fCylinderRadius']*Math['cos'](_0x2407b4),_0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']==_0x447b9c||_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR']==_0x447b9c?(_0x2273d7=0.5+(0.1+0.01*_0x3f67dd)*Math['sin'](_0x2407b4),_0x30b35e=0.5+(0.1+0.01*_0x3f67dd)*Math['cos'](_0x2407b4)):(_0x2273d7=0.5-(0.5-0.01*_0x3f67dd)*Math['sin'](_0x2407b4),_0x30b35e=0.5+(0.5-0.01*_0x3f67dd)*Math['cos'](_0x2407b4)),this['pCylinderTex'][_0xcbeb02++]=(0x2*_0x2273d7*_0x33d5cd+0x1*_0x1fa41f)/0x1,this['pCylinderTex'][_0xcbeb02++]=(0x2*_0x30b35e*_0x33d5cd+_0x54c204*_0x5d92a7)/_0x5d92a7,_0x46bed3+=0x3,this['pCylinderPos'][_0x46bed3]=-this['fCylinderRadius']*Math['sin'](_0x2407b4),this['pCylinderPos'][_0x46bed3+0x1]=this['fCylinderHeight']/0x2-_0x3f67dd*_0x364e86,this['pCylinderPos'][_0x46bed3+0x2]=-this['fCylinderRadius']*Math['cos'](_0x2407b4),_0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']==_0x447b9c||_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR']==_0x447b9c?(_0x2273d7=0.5+(0.1+0.01*_0x3f67dd)*Math['sin'](_0x2407b4),_0x30b35e=0.5+(0.1+0.01*_0x3f67dd)*Math['cos'](_0x2407b4)):(_0x2273d7=0.5-(0.5-0.01*_0x3f67dd)*Math['sin'](_0x2407b4),_0x30b35e=0.5+(0.5-0.01*_0x3f67dd)*Math['cos'](_0x2407b4)),this['pCylinderTex'][_0xcbeb02++]=(0x2*_0x2273d7*_0x33d5cd+0x1*_0x1fa41f)/0x1,this['pCylinderTex'][_0xcbeb02++]=(0x2*_0x30b35e*_0x33d5cd+_0x54c204*_0x5d92a7)/_0x5d92a7,_0x46bed3+=0x3,this['pCylinderPos'][_0x46bed3]=-this['fCylinderRadius']*Math['sin'](_0x4817e3),this['pCylinderPos'][_0x46bed3+0x1]=this['fCylinderHeight']/0x2-(_0x3f67dd+0x1)*_0x364e86,this['pCylinderPos'][_0x46bed3+0x2]=-this['fCylinderRadius']*Math['cos'](_0x4817e3),_0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']==_0x447b9c||_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR']==_0x447b9c?(_0x2273d7=0.5+(0.1+0.01*(_0x3f67dd+0x1))*Math['sin'](_0x4817e3),_0x30b35e=0.5+(0.1+0.01*(_0x3f67dd+0x1))*Math['cos'](_0x4817e3)):(_0x2273d7=0.5-(0.5-0.01*(_0x3f67dd+0x1))*Math['sin'](_0x4817e3),_0x30b35e=0.5+(0.5-0.01*(_0x3f67dd+0x1))*Math['cos'](_0x4817e3)),this['pCylinderTex'][_0xcbeb02++]=(0x2*_0x2273d7*_0x33d5cd+0x1*_0x1fa41f)/0x1,this['pCylinderTex'][_0xcbeb02++]=(0x2*_0x30b35e*_0x33d5cd+_0x54c204*_0x5d92a7)/_0x5d92a7,_0x46bed3+=0x3,this['pCylinderPos'][_0x46bed3]=-this['fCylinderRadius']*Math['sin'](_0x2407b4),this['pCylinderPos'][_0x46bed3+0x1]=this['fCylinderHeight']/0x2-(_0x3f67dd+0x1)*_0x364e86,this['pCylinderPos'][_0x46bed3+0x2]=-this['fCylinderRadius']*Math['cos'](_0x2407b4),_0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']==_0x447b9c||_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR']==_0x447b9c?(_0x2273d7=0.5+(0.1+0.01*(_0x3f67dd+0x1))*Math['sin'](_0x2407b4),_0x30b35e=0.5+(0.1+0.01*(_0x3f67dd+0x1))*Math['cos'](_0x2407b4)):(_0x2273d7=0.5-(0.5-0.01*(_0x3f67dd+0x1))*Math['sin'](_0x2407b4),_0x30b35e=0.5+(0.5-0.01*(_0x3f67dd+0x1))*Math['cos'](_0x2407b4)),this['pCylinderTex'][_0xcbeb02++]=(0x2*_0x2273d7*_0x33d5cd+0x1*_0x1fa41f)/0x1,this['pCylinderTex'][_0xcbeb02++]=(0x2*_0x30b35e*_0x33d5cd+_0x54c204*_0x5d92a7)/_0x5d92a7,_0x46bed3+=0x3;}return this['nCylinderPosNum']=_0x46bed3/0x3,this['nCylinderPosSize']=0x3,this['nCylinderTexSize']=0x2,_0x2ffc1c['SR_OK'];}},{'key':'_CreateArcSphere','value':function(_0x19256f,_0xbca3ac,_0x315f2d,_0x31ac75,_0xd9c9ef){if(null!=this['pArcSpherePos']||null!=this['pArcSphereTex'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']){if(_0x31ac75>0x0||_0xd9c9ef<0x1)return _0x2ffc1c['SR_ERR_PARAM'];}else{if(_0x19256f!=_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL'])return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];if(_0xbca3ac>0x0||_0x315f2d<0x1)return _0x2ffc1c['SR_ERR_PARAM'];}this['fImageWidth']=0x1,this['fImageHeight']=(_0x315f2d-_0xbca3ac)/(_0xd9c9ef-_0x31ac75),this['fTexCenterX']=(_0xbca3ac+_0x315f2d)/0x2*this['fImageWidth'],this['fTexCenterY']=(_0x31ac75+_0xd9c9ef)/0x2*this['fImageHeight'],this['fTexRadius']=(_0x315f2d-_0xbca3ac)/0x2*this['fImageWidth'];if(null==this['pArcSphereTex']&&(this['pArcSphereTex']=new Float32Array(0x3960),null==this['pArcSphereTex']))return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];if(null==this['pArcSpherePos']&&(this['pArcSpherePos']=new Float32Array(0x5610),null==this['pArcSpherePos']))return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];var _0x258cdb=new Float32Array(0x40);if(null==_0x258cdb)return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];var _0x19870a=_0x2ffc1c['SR_OK'];if(_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']?_0x19870a=this['_ComputeLatitudeHorizontal'](_0x258cdb,0x19,0x28,0x1):_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']&&(_0x19870a=this['_ComputeLatitudeVertical'](_0x258cdb,0x19,0x28,0x1)),_0x2ffc1c['SR_OK']!=_0x19870a)return this['pArcSpherePos']=null,this['pArcSphereTex']=null,_0x19870a;this['fFirstLatitude']=_0x258cdb[0xc],this['fLastLatitude']=_0x258cdb[0x33];var _0x1b65ad=0x0,_0x462d87=0x0,_0x4a593a=new Float32Array(0x5);if(null==_0x4a593a)return this['pArcSpherePos']=null,this['pArcSphereTex']=null,_0x2ffc1c['SR_ERR_ALLOC_MEMORY'];for(var _0x4e7ac0=_0x238eca/0x18,_0x3920bb=-0xc;_0x3920bb<0xc;++_0x3920bb)for(var _0x3ac970=_0x3920bb<0x0?-_0x3920bb:_0x3920bb,_0x4804a0=_0x3920bb<0x0?_0x3ac970:_0x3ac970+0x1,_0x50f9b8=_0x3920bb<0x0?0x40-0x2*(_0x3ac970-0x1)-0x2:0x40-0x2*_0x3ac970-0x2,_0x147423=0x0;_0x147423<_0x50f9b8;++_0x147423,++_0x4804a0)_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']?this['_ComputeVertexAndTexturePosHorizontal'](0x1,1.5707963-_0x4e7ac0*_0x3920bb,_0x258cdb[_0x4804a0],_0x4a593a):_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']&&this['_ComputeVertexAndTexturePosVertical'](0x1,1.5707963-_0x4e7ac0*_0x3920bb,_0x258cdb[_0x4804a0],_0x4a593a),this['pArcSpherePos'][_0x1b65ad]=_0x4a593a[0x0],this['pArcSpherePos'][_0x1b65ad+0x1]=_0x4a593a[0x1],this['pArcSpherePos'][_0x1b65ad+0x2]=_0x4a593a[0x2],this['pArcSphereTex'][_0x462d87++]=_0x4a593a[0x3],this['pArcSphereTex'][_0x462d87++]=_0x4a593a[0x4],_0x1b65ad+=0x3,_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']?this['_ComputeVertexAndTexturePosHorizontal'](0x1,1.5707963-_0x4e7ac0*(_0x3920bb+0x1),_0x258cdb[_0x4804a0],_0x4a593a):_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']&&this['_ComputeVertexAndTexturePosVertical'](0x1,1.5707963-_0x4e7ac0*(_0x3920bb+0x1),_0x258cdb[_0x4804a0],_0x4a593a),this['pArcSpherePos'][_0x1b65ad]=_0x4a593a[0x0],this['pArcSpherePos'][_0x1b65ad+0x1]=_0x4a593a[0x1],this['pArcSpherePos'][_0x1b65ad+0x2]=_0x4a593a[0x2],this['pArcSphereTex'][_0x462d87++]=_0x4a593a[0x3],this['pArcSphereTex'][_0x462d87++]=_0x4a593a[0x4],_0x1b65ad+=0x3,_0x3920bb>=0x0&&0x0==_0x147423?_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']?this['_ComputeVertexAndTexturePosHorizontal'](0x1,1.5707963-_0x4e7ac0*_0x3920bb,_0x258cdb[_0x4804a0-0x1],_0x4a593a):_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']&&this['_ComputeVertexAndTexturePosVertical'](0x1,1.5707963-_0x4e7ac0*_0x3920bb,_0x258cdb[_0x4804a0-0x1],_0x4a593a):_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']?this['_ComputeVertexAndTexturePosHorizontal'](0x1,1.5707963-_0x4e7ac0*(_0x3920bb+0x1),_0x258cdb[_0x4804a0-0x1],_0x4a593a):_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']&&this['_ComputeVertexAndTexturePosVertical'](0x1,1.5707963-_0x4e7ac0*(_0x3920bb+0x1),_0x258cdb[_0x4804a0-0x1],_0x4a593a),this['pArcSpherePos'][_0x1b65ad]=_0x4a593a[0x0],this['pArcSpherePos'][_0x1b65ad+0x1]=_0x4a593a[0x1],this['pArcSpherePos'][_0x1b65ad+0x2]=_0x4a593a[0x2],this['pArcSphereTex'][_0x462d87++]=_0x4a593a[0x3],this['pArcSphereTex'][_0x462d87++]=_0x4a593a[0x4],_0x1b65ad+=0x3,_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']?this['_ComputeVertexAndTexturePosHorizontal'](0x1,1.5707963-_0x4e7ac0*(_0x3920bb+0x1),_0x258cdb[_0x4804a0],_0x4a593a):_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']&&this['_ComputeVertexAndTexturePosVertical'](0x1,1.5707963-_0x4e7ac0*(_0x3920bb+0x1),_0x258cdb[_0x4804a0],_0x4a593a),this['pArcSpherePos'][_0x1b65ad]=_0x4a593a[0x0],this['pArcSpherePos'][_0x1b65ad+0x1]=_0x4a593a[0x1],this['pArcSpherePos'][_0x1b65ad+0x2]=_0x4a593a[0x2],this['pArcSphereTex'][_0x462d87++]=_0x4a593a[0x3],this['pArcSphereTex'][_0x462d87++]=_0x4a593a[0x4],_0x1b65ad+=0x3,_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']?this['_ComputeVertexAndTexturePosHorizontal'](0x1,1.5707963-_0x4e7ac0*_0x3920bb,_0x258cdb[_0x4804a0],_0x4a593a):_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']&&this['_ComputeVertexAndTexturePosVertical'](0x1,1.5707963-_0x4e7ac0*_0x3920bb,_0x258cdb[_0x4804a0],_0x4a593a),this['pArcSpherePos'][_0x1b65ad]=_0x4a593a[0x0],this['pArcSpherePos'][_0x1b65ad+0x1]=_0x4a593a[0x1],this['pArcSpherePos'][_0x1b65ad+0x2]=_0x4a593a[0x2],this['pArcSphereTex'][_0x462d87++]=_0x4a593a[0x3],this['pArcSphereTex'][_0x462d87++]=_0x4a593a[0x4],_0x1b65ad+=0x3,_0x3920bb<0x0&&_0x147423==_0x50f9b8-0x1?_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']?this['_ComputeVertexAndTexturePosHorizontal'](0x1,1.5707963-_0x4e7ac0*(_0x3920bb+0x1),_0x258cdb[_0x4804a0+0x1],_0x4a593a):_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']&&this['_ComputeVertexAndTexturePosVertical'](0x1,1.5707963-_0x4e7ac0*(_0x3920bb+0x1),_0x258cdb[_0x4804a0+0x1],_0x4a593a):_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']?this['_ComputeVertexAndTexturePosHorizontal'](0x1,1.5707963-_0x4e7ac0*_0x3920bb,_0x258cdb[_0x4804a0+0x1],_0x4a593a):_0x19256f==_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']&&this['_ComputeVertexAndTexturePosVertical'](0x1,1.5707963-_0x4e7ac0*_0x3920bb,_0x258cdb[_0x4804a0+0x1],_0x4a593a),this['pArcSpherePos'][_0x1b65ad]=_0x4a593a[0x0],this['pArcSpherePos'][_0x1b65ad+0x1]=_0x4a593a[0x1],this['pArcSpherePos'][_0x1b65ad+0x2]=_0x4a593a[0x2],this['pArcSphereTex'][_0x462d87++]=_0x4a593a[0x3],this['pArcSphereTex'][_0x462d87++]=_0x4a593a[0x4],_0x1b65ad+=0x3;return this['nArcSpherePosNum']=_0x1b65ad/0x3,this['nArcSpherePosSize']=0x3,this['nArcSphereTexSize']=0x2,_0x258cdb=null,_0x4a593a=null,_0x2ffc1c['SR_OK'];}},{'key':'_ComputeIntersectionOfPlaneAndLongtitude','value':function(_0x3823e6,_0x5b5d70,_0x219c08){if(null==_0x3823e6)return _0x2ffc1c['SR_ERR_PARAM'];var _0xd53f8d,_0x294a44=_0x3823e6[0x1]*_0x219c08,_0x5184f3=_0x3823e6[0x2]*_0x219c08*Math['sin'](_0x5b5d70),_0x368ad6=-_0x3823e6[0x3],_0x5b47b2=0x0;if(_0x3823e6[0x1]>0x0){var _0x3871b6=_0x294a44*_0x294a44*_0x368ad6*_0x368ad6-(_0x294a44*_0x294a44+_0x5184f3*_0x5184f3)*(_0x368ad6*_0x368ad6-_0x5184f3*_0x5184f3);_0x5b47b2=(-_0x294a44*_0x368ad6-Math['sqrt'](_0x3871b6))/(_0x294a44*_0x294a44+_0x5184f3*_0x5184f3),_0x3871b6=_0x5184f3*_0x5184f3*_0x368ad6*_0x368ad6-(_0x294a44*_0x294a44+_0x5184f3*_0x5184f3)*(_0x368ad6*_0x368ad6-_0x294a44*_0x294a44),(-_0x5184f3*_0x368ad6+Math['sqrt'](_0x3871b6))/(_0x294a44*_0x294a44+_0x5184f3*_0x5184f3);}if(_0x3823e6[0x1]<0x0){var _0x51496e=_0x294a44*_0x294a44*_0x368ad6*_0x368ad6-(_0x294a44*_0x294a44+_0x5184f3*_0x5184f3)*(_0x368ad6*_0x368ad6-_0x5184f3*_0x5184f3);_0x5b47b2=(-_0x294a44*_0x368ad6+Math['sqrt'](_0x51496e))/(_0x294a44*_0x294a44+_0x5184f3*_0x5184f3),_0x51496e=_0x5184f3*_0x5184f3*_0x368ad6*_0x368ad6-(_0x294a44*_0x294a44+_0x5184f3*_0x5184f3)*(_0x368ad6*_0x368ad6-_0x294a44*_0x294a44),(-_0x5184f3*_0x368ad6+Math['sqrt'](_0x51496e))/(_0x294a44*_0x294a44+_0x5184f3*_0x5184f3);}return Math['cos'](_0x5b5d70),_0xd53f8d=-_0x219c08*_0x5b47b2,Math['sin'](_0x5b5d70),Math['asin'](_0xd53f8d/_0x219c08);}},{'key':'_ComputeLatitudeHorizontal','value':function(_0x5e0f07,_0x299ca2,_0x3b7b3a,_0x266cf0){if(null==_0x5e0f07)return _0x2ffc1c['SR_ERR_PARAM'];var _0x55cdab=0x0,_0x195fcc=(this['fTexCenterY'],_0x238eca/(_0x299ca2-0x1)),_0x4ef60e=_0x238eca*this['fTexCenterY']/(0x2*this['fTexRadius']),_0xbafcee=Math['asin'](this['fTexCenterY']/this['fTexRadius']),_0x712942=Math['atan'](Math['cos'](_0x4ef60e)/(Math['sin'](_0x4ef60e)-Math['sin'](_0xbafcee))),_0xc2b596=new Float32Array(0x4);_0xc2b596[0x0]=0x0,_0xc2b596[0x1]=Math['sin'](_0x712942),_0xc2b596[0x2]=Math['cos'](_0x712942),_0xc2b596[0x3]=-_0x266cf0*Math['sin'](_0x712942)*Math['sin'](_0xbafcee),_0x5e0f07[_0x55cdab++]=_0x4ef60e;for(var _0x16c678=0x1;_0x16c678<=(_0x299ca2-0x3)/0x2;++_0x16c678){var _0x74ecb0=this['_ComputeIntersectionOfPlaneAndLongtitude'](_0xc2b596,1.5707963-_0x195fcc*_0x16c678,_0x266cf0);_0x5e0f07[_0x55cdab++]=_0x74ecb0;}for(var _0x12fb7f=-Math['asin']((this['fImageHeight']-this['fTexCenterY'])/this['fTexRadius']),_0x3e296e=_0xbafcee,_0xd2ff5e=(_0x3e296e-_0x12fb7f)/(_0x3b7b3a-0x1),_0x417f24=0x0;_0x417f24<_0x3b7b3a;++_0x417f24)_0x5e0f07[_0x55cdab++]=_0x3e296e-_0x417f24*_0xd2ff5e;var _0x4cddac=_0x12fb7f,_0x766121=_0x238eca*(this['fTexCenterY']-this['fImageHeight'])/(0x2*this['fTexRadius']);_0x712942=Math['atan'](Math['cos'](_0x766121)/(Math['sin'](_0x4cddac)-Math['sin'](_0x766121)));var _0x55ed20=new Float32Array(0x4);_0x55ed20[0x0]=0x0,_0x55ed20[0x1]=-Math['sin'](_0x712942),_0x55ed20[0x2]=Math['cos'](_0x712942),_0x55ed20[0x3]=_0x266cf0*Math['sin'](_0x712942)*Math['sin'](_0x4cddac);for(var _0x3aabf7=0x1;_0x3aabf7<=(_0x299ca2-0x3)/0x2;++_0x3aabf7){var _0x47de68=this['_ComputeIntersectionOfPlaneAndLongtitude'](_0x55ed20,_0x195fcc*_0x3aabf7,_0x266cf0);_0x5e0f07[_0x55cdab++]=_0x47de68;}return _0x5e0f07[_0x55cdab++]=_0x766121,_0xc2b596=null,_0x55ed20=null,_0x2ffc1c['SR_OK'];}},{'key':'_ComputeVertexAndTexturePosHorizontal','value':function(_0x38dffc,_0x459c7b,_0x286536,_0x5f071d){if(null==_0x5f071d)return _0x2ffc1c['SR_ERR_PARAM'];_0x5f071d[0x2]=-_0x38dffc*Math['cos'](_0x286536)*Math['sin'](_0x459c7b),_0x5f071d[0x0]=_0x38dffc*Math['cos'](_0x286536)*Math['cos'](_0x459c7b),_0x5f071d[0x1]=_0x38dffc*Math['sin'](_0x286536);var _0x83f272,_0x4cdf5f=-Math['asin'](-_0x5f071d[0x2]/_0x38dffc)/_0x238eca;_0x83f272=_0x286536>=0x0?Math['acos'](_0x5f071d[0x0]/Math['sqrt'](_0x5f071d[0x0]*_0x5f071d[0x0]+_0x5f071d[0x1]*_0x5f071d[0x1])):6.2831852-Math['acos'](_0x5f071d[0x0]/Math['sqrt'](_0x5f071d[0x0]*_0x5f071d[0x0]+_0x5f071d[0x1]*_0x5f071d[0x1]));var _0x46c792=this['fTexCenterX']-this['fTexRadius'],_0x3ab796=this['fTexRadius']-this['fTexCenterY'];return _0x5f071d[0x3]=(Math['cos'](_0x83f272)*this['fTexRadius']*(0x1+0x2*_0x4cdf5f)+this['fTexRadius']+_0x46c792)/this['fImageWidth'],_0x5f071d[0x4]=(Math['sin'](_0x83f272)*this['fTexRadius']*(-0x1-0x2*_0x4cdf5f)+this['fTexRadius']-_0x3ab796)/this['fImageHeight'],_0x2ffc1c['SR_OK'];}},{'key':'_ComputeLatitudeVertical','value':function(_0x50b29f,_0x573e7e,_0x572fde,_0x4c53be){if(null==_0x50b29f)return _0x2ffc1c['SR_ERR_PARAM'];var _0x372d32=0x0,_0x2509bb=_0x238eca/(_0x573e7e-0x1),_0x472b3a=_0x238eca*this['fTexCenterX']/(0x2*this['fTexRadius']),_0x1cb163=Math['asin'](this['fTexCenterX']/this['fTexRadius']),_0x18ce8f=Math['atan'](Math['cos'](_0x472b3a)/(Math['sin'](_0x472b3a)-Math['sin'](_0x1cb163))),_0x4a9b42=new Float32Array(0x4);_0x4a9b42[0x0]=0x0,_0x4a9b42[0x1]=Math['sin'](_0x18ce8f),_0x4a9b42[0x2]=Math['cos'](_0x18ce8f),_0x4a9b42[0x3]=-_0x4c53be*Math['sin'](_0x18ce8f)*Math['sin'](_0x1cb163),_0x50b29f[_0x372d32++]=_0x472b3a;for(var _0x135cf3=0x1;_0x135cf3<=(_0x573e7e-0x3)/0x2;++_0x135cf3){var _0x2742f3=this['_ComputeIntersectionOfPlaneAndLongtitude'](_0x4a9b42,1.5707963-_0x2509bb*_0x135cf3,_0x4c53be);_0x50b29f[_0x372d32++]=_0x2742f3;}for(var _0x5d84c6=-Math['asin']((this['fImageWidth']-this['fTexCenterX'])/this['fTexRadius']),_0x433ba0=_0x1cb163,_0x3cf756=(_0x433ba0-_0x5d84c6)/(_0x572fde-0x1),_0x39581c=0x0;_0x39581c<_0x572fde;++_0x39581c)_0x50b29f[_0x372d32++]=_0x433ba0-_0x39581c*_0x3cf756;var _0x282df0=_0x5d84c6,_0x505e8d=_0x238eca*(this['fTexCenterX']-this['fImageWidth'])/(0x2*this['fTexRadius']);_0x18ce8f=Math['atan'](Math['cos'](_0x505e8d)/(Math['sin'](_0x282df0)-Math['sin'](_0x505e8d)));var _0x254e4c=new Float32Array(0x4);_0x254e4c[0x0]=0x0,_0x254e4c[0x1]=-Math['sin'](_0x18ce8f),_0x254e4c[0x2]=Math['cos'](_0x18ce8f),_0x254e4c[0x3]=_0x4c53be*Math['sin'](_0x18ce8f)*Math['sin'](_0x282df0);for(var _0x18e604=0x1;_0x18e604<=(_0x573e7e-0x3)/0x2;++_0x18e604){var _0x462e0e=this['_ComputeIntersectionOfPlaneAndLongtitude'](_0x254e4c,_0x2509bb*_0x18e604,_0x4c53be);_0x50b29f[_0x372d32++]=_0x462e0e;}return _0x50b29f[_0x372d32++]=_0x505e8d,_0x4a9b42=null,_0x254e4c=null,_0x2ffc1c['SR_OK'];}},{'key':'_ComputeVertexAndTexturePosVertical','value':function(_0x5e5054,_0x58d518,_0x450e36,_0x433a0b){if(null==_0x433a0b)return _0x2ffc1c['SR_ERR_PARAM'];_0x433a0b[0x2]=-_0x5e5054*Math['cos'](_0x450e36)*Math['sin'](_0x58d518),_0x433a0b[0x1]=_0x5e5054*Math['cos'](_0x450e36)*Math['cos'](_0x58d518),_0x433a0b[0x0]=-_0x5e5054*Math['sin'](_0x450e36);var _0x192121,_0x40fde2=-Math['asin'](-_0x433a0b[0x2]/_0x5e5054)/_0x238eca;_0x192121=_0x58d518<=1.5707963?Math['acos'](_0x433a0b[0x0]/Math['sqrt'](_0x433a0b[0x0]*_0x433a0b[0x0]+_0x433a0b[0x1]*_0x433a0b[0x1])):6.2831852-Math['acos'](_0x433a0b[0x0]/Math['sqrt'](_0x433a0b[0x0]*_0x433a0b[0x0]+_0x433a0b[0x1]*_0x433a0b[0x1]));var _0x2978b1=this['fTexCenterX']-this['fTexRadius'],_0x311aa8=this['fTexRadius']-this['fTexCenterY'];return _0x433a0b[0x3]=(Math['cos'](_0x192121)*this['fTexRadius']*(0x1+0x2*_0x40fde2)+this['fTexRadius']+_0x2978b1)/this['fImageWidth'],_0x433a0b[0x4]=(Math['sin'](_0x192121)*this['fTexRadius']*(-0x1-0x2*_0x40fde2)+this['fTexRadius']-_0x311aa8)/this['fImageHeight'],_0x2ffc1c['SR_OK'];}},{'key':'_BeginCapture','value':function(){var _0x37dd71=_0x2ffc1c['SR_OK'];return 0x0==this['bCaptureResInit']&&(_0x37dd71=this['_InitRenderTarget'](this['nWndWidth'],this['nWndHeight'],!0x1,!0x0),_0x2ffc1c['SR_OK']!=_0x37dd71)?_0x37dd71:(_0x37dd71=this['_Resize'](this['nWndWidth'],this['nWndHeight'],!0x1,!0x0),_0x2ffc1c['SR_OK']!=_0x37dd71?_0x37dd71:(this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],this['nCaptureFBO']),this['bIsCapturing']=!0x0,_0x2ffc1c['SR_OK']));}},{'key':'_InitRenderTarget','value':function(_0x5c9cc6,_0xa4f7c,_0x637383,_0x1b0225){if(0x0!=this['nCaptureRTTex']||0x0!=this['nCaptureFBO'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(_0x5c9cc6<=0x0||_0xa4f7c<=0x0)return _0x2ffc1c['SR_ERR_PARAM'];if(this['nCaptureRTTex']=this['ctx']['createTexture'](),this['nCaptureRTTex']<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];if(this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nCaptureRTTex']),this['bAntialias']?this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR_MINMAP_LINEAR']):this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MAG_FILTER'],this['ctx']['LINEAR']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_WRAP_S'],this['ctx']['CLAMP_TO_EDGE']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_WRAP_T'],this['ctx']['CLAMP_TO_EDGE']),this['ctx']['texImage2D'](this['ctx']['TEXTURE_2D'],0x0,this['ctx']['RGBA'],_0x5c9cc6,_0xa4f7c,0x0,this['ctx']['RGBA'],this['ctx']['UNSIGNED_BYTE'],null),0x0==this['nCaptureFBO']&&(this['nCaptureFBO']=this['ctx']['createFramebuffer'](),this['nCaptureFBO']<=0x0))return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];if(this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],this['nCaptureFBO']),this['ctx']['framebufferTexture2D'](this['ctx']['FRAMEBUFFER'],this['ctx']['COLOR_ATTACHMENT0'],this['ctx']['TEXTURE_2D'],this['nCaptureRTTex'],0x0),0x1==_0x1b0225&&0x0==this['nCaptureDepthbuffer']){if(this['nCaptureDepthbuffer']=this['ctx']['createRenderbuffer'](),this['nCaptureDepthbuffer']<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['bindRenderbuffer'](this['ctx']['RENDERBUFFER'],this['nCaptureDepthbuffer']),this['ctx']['renderbufferStorage'](this['ctx']['RENDERBUFFER'],this['ctx']['DEPTH_COMPONENT16'],_0x5c9cc6,_0xa4f7c),this['ctx']['framebufferRenderbuffer'](this['ctx']['FRAMEBUFFER'],this['ctx']['DEPTH_ATTACHMENT'],this['ctx']['RENDERBUFFER'],this['nCaptureDepthbuffer']);}return this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),this['nCaptureFBOWidth']=_0x5c9cc6,this['nCaptureFBOHeight']=_0xa4f7c,this['bCaptureResInit']=!0x0,_0x2ffc1c['SR_OK'];}},{'key':'_Resize','value':function(_0x1c7b87,_0x36f383,_0x170693,_0x56575d){if(this['nCaptureFBOWidth']!=_0x1c7b87||this['nCaptureFBOHeight']!=_0x36f383){if(this['nCaptureFBOWidth']=_0x1c7b87,this['nCaptureFBOHeight']=_0x36f383,0x0!=this['nCaptureRTTex']&&(this['ctx']['deleteTexture'](this['nCaptureRTTex']),this['nCaptureRTTex']=0x0),0x0!=this['nCaptureDepthbuffer']&&(this['ctx']['deleteRenderbuffer'](this['nCaptureDepthbuffer']),this['nCaptureDepthbuffer']=0x0),0x0==this['nCaptureRTTex']&&(this['nCaptureRTTex']=this['ctx']['createTexture'](),this['nCaptureRTTex']<=0x0))return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];if(this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nCaptureRTTex']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MAG_FILTER'],this['ctx']['LINEAR']),this['bAntialias']?this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR_MINMAP_LINEAR']):this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_WRAP_S'],this['ctx']['CLAMP_TO_EDGE']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_WRAP_T'],this['ctx']['CLAMP_TO_EDGE']),this['ctx']['texImage2D'](this['ctx']['TEXTURE_2D'],0x0,this['ctx']['RGBA'],this['nCaptureFBOWidth'],this['nCaptureFBOHeight'],0x0,this['ctx']['RGBA'],this['ctx']['UNSIGNED_BYTE'],null),this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],this['nCaptureFBO']),this['ctx']['framebufferTexture2D'](this['ctx']['FRAMEBUFFER'],this['ctx']['COLOR_ATTACHMENT0'],this['ctx']['TEXTURE_2D'],this['nCaptureRTTex'],0x0),0x1==_0x56575d&&0x0==this['nCaptureDepthbuffer']){if(this['nCaptureDepthbuffer']=this['ctx']['createRenderbuffer'](),this['nCaptureDepthbuffer']<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['bindRenderbuffer'](this['ctx']['RENDERBUFFER'],this['nCaptureDepthbuffer']),this['ctx']['renderbufferStorage'](this['ctx']['RENDERBUFFER'],this['ctx']['DEPTH_COMPONENT16'],_0x1c7b87,_0x36f383),this['ctx']['framebufferRenderbuffer'](this['ctx']['FRAMEBUFFER'],this['ctx']['DEPTH_ATTACHMENT'],this['ctx']['RENDERBUFFER'],this['nCaptureDepthbuffer']);}this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null);}return _0x2ffc1c['SR_OK'];}},{'key':'_EndCapture','value':function(_0x5a41d7){return null==this['ctx']?(this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_CALL_ORDER']):null==_0x5a41d7['pBuffer']||null==_0x5a41d7['pBuffer']?(this['bIsCapturing']=!0x1,this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),_0x2ffc1c['SR_ERR_PARAM']):(this['ctx']['readPixels'](0x0,0x0,this['nCaptureWidth'],this['nCaptureHeight'],this['ctx']['RGBA'],this['ctx']['UNSIGNED_BYTE'],_0x5a41d7['pBuffer']),this['ctx']['bindFramebuffer'](this['ctx']['FRAMEBUFFER'],null),this['bIsCapturing']=!0x1,_0x2ffc1c['SR_OK']);}},{'key':'_ComputeRotateLimits','value':function(){if(this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']||this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']){var _0x552138,_0x5e670b;if(this['enDisplayEffect']==_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']?(_0x552138=0.17453292222222222,_0x5e670b=1.0471975333333334):(_0x552138=0.5235987666666667,_0x5e670b=0.34906584444444444),0x0==this['nWndWidth']||0x0==this['nWndHeight'])this['fRotateLimitX']=_0x552138,this['fRotateLimitY']=_0x5e670b;else{var _0x3834ae=Math['tan'](2.748893525);if(Math['abs'](_0x3834ae*this['fScale'])<0x1){var _0x4f98f4=_0x3834ae*_0x3834ae+0x1,_0x2009a1=-0x2*_0x3834ae*_0x3834ae*this['fScale'],_0x589d74=_0x3834ae*_0x3834ae*this['fScale']*this['fScale']-0x1,_0x1ceb85=(-_0x2009a1-Math['sqrt'](_0x2009a1*_0x2009a1-0x4*_0x4f98f4*_0x589d74))/(0x2*_0x4f98f4),_0x4a3819=_0x3834ae*(_0x1ceb85-this['fScale']);this['fRotateLimitX']=Math['acos'](_0x4a3819/Math['sqrt'](_0x1ceb85*_0x1ceb85+_0x4a3819*_0x4a3819)),this['fRotateLimitX']<_0x552138&&(this['fRotateLimitX']=_0x552138);}else this['fRotateLimitX']=_0x552138;var _0x201fef=Math['atan'](this['nWndWidth']/this['nWndHeight']*Math['tan'](_0x22bf32/0x2));if(_0x3834ae=Math['tan'](_0x238eca-_0x201fef),Math['abs'](_0x3834ae*this['fScale'])<0x1){var _0x1646ad=_0x3834ae*_0x3834ae+0x1,_0x38b88a=-0x2*_0x3834ae*_0x3834ae*this['fScale'],_0x220e42=_0x3834ae*_0x3834ae*this['fScale']*this['fScale']-0x1,_0x22c465=(-_0x38b88a-Math['sqrt'](_0x38b88a*_0x38b88a-0x4*_0x1646ad*_0x220e42))/(0x2*_0x1646ad),_0x4f20b4=_0x3834ae*(_0x22c465-this['fScale']);this['fRotateLimitY']=Math['acos'](_0x4f20b4/Math['sqrt'](_0x22c465*_0x22c465+_0x4f20b4*_0x4f20b4)),this['fRotateLimitY']<_0x5e670b&&(this['fRotateLimitY']=_0x5e670b);}else this['fRotateLimitY']=_0x5e670b;}this['fRotateX']>this['fRotateLimitX']&&(this['fRotateX']=this['fRotateLimitX']),this['fRotateX']<-this['fRotateLimitX']&&(this['fRotateX']=-this['fRotateLimitX']),this['fRotateY']>this['fRotateLimitY']&&(this['fRotateY']=this['fRotateLimitX']),this['fRotateY']<-this['fRotateLimitX']&&(this['fRotateY']=-this['fRotateLimitX']);}return _0x2ffc1c['SR_OK'];}},{'key':'SetMSAACache','value':function(_0x3cd7bd,_0x467741){return this['msaaFrameBuffer']=_0x3cd7bd,this['renderBuffer']=_0x467741,_0x2ffc1c['SR_OK'];}}]),_0x51185b;}()),_0x51973c=(function(){function _0x584326(){_0x1d5976(this,_0x584326),this['canvas']=null,this['ctx']=null,this['pFrameData']=null,this['frameDisplayWidth']=0x0,this['frameDisplayHeight']=0x0,this['onlySupportedWebGL1']=!0x1,this['bAntialias']=!0x1,this['bAntialiasStateNeedChange']=!0x1,this['bRecreateTex']=!0x0,this['nSurfaceTexture']=[],this['nSurfaceTexture'][0x0]=0x0,this['nSurfaceTexture'][0x1]=0x0,this['nSurfaceTexture'][0x2]=0x0,this['bOpenMsaa']=!0x1,this['nMsaaFBO']=0x0,this['nResolveFBO']=0x0,this['nMsaaColorBuffer']=0x0,this['nResolveTexture']=0x0,this['nMsaaSample']=0x0,this['pFishParamManager']=null,this['enDisplayEffect']=_0x5dc8af['SR_DE_NULL'],this['nFECPort']=-0x1,this['enPixelFormat']=_0x444828['SR_PF_NULL'],this['nTextureNum']=0x0,this['nCaptureWidth']=0x0,this['nCaptureHeight']=0x0,this['pSubDisplay']=null,this['nRTWidth']=0x0,this['nRTHeight']=0x0,this['pRenderToTex']=null,this['bRenderToTex']=!0x1,this['b3DPort']=!0x1,this['preDisplayRectnX']=0x0,this['preDisplayRectnY']=0x0,this['preDisplayRectnW']=0x0,this['preDisplayRectnH']=0x0,this['preImageRotateValue']=0x0;}return _0x2d31ab(_0x584326,[{'key':'SR_Init','value':function(_0x45fdd0,_0x3a79cb){if(null==_0x45fdd0)return _0x2ffc1c['SR_ERR_PARAM'];if(this['canvas']=_0x45fdd0,this['ctx']=this['canvas']['getContext']('webgl2'),!this['ctx']){if(this['ctx']=this['canvas']['getContext']('webgl')||this['canvas']['getContext']('experimental-webgl'),!this['ctx'])return _0x2ffc1c['SR_ERR_CANVAS'];this['onlySupportedWebGL1']=!0x0;}if(_0x3a79cb==_0x444828['SR_PF_NV12']||_0x3a79cb==_0x444828['SR_PF_NV21'])return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];switch(_0x3a79cb){case _0x444828['SR_PF_YV12']:case _0x444828['SR_PF_I420']:this['nTextureNum']=0x3;break;case _0x444828['SR_PF_SURFACE']:this['nTextureNum']=0x1;break;default:return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}return this['enPixelFormat']=_0x3a79cb,_0x2ffc1c['SR_OK'];}},{'key':'SR_AddSubPort','value':function(_0x282878){var _0x492cda=-0x1;if(null==this['ctx'])return _0x492cda;if(null!=this['pFishParamManager']?(_0x492cda=this['pFishParamManager']['GetFECPort'](_0x282878),this['b3DPort']=!0x0):_0x282878==_0x5dc8af['SR_DE_NULL']&&(_0x492cda=0x0),-0x1==_0x492cda)return-0x1;this['nFECPort']=_0x492cda;var _0xa7ccff=_0x2ffc1c['SR_OK'];if(null==this['pSubDisplay']&&(this['pSubDisplay']=new _0x5c3dde(),null==this['pSubDisplay']))return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];if((_0xa7ccff=this['pSubDisplay']['SetCanvasSize'](this['canvas']['width'],this['canvas']['height']))!=_0x2ffc1c['SR_OK'])return _0xa7ccff;if((_0xa7ccff=this['pSubDisplay']['SetWebGL2Support'](this['onlySupportedWebGL1']))!=_0x2ffc1c['SR_OK'])return _0xa7ccff;var _0x12fdb5={};if(null!=this['pFishParamManager']){this['pSubDisplay']['SetFishParamManager'](this['pFishParamManager']),this['pSubDisplay']['SetFECPort'](this['nFECPort']);for(var _0x965e4e=0x0;_0x965e4e<0x20&&_0x2ffc1c['SR_OK']!=this['pFishParamManager']['GetRenderParam'](_0x965e4e,_0x12fdb5);++_0x965e4e);}if((_0xa7ccff=this['pSubDisplay']['Init'](this['ctx'],this['enPixelFormat'],_0x282878,_0x12fdb5))!=_0x2ffc1c['SR_OK'])return _0xa7ccff;if(_0x5dc8af['SR_DE_NULL']!=_0x282878){_0xa7ccff=this['pFishParamManager']['SetPTZDisplayMode'](_0x280409['SR_DM_NULL']);var _0x38ba6d={};if((_0xa7ccff=this['pFishParamManager']['GetFishParam'](this['nFECPort'],_0x38ba6d))!=_0x2ffc1c['SR_OK'])return _0xa7ccff;if(_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']==_0x282878){if(_0x38ba6d['nFishParamType']=_0x34f5da['SR_FPT_CENTER'],_0x38ba6d['fRXLeft']=0.05,_0x38ba6d['fRXRight']=0.95,_0x38ba6d['fRYTop']=-0.3,_0x38ba6d['fRYBottom']=1.3,(_0xa7ccff=this['pFishParamManager']['SetFishParam'](this['nFECPort'],_0x38ba6d))!=_0x2ffc1c['SR_OK'])return _0xa7ccff;}else{if(_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']==_0x282878&&(_0x38ba6d['nFishParamType']=_0x34f5da['SR_FPT_CENTER'],_0x38ba6d['fRXLeft']=-0.16,_0x38ba6d['fRXRight']=1.16,_0x38ba6d['fRYTop']=0.005,_0x38ba6d['fRYBottom']=0.995,(_0xa7ccff=this['pFishParamManager']['SetFishParam'](this['nFECPort'],_0x38ba6d))!=_0x2ffc1c['SR_OK']))return _0xa7ccff;}}return null!=this['pFishParamManager']&&this['pFishParamManager']['ComputePTZPoints'](),this['enDisplayEffect']=_0x282878,this['nFECPort'];}},{'key':'SR_UpdateFrameData','value':function(_0x26686c,_0x5243b7,_0x3a37dd,_0x296409,_0x4920fe){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==_0x26686c||_0x5243b7<=0x0||_0x3a37dd<=0x0)return _0x2ffc1c['SR_ERR_PARAM'];this['frameDisplayWidth']==_0x5243b7&&this['frameDisplayHeight']==_0x3a37dd||(this['bRecreateTex']=!0x0);var _0x2264a4=_0x2ffc1c['SR_OK'];if(_0x444828['SR_PF_SURFACE']==this['enPixelFormat'])this['frameDisplayWidth']=_0x5243b7,this['frameDisplayHeight']=_0x3a37dd;else{if(_0x2264a4=this['_ResizeFrameData'](_0x26686c,_0x5243b7,_0x3a37dd,_0x296409),_0x2ffc1c['SR_OK']!=_0x2264a4)return _0x2264a4;}if(0x1==this['bRecreateTex']){if(this['enPixelFormat']==_0x444828['SR_PF_SURFACE']){if(0x0!=this['nSurfaceTexture'][0x0]){var _0x445ae7=this['nSurfaceTexture'][0x0];this['ctx']['deleteTexture'](_0x445ae7),this['nSurfaceTexture'][0x0]=0x0;}var _0xca215e=this['ctx']['createTexture']();if(_0xca215e<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],_0xca215e),this['onlySupportedWebGL1']||0x1!=this['bAntialias']?this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR']):this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR_MIPMAP_NEAREST']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MAG_FILTER'],this['ctx']['LINEAR']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_WRAP_S'],this['ctx']['CLAMP_TO_EDGE']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_WRAP_T'],this['ctx']['CLAMP_TO_EDGE']),this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],null),this['nSurfaceTexture'][0x0]=_0xca215e;}else{if(this['enPixelFormat']==_0x444828['SR_PF_YV12']||this['enPixelFormat']==_0x444828['SR_PF_I420'])for(var _0x3a9a06=0x0;_0x3a9a06<this['nTextureNum'];_0x3a9a06++){if(0x0!=this['nSurfaceTexture'][_0x3a9a06]){var _0x513de8=this['nSurfaceTexture'][_0x3a9a06];this['ctx']['deleteTexture'](_0x513de8),this['nSurfaceTexture'][_0x3a9a06]=0x0;}var _0x3aeac9=this['ctx']['createTexture']();if(_0x3aeac9<=0x0)return _0x2ffc1c['SR_ERR_WEBGL_RESOURCE'];this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],_0x3aeac9),this['onlySupportedWebGL1']||0x1!=this['bAntialias']?this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR']):this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR_MIPMAP_NEAREST']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MAG_FILTER'],this['ctx']['LINEAR']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_WRAP_S'],this['ctx']['CLAMP_TO_EDGE']),this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_WRAP_T'],this['ctx']['CLAMP_TO_EDGE']),this['nSurfaceTexture'][_0x3a9a06]=_0x3aeac9,this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],null);}}this['bRecreateTex']=!0x1;}if(_0x444828['SR_PF_YV12']==this['enPixelFormat']){var _0x56fcfb=this['pFrameData']['subarray'](0x0,_0x5243b7*_0x3a37dd);this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nSurfaceTexture'][0x0]),this['ctx']['texImage2D'](this['ctx']['TEXTURE_2D'],0x0,this['ctx']['LUMINANCE'],_0x5243b7,_0x3a37dd,0x0,this['ctx']['LUMINANCE'],this['ctx']['UNSIGNED_BYTE'],_0x56fcfb),this['bAntialiasStateNeedChange']&&(this['onlySupportedWebGL1']||0x1!=this['bAntialias']?this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR']):(this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR_MIPMAP_NEAREST']),this['ctx']['generateMipmap'](this['ctx']['TEXTURE_2D'])));var _0x2b554d=this['pFrameData']['subarray'](_0x5243b7*_0x3a37dd+_0x5243b7/0x2*_0x3a37dd/0x2,_0x5243b7*_0x3a37dd+_0x5243b7/0x2*_0x3a37dd/0x2+_0x5243b7/0x2*_0x3a37dd/0x2);this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nSurfaceTexture'][0x1]),this['ctx']['texImage2D'](this['ctx']['TEXTURE_2D'],0x0,this['ctx']['LUMINANCE'],_0x5243b7/0x2,_0x3a37dd/0x2,0x0,this['ctx']['LUMINANCE'],this['ctx']['UNSIGNED_BYTE'],_0x2b554d),this['bAntialiasStateNeedChange']&&(this['onlySupportedWebGL1']||0x1!=this['bAntialias']?this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR']):(this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR_MIPMAP_NEAREST']),this['ctx']['generateMipmap'](this['ctx']['TEXTURE_2D'])));var _0x26c1cf=this['pFrameData']['subarray'](_0x5243b7*_0x3a37dd,_0x5243b7*_0x3a37dd+_0x5243b7/0x2*_0x3a37dd/0x2);this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nSurfaceTexture'][0x2]),this['ctx']['texImage2D'](this['ctx']['TEXTURE_2D'],0x0,this['ctx']['LUMINANCE'],_0x5243b7/0x2,_0x3a37dd/0x2,0x0,this['ctx']['LUMINANCE'],this['ctx']['UNSIGNED_BYTE'],_0x26c1cf),this['bAntialiasStateNeedChange']&&(this['onlySupportedWebGL1']||0x1!=this['bAntialias']?this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR']):(this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR_MIPMAP_NEAREST']),this['ctx']['generateMipmap'](this['ctx']['TEXTURE_2D'])),this['bAntialiasStateNeedChange']=!0x1),_0x56fcfb=null,_0x2b554d=null,_0x26c1cf=null;}else{if(_0x444828['SR_PF_I420']==this['enPixelFormat']){var _0x4831d8=this['pFrameData']['subarray'](0x0,_0x5243b7*_0x3a37dd);this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nSurfaceTexture'][0x0]),this['ctx']['texImage2D'](this['ctx']['TEXTURE_2D'],0x0,this['ctx']['LUMINANCE'],_0x5243b7,_0x3a37dd,0x0,this['ctx']['LUMINANCE'],this['ctx']['UNSIGNED_BYTE'],_0x4831d8),this['bAntialiasStateNeedChange']&&(this['onlySupportedWebGL1']||0x1!=this['bAntialias']?this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR']):(this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR_MIPMAP_NEAREST']),this['ctx']['generateMipmap'](this['ctx']['TEXTURE_2D'])));var _0x1c82b1=this['pFrameData']['subarray'](_0x5243b7*_0x3a37dd,_0x5243b7*_0x3a37dd+_0x5243b7/0x2*_0x3a37dd/0x2);this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nSurfaceTexture'][0x1]),this['ctx']['texImage2D'](this['ctx']['TEXTURE_2D'],0x0,this['ctx']['LUMINANCE'],_0x5243b7/0x2,_0x3a37dd/0x2,0x0,this['ctx']['LUMINANCE'],this['ctx']['UNSIGNED_BYTE'],_0x1c82b1),this['bAntialiasStateNeedChange']&&(this['onlySupportedWebGL1']||0x1!=this['bAntialias']?this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR']):(this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR_MIPMAP_NEAREST']),this['ctx']['generateMipmap'](this['ctx']['TEXTURE_2D'])));var _0x240980=this['pFrameData']['subarray'](_0x5243b7*_0x3a37dd+_0x5243b7/0x2*_0x3a37dd/0x2,_0x5243b7*_0x3a37dd+_0x5243b7/0x2*_0x3a37dd/0x2+_0x5243b7/0x2*_0x3a37dd/0x2);this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nSurfaceTexture'][0x2]),this['ctx']['texImage2D'](this['ctx']['TEXTURE_2D'],0x0,this['ctx']['LUMINANCE'],_0x5243b7/0x2,_0x3a37dd/0x2,0x0,this['ctx']['LUMINANCE'],this['ctx']['UNSIGNED_BYTE'],_0x240980),this['bAntialiasStateNeedChange']&&(this['onlySupportedWebGL1']||0x1!=this['bAntialias']?this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR']):(this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR_MIPMAP_NEAREST']),this['ctx']['generateMipmap'](this['ctx']['TEXTURE_2D'])),this['bAntialiasStateNeedChange']=!0x1),_0x4831d8=null,_0x1c82b1=null,_0x240980=null;}else _0x444828['SR_PF_SURFACE']==this['enPixelFormat']&&(this['ctx']['bindTexture'](this['ctx']['TEXTURE_2D'],this['nSurfaceTexture'][0x0]),this['ctx']['texImage2D'](this['ctx']['TEXTURE_2D'],0x0,this['ctx']['RGBA'],_0x5243b7,_0x3a37dd,0x0,this['ctx']['RGBA'],this['ctx']['UNSIGNED_BYTE'],_0x26686c),this['bAntialiasStateNeedChange']&&(this['onlySupportedWebGL1']||0x1!=this['bAntialias']?this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR']):(this['ctx']['texParameteri'](this['ctx']['TEXTURE_2D'],this['ctx']['TEXTURE_MIN_FILTER'],this['ctx']['LINEAR_MIPMAP_NEAREST']),this['ctx']['generateMipmap'](this['ctx']['TEXTURE_2D'])),this['bAntialiasStateNeedChange']=!0x1));}return _0x2ffc1c['SR_OK'];}},{'key':'SR_Display','value':function(_0x30028a){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==this['pSubDisplay'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];this['pSubDisplay']['SetTextureNum'](this['nTextureNum']);for(var _0x8166f5=0x0;_0x8166f5<this['nTextureNum'];_0x8166f5++)this['pSubDisplay']['SetTextures'](_0x8166f5,this['nSurfaceTexture'][_0x8166f5]);if(null!=this['pFishParamManager']){var _0x2a2e51={};this['pFishParamManager']['GetRenderParam'](this['nFECPort'],_0x2a2e51),this['pSubDisplay']['SetFishParam'](_0x2a2e51);}var _0xcd2f91=this['pSubDisplay']['Render'](!0x1);if(_0x2ffc1c['SR_OK']!=_0xcd2f91)return _0xcd2f91;if(null!=this['pFishParamManager']){var _0x46018e=this['pFishParamManager']['GetWndPort']();-0x1!=_0x46018e&&_0x46018e==this['nFECPort']&&this['DrawPTZLines']();}return this['pSubDisplay']['SetVideoResolution'](this['frameDisplayWidth'],this['frameDisplayHeight']),_0x30028a||this['pSubDisplay']['DoCallBack'](),_0x2ffc1c['SR_OK'];}},{'key':'SR_SetDisplayRect','value':function(_0x2d8dc6,_0x3d8513,_0x171896,_0x6c69ee,_0x490b8e){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==this['pSubDisplay'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x390610=_0x2ffc1c['SR_OK'];return(_0x390610=this['pSubDisplay']['SetDisplayRect'](_0x2d8dc6,_0x3d8513,_0x171896,_0x6c69ee,_0x490b8e))!=_0x2ffc1c['SR_OK']?_0x390610:(this['preDisplayRectnX']=_0x2d8dc6,this['preDisplayRectnY']=_0x3d8513,this['preDisplayRectnW']=_0x171896,this['preDisplayRectnH']=_0x6c69ee,_0x2ffc1c['SR_OK']);}},{'key':'SR_SetImagePostProcess','value':function(_0x3c58d6,_0xa5cd9e){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==this['pSubDisplay']&&(this['pSubDisplay']=new _0x5c3dde(),null==this['pSubDisplay']))return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];var _0x53d97d=_0x2ffc1c['SR_OK'];return(_0x53d97d=this['pSubDisplay']['SetImagePostProcess'](_0x3c58d6,_0xa5cd9e))!=_0x2ffc1c['SR_OK']?_0x53d97d:_0x2ffc1c['SR_OK'];}},{'key':'SR_SetRenderState','value':function(_0x419dbf,_0x28b462){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==this['pSubDisplay'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x3a1e53=_0x2ffc1c['SR_OK'];return(_0x3a1e53=this['pSubDisplay']['SetRenderState'](_0x419dbf,_0x28b462))!=_0x2ffc1c['SR_OK']?_0x3a1e53:(_0x419dbf==_0x453ff1['SR_RST_IMAGE_ROTATE']&&(this['preImageRotateValue']=_0x28b462),_0x2ffc1c['SR_OK']);}},{'key':'SR_GetCaptureSize','value':function(_0x3ff1ac){var _0x129e7d=arguments['length']>0x1&&void 0x0!==arguments[0x1]&&arguments[0x1];if(null==_0x3ff1ac)return _0x2ffc1c['SR_ERR_PARAM'];if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==this['pSubDisplay'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x46723e=_0x2ffc1c['SR_OK'];return(_0x46723e=this['pSubDisplay']['GetCaptureSize'](_0x3ff1ac,_0x129e7d))!=_0x2ffc1c['SR_OK']?_0x46723e:(this['nCaptureWidth']=_0x3ff1ac['nWidth'],this['nCaptureHeight']=_0x3ff1ac['nHeight'],_0x2ffc1c['SR_OK']);}},{'key':'SR_CaptureScreen','value':function(_0x42947f){var _0x44f8ef=arguments['length']>0x1&&void 0x0!==arguments[0x1]&&arguments[0x1];if(0x0==this['nSurfaceTexture'][0x0])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==this['pSubDisplay'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x474d99={'nWndWidth':0x0,'nWndHeight':0x0};this['pSubDisplay']['GetWndResolution'](_0x474d99),this['pSubDisplay']['SetWndResolution'](this['nCaptureWidth'],this['nCaptureHeight']);var _0x5667a9=_0x2ffc1c['SR_OK'];return(_0x5667a9=this['pSubDisplay']['CaptureScreen'](_0x42947f,_0x44f8ef))!=_0x2ffc1c['SR_OK']?_0x5667a9:(this['pSubDisplay']['SetWndResolution'](_0x474d99['nWndWidth'],_0x474d99['nWndHeight']),_0x2ffc1c['SR_OK']);}},{'key':'SR_DrawMosaic','value':function(_0xedab6b,_0x5c6637,_0x4b880d,_0x9b9c48,_0x3a88e1){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==this['pSubDisplay'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0xfa5793=_0x2ffc1c['SR_OK'];return(_0xfa5793=this['pSubDisplay']['DrawMosaic'](_0xedab6b,_0x5c6637,_0x4b880d,_0x9b9c48,_0x3a88e1))!=_0x2ffc1c['SR_OK']?_0xfa5793:_0x2ffc1c['SR_OK'];}},{'key':'DrawPTZLines','value':function(){if(null==this['pFishParamManager'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x381a93=this['pFishParamManager']['GetPTZDisplayMode']();if(_0x381a93==_0x280409['SR_DM_RANGE']||_0x381a93==_0x280409['SR_DM_RECT']){for(var _0x86d2d6=0x0,_0x7fccd2={'fR':0x0,'fG':0x0,'fB':0x0,'fA':0x0},_0x2d3387=_0x2ffc1c['SR_OK'],_0x41568e=0x0;_0x41568e<0x20;++_0x41568e)if(0x0!=this['pFishParamManager']['IsPortAllocated'](_0x41568e)&&(_0x86d2d6=0x2,_0x2d3387=this['pFishParamManager']['GetPTZColor'](_0x41568e,_0x7fccd2),_0x2ffc1c['SR_OK']==_0x2d3387)){0x1==this['pFishParamManager']['IsPTZSelected'](_0x41568e)&&(_0x86d2d6+=0x1);var _0x9da231=this['pFishParamManager']['GetWndPort']();if(_0x41568e!=_0x9da231&&_0x280409['SR_DM_RANGE']==_0x381a93){if(_0x5dc8af['SR_DE_FISH_ORIGINAL']==this['pFishParamManager']['GetDisplayEffect'](_0x9da231)){var _0x5e051a={};if(_0x2d3387=this['pFishParamManager']['GetPTZPoints'](_0x41568e,_0x5e051a,_0x280409['SR_DM_RANGE']),_0x2ffc1c['SR_OK']!=_0x2d3387)continue;if(null!=_0x5e051a['pstPoints']&&0x0!=_0x5e051a['nPointNum']&&(_0x2d3387=this['SR_DrawLines'](_0x5e051a['pstPoints'],_0x5e051a['nPointNum'],!0x0,_0x7fccd2,_0x86d2d6,!0x1),_0x2ffc1c['SR_OK']!=_0x2d3387))continue;}else{var _0x1a3448;if((_0x1a3448=this['pFishParamManager']['GetPTZFragmentNum'](_0x41568e))<=0x0)continue;for(var _0x341186=0x0;_0x341186<_0x1a3448;_0x341186++){var _0x2367df={};this['pFishParamManager']['GetPTZFragmentPoints'](_0x41568e,_0x2367df,_0x341186),null!=_0x2367df['pstPoints']&&0x0!=_0x2367df['nPointNum']&&this['SR_DrawLines'](_0x2367df['pstPoints'],_0x2367df['nPointNum'],!0x1,_0x7fccd2,_0x86d2d6,!0x1);}}}else{if(_0x41568e!=_0x9da231&&_0x280409['SR_DM_RECT']==_0x381a93){var _0x4f4538={};if(_0x2d3387=this['pFishParamManager']['GetPTZPoints'](_0x41568e,_0x4f4538,_0x280409['SR_DM_RECT']),_0x2ffc1c['SR_OK']!=_0x2d3387)continue;if(null!=_0x4f4538['pstPoints']&&0x0!=_0x4f4538['nPointNum']&&(_0x2d3387=this['SR_DrawLines'](_0x4f4538['pstPoints'],_0x4f4538['nPointNum'],!0x0,_0x7fccd2,_0x86d2d6,!0x1),_0x2ffc1c['SR_OK']!=_0x2d3387))continue;}}}}return _0x2ffc1c['SR_OK'];}},{'key':'SR_DrawLines','value':function(_0x2a9584,_0x53e625,_0x328d6e,_0x297271,_0x20449d,_0x45b282){return null==this['ctx']||null==this['pSubDisplay']?_0x2ffc1c['SR_ERR_CALL_ORDER']:this['pSubDisplay']['DrawLines'](_0x2a9584,_0x53e625,_0x328d6e,_0x297271,_0x20449d,_0x45b282);}},{'key':'SR_DrawLinesEx','value':function(_0x12969d,_0x1e9a4c,_0x1bb075,_0x193c4f){return null==this['ctx']||null==this['pSubDisplay']?_0x2ffc1c['SR_ERR_CALL_ORDER']:this['pSubDisplay']['DrawLinesEx'](_0x12969d,_0x1e9a4c,_0x1bb075,_0x193c4f);}},{'key':'SR_DrawFont','value':function(_0x1789ed,_0x44ee22,_0x50064b,_0x561817,_0x2c11be,_0x482e4,_0xe21fb5,_0x2e0a03,_0x4e5506,_0xc8e07e,_0x1a6725){return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}},{'key':'SR_DrawFontEx','value':function(_0x697b30,_0x370f17){var _0x30e903=arguments['length']>0x2&&void 0x0!==arguments[0x2]?arguments[0x2]:0x0,_0x6adf98=arguments['length']>0x3?arguments[0x3]:void 0x0;if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==this['pSubDisplay'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x19afe0=this['pSubDisplay']['DrawFontEx'](_0x697b30,_0x370f17,_0x30e903,_0x6adf98);return _0x19afe0;}},{'key':'SR_DrawImage','value':function(_0x514a8a,_0x5efbc8,_0x14789e,_0xebc35,_0x3eedc8,_0x349b9c){return null==this['ctx']||null==this['pSubDisplay']?_0x2ffc1c['SR_ERR_CALL_ORDER']:this['pSubDisplay']['DrawImage'](_0x514a8a,_0x5efbc8,_0x14789e,_0xebc35,_0x3eedc8,_0x349b9c);}},{'key':'SR_DelSubPort','value':function(_0x60fa6d){return null==this['ctx']||null==this['pSubDisplay']?_0x2ffc1c['SR_ERR_CALL_ORDER']:(this['pSubDisplay']['DelSubPort'](),null!=this['pFishParamManager']&&this['nFECPort']==_0x60fa6d&&this['pFishParamManager']['FreeFECPort'](this['nFECPort']),this['enDisplayEffect']=_0x5dc8af['SR_DE_NULL'],this['pSubDisplay']=null,_0x2ffc1c['SR_OK']);}},{'key':'SR_GetFishParam','value':function(_0x590140){return null==_0x590140?_0x2ffc1c['SR_ERR_PARAM']:null==this['pFishParamManager']?_0x2ffc1c['SR_ERR_CALL_ORDER']:this['pFishParamManager']['GetFishParam'](this['nFECPort'],_0x590140);}},{'key':'SR_SetFishParam','value':function(_0x37577e){return null==_0x37577e?_0x2ffc1c['SR_ERR_PARAM']:null==this['pFishParamManager']?_0x2ffc1c['SR_ERR_CALL_ORDER']:this['pFishParamManager']['SetFishParam'](this['nFECPort'],_0x37577e);}},{'key':'SR_Destroy','value':function(){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];this['frameDisplayWidth']=0x0,this['frameDisplayHeight']=0x0,this['pFrameData']=null;for(var _0x503d51=0x0;_0x503d51<this['nTextureNum'];_0x503d51++)0x0!=this['nSurfaceTexture'][_0x503d51]&&null!=this['ctx']&&(this['ctx']['deleteTexture'](this['nSurfaceTexture'][_0x503d51]),this['nSurfaceTexture'][_0x503d51]=0x0);return this['SR_DelSubPort'](this['nFECPort']),this['ctx']=null,this['onlySupportedWebGL1']=!0x1,this['bAntialias']=!0x1,this['bAntialiasStateNeedChange']=!0x1,this['bOpenMsaa']=!0x1,this['bRecreateTex']=!0x0,this['pFishParamManager']=null,_0x2ffc1c['SR_OK'];}},{'key':'SR_SetCanvasSize','value':function(_0x146b46,_0x281ccb){if(!this['pSubDisplay']||!this['canvas'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];this['canvas']['width']=_0x146b46,this['canvas']['height']=_0x281ccb;var _0x2cf47a=this['pSubDisplay']['SetCanvasSize'](_0x146b46,_0x281ccb);return _0x2cf47a!=_0x2ffc1c['SR_OK']?_0x2cf47a:_0x2ffc1c['SR_OK'];}},{'key':'SR_GetCanvasSize','value':function(){return this['canvas']?_0x2ffc1c['SR_OK']:_0x2ffc1c['SR_ERR_CALL_ORDER'];}},{'key':'SR_SetAntialias','value':function(_0xff3592){if(null==this['pSubDisplay'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(0x1==this['onlySupportedWebGL1'])return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];this['bAntialias']!=_0xff3592&&(this['bAntialias']=_0xff3592,this['bAntialiasStateNeedChange']=!0x0);var _0x3f580b=this['pSubDisplay']['SetAntialias'](this['bAntialias']);return _0x3f580b!=_0x2ffc1c['SR_OK']?_0x3f580b:_0x2ffc1c['SR_OK'];}},{'key':'SR_SetRenderMode','value':function(_0x43d181){return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}},{'key':'SR_SetPTZDisplayMode','value':function(_0x97f3a2){return null==this['pFishParamManager']?_0x2ffc1c['SR_ERR_CALL_ORDER']:this['pFishParamManager']['SetPTZDisplayMode'](_0x97f3a2);}},{'key':'SR_SetFishParamManager','value':function(_0x1f52fd){return null!=this['pFishParamManager']?_0x2ffc1c['SR_ERR_NOT_SUPPORT']:(this['pFishParamManager']=_0x1f52fd,_0x2ffc1c['SR_OK']);}},{'key':'SR_SetViewParam','value':function(_0x3540ef,_0xdd266a){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==this['pSubDisplay'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x5dad53=this['pSubDisplay']['SetViewParam'](_0x3540ef,_0xdd266a);return _0x5dad53!=_0x2ffc1c['SR_OK']?_0x5dad53:_0x2ffc1c['SR_OK'];}},{'key':'SR_GetViewParam','value':function(_0x5d01fb,_0x3453a8){if(null==this['ctx'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==this['pSubDisplay'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x3a2095=this['pSubDisplay']['GetViewParam'](_0x5d01fb,_0x3453a8);return _0x3a2095!=_0x2ffc1c['SR_OK']?_0x3a2095:_0x2ffc1c['SR_OK'];}},{'key':'SR_SetCallBack','value':function(_0x228ec3,_0x4e953c,_0x2cdff6){if(null==this['pSubDisplay'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x13af58=_0x2ffc1c['SR_OK'];return(_0x13af58=this['pSubDisplay']['SetCallBack'](_0x228ec3,_0x4e953c,_0x2cdff6))!=_0x2ffc1c['SR_OK']?_0x13af58:_0x2ffc1c['SR_OK'];}},{'key':'SR_SetPTZColor','value':function(_0xad6a08,_0x36097d){return null==this['pFishParamManager']?_0x2ffc1c['SR_ERR_CALL_ORDER']:this['pFishParamManager']['SetPTZColor'](_0xad6a08,_0x36097d);}},{'key':'SR_GetPTZColor','value':function(_0x4a8e73,_0x11692d){return null==this['pFishParamManager']?_0x2ffc1c['SR_ERR_CALL_ORDER']:this['pFishParamManager']['GetPTZColor'](_0x4a8e73,_0x11692d);}},{'key':'SR_SetPTZPort','value':function(_0x3d3526){return null==this['pFishParamManager']?_0x2ffc1c['SR_ERR_CALL_ORDER']:this['pFishParamManager']['SetPTZPort'](_0x3d3526);}},{'key':'SR_GetPTZPort','value':function(_0x5aee41,_0xc8a56b,_0x448ef9){return null==this['pFishParamManager']?_0x2ffc1c['SR_ERR_CALL_ORDER']:null==_0x448ef9?_0x2ffc1c['SR_ERR_PARAM']:this['pFishParamManager']['GetPTZPort'](_0x5aee41,_0xc8a56b,_0x448ef9);}},{'key':'SR_GetDllVersion','value':function(){return'V1.1.0.3_build20250820_svn96751';}},{'key':'_ResizeFrameData','value':function(_0x469c8c,_0x28c5a5,_0x265dd9,_0x520252){if(0x0==_0x28c5a5%0x8&&null==_0x520252)return this['frameDisplayWidth']=Math['round'](_0x28c5a5),this['frameDisplayHeight']=Math['round'](_0x265dd9),this['pFrameData']=_0x469c8c,_0x2ffc1c['SR_OK'];if(null!=_0x520252&&0x0==_0x520252['nCropBottom']&&0x0==_0x520252['nCropLeft']&&0x0==_0x520252['nCropRight']&&0x0==_0x520252['nCropTop']&&0x0==_0x28c5a5%0x8)return this['frameDisplayWidth']=Math['round'](_0x28c5a5),this['frameDisplayHeight']=Math['round'](_0x265dd9),this['pFrameData']=_0x469c8c,_0x2ffc1c['SR_OK'];if((null==this['pFrameData']||this['frameDisplayWidth']!=_0x28c5a5/0x8*0x8||this['frameDisplayHeight']!=_0x265dd9)&&(this['frameDisplayWidth']=0x8*Math['round'](_0x28c5a5/0x8),this['frameDisplayHeight']=Math['round'](_0x265dd9),this['pFrameData']=null,this['pFrameData']=new Uint8Array(this['frameDisplayWidth']*this['frameDisplayHeight']*0x3/0x2),null==this['pFrameData']))return _0x2ffc1c['SR_ERR_ALLOC_MEMORY'];var _0x10291d=0x0,_0x2d1fcc=0x0,_0x55c7d4=Math['round'](_0x520252['nCodeWidth']),_0x4bd7d9=Math['round'](_0x520252['nCodeHeight']),_0x2ecafd=0x0;if(_0x444828['SR_PF_YV12']==this['enPixelFormat']||_0x444828['SR_PF_I420']==this['enPixelFormat']){var _0x203011,_0x24dd75,_0x55140d;null!=_0x520252?(_0x10291d=Math['round'](_0x520252['nCropLeft']),_0x2d1fcc=Math['round'](_0x520252['nCropTop']),_0x203011=_0x469c8c['subarray'](_0x10291d*_0x55c7d4+_0x2d1fcc,_0x55c7d4*_0x4bd7d9),_0x24dd75=_0x469c8c['subarray'](_0x55c7d4*_0x4bd7d9+_0x2d1fcc*_0x55c7d4/0x4+_0x10291d/0x2,_0x55c7d4*_0x4bd7d9*0x5/0x4),_0x55140d=_0x469c8c['subarray'](_0x55c7d4*_0x4bd7d9*0x5/0x4+_0x2d1fcc*_0x55c7d4/0x4+_0x10291d/0x2,_0x55c7d4*_0x4bd7d9*0x3/0x2),_0x2ecafd=_0x55c7d4):(_0x203011=_0x469c8c['subarray'](0x0,_0x28c5a5*_0x265dd9),_0x24dd75=_0x469c8c['subarray'](_0x28c5a5*_0x265dd9,_0x28c5a5*_0x265dd9*0x5/0x4),_0x55140d=_0x469c8c['subarray'](_0x28c5a5*_0x265dd9*0x5/0x4,_0x28c5a5*_0x265dd9*0x3/0x2),_0x2ecafd=this['frameDisplayWidth']);for(var _0x161d31=null,_0x45a152=0x0;_0x45a152<this['frameDisplayHeight'];++_0x45a152){var _0x5cb524=Math['round'](_0x45a152*_0x2ecafd),_0xd65999=Math['round'](_0x45a152*_0x2ecafd+this['frameDisplayWidth']);_0x161d31=_0x203011['slice'](_0x5cb524,_0xd65999);var _0x1f8e82=Math['round'](_0x45a152*this['frameDisplayWidth']);this['pFrameData']['set'](_0x161d31,_0x1f8e82);}for(var _0x51a94d=0x0;_0x51a94d<this['frameDisplayHeight']/0x2;++_0x51a94d){var _0x548a8b=Math['round'](_0x51a94d*_0x2ecafd/0x2),_0x2d2e1d=Math['round'](_0x51a94d*_0x2ecafd/0x2+this['frameDisplayWidth']/0x2);_0x161d31=_0x24dd75['slice'](_0x548a8b,_0x2d2e1d);var _0x3caf57=Math['round'](this['frameDisplayWidth']*this['frameDisplayHeight']+_0x51a94d*this['frameDisplayWidth']/0x2);this['pFrameData']['set'](_0x161d31,_0x3caf57);}for(var _0x12e70b=0x0;_0x12e70b<this['frameDisplayHeight']/0x2;++_0x12e70b){var _0x3b47e5=Math['round'](_0x12e70b*_0x2ecafd/0x2),_0x23487f=Math['round'](_0x12e70b*_0x2ecafd/0x2+this['frameDisplayWidth']/0x2);_0x161d31=_0x55140d['slice'](_0x3b47e5,_0x23487f);var _0x274cba=Math['round'](this['frameDisplayWidth']*this['frameDisplayHeight']*0x5/0x4+_0x12e70b*this['frameDisplayWidth']/0x2);this['pFrameData']['set'](_0x161d31,_0x274cba);}_0x203011=null,_0x24dd75=null,_0x55140d=null,_0x161d31=null;}else{if(_0x444828['SR_PF_NV12']==this['enPixelFormat']){var _0x34b1af,_0x218b10,_0x2e1e59;null!=_0x520252?(_0x10291d=Math['round'](_0x520252['nCropLeft']),_0x2d1fcc=Math['round'](_0x520252['nCropTop']),_0x34b1af=_0x469c8c['subarray'](_0x2d1fcc*_0x55c7d4+_0x10291d,_0x55c7d4*_0x4bd7d9),_0x218b10=_0x469c8c['subarray'](_0x55c7d4*_0x4bd7d9+_0x2d1fcc*_0x55c7d4/0x4+_0x10291d/0x2,_0x55c7d4*_0x4bd7d9*0x3/0x2),_0x2ecafd=Math['round'](_0x520252['nCodeWidth'])):(_0x34b1af=_0x469c8c['subarray'](0x0,_0x55c7d4*_0x4bd7d9),_0x218b10=_0x469c8c['subarray'](_0x55c7d4*_0x4bd7d9,_0x55c7d4*_0x4bd7d9*0x3/0x2),_0x2ecafd=this['frameDisplayWidth']);for(var _0x506620=0x0;_0x506620<this['frameDisplayHeight'];++_0x506620){var _0x2fc14c=Math['round'](_0x506620*_0x2ecafd),_0x2343cd=Math['round'](_0x506620*_0x2ecafd+this['frameDisplayWidth']);_0x2e1e59=_0x34b1af['slice'](_0x2fc14c,_0x2343cd);var _0x41cf87=Math['round'](_0x506620*this['frameDisplayWidth']);this['pFrameData']['set'](_0x2e1e59,_0x41cf87);}for(var _0x58483a=0x0;_0x58483a<this['frameDisplayHeight']/0x2;++_0x58483a){var _0x351bf5=Math['round'](_0x58483a*_0x2ecafd),_0x453c06=Math['round'](_0x58483a*_0x2ecafd+this['frameDisplayWidth']);_0x2e1e59=_0x218b10['slice'](_0x351bf5,_0x453c06);var _0x5af522=Math['round'](this['frameDisplayWidth']*this['frameDisplayHeight']+_0x58483a*this['frameDisplayWidth']);this['pFrameData']['set'](_0x2e1e59,_0x5af522);}_0x34b1af=null,_0x218b10=null,_0x2e1e59=null;}}return _0x2ffc1c['SR_OK'];}},{'key':'_RenderToTarget','value':function(_0x15923d){return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}},{'key':'_SetRenderMode','value':function(_0x586e1c){if(null==this['pSubDisplay'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x5a47aa=_0x2ffc1c['SR_OK'];if(_0x586e1c==this['bRenderToTex'])return _0x2ffc1c['SR_OK'];this['bRenderToTex']=_0x586e1c;var _0x15a266={};if(null!=this['pFishParamManager']){this['pSubDisplay']['SetFishParamManager'](this['pFishParamManager']),this['pSubDisplay']['SetFECPort'](this['nFECPort']);for(var _0x587bce=0x0;_0x587bce<0x20&&_0x2ffc1c['SR_OK']!=this['pFishParamManager']['GetRenderParam'](_0x587bce,_0x15a266);++_0x587bce);}return(_0x5a47aa=this['bRenderToTex']?this['pSubDisplay']['Init'](this['ctx'],_0x444828['SR_PF_RGBA32'],this['enDisplayEffect'],_0x15a266):this['pSubDisplay']['Init'](this['ctx'],this['enPixelFormat'],this['enDisplayEffect'],_0x15a266))!=_0x2ffc1c['SR_OK']?_0x5a47aa:0x0==this['preDisplayRectnX']&&0x0==this['preDisplayRectnY']&&0x0==this['preDisplayRectnW']&&0x0==this['preDisplayRectnH']||(_0x5a47aa=this['pSubDisplay']['SetDisplayRect'](this['preDisplayRectnX'],this['preDisplayRectnY'],this['preDisplayRectnW'],this['preDisplayRectnH'],_0x20e142['SR_SRT_SRC']))==_0x2ffc1c['SR_OK']?(this['pSubDisplay']['nImageRotateAngle']=_0x185fa4['SR_IRA_0'],(_0x5a47aa=this['pSubDisplay']['SetRenderState'](_0x453ff1['SR_RST_IMAGE_ROTATE'],this['preImageRotateValue']))!=_0x2ffc1c['SR_OK']?_0x5a47aa:_0x2ffc1c['SR_OK']):_0x5a47aa;}}]),_0x584326;}()),_0x331e43=(function(){function _0x1f24a2(){_0x1d5976(this,_0x1f24a2),this['bPortAllocated']=[],this['pRenderParam']=[],this['pFishParam']=[],this['stPTZColor']=[],this['pPTZSetColor']=[];for(var _0x4906bc=0x0;_0x4906bc<0x20;++_0x4906bc)this['pPTZSetColor'][_0x4906bc]={},this['pPTZSetColor'][_0x4906bc]['fR']=0x0,this['pPTZSetColor'][_0x4906bc]['fG']=0x0,this['pPTZSetColor'][_0x4906bc]['fB']=0x0,this['pPTZSetColor'][_0x4906bc]['fA']=0x1,this['pPTZSetColor'][_0x4906bc]['bSetColor']=!0x1;this['nBasePTZPointNum']=[],this['nOriPTZPointNum']=[],this['nPanoPTZPointNum']=[],this['nPTZFragmentNum']=[],this['pBasePTZPoints']=[],this['pPanoPTZPoints']=[],this['pRectPoints']=[],this['nPTZRectNum']=[],this['nPTZDisplayMode']=_0x280409['SR_DM_NULL'],this['fRX1']=0x0,this['fRX2']=0x1,this['fRY1']=0x0,this['fRY2']=0x1,this['bBlack']=!0x1,this['pOriPTZPoints']=[],this['nWndPort']=-0x1,this['nPlaceType']=0x0,this['nPTZFragmentNode']=[],this['bPTZSelected']=[],this['nPTZDisplayMode']=_0x280409['SR_DM_RANGE'];for(var _0x255f78=0x0;_0x255f78<0x20;++_0x255f78){this['bPortAllocated'][_0x255f78]=!0x1,this['bPTZSelected'][_0x255f78]=!0x1,this['pRenderParam'][_0x255f78]=null,this['pFishParam'][_0x255f78]=null,this['stPTZColor'][_0x255f78]={},this['stPTZColor'][_0x255f78]['fR']=0x0,this['stPTZColor'][_0x255f78]['fG']=0x0,this['stPTZColor'][_0x255f78]['fB']=0x0,this['stPTZColor'][_0x255f78]['fA']=0x0,this['nBasePTZPointNum'][_0x255f78]=0x0,this['nOriPTZPointNum'][_0x255f78]=0x0,this['nPanoPTZPointNum'][_0x255f78]=0x0,this['nPTZRectNum'][_0x255f78]=0x0,this['pPanoPTZPoints'][_0x255f78]=[],this['pRectPoints'][_0x255f78]=[],this['pBasePTZPoints'][_0x255f78]=[],this['pOriPTZPoints'][_0x255f78]=[];for(var _0x39ceb0=0x0;_0x39ceb0<0x4;++_0x39ceb0)this['pRectPoints'][_0x255f78][_0x39ceb0]={},this['pRectPoints'][_0x255f78][_0x39ceb0]['fX']=0x0,this['pRectPoints'][_0x255f78][_0x39ceb0]['fY']=0x0;for(var _0x33e012=0x0;_0x33e012<0x400;++_0x33e012)this['pBasePTZPoints'][_0x255f78][_0x33e012]={},this['pBasePTZPoints'][_0x255f78][_0x33e012]['fX']=0x0,this['pBasePTZPoints'][_0x255f78][_0x33e012]['fY']=0x0,this['pOriPTZPoints'][_0x255f78][_0x33e012]={},this['pOriPTZPoints'][_0x255f78][_0x33e012]['fX']=0x0,this['pOriPTZPoints'][_0x255f78][_0x33e012]['fY']=0x0,this['pPanoPTZPoints'][_0x255f78][_0x33e012]={},this['pPanoPTZPoints'][_0x255f78][_0x33e012]['fX']=0x0,this['pPanoPTZPoints'][_0x255f78][_0x33e012]['fY']=0x0;this['nPTZFragmentNum'][_0x255f78]=0x0,this['nPTZFragmentNode'][_0x255f78]=[];for(var _0x22e472=0x0;_0x22e472<0x64;++_0x22e472)this['nPTZFragmentNode'][_0x255f78][_0x22e472]=0x0;}this['InitColorList']();}return _0x2d31ab(_0x1f24a2,[{'key':'GetFECPort','value':function(_0x549804){for(var _0x3d277e=-0x1,_0x664126=0x0;_0x664126<0x20;++_0x664126)if(0x0==this['bPortAllocated'][_0x664126]){_0x3d277e=_0x664126;break;}if(-0x1==_0x3d277e)return _0x3d277e;if(_0x549804==_0x5dc8af['SR_DE_NULL'])return _0x3d277e;var _0x1ff4ca=this['JudgeDisplayEffect'](_0x549804);if(_0x2ffc1c['SR_OK']!=_0x1ff4ca)return this['FreeFECPort'](_0x3d277e),-0x1;if(_0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_360']==_0x549804||_0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_180']==_0x549804||_0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_360']==_0x549804||_0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_180']==_0x549804||_0x5dc8af['SR_DE_FISH_PANORAMA_WALL']==_0x549804||_0x5dc8af['SR_DE_FISH_ORIGINAL']==_0x549804){if(-0x1!=this['nWndPort'])return this['FreeFECPort'](_0x3d277e),-0x1;this['nWndPort']=_0x3d277e;}if(!(_0x5dc8af['SR_DE_FISH_PTZ_CEILING']!=_0x549804&&_0x5dc8af['SR_DE_FISH_PTZ_FLOOR']!=_0x549804&&_0x5dc8af['SR_DE_FISH_PTZ_WALL']!=_0x549804||-0x1==this['nWndPort']||null==this['pRenderParam'][this['nWndPort']]||_0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_180']!=this['pRenderParam'][this['nWndPort']]['nDisplayEffect']&&_0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_180']!=this['pRenderParam'][this['nWndPort']]['nDisplayEffect']))return this['FreeFECPort'](_0x3d277e),-0x1;if(_0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_180']==_0x549804||_0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_180']==_0x549804){for(var _0x2ba609=0x0;_0x2ba609<0x20;++_0x2ba609)if(null!=this['pRenderParam'][_0x2ba609]&&(_0x5dc8af['SR_DE_FISH_PTZ_CEILING']==this['pRenderParam'][_0x2ba609]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_PTZ_FLOOR']==this['pRenderParam'][_0x2ba609]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_PTZ_WALL']==this['pRenderParam'][_0x2ba609]['nDisplayEffect']))return this['FreeFECPort'](_0x3d277e),-0x1;}if(_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']==_0x549804){for(var _0x13521d=0x0;_0x13521d<0x20;++_0x13521d)if(null!=this['pRenderParam'][_0x13521d]&&_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']==this['pRenderParam'][_0x13521d]['nDisplayEffect'])return this['FreeFECPort'](_0x3d277e),-0x1;}if(_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']==_0x549804){for(var _0x2eec00=0x0;_0x2eec00<0x20;++_0x2eec00)if(null!=this['pRenderParam'][_0x2eec00]&&_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']==this['pRenderParam'][_0x2eec00]['nDisplayEffect'])return this['FreeFECPort'](_0x3d277e),-0x1;}return this['pRenderParam'][_0x3d277e]={},this['pRenderParam'][_0x3d277e]['fCosH']=0x1,this['pRenderParam'][_0x3d277e]['fSinH']=0x0,this['pRenderParam'][_0x3d277e]['fCosV']=0x1,this['pRenderParam'][_0x3d277e]['fSinV']=0x0,this['pRenderParam'][_0x3d277e]['fAngle']=0x0,this['pRenderParam'][_0x3d277e]['fRX1']=this['fRX1'],this['pRenderParam'][_0x3d277e]['fRX2']=this['fRX2'],this['pRenderParam'][_0x3d277e]['fRY1']=this['fRY1'],this['pRenderParam'][_0x3d277e]['fRY2']=this['fRY2'],this['pRenderParam'][_0x3d277e]['bBlack']=this['bBlack'],this['pRenderParam'][_0x3d277e]['fZoom']=0.035+0.8,this['pRenderParam'][_0x3d277e]['nDisplayEffect']=_0x549804,this['pRenderParam'][_0x3d277e]['bBlack']=!0x1,this['pRenderParam'][_0x3d277e]['bCut']=!0x1,this['pFishParam'][_0x3d277e]={},this['pFishParam'][_0x3d277e]['nFishParamType']=0x0,this['pFishParam'][_0x3d277e]['bCut']=!0x1,this['pFishParam'][_0x3d277e]['fAngle']=this['pRenderParam'][_0x3d277e]['fAngle'],this['pFishParam'][_0x3d277e]['fPTZX']=0.5,this['pFishParam'][_0x3d277e]['fPTZY']=0.5,this['pFishParam'][_0x3d277e]['fRXLeft']=this['pRenderParam'][_0x3d277e]['fRX1'],this['pFishParam'][_0x3d277e]['fRXRight']=this['pRenderParam'][_0x3d277e]['fRX2'],this['pFishParam'][_0x3d277e]['fRYTop']=this['pRenderParam'][_0x3d277e]['fRY1'],this['pFishParam'][_0x3d277e]['fRYBottom']=this['pRenderParam'][_0x3d277e]['fRY2'],this['pFishParam'][_0x3d277e]['bBlack']=this['pRenderParam'][_0x3d277e]['bBlack'],this['pFishParam'][_0x3d277e]['fZoom']=(this['pRenderParam'][_0x3d277e]['fZoom']-0.8)/0x7,this['bPortAllocated'][_0x3d277e]=!0x0,_0x3d277e;}},{'key':'FreeFECPort','value':function(_0x438789){if(_0x438789<0x0||_0x438789>=0x20)return _0x2ffc1c['SR_ERR_PARAM'];this['nWndPort']==_0x438789&&(this['nWndPort']=-0x1),null!=this['pRenderParam'][_0x438789]&&(this['pRenderParam'][_0x438789]['fCosH']=0x1,this['pRenderParam'][_0x438789]['fSinH']=0x0,this['pRenderParam'][_0x438789]['fCosV']=0x1,this['pRenderParam'][_0x438789]['fSinV']=0x0,this['pRenderParam'][_0x438789]['fAngle']=0x0,this['pRenderParam'][_0x438789]['fZoom']=0x0,this['pRenderParam'][_0x438789]['fRX1']=0x0,this['pRenderParam'][_0x438789]['fRX2']=0x1,this['pRenderParam'][_0x438789]['fRY1']=0x0,this['pRenderParam'][_0x438789]['fRY2']=0x1,this['pRenderParam'][_0x438789]['nDisplayEffect']=0x0,this['pRenderParam'][_0x438789]['bBlack']=!0x1,this['pRenderParam'][_0x438789]['bCut']=!0x1),null!=this['pFishParam'][_0x438789]&&(this['pFishParam'][_0x438789]['nFishParamType']=0x0,this['pFishParam'][_0x438789]['fRXLeft']=0x0,this['pFishParam'][_0x438789]['fRXRight']=0x1,this['pFishParam'][_0x438789]['fRYTop']=0x0,this['pFishParam'][_0x438789]['fRYBottom']=0x1,this['pFishParam'][_0x438789]['bBlack']=!0x1,this['pFishParam'][_0x438789]['bCut']=!0x1,this['pFishParam'][_0x438789]['fAngle']=0x0,this['pFishParam'][_0x438789]['fZoom']=0x0,this['pFishParam'][_0x438789]['fPTZX']=0.5,this['pFishParam'][_0x438789]['fPTZY']=0.5),this['nBasePTZPointNum'][_0x438789]=0x0,this['nOriPTZPointNum'][_0x438789]=0x0,this['nPanoPTZPointNum'][_0x438789]=0x0,this['nPTZRectNum'][_0x438789]=0x0;for(var _0x4166dd=0x0;_0x4166dd<0x4;++_0x4166dd)this['pRectPoints'][_0x438789][_0x4166dd]['fX']=0x0,this['pRectPoints'][_0x438789][_0x4166dd]['fY']=0x0;for(var _0x272993=0x0;_0x272993<0x400;++_0x272993)this['pBasePTZPoints'][_0x438789][_0x272993]['fX']=0x0,this['pBasePTZPoints'][_0x438789][_0x272993]['fY']=0x0,this['pOriPTZPoints'][_0x438789][_0x272993]['fX']=0x0,this['pOriPTZPoints'][_0x438789][_0x272993]['fY']=0x0,this['pPanoPTZPoints'][_0x438789][_0x272993]['fX']=0x0,this['pPanoPTZPoints'][_0x438789][_0x272993]['fY']=0x0;if(this['pPTZSetColor'][_0x438789]['bSetColor']&&(this['pPTZSetColor'][_0x438789]['fA']=0x0,this['pPTZSetColor'][_0x438789]['fR']=0x0,this['pPTZSetColor'][_0x438789]['fG']=0x0,this['pPTZSetColor'][_0x438789]['fB']=0x0,this['pPTZSetColor'][_0x438789]['bSetColor']=!0x1),this['bPTZSelected'][_0x438789]=!0x1,0x0!=this['nPlaceType']){for(var _0x24df6d=!0x1,_0x41faff=0x0;_0x41faff<0x20;++_0x41faff)if(null!=this['pRenderParam'][_0x41faff]&&(_0x5dc8af['SR_DE_FISH_PTZ_CEILING']==this['pRenderParam'][_0x41faff]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_PTZ_FLOOR']==this['pRenderParam'][_0x41faff]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_PTZ_WALL']==this['pRenderParam'][_0x41faff]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_360']==this['pRenderParam'][_0x41faff]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_180']==this['pRenderParam'][_0x41faff]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_360']==this['pRenderParam'][_0x41faff]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_180']==this['pRenderParam'][_0x41faff]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_PANORAMA_WALL']==this['pRenderParam'][_0x41faff]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_CYLINDER_CEILING']==this['pRenderParam'][_0x41faff]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']==this['pRenderParam'][_0x41faff]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_CEILING']==this['pRenderParam'][_0x41faff]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR']==this['pRenderParam'][_0x41faff]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']==this['pRenderParam'][_0x41faff]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']==this['pRenderParam'][_0x41faff]['nDisplayEffect'])){_0x24df6d=!0x0;break;}_0x24df6d||(this['nPlaceType']=0x0);}for(var _0x21cebe=!0x1,_0x17fe50=0x0;_0x17fe50<0x20;++_0x17fe50)if(null!=this['pRenderParam'][_0x17fe50]){_0x21cebe=!0x0;break;}_0x21cebe||(this['fRX1']=0x0,this['fRX2']=0x1,this['fRY1']=0x0,this['fRY2']=0x1,this['bBlack']=!0x1),this['nPTZFragmentNum'][_0x438789]=0x0;for(var _0x3ceaa3=0x0;_0x3ceaa3<0x64;++_0x3ceaa3)this['nPTZFragmentNode'][_0x438789][_0x3ceaa3]=0x0;return this['bPortAllocated'][_0x438789]=!0x1,_0x2ffc1c['SR_OK'];}},{'key':'DeInit','value':function(){for(var _0x486040=0x0;_0x486040<0x20;++_0x486040){for(var _0x26532e=0x0;_0x26532e<0x4;++_0x26532e)this['pRectPoints'][_0x486040][_0x26532e]=null;for(var _0x54cb08=0x0;_0x54cb08<0x400;++_0x54cb08)this['pBasePTZPoints'][_0x486040][_0x54cb08]=null,this['pOriPTZPoints'][_0x486040][_0x54cb08]=null,this['pPanoPTZPoints'][_0x486040][_0x54cb08]=null;this['nPTZFragmentNum'][_0x486040]=0x0,this['nPTZFragmentNode'][_0x486040]=null,this['bPortAllocated'][_0x486040]=!0x1,this['bPTZSelected'][_0x486040]=!0x1,this['pRenderParam'][_0x486040]=null,this['pFishParam'][_0x486040]=null,this['stPTZColor'][_0x486040]=null,this['nBasePTZPointNum'][_0x486040]=0x0,this['nOriPTZPointNum'][_0x486040]=0x0,this['nPanoPTZPointNum'][_0x486040]=0x0,this['nPTZRectNum'][_0x486040]=0x0,this['pPanoPTZPoints'][_0x486040]=null,this['pRectPoints'][_0x486040]=null,this['pBasePTZPoints'][_0x486040]=null,this['pOriPTZPoints'][_0x486040]=null;}return this['bPortAllocated']=null,this['pRenderParam']=null,this['pFishParam']=null,this['stPTZColor']=null,this['nBasePTZPointNum']=null,this['nOriPTZPointNum']=null,this['nPanoPTZPointNum']=null,this['nPTZFragmentNum']=null,this['pBasePTZPoints']=null,this['pPanoPTZPoints']=null,this['pRectPoints']=null,this['nPTZRectNum']=null,this['nPTZDisplayMode']=_0x280409['SR_DM_NULL'],this['fRX1']=0x0,this['fRX2']=0x1,this['fRY1']=0x0,this['fRY2']=0x1,this['bBlack']=!0x1,this['pOriPTZPoints']=null,this['pBasePTZPoints']=null,this['nWndPort']=-0x1,this['nPlaceType']=0x0,this['nPTZFragmentNode']=null,this['bPTZSelected']=null,this['nPTZDisplayMode']=_0x280409['SR_DM_RANGE'],_0x2ffc1c['SR_OK'];}},{'key':'InitColorList','value':function(){this['stPTZColor'][0x0]['fR']=0.5,this['stPTZColor'][0x0]['fG']=0.5,this['stPTZColor'][0x0]['fB']=0x0,this['stPTZColor'][0x0]['fA']=0x1,this['stPTZColor'][0x1]['fR']=0x1,this['stPTZColor'][0x1]['fG']=0x0,this['stPTZColor'][0x1]['fB']=0x0,this['stPTZColor'][0x1]['fA']=0x1,this['stPTZColor'][0x2]['fR']=0x0,this['stPTZColor'][0x2]['fG']=0x1,this['stPTZColor'][0x2]['fB']=0x0,this['stPTZColor'][0x2]['fA']=0x1,this['stPTZColor'][0x3]['fR']=0x0,this['stPTZColor'][0x3]['fG']=0x0,this['stPTZColor'][0x3]['fB']=0x1,this['stPTZColor'][0x3]['fA']=0x1,this['stPTZColor'][0x4]['fR']=0x1,this['stPTZColor'][0x4]['fG']=0x1,this['stPTZColor'][0x4]['fB']=0x0,this['stPTZColor'][0x4]['fA']=0x1,this['stPTZColor'][0x5]['fR']=0.5,this['stPTZColor'][0x5]['fG']=0x0,this['stPTZColor'][0x5]['fB']=0x1,this['stPTZColor'][0x5]['fA']=0x1,this['stPTZColor'][0x6]['fR']=0x0,this['stPTZColor'][0x6]['fG']=0x1,this['stPTZColor'][0x6]['fB']=0x1,this['stPTZColor'][0x6]['fA']=0x1,this['stPTZColor'][0x7]['fR']=0x1,this['stPTZColor'][0x7]['fG']=0.5,this['stPTZColor'][0x7]['fB']=0x0,this['stPTZColor'][0x7]['fA']=0x1,this['stPTZColor'][0x8]['fR']=0x0,this['stPTZColor'][0x8]['fG']=0.5,this['stPTZColor'][0x8]['fB']=0.5,this['stPTZColor'][0x8]['fA']=0x1;for(var _0x141650=0x9;_0x141650<0x20;_0x141650++)this['stPTZColor'][_0x141650]['fR']=0x1*_0x141650/0x20,this['stPTZColor'][_0x141650]['fG']=0x1*_0x141650/0x20,this['stPTZColor'][_0x141650]['fB']=0x1*_0x141650/0x20,this['stPTZColor'][_0x141650]['fA']=0x1;return _0x2ffc1c['SR_OK'];}},{'key':'GetRangePoints','value':function(_0x39bfd7){if(_0x39bfd7<0x0||_0x39bfd7>=0x20)return _0x2ffc1c['SR_ERR_PARAM'];if(null==this['pRenderParam'][_0x39bfd7])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x373eee=0x0,_0x105dec=0x0;switch(this['nOriPTZPointNum'][_0x39bfd7]=0x0,this['nBasePTZPointNum'][_0x39bfd7]=0x0,this['pRenderParam'][_0x39bfd7]['nDisplayEffect']){case _0x5dc8af['SR_DE_FISH_PTZ_CEILING']:for(_0x105dec=0x0;_0x105dec<0x1;_0x105dec+=0.01)this['GetFishPTZCeiling'](_0x373eee,_0x105dec,_0x39bfd7);for(_0x105dec=0.9995,_0x373eee=0x0;_0x373eee<0x1;_0x373eee+=0.02)this['GetFishPTZCeiling'](_0x373eee,_0x105dec,_0x39bfd7);for(_0x373eee=0.999,_0x105dec=0.9995;_0x105dec>=0x0;_0x105dec-=0.01)this['GetFishPTZCeiling'](_0x373eee,_0x105dec,_0x39bfd7);for(_0x105dec=0x0,_0x373eee=0.999;_0x373eee>=0x0;_0x373eee-=0.02)this['GetFishPTZCeiling'](_0x373eee,_0x105dec,_0x39bfd7);break;case _0x5dc8af['SR_DE_FISH_PTZ_FLOOR']:for(_0x105dec=0x0;_0x105dec<0x1;_0x105dec+=0.01)this['GetFishPTZFloor'](_0x373eee,_0x105dec,_0x39bfd7);for(_0x105dec=0.9995,_0x373eee=0x0;_0x373eee<0x1;_0x373eee+=0.02)this['GetFishPTZFloor'](_0x373eee,_0x105dec,_0x39bfd7);for(_0x373eee=0.999,_0x105dec=0.9995;_0x105dec>=0x0;_0x105dec-=0.01)this['GetFishPTZFloor'](_0x373eee,_0x105dec,_0x39bfd7);for(_0x105dec=0x0,_0x373eee=0.999;_0x373eee>=0x0;_0x373eee-=0.02)this['GetFishPTZFloor'](_0x373eee,_0x105dec,_0x39bfd7);break;case _0x5dc8af['SR_DE_FISH_PTZ_WALL']:for(_0x105dec=0x0;_0x105dec<0x1;_0x105dec+=0.01)this['GetFishPTZWALL'](_0x373eee,_0x105dec,_0x39bfd7);for(_0x105dec=0.9995,_0x373eee=0x0;_0x373eee<0x1;_0x373eee+=0.02)this['GetFishPTZWALL'](_0x373eee,_0x105dec,_0x39bfd7);for(_0x373eee=0.999,_0x105dec=0.9995;_0x105dec>=0x0;_0x105dec-=0.01)this['GetFishPTZWALL'](_0x373eee,_0x105dec,_0x39bfd7);for(_0x105dec=0x0,_0x373eee=0.999;_0x373eee>=0x0;_0x373eee-=0.02)this['GetFishPTZWALL'](_0x373eee,_0x105dec,_0x39bfd7);break;default:return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}return _0x2ffc1c['SR_OK'];}},{'key':'TransformPTZRangePoints','value':function(_0x11c1df){if(-0x1==this['nWndPort'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==this['pBasePTZPoints'][_0x11c1df]||null==this['pRenderParam'][this['nWndPort']])return _0x2ffc1c['SR_ERR_CALL_ORDER'];this['nPanoPTZPointNum'][_0x11c1df]=0x0;var _0xe80fd6=_0x2ffc1c['SR_OK'],_0x35c825=this['nWndPort'];switch(this['pRenderParam'][_0x35c825]['nDisplayEffect']){case _0x5dc8af['SR_DE_FISH_PANORAMA_WALL']:if(_0xe80fd6=this['GetPanoPTZWall'](_0x11c1df),_0x2ffc1c['SR_OK']!=_0xe80fd6)return _0xe80fd6;break;case _0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_360']:if(_0xe80fd6=this['GetPanoPTZFloor'](_0x11c1df),_0x2ffc1c['SR_OK']!=_0xe80fd6)return _0xe80fd6;break;case _0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_360']:if(_0xe80fd6=this['GetPanoPTZCeiling'](_0x11c1df),_0x2ffc1c['SR_OK']!=_0xe80fd6)return _0xe80fd6;}return this['CalcPTZFragmentPoints'](_0x11c1df),_0x2ffc1c['SR_OK'];}},{'key':'GetRectPoints','value':function(_0x219e1c){if(_0x219e1c<0x0||_0x219e1c>=0x20)return _0x2ffc1c['SR_ERR_PARAM'];if(-0x1==this['nWndPort'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==this['pRenderParam'][this['nWndPort']]||null==this['pFishParam'][_0x219e1c])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x537a49=this['pRenderParam'][this['nWndPort']]['nDisplayEffect'],_0x1f9c92=_0x2ffc1c['SR_OK'],_0x53680b={'fX':0x0,'fY':0x0};switch(_0x537a49){case _0x5dc8af['SR_DE_FISH_PANORAMA_WALL']:if(_0x1f9c92=this['GetPointFish2PanoWall'](_0x53680b,this['pFishParam'][_0x219e1c]['fPTZX'],this['pFishParam'][_0x219e1c]['fPTZY']),_0x2ffc1c['SR_OK']!=_0x1f9c92)return _0x1f9c92;break;case _0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_360']:if(_0x1f9c92=this['GetPointFish2PanoFloor'](_0x53680b,this['pFishParam'][_0x219e1c]['fPTZX'],this['pFishParam'][_0x219e1c]['fPTZY']),_0x2ffc1c['SR_OK']!=_0x1f9c92)return _0x2ffc1c['SR_ERR_NOT_SUPPORT']==_0x1f9c92&&(this['pRectPoints'][_0x219e1c]=null),_0x1f9c92;break;case _0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_360']:if(_0x1f9c92=this['GetPointFish2PanoCeiling'](_0x53680b,this['pFishParam'][_0x219e1c]['fPTZX'],this['pFishParam'][_0x219e1c]['fPTZY']),_0x2ffc1c['SR_OK']!=_0x1f9c92)return _0x2ffc1c['SR_ERR_NOT_SUPPORT']==_0x1f9c92&&(this['pRectPoints'][_0x219e1c]=null),_0x1f9c92;break;case _0x5dc8af['SR_DE_FISH_ORIGINAL']:_0x53680b['fX']=this['pFishParam'][_0x219e1c]['fPTZX'],_0x53680b['fY']=this['pFishParam'][_0x219e1c]['fPTZY'];}if(null==this['pRectPoints'][_0x219e1c]){this['pRectPoints'][_0x219e1c]=[];for(var _0x206ce1=0x0;_0x206ce1<0x4;++_0x206ce1)this['pRectPoints'][_0x219e1c][_0x206ce1]={},this['pRectPoints'][_0x219e1c][_0x206ce1]['fX']=0x0,this['pRectPoints'][_0x219e1c][_0x206ce1]['fY']=0x0;}return this['pRectPoints'][_0x219e1c][0x0]['fX']=_0x53680b['fX']-0.05,this['pRectPoints'][_0x219e1c][0x0]['fY']=_0x53680b['fY']-0.05,this['pRectPoints'][_0x219e1c][0x1]['fX']=_0x53680b['fX']+0.05,this['pRectPoints'][_0x219e1c][0x1]['fY']=_0x53680b['fY']-0.05,this['pRectPoints'][_0x219e1c][0x2]['fX']=_0x53680b['fX']+0.05,this['pRectPoints'][_0x219e1c][0x2]['fY']=_0x53680b['fY']+0.05,this['pRectPoints'][_0x219e1c][0x3]['fX']=_0x53680b['fX']-0.05,this['pRectPoints'][_0x219e1c][0x3]['fY']=_0x53680b['fY']+0.05,this['nPTZRectNum'][_0x219e1c]=0x4,_0x2ffc1c['SR_OK'];}},{'key':'GetFishPTZCeiling','value':function(_0x2c59c4,_0x539f8c,_0x272d4f){var _0x45b506,_0x5400e6,_0x3a0998,_0x3a7a12,_0x2afdfd,_0xa5bd82,_0x353348,_0x117478={'fX':0x0,'fY':0x0},_0x461a60={'fX':0x0,'fY':0x0},_0x5851b1={'fX':0x0,'fY':0x0},_0x4d16da={};_0x3a7a12=(this['fRX2']-this['fRX1'])/(this['fRY2']-this['fRY1']),_0x2afdfd=(this['fRX1']+this['fRX2'])/0x2*0x1,_0xa5bd82=(this['fRY1']+this['fRY2'])/0x2*_0x3a7a12,_0x353348=(this['fRX2']-this['fRX1'])/0x2*0x1,_0x117478['fX']=_0x539f8c-0.5,_0x117478['fY']=0.5-_0x2c59c4,_0x45b506=this['pRenderParam'][_0x272d4f]['fZoom'],_0x461a60['fX']=_0x117478['fX'],_0x461a60['fY']=_0x117478['fY']*this['pRenderParam'][_0x272d4f]['fCosV']+_0x45b506*this['pRenderParam'][_0x272d4f]['fSinV'],_0x5400e6=_0x45b506*this['pRenderParam'][_0x272d4f]['fCosV']-_0x117478['fY']*this['pRenderParam'][_0x272d4f]['fSinV'],_0x3a0998=Math['sqrt'](_0x461a60['fX']*_0x461a60['fX']+_0x461a60['fY']*_0x461a60['fY']);var _0x396733=Math['sqrt'](_0x461a60['fX']*_0x461a60['fX']+_0x461a60['fY']*_0x461a60['fY']+_0x5400e6*_0x5400e6),_0x30eb5c=Math['asin'](_0x3a0998/_0x396733)/1.5707963*0.5;_0x461a60['fX']=_0x30eb5c*_0x461a60['fX']/_0x3a0998,_0x461a60['fY']=_0x30eb5c*_0x461a60['fY']/_0x3a0998,_0x5851b1['fX']=_0x461a60['fX']*this['pRenderParam'][_0x272d4f]['fCosH']-_0x461a60['fY']*this['pRenderParam'][_0x272d4f]['fSinH'],_0x5851b1['fY']=_0x461a60['fX']*this['pRenderParam'][_0x272d4f]['fSinH']+_0x461a60['fY']*this['pRenderParam'][_0x272d4f]['fCosH'],_0x4d16da['fX']=0x2*_0x5851b1['fX']*_0x353348+_0x2afdfd,_0x4d16da['fY']=0x2*-_0x5851b1['fY']*_0x353348+_0xa5bd82;var _0xa9f9cd=this['nBasePTZPointNum'][_0x272d4f];this['pBasePTZPoints'][_0x272d4f][_0xa9f9cd]['fX']=_0x5851b1['fX']+0.5,this['pBasePTZPoints'][_0x272d4f][_0xa9f9cd]['fY']=0.5-_0x5851b1['fY'],this['nBasePTZPointNum'][_0x272d4f]=this['nBasePTZPointNum'][_0x272d4f]+0x1;var _0x1b10d4=this['fRX1']<=0x0?0x0:0x1*this['fRX1'],_0x17c47a=this['fRY1']<=0x0?0x0:this['fRY1']*_0x3a7a12,_0xfeae16=this['fRX2']>=0x1?0x1-_0x1b10d4:0x1*this['fRX2']-_0x1b10d4,_0x5a0a31=this['fRY2']>=0x1?_0x3a7a12-_0x17c47a:this['fRY2']*_0x3a7a12-_0x17c47a;if(_0x4d16da['fX']=(_0x4d16da['fX']-_0x1b10d4)/_0xfeae16,_0x4d16da['fY']=(_0x4d16da['fY']-_0x17c47a)/_0x5a0a31,_0x4d16da['fX']<=0x1&&_0x4d16da['fY']<=0x1&&_0x4d16da['fX']>=0x0&&_0x4d16da['fY']>=0x0){var _0x3e47fb=this['nOriPTZPointNum'][_0x272d4f];this['pOriPTZPoints'][_0x272d4f][_0x3e47fb]['fX']=_0x4d16da['fX'],this['pOriPTZPoints'][_0x272d4f][_0x3e47fb]['fY']=_0x4d16da['fY'],this['nOriPTZPointNum'][_0x272d4f]=this['nOriPTZPointNum'][_0x272d4f]+0x1;}return _0x2ffc1c['SR_OK'];}},{'key':'GetFishPTZFloor','value':function(_0x5ac3f5,_0x5aaa18,_0x2c30e2){var _0x21a63c,_0x217117,_0x304cc8,_0x4c32d8,_0x43f1e9,_0x3e8912,_0x4dd2d6,_0xf11a1a={'fX':0x0,'fY':0x0},_0x1c1372={'fX':0x0,'fY':0x0},_0x58b1dd={'fX':0x0,'fY':0x0},_0x12558d={};_0x4c32d8=(this['fRX2']-this['fRX1'])/(this['fRY2']-this['fRY1']),_0x43f1e9=(this['fRX1']+this['fRX2'])/0x2*0x1,_0x3e8912=(this['fRY1']+this['fRY2'])/0x2*_0x4c32d8,_0x4dd2d6=(this['fRX2']-this['fRX1'])/0x2*0x1,_0xf11a1a['fX']=_0x5ac3f5-0.5,_0xf11a1a['fY']=_0x5aaa18-0.5,_0x21a63c=this['pRenderParam'][_0x2c30e2]['fZoom'],_0x1c1372['fX']=_0xf11a1a['fX'],_0x1c1372['fY']=_0xf11a1a['fY']*this['pRenderParam'][_0x2c30e2]['fCosV']+_0x21a63c*this['pRenderParam'][_0x2c30e2]['fSinV'],_0x217117=_0x21a63c*this['pRenderParam'][_0x2c30e2]['fCosV']-_0xf11a1a['fY']*this['pRenderParam'][_0x2c30e2]['fSinV'],_0x304cc8=Math['sqrt'](_0x1c1372['fX']*_0x1c1372['fX']+_0x1c1372['fY']*_0x1c1372['fY']);var _0x45d2df=Math['sqrt'](_0x1c1372['fX']*_0x1c1372['fX']+_0x1c1372['fY']*_0x1c1372['fY']+_0x217117*_0x217117),_0x22a535=Math['asin'](_0x304cc8/_0x45d2df)/1.5707963*0.5;_0x1c1372['fX']=_0x22a535*_0x1c1372['fX']/_0x304cc8,_0x1c1372['fY']=_0x22a535*_0x1c1372['fY']/_0x304cc8,_0x58b1dd['fX']=_0x1c1372['fX']*this['pRenderParam'][_0x2c30e2]['fCosH']-_0x1c1372['fY']*this['pRenderParam'][_0x2c30e2]['fSinH'],_0x58b1dd['fY']=_0x1c1372['fX']*this['pRenderParam'][_0x2c30e2]['fSinH']+_0x1c1372['fY']*this['pRenderParam'][_0x2c30e2]['fCosH'],_0x12558d['fX']=0x2*_0x58b1dd['fX']*_0x4dd2d6+_0x43f1e9,_0x12558d['fY']=0x2*_0x58b1dd['fY']*_0x4dd2d6+_0x3e8912;var _0x396a6c=this['nBasePTZPointNum'][_0x2c30e2];this['pBasePTZPoints'][_0x2c30e2][_0x396a6c]['fX']=_0x58b1dd['fX']+0.5,this['pBasePTZPoints'][_0x2c30e2][_0x396a6c]['fY']=_0x58b1dd['fY']+0.5,this['nBasePTZPointNum'][_0x2c30e2]=this['nBasePTZPointNum'][_0x2c30e2]+0x1;var _0x129dad=this['fRX1']<=0x0?0x0:0x1*this['fRX1'],_0x268a05=this['fRY1']<=0x0?0x0:this['fRY1']*_0x4c32d8,_0x10369c=this['fRX2']>=0x1?0x1-_0x129dad:0x1*this['fRX2']-_0x129dad,_0x3fa8ab=this['fRY2']>=0x1?_0x4c32d8-_0x268a05:this['fRY2']*_0x4c32d8-_0x268a05;if(_0x12558d['fX']=(_0x12558d['fX']-_0x129dad)/_0x10369c,_0x12558d['fY']=(_0x12558d['fY']-_0x268a05)/_0x3fa8ab,_0x12558d['fX']<=0x1&&_0x12558d['fY']<=0x1&&_0x12558d['fX']>=0x0&&_0x12558d['fY']>=0x0){var _0x421a9a=this['nOriPTZPointNum'][_0x2c30e2];this['pOriPTZPoints'][_0x2c30e2][_0x421a9a]['fX']=_0x12558d['fX'],this['pOriPTZPoints'][_0x2c30e2][_0x421a9a]['fY']=_0x12558d['fY'],this['nOriPTZPointNum'][_0x2c30e2]=this['nOriPTZPointNum'][_0x2c30e2]+0x1;}return _0x2ffc1c['SR_OK'];}},{'key':'GetFishPTZWALL','value':function(_0x1c950a,_0x37e68d,_0x3162fa){var _0x109ba1,_0x9f18a9,_0x40fe67,_0x4d8e0a,_0x5e1a8c,_0x316478,_0x307945,_0x195529,_0x7405f={'fX':0x0,'fY':0x0},_0x40802f={'fX':0x0,'fY':0x0},_0x428e24={'fX':0x0,'fY':0x0},_0x3dbb39={};_0x5e1a8c=(this['fRX2']-this['fRX1'])/(this['fRY2']-this['fRY1']),_0x316478=(this['fRX1']+this['fRX2'])/0x2*0x1,_0x307945=(this['fRY1']+this['fRY2'])/0x2*_0x5e1a8c,_0x195529=(this['fRX2']-this['fRX1'])/0x2*0x1,_0x7405f['fX']=_0x37e68d-0.5,_0x7405f['fY']=_0x1c950a-0.5,_0x109ba1=this['pRenderParam'][_0x3162fa]['fZoom'],_0x40802f['fX']=_0x7405f['fX'],_0x40802f['fY']=_0x7405f['fY']*this['pRenderParam'][_0x3162fa]['fCosV']+_0x109ba1*this['pRenderParam'][_0x3162fa]['fSinV'],_0x9f18a9=_0x109ba1*this['pRenderParam'][_0x3162fa]['fCosV']-_0x7405f['fY']*this['pRenderParam'][_0x3162fa]['fSinV'],_0x428e24['fX']=_0x40802f['fX']*this['pRenderParam'][_0x3162fa]['fCosH']+_0x9f18a9*this['pRenderParam'][_0x3162fa]['fSinH'],_0x428e24['fY']=_0x40802f['fY'],_0x40fe67=_0x9f18a9*this['pRenderParam'][_0x3162fa]['fCosH']-_0x40802f['fX']*this['pRenderParam'][_0x3162fa]['fSinH'],_0x4d8e0a=Math['sqrt'](_0x428e24['fX']*_0x428e24['fX']+_0x428e24['fY']*_0x428e24['fY']);var _0x536124=Math['sqrt'](_0x428e24['fX']*_0x428e24['fX']+_0x428e24['fY']*_0x428e24['fY']+_0x40fe67*_0x40fe67),_0x29f7b2=Math['asin'](_0x4d8e0a/_0x536124)/1.5707963*0.5;_0x3dbb39['fX']=_0x29f7b2*_0x428e24['fX']/_0x4d8e0a*_0x195529*0x2+_0x316478,_0x3dbb39['fY']=_0x29f7b2*_0x428e24['fY']/_0x4d8e0a*_0x195529*0x2+_0x307945;var _0x3dbd05=this['nBasePTZPointNum'][_0x3162fa];this['pBasePTZPoints'][_0x3162fa][_0x3dbd05]['fX']=_0x29f7b2*_0x428e24['fX']/_0x4d8e0a+0.5,this['pBasePTZPoints'][_0x3162fa][_0x3dbd05]['fY']=_0x29f7b2*_0x428e24['fY']/_0x4d8e0a+0.5,this['nBasePTZPointNum'][_0x3162fa]=this['nBasePTZPointNum'][_0x3162fa]+0x1;var _0x449faf=this['fRX1']<=0x0?0x0:0x1*this['fRX1'],_0x2241b2=this['fRY1']<=0x0?0x0:this['fRY1']*_0x5e1a8c,_0x1b0fd1=this['fRX2']>=0x1?0x1-_0x449faf:0x1*this['fRX2']-_0x449faf,_0x2ded6a=this['fRY2']>=0x1?_0x5e1a8c-_0x2241b2:this['fRY2']*_0x5e1a8c-_0x2241b2;if(_0x3dbb39['fX']=(_0x3dbb39['fX']-_0x449faf)/_0x1b0fd1,_0x3dbb39['fY']=(_0x3dbb39['fY']-_0x2241b2)/_0x2ded6a,_0x3dbb39['fX']<=0x1&&_0x3dbb39['fY']<=0x1&&_0x3dbb39['fX']>=0x0&&_0x3dbb39['fY']>=0x0){var _0x4fe5f3=this['nOriPTZPointNum'][_0x3162fa];this['pOriPTZPoints'][_0x3162fa][_0x4fe5f3]['fX']=_0x3dbb39['fX'],this['pOriPTZPoints'][_0x3162fa][_0x4fe5f3]['fY']=_0x3dbb39['fY'],this['nOriPTZPointNum'][_0x3162fa]=this['nOriPTZPointNum'][_0x3162fa]+0x1;}return _0x2ffc1c['SR_OK'];}},{'key':'GetPanoPTZCeiling','value':function(_0x51221e){if(null==this['pRenderParam'][_0x51221e]||null==this['pRenderParam'][this['nWndPort']])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==this['pBasePTZPoints'][_0x51221e])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x2d7976,_0x573174,_0x5e7925=this['nBasePTZPointNum'][_0x51221e];_0x2d7976=(this['fRX2']-this['fRX1'])/(this['fRY2']-this['fRY1']),_0x573174=(this['fRX2']-this['fRX1'])/0x2*0x1;var _0x31557a,_0x2aa072=0x0;(this['fRX2']>0x1||this['fRY2']>0x1||this['fRY1']<0x0||this['fRX1']<0x0)&&(this['fRX1']<0x0&&(_0x31557a=0x1*-this['fRX1'])>_0x2aa072&&(_0x2aa072=_0x31557a),this['fRX2']>0x1&&(_0x31557a=0x1*(this['fRX2']-0x1))>_0x2aa072&&(_0x2aa072=_0x31557a),this['fRY1']<0x0&&(_0x31557a=-this['fRY1']*_0x2d7976)>_0x2aa072&&(_0x2aa072=_0x31557a),this['fRY2']>0x1&&(_0x31557a=(this['fRY2']-0x1)*_0x2d7976)>_0x2aa072&&(_0x2aa072=_0x31557a));for(var _0x475a88,_0x1d061a=_0x2aa072/_0x573174,_0x3bc8fc={'fX':0x0,'fY':0x0},_0x2bfe29={'fX':0x0,'fY':0x0},_0x5ee10d=0x0;_0x5ee10d<_0x5e7925;++_0x5ee10d)if(_0x2bfe29['fX']=this['pBasePTZPoints'][_0x51221e][_0x5ee10d]['fX'],_0x2bfe29['fY']=this['pBasePTZPoints'][_0x51221e][_0x5ee10d]['fY'],!(Math['abs'](_0x2bfe29['fX']-0.5)<0.000001&&Math['abs'](_0x2bfe29['fY']-0.5)<0.000001)){var _0x22c53e={'fX':0x0,'fY':0x0},_0xa05da4={'fX':0x0,'fY':0x0};_0x22c53e['fX']=_0x2bfe29['fX']-0.5,_0x22c53e['fY']=_0x2bfe29['fY']-0.5,_0xa05da4['fX']=-0.5*Math['sin'](this['pRenderParam'][this['nWndPort']]['fAngle']),_0xa05da4['fY']=0.5*Math['cos'](this['pRenderParam'][this['nWndPort']]['fAngle']);var _0x3021a4=Math['sqrt'](_0x22c53e['fX']*_0x22c53e['fX']+_0x22c53e['fY']*_0x22c53e['fY']),_0x10de26=Math['sqrt'](_0xa05da4['fX']*_0xa05da4['fX']+_0xa05da4['fY']*_0xa05da4['fY']);if(_0x475a88=Math['acos']((_0x22c53e['fX']*_0xa05da4['fX']+_0x22c53e['fY']*_0xa05da4['fY'])/(_0x3021a4*_0x10de26)),_0x22c53e['fX']*_0xa05da4['fY']-_0x22c53e['fY']*_0xa05da4['fX']>0x0&&(_0x475a88=6.2831852-_0x475a88),_0x3bc8fc['fX']=_0x475a88/6.2831853,_0x3bc8fc['fY']=(0x2*(0.5-_0x3021a4)-_0x1d061a)/(0.8-_0x1d061a),_0x3bc8fc['fY']>=0x0&&_0x3bc8fc['fX']>=0x0&&_0x3bc8fc['fY']<=0x1&&_0x3bc8fc['fX']<=0x1){var _0x3e6192=this['nPanoPTZPointNum'][_0x51221e];this['pPanoPTZPoints'][_0x51221e][_0x3e6192]['fX']=_0x3bc8fc['fX'],this['pPanoPTZPoints'][_0x51221e][_0x3e6192]['fY']=_0x3bc8fc['fY'],this['nPanoPTZPointNum'][_0x51221e]=this['nPanoPTZPointNum'][_0x51221e]+0x1;}}return _0x2ffc1c['SR_OK'];}},{'key':'GetPanoPTZFloor','value':function(_0x419aee){if(null==this['pRenderParam'][_0x419aee]||null==this['pRenderParam'][this['nWndPort']])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==this['pBasePTZPoints'][_0x419aee])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x4976a0,_0x198b16,_0x3bcaa3=this['nBasePTZPointNum'][_0x419aee];_0x4976a0=(this['fRX2']-this['fRX1'])/(this['fRY2']-this['fRY1']),_0x198b16=(this['fRX2']-this['fRX1'])/0x2*0x1;var _0x4346c3,_0x412a87=0x0;(this['fRX2']>0x1||this['fRY2']>0x1||this['fRY1']<0x0||this['fRX1']<0x0)&&(this['fRX1']<0x0&&(_0x4346c3=0x1*-this['fRX1'])>_0x412a87&&(_0x412a87=_0x4346c3),this['fRX2']>0x1&&(_0x4346c3=0x1*(this['fRX2']-0x1))>_0x412a87&&(_0x412a87=_0x4346c3),this['fRY1']<0x0&&(_0x4346c3=-this['fRY1']*_0x4976a0)>_0x412a87&&(_0x412a87=_0x4346c3),this['fRY2']>0x1&&(_0x4346c3=(this['fRY2']-0x1)*_0x4976a0)>_0x412a87&&(_0x412a87=_0x4346c3));for(var _0x591157,_0x4c2063=_0x412a87/_0x198b16,_0x42f446={'fX':0x0,'fY':0x0},_0x452de3={'fX':0x0,'fY':0x0},_0x2a79e9=0x0;_0x2a79e9<_0x3bcaa3;++_0x2a79e9)if(_0x452de3['fX']=this['pBasePTZPoints'][_0x419aee][_0x2a79e9]['fX'],_0x452de3['fY']=this['pBasePTZPoints'][_0x419aee][_0x2a79e9]['fY'],!(Math['abs'](_0x452de3['fX']-0.5)<0.000001&&Math['abs'](_0x452de3['fY']-0.5)<0.000001)){var _0x33984b={'fX':0x0,'fY':0x0},_0x5133bf={'fX':0x0,'fY':0x0};_0x33984b['fX']=_0x452de3['fX']-0.5,_0x33984b['fY']=_0x452de3['fY']-0.5,_0x5133bf['fX']=-0.5*Math['sin'](this['pRenderParam'][this['nWndPort']]['fAngle']),_0x5133bf['fY']=0.5*Math['cos'](this['pRenderParam'][this['nWndPort']]['fAngle']);var _0x480162=Math['sqrt'](_0x33984b['fX']*_0x33984b['fX']+_0x33984b['fY']*_0x33984b['fY']),_0x10ef5e=Math['sqrt'](_0x5133bf['fX']*_0x5133bf['fX']+_0x5133bf['fY']*_0x5133bf['fY']);if(_0x591157=Math['acos']((_0x33984b['fX']*_0x5133bf['fX']+_0x33984b['fY']*_0x5133bf['fY'])/(_0x480162*_0x10ef5e)),_0x33984b['fX']*_0x5133bf['fY']-_0x33984b['fY']*_0x5133bf['fX']>0x0&&(_0x591157=6.2831852-_0x591157),_0x42f446['fX']=0x1-_0x591157/6.2831853,_0x42f446['fY']=0x1-(0x2*(0.5-_0x480162)-_0x4c2063)/(0.8-_0x4c2063),_0x42f446['fY']>=0x0&&_0x42f446['fX']>=0x0&&_0x42f446['fY']<=0x1&&_0x42f446['fX']<=0x1){var _0x51b0bd=this['nPanoPTZPointNum'][_0x419aee];this['pPanoPTZPoints'][_0x419aee][_0x51b0bd]['fX']=_0x42f446['fX'],this['pPanoPTZPoints'][_0x419aee][_0x51b0bd]['fY']=_0x42f446['fY'],this['nPanoPTZPointNum'][_0x419aee]=this['nPanoPTZPointNum'][_0x419aee]+0x1;}}return _0x2ffc1c['SR_OK'];}},{'key':'GetPanoPTZWall','value':function(_0x2636ce){if(null==this['pRenderParam'][_0x2636ce]||null==this['pRenderParam'][this['nWndPort']])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==this['pBasePTZPoints'][_0x2636ce])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x29b10b,_0x1347ff,_0xe9813=this['nBasePTZPointNum'][_0x2636ce];_0x29b10b=(this['fRX2']-this['fRX1'])/(this['fRY2']-this['fRY1']),_0x1347ff=(this['fRX2']-this['fRX1'])/0x2*0x1;var _0x17bc16,_0x2736a6,_0x4e95a9,_0x3dc287,_0x40103a,_0x2e382e=0x0,_0x4100ed=0x1,_0xb19e70=0.1,_0x2766d6=0.9;this['fRX1']<0x0&&(_0x17bc16=0x1*-this['fRX1'],_0x2e382e=_0x17bc16/=0x2*_0x1347ff),this['fRX2']>0x1&&(_0x2736a6=0x1*(this['fRX2']-0x1),_0x4100ed=0x1-(_0x2736a6/=0x2*_0x1347ff)),this['fRY1']<0x0&&(_0x4e95a9=-this['fRY1']*_0x29b10b,_0xb19e70=(_0x4e95a9/=0x2*_0x1347ff)>0.1?_0x4e95a9:0.1),this['fRY2']>0x1&&(_0x3dc287=(this['fRY2']-0x1)*_0x29b10b,_0x2766d6=(_0x3dc287/=0x2*_0x1347ff)>0x1-0.9?0x1-_0x3dc287:0.9);for(var _0x1ab9a9={'fX':0x0,'fY':0x0},_0x3822e7={'fX':0x0,'fY':0x0},_0x279831=0x0;_0x279831<_0xe9813;++_0x279831){_0x3822e7['fX']=this['pBasePTZPoints'][_0x2636ce][_0x279831]['fX'],_0x3822e7['fY']=this['pBasePTZPoints'][_0x2636ce][_0x279831]['fY'];var _0x4bf89f=0x2*_0x3822e7['fX']*_0x1347ff,_0x2e0b82=0x2*_0x3822e7['fY']*_0x1347ff;if(_0x40103a=Math['sqrt'](_0x1347ff*_0x1347ff-(_0x2e0b82-_0x1347ff)*(_0x2e0b82-_0x1347ff)),!(Math['abs'](_0x40103a)<0.000001)&&(_0x3822e7['fX']=_0x1347ff*(_0x4bf89f-_0x1347ff)/_0x40103a+_0x1347ff,_0x3822e7['fY']=_0x2e0b82,_0x1ab9a9['fX']=(_0x3822e7['fX']-0x2*_0x2e382e*_0x1347ff)/(0x2*(_0x4100ed-_0x2e382e)*_0x1347ff),_0x1ab9a9['fY']=(_0x3822e7['fY']-0x2*_0xb19e70*_0x1347ff)/(0x2*(_0x2766d6-_0xb19e70)*_0x1347ff),_0x1ab9a9['fY']>=0x0&&_0x1ab9a9['fX']>=0x0&&_0x1ab9a9['fY']<=0x1&&_0x1ab9a9['fX']<=0x1)){var _0x10cce6=this['nPanoPTZPointNum'][_0x2636ce];this['pPanoPTZPoints'][_0x2636ce][_0x10cce6]['fX']=_0x1ab9a9['fX'],this['pPanoPTZPoints'][_0x2636ce][_0x10cce6]['fY']=_0x1ab9a9['fY'],this['nPanoPTZPointNum'][_0x2636ce]=this['nPanoPTZPointNum'][_0x2636ce]+0x1;}}return _0x2ffc1c['SR_OK'];}},{'key':'GetPointPano2FishCeiling','value':function(_0x70b06b,_0x12f0d1,_0x3770b0){if(null==_0x70b06b||null==this['pRenderParam'][this['nWndPort']])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x5d2167,_0x2eb2c8;_0x5d2167=(this['fRX2']-this['fRX1'])/(this['fRY2']-this['fRY1']),_0x2eb2c8=(this['fRX2']-this['fRX1'])/0x2*0x1;var _0x2b76c7,_0x1a1043=0x0,_0x4957e0=0x1,_0x201ce6=0x0,_0x40a35b=0x1,_0x5a18e0=0x0;(this['fRX2']>0x1||this['fRY2']>0x1||this['fRX1']<0x0||this['fRY1']<0x0)&&(this['fRX1']<0x0&&((_0x2b76c7=0x1*-this['fRX1'])>_0x5a18e0&&(_0x5a18e0=_0x2b76c7),_0x1a1043=_0x2b76c7/=0x2*_0x2eb2c8),this['fRX2']>0x1&&((_0x2b76c7=0x1*(this['fRX2']-0x1))>_0x5a18e0&&(_0x5a18e0=_0x2b76c7),_0x4957e0=0x1-(_0x2b76c7/=0x2*_0x2eb2c8)),this['fRY1']<0x0&&((_0x2b76c7=-this['fRY1']*_0x5d2167)>_0x5a18e0&&(_0x5a18e0=_0x2b76c7),_0x201ce6=_0x2b76c7/=0x2*_0x2eb2c8),this['fRY2']>0x1&&((_0x2b76c7=(this['fRY2']-0x1)*_0x5d2167)>_0x5a18e0&&(_0x5a18e0=_0x2b76c7),_0x40a35b=0x1-(_0x2b76c7/=0x2*_0x2eb2c8)));var _0x514a37,_0x4bbd32,_0x424b9b=_0x5a18e0/_0x2eb2c8,_0x5cd672={},_0xd5f509={};return _0x5cd672['fX']=_0x12f0d1,_0x5cd672['fY']=(0.8-_0x424b9b)*_0x3770b0+_0x424b9b,_0x514a37=6.2831853*_0x5cd672['fX']+this['pRenderParam'][this['nWndPort']]['fAngle'],_0x4bbd32=0.5*(0x1-_0x5cd672['fY']),_0xd5f509['fX']=0.5-_0x4bbd32*Math['sin'](_0x514a37),_0xd5f509['fY']=0.5+_0x4bbd32*Math['cos'](_0x514a37),_0xd5f509['fX']=(_0xd5f509['fX']-_0x1a1043)/(_0x4957e0-_0x1a1043),_0xd5f509['fY']=(_0xd5f509['fY']-_0x201ce6)/(_0x40a35b-_0x201ce6),_0x70b06b['fX']=_0xd5f509['fX'],_0x70b06b['fY']=_0xd5f509['fY'],_0x2ffc1c['SR_OK'];}},{'key':'GetPointPano2FishFloor','value':function(_0x472ca5,_0x1482bc,_0x593509){if(null==this['pRenderParam'][this['nWndPort']])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==_0x472ca5)return _0x2ffc1c['SR_ERR_PARAM'];var _0x570f55,_0x1244b1;_0x570f55=(this['fRX2']-this['fRX1'])/(this['fRY2']-this['fRY1']),_0x1244b1=(this['fRX2']-this['fRX1'])/0x2*0x1;var _0x1a8fce,_0x363cc7=0x0,_0x13c325=0x1,_0x58e193=0x0,_0x3b55fb=0x1,_0x1d4c13=0x0;(this['fRX2']>0x1||this['fRY2']>0x1||this['fRX1']<0x0||this['fRY1']<0x0)&&(this['fRX1']<0x0&&((_0x1a8fce=0x1*-this['fRX1'])>_0x1d4c13&&(_0x1d4c13=_0x1a8fce),_0x363cc7=_0x1a8fce/=0x2*_0x1244b1),this['fRX2']>0x1&&((_0x1a8fce=0x1*(this['fRX2']-0x1))>_0x1d4c13&&(_0x1d4c13=_0x1a8fce),_0x13c325=0x1-(_0x1a8fce/=0x2*_0x1244b1)),this['fRY1']<0x0&&((_0x1a8fce=-this['fRY1']*_0x570f55)>_0x1d4c13&&(_0x1d4c13=_0x1a8fce),_0x58e193=_0x1a8fce/=0x2*_0x1244b1),this['fRY2']>0x1&&((_0x1a8fce=(this['fRY2']-0x1)*_0x570f55)>_0x1d4c13&&(_0x1d4c13=_0x1a8fce),_0x3b55fb=0x1-(_0x1a8fce/=0x2*_0x1244b1)));var _0x396658,_0x2c4593,_0x4d46ae=_0x1d4c13/_0x1244b1,_0x3b69da={},_0x393f2d={};return _0x3b69da['fX']=0x1-_0x1482bc,_0x3b69da['fY']=(0.8-_0x4d46ae)*(0x1-_0x593509)+_0x4d46ae,_0x396658=6.2831853*_0x3b69da['fX']+this['pRenderParam'][this['nWndPort']]['fAngle'],_0x2c4593=0.5*(0x1-_0x3b69da['fY']),_0x393f2d['fX']=0.5-_0x2c4593*Math['sin'](_0x396658),_0x393f2d['fY']=0.5+_0x2c4593*Math['cos'](_0x396658),_0x393f2d['fX']=(_0x393f2d['fX']-_0x363cc7)/(_0x13c325-_0x363cc7),_0x393f2d['fY']=(_0x393f2d['fY']-_0x58e193)/(_0x3b55fb-_0x58e193),_0x472ca5['fX']=_0x393f2d['fX'],_0x472ca5['fY']=_0x393f2d['fY'],_0x2ffc1c['SR_OK'];}},{'key':'GetPointPano2FishWall','value':function(_0x822875,_0x6da0f6,_0x3247f4){if(null==this['pRenderParam'][this['nWndPort']])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==_0x822875)return _0x2ffc1c['SR_ERR_PARAM'];var _0x28c56b,_0x310159;_0x28c56b=(this['fRX2']-this['fRX1'])/(this['fRY2']-this['fRY1']),_0x310159=(this['fRX2']-this['fRX1'])/0x2*0x1;var _0xae4f33,_0x1c2cd6,_0x5c587c,_0x363e7f,_0x1e204e=0x0,_0x8cfc=0x1,_0x24c1af=0.1,_0x2abf82=0.9,_0x225d96=0x0,_0x26f874=0x1,_0x455ce2=0x0,_0x3a4e18=0x1;this['fRX1']<0x0&&(_0xae4f33=0x1*-this['fRX1'],_0x1e204e=_0xae4f33/=0x2*_0x310159,_0x225d96=_0xae4f33),this['fRX2']>0x1&&(_0x1c2cd6=0x1*(this['fRX2']-0x1),_0x8cfc=0x1-(_0x1c2cd6/=0x2*_0x310159),_0x26f874=0x1-_0x1c2cd6),this['fRY1']<0x0&&(_0x5c587c=-this['fRY1']*_0x28c56b,_0x24c1af=(_0x5c587c/=0x2*_0x310159)>0.1?_0x5c587c:0.1,_0x455ce2=_0x5c587c),this['fRY2']>0x1&&(_0x363e7f=(this['fRY2']-0x1)*_0x28c56b,_0x2abf82=(_0x363e7f/=0x2*_0x310159)>0x1-0.9?0x1-_0x363e7f:0.9,_0x3a4e18=0x1-_0x363e7f);var _0x1d65f4={},_0x3bab91={};_0x1d65f4['fX']=_0x6da0f6*(_0x8cfc-_0x1e204e)+_0x1e204e,_0x1d65f4['fY']=_0x3247f4*(_0x2abf82-_0x24c1af)+_0x24c1af;var _0x5cd4b5=Math['sqrt'](0.25-(_0x1d65f4['fY']-0.5)*(_0x1d65f4['fY']-0.5));return _0x3bab91['fX']=(_0x1d65f4['fX']-0.5)*_0x5cd4b5/0.5+0.5,_0x3bab91['fY']=_0x1d65f4['fY'],_0x3bab91['fX']=(_0x3bab91['fX']-_0x225d96)/(_0x26f874-_0x225d96),_0x3bab91['fY']=(_0x3bab91['fY']-_0x455ce2)/(_0x3a4e18-_0x455ce2),_0x822875['fX']=_0x3bab91['fX'],_0x822875['fY']=_0x3bab91['fY'],_0x2ffc1c['SR_OK'];}},{'key':'UpdatePTZPosition','value':function(_0x305af5,_0x18bd6f,_0x55f2f4){if(null==this['pRenderParam'][_0x305af5])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0x137484={'fHAngleSin':0x0,'fHAngleCos':0x0,'fVAngleSin':0x0,'fVAngleCos':0x0},_0x5b8f9c=_0x2ffc1c['SR_OK'];if(_0x5dc8af['SR_DE_FISH_PTZ_FLOOR']==this['pRenderParam'][_0x305af5]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_PTZ_CEILING']==this['pRenderParam'][_0x305af5]['nDisplayEffect']){if((_0x5b8f9c=this['ComputeAngleVertical'](_0x18bd6f,_0x55f2f4,_0x137484,this['pRenderParam'][_0x305af5]['nDisplayEffect']))!=_0x2ffc1c['SR_OK'])return _0x5b8f9c;}else{if(_0x5dc8af['SR_DE_FISH_PTZ_WALL']!=this['pRenderParam'][_0x305af5]['nDisplayEffect'])return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];if((_0x5b8f9c=this['ComputeAngleHorizontal'](_0x18bd6f,_0x55f2f4,_0x137484))!=_0x2ffc1c['SR_OK'])return _0x5b8f9c;}return 0x0==this['IsInImage'](this['fRX1'],this['fRX2'],this['fRY1'],this['fRY2'],_0x137484,this['pRenderParam'][_0x305af5]['fZoom'],this['pRenderParam'][_0x305af5]['nDisplayEffect'])?_0x2ffc1c['SR_ERR_PARAM']:(this['pRenderParam'][_0x305af5]['fCosH']=_0x137484['fHAngleCos'],this['pRenderParam'][_0x305af5]['fSinH']=_0x137484['fHAngleSin'],this['pRenderParam'][_0x305af5]['fCosV']=_0x137484['fVAngleCos'],this['pRenderParam'][_0x305af5]['fSinV']=_0x137484['fVAngleSin'],_0x2ffc1c['SR_OK']);}},{'key':'JudgeDisplayEffect','value':function(_0x3c53be){var _0x13f3cb=0x0;switch(_0x13f3cb){case 0x0:return _0x13f3cb=this['GetPlaceType'](_0x3c53be),0x4==this['nPlaceType']&&(this['nPlaceType']=0x0),_0x2ffc1c['SR_OK'];case 0x3:return(_0x13f3cb=this['GetPlaceType'](_0x3c53be))==this['nPlaceType']||0x4==this['nPlaceType']?_0x2ffc1c['SR_OK']:_0x2ffc1c['SR_ERR_NOT_SUPPORT'];case 0x2:case 0x1:return(_0x13f3cb=this['GetPlaceType'](_0x3c53be))==this['nPlaceType']||0x4==_0x13f3cb?_0x2ffc1c['SR_OK']:_0x2ffc1c['SR_ERR_NOT_SUPPORT'];default:return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}},{'key':'GetPlaceType','value':function(_0x3dd480){switch(_0x3dd480){case _0x5dc8af['SR_DE_FISH_PTZ_CEILING']:case _0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_360']:case _0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_180']:case _0x5dc8af['SR_DE_FISH_CYLINDER_CEILING']:case _0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_CEILING']:return 0x3;case _0x5dc8af['SR_DE_FISH_PTZ_FLOOR']:case _0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_360']:case _0x5dc8af['SR_DE_FISH_PANARAMA_FLOOR_180']:case _0x5dc8af['SR_DE_FISH_CYLINDER_FLOOR']:case _0x5dc8af['SR_DE_FISH_CYLINDER_SPLIT_FLOOR']:return 0x2;case _0x5dc8af['SR_DE_FISH_PTZ_WALL']:case _0x5dc8af['SR_DE_FISH_PANORAMA_WALL']:case _0x5dc8af['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']:case _0x5dc8af['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']:return 0x1;case _0x5dc8af['SR_DE_FISH_SEMISPHERE']:case _0x5dc8af['SR_DE_FISH_ORIGINAL']:case _0x5dc8af['SR_DE_FISH_PLANET']:case _0x5dc8af['SR_DE_PANORAMA_SPHERE']:case _0x5dc8af['SR_DE_PANORAMA_PLANET']:return 0x4;default:return 0x0;}return 0x0;}},{'key':'SetFishParam','value':function(_0x2fd4dc,_0x5eab0d){if(_0x2fd4dc<0x0||_0x2fd4dc>=0x20)return _0x2ffc1c['SR_ERR_PARAM'];if(null==_0x5eab0d)return _0x2ffc1c['SR_ERR_PARAM'];if(null==this['pRenderParam'][_0x2fd4dc])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0xb5a674=_0x2ffc1c['SR_OK'];switch(_0x5eab0d['nFishParamType']){case _0x34f5da['SR_FPT_CENTER']:if((_0xb5a674=this['UpdateCircyeParam'](_0x5eab0d['fRXLeft'],_0x5eab0d['fRXRight'],_0x5eab0d['fRYTop'],_0x5eab0d['fRYBottom']))!=_0x2ffc1c['SR_OK'])return _0xb5a674;this['pRenderParam'][_0x2fd4dc]['bCut']=_0x5eab0d['bCut'],this['bBlack']=_0x5eab0d['bBlack'];break;case _0x34f5da['SR_FPT_ANGLE']:if(_0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_360']!=this['pRenderParam'][_0x2fd4dc]['nDisplayEffect']&&_0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_180']!=this['pRenderParam'][_0x2fd4dc]['nDisplayEffect']&&_0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_360']!=this['pRenderParam'][_0x2fd4dc]['nDisplayEffect']&&_0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_180']!=this['pRenderParam'][_0x2fd4dc]['nDisplayEffect'])return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];if((_0xb5a674=this['UpdateWideScanAngle'](_0x2fd4dc,_0x5eab0d['fAngle']))!=_0x2ffc1c['SR_OK'])return _0xb5a674;this['pFishParam'][_0x2fd4dc]['fAngle']=_0x5eab0d['fAngle'];break;case _0x34f5da['SR_FPT_ZOOM']:if(_0x5dc8af['SR_DE_FISH_PTZ_WALL']!=this['pRenderParam'][_0x2fd4dc]['nDisplayEffect']&&_0x5dc8af['SR_DE_FISH_PTZ_CEILING']!=this['pRenderParam'][_0x2fd4dc]['nDisplayEffect']&&_0x5dc8af['SR_DE_FISH_PTZ_FLOOR']!=this['pRenderParam'][_0x2fd4dc]['nDisplayEffect'])return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];if((_0xb5a674=this['UpdateRangeParam'](_0x2fd4dc,_0x5eab0d['fZoom']))!=_0x2ffc1c['SR_OK'])return _0xb5a674;this['pFishParam'][_0x2fd4dc]['fZoom']=_0x5eab0d['fZoom'];break;case _0x34f5da['SR_FPT_PTZ']:if(_0x5dc8af['SR_DE_FISH_PTZ_WALL']!=this['pRenderParam'][_0x2fd4dc]['nDisplayEffect']&&_0x5dc8af['SR_DE_FISH_PTZ_CEILING']!=this['pRenderParam'][_0x2fd4dc]['nDisplayEffect']&&_0x5dc8af['SR_DE_FISH_PTZ_FLOOR']!=this['pRenderParam'][_0x2fd4dc]['nDisplayEffect'])return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];if((_0xb5a674=this['UpdatePTZPosition'](_0x2fd4dc,_0x5eab0d['fPTZX'],_0x5eab0d['fPTZY'],this['pRenderParam'][_0x2fd4dc]['fZoom'],!0x0))!=_0x2ffc1c['SR_OK'])return _0xb5a674;this['pFishParam'][_0x2fd4dc]['fPTZX']=_0x5eab0d['fPTZX'],this['pFishParam'][_0x2fd4dc]['fPTZY']=_0x5eab0d['fPTZY'];break;case _0x34f5da['SR_FPT_NULL']:default:return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];}return this['ComputePTZPoints'](),_0x2ffc1c['SR_OK'];}},{'key':'GetFishParam','value':function(_0x8520b8,_0x9cd079){return _0x8520b8<0x0||_0x8520b8>=0x20||null==_0x9cd079||null==this['pFishParam'][_0x8520b8]?_0x2ffc1c['SR_ERR_PARAM']:(_0x9cd079['fRXLeft']=this['fRX1'],_0x9cd079['fRXRight']=this['fRX2'],_0x9cd079['fRYTop']=this['fRY1'],_0x9cd079['fRYBottom']=this['fRY2'],_0x9cd079['bBlack']=this['bBlack'],_0x9cd079['bCut']=this['pRenderParam'][_0x8520b8]['bCut'],_0x9cd079['nFishParamType']=this['pFishParam'][_0x8520b8]['nFishParamType'],_0x9cd079['fAngle']=this['pFishParam'][_0x8520b8]['fAngle'],_0x9cd079['fZoom']=this['pFishParam'][_0x8520b8]['fZoom'],_0x9cd079['fPTZX']=this['pFishParam'][_0x8520b8]['fPTZX'],_0x9cd079['fPTZY']=this['pFishParam'][_0x8520b8]['fPTZY'],_0x2ffc1c['SR_OK']);}},{'key':'GetRenderParam','value':function(_0x182a64,_0x35ec66){return _0x182a64<0x0||_0x182a64>=0x20||null==_0x35ec66||null==this['pRenderParam'][_0x182a64]?_0x2ffc1c['SR_ERR_PARAM']:(_0x35ec66['fRXLeft']=this['fRX1'],_0x35ec66['fRXRight']=this['fRX2'],_0x35ec66['fRYTop']=this['fRY1'],_0x35ec66['fRYBottom']=this['fRY2'],_0x35ec66['bBlack']=this['bBlack'],_0x35ec66['fCosH']=this['pRenderParam'][_0x182a64]['fCosH'],_0x35ec66['fSinH']=this['pRenderParam'][_0x182a64]['fSinH'],_0x35ec66['fCosV']=this['pRenderParam'][_0x182a64]['fCosV'],_0x35ec66['fSinV']=this['pRenderParam'][_0x182a64]['fSinV'],_0x35ec66['fAngle']=this['pRenderParam'][_0x182a64]['fAngle'],_0x35ec66['fZoom']=this['pRenderParam'][_0x182a64]['fZoom'],_0x35ec66['nDisplayEffect']=this['pRenderParam'][_0x182a64]['nDisplayEffect'],_0x35ec66['bCut']=this['pRenderParam'][_0x182a64]['bCut'],_0x2ffc1c['SR_OK']);}},{'key':'UpdateCircyeParam','value':function(_0x228868,_0x4b64f1,_0x5be038,_0x15fdfd){if(_0x228868<=-0.5||_0x228868>=0.4||_0x4b64f1<=0.6||_0x4b64f1>=1.5||_0x5be038<=-0.5||_0x5be038>=0.4||_0x15fdfd<=0.6||_0x15fdfd>=1.5||_0x228868+_0x4b64f1<=0.8||_0x228868+_0x4b64f1>=1.2||_0x5be038+_0x15fdfd<=0.8||_0x5be038+_0x15fdfd>=1.2)return _0x2ffc1c['SR_ERR_PARAM'];if(_0x228868<0x0||_0x4b64f1>0x1||_0x5be038<0x0||_0x15fdfd>0x1){for(var _0x3260cb=0x0;_0x3260cb<0x20;++_0x3260cb)if(null!=this['pRenderParam'][_0x3260cb]&&(_0x5dc8af['SR_DE_FISH_PTZ_CEILING']==this['pRenderParam'][_0x3260cb]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_PTZ_FLOOR']==this['pRenderParam'][_0x3260cb]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_PTZ_WALL']==this['pRenderParam'][_0x3260cb]['nDisplayEffect'])){var _0x148af9={};if(_0x148af9['fHAngleCos']=this['pRenderParam'][_0x3260cb]['fCosH'],_0x148af9['fHAngleSin']=this['pRenderParam'][_0x3260cb]['fSinH'],_0x148af9['fVAngleCos']=this['pRenderParam'][_0x3260cb]['fCosV'],_0x148af9['fVAngleSin']=this['pRenderParam'][_0x3260cb]['fSinV'],0x0==this['IsInImage'](_0x228868,_0x4b64f1,_0x5be038,_0x15fdfd,_0x148af9,this['pRenderParam'][_0x3260cb]['fZoom'],this['pRenderParam'][_0x3260cb]['nDisplayEffect']))return _0x2ffc1c['SR_ERR_PARAM'];}}return this['fRX1']=_0x228868,this['fRX2']=_0x4b64f1,this['fRY1']=_0x5be038,this['fRY2']=_0x15fdfd,_0x2ffc1c['SR_OK'];}},{'key':'UpdateWideScanAngle','value':function(_0x2c39,_0x9eab50){return null==this['pRenderParam'][_0x2c39]?_0x2ffc1c['SR_ERR_CALL_ORDER']:(_0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_360']==this['pRenderParam'][_0x2c39]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_180']==this['pRenderParam'][_0x2c39]['nDisplayEffect']?this['pRenderParam'][_0x2c39]['fAngle']=_0x9eab50:_0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_360']!=this['pRenderParam'][_0x2c39]['nDisplayEffect']&&_0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_180']!=this['pRenderParam'][_0x2c39]['nDisplayEffect']||(this['pRenderParam'][_0x2c39]['fAngle']=-_0x9eab50),_0x2ffc1c['SR_OK']);}},{'key':'ComputeAngleVertical','value':function(_0xf7618f,_0x16b56b,_0x412284,_0x5f30ae){var _0x1580b6=_0xf7618f,_0x37758c=_0x16b56b,_0x11719d=Math['sqrt']((_0x37758c-0.5)*(_0x37758c-0.5)+(_0x1580b6-0.5)*(_0x1580b6-0.5));if(_0x11719d>0.5)return _0x2ffc1c['SR_ERR_PARAM'];if(_0x11719d<0.001)return _0x412284['fVAngleCos']=0x1,_0x412284['fVAngleSin']=0x0,_0x412284['fHAngleCos']=0x1,_0x412284['fHAngleSin']=0x0,_0x2ffc1c['SR_OK'];if(_0x5f30ae==_0x5dc8af['SR_DE_FISH_PTZ_CEILING']){_0x412284['fHAngleCos']=(0.5-_0x37758c)/_0x11719d,_0x412284['fHAngleSin']=(0.5-_0x1580b6)/_0x11719d;var _0x1d5745=_0x11719d*_0x238eca;_0x412284['fVAngleCos']=Math['cos'](_0x1d5745),_0x412284['fVAngleSin']=Math['sin'](_0x1d5745);}else{if(_0x5f30ae!=_0x5dc8af['SR_DE_FISH_PTZ_FLOOR'])return _0x2ffc1c['SR_ERR_PARAM'];_0x412284['fHAngleCos']=(_0x37758c-0.5)/_0x11719d,_0x412284['fHAngleSin']=(0.5-_0x1580b6)/_0x11719d;var _0x3a304a=_0x11719d*_0x238eca;_0x412284['fVAngleCos']=Math['cos'](_0x3a304a),_0x412284['fVAngleSin']=Math['sin'](_0x3a304a);}return _0x2ffc1c['SR_OK'];}},{'key':'ComputeAngleHorizontal','value':function(_0x42488a,_0x17f569,_0xb415dd){var _0x5a620a,_0x434f78,_0x7dce21,_0x6d75b3,_0x32ef88,_0x19d433,_0x345d6a,_0x4e564d=_0x42488a,_0x157fd4=_0x17f569;return(_0x157fd4-(_0x32ef88=0.5))*(_0x157fd4-_0x32ef88)+(_0x4e564d-_0x32ef88)*(_0x4e564d-_0x32ef88)>0.25?_0x2ffc1c['SR_ERR_PARAM']:(_0x19d433=(_0x157fd4-_0x32ef88)/_0x32ef88*_0x238eca/0x2,_0x5a620a=Math['cos'](_0x19d433),_0x434f78=Math['sin'](_0x19d433),(_0x4e564d-_0x32ef88)/_0x32ef88/_0x5a620a>0x1||(_0x4e564d-_0x32ef88)/_0x32ef88/_0x5a620a<-0x1?_0x2ffc1c['SR_ERR_PARAM']:(_0x345d6a=(_0x4e564d-_0x32ef88)/_0x32ef88/_0x5a620a*_0x238eca/0x2,_0x7dce21=Math['cos'](_0x345d6a),_0x6d75b3=Math['sin'](_0x345d6a),_0xb415dd['fVAngleCos']=_0x5a620a,_0xb415dd['fVAngleSin']=_0x434f78,_0xb415dd['fHAngleCos']=_0x7dce21,_0xb415dd['fHAngleSin']=_0x6d75b3,_0x2ffc1c['SR_OK']));}},{'key':'IsInImage','value':function(_0x2d8b7d,_0x24b047,_0x4559b9,_0x2983b9,_0x366981,_0x206bfa,_0x543280){return 0x1!=this['IsOutofImage'](_0x2d8b7d,_0x24b047,_0x4559b9,_0x2983b9,_0x366981['fHAngleCos'],_0x366981['fHAngleSin'],_0x366981['fVAngleCos'],_0x366981['fVAngleSin'],_0x206bfa,0x1,0.5,_0x543280)&&0x1!=this['IsOutofImage'](_0x2d8b7d,_0x24b047,_0x4559b9,_0x2983b9,_0x366981['fHAngleCos'],_0x366981['fHAngleSin'],_0x366981['fVAngleCos'],_0x366981['fVAngleSin'],_0x206bfa,0x0,0.5,_0x543280)&&0x1!=this['IsOutofImage'](_0x2d8b7d,_0x24b047,_0x4559b9,_0x2983b9,_0x366981['fHAngleCos'],_0x366981['fHAngleSin'],_0x366981['fVAngleCos'],_0x366981['fVAngleSin'],_0x206bfa,0.5,0x1,_0x543280)&&0x1!=this['IsOutofImage'](_0x2d8b7d,_0x24b047,_0x4559b9,_0x2983b9,_0x366981['fHAngleCos'],_0x366981['fHAngleSin'],_0x366981['fVAngleCos'],_0x366981['fVAngleSin'],_0x206bfa,0.5,0x0,_0x543280)&&0x1!=this['IsOutofImage'](_0x2d8b7d,_0x24b047,_0x4559b9,_0x2983b9,_0x366981['fHAngleCos'],_0x366981['fHAngleSin'],_0x366981['fVAngleCos'],_0x366981['fVAngleSin'],_0x206bfa,0x0,0x0,_0x543280)&&0x1!=this['IsOutofImage'](_0x2d8b7d,_0x24b047,_0x4559b9,_0x2983b9,_0x366981['fHAngleCos'],_0x366981['fHAngleSin'],_0x366981['fVAngleCos'],_0x366981['fVAngleSin'],_0x206bfa,0x0,0x1,_0x543280)&&0x1!=this['IsOutofImage'](_0x2d8b7d,_0x24b047,_0x4559b9,_0x2983b9,_0x366981['fHAngleCos'],_0x366981['fHAngleSin'],_0x366981['fVAngleCos'],_0x366981['fVAngleSin'],_0x206bfa,0x1,0x1,_0x543280)&&0x1!=this['IsOutofImage'](_0x2d8b7d,_0x24b047,_0x4559b9,_0x2983b9,_0x366981['fHAngleCos'],_0x366981['fHAngleSin'],_0x366981['fVAngleCos'],_0x366981['fVAngleSin'],_0x206bfa,0x1,0x0,_0x543280);}},{'key':'IsOutofImage','value':function(_0x5c9f35,_0xa5515d,_0x2729bd,_0x277b0e,_0x396c76,_0x5dbc6b,_0x392be5,_0x53ff81,_0x4f493d,_0x5d2537,_0x5a33a5,_0x2b0852){var _0x2b246b,_0x31deca,_0x1602ef,_0x4c2028,_0x5d0d91,_0x2c625a,_0x4dc2ab,_0x33b99a,_0xe2c0b7,_0x51f190,_0x4728c1,_0x494f81,_0x2b89d3;if(_0x4728c1=(_0x5c9f35+_0xa5515d)/0x2*0x1,_0x494f81=(_0x2729bd+_0x277b0e)/0x2*(_0x51f190=(_0xa5515d-_0x5c9f35)/(_0x277b0e-_0x2729bd)),_0x2b89d3=(_0xa5515d-_0x5c9f35)/0x2*0x1,_0x2b0852==_0x5dc8af['SR_DE_FISH_PTZ_CEILING']){if(_0x31deca=_0x5d2537-0.5,_0x1602ef=(_0x2b246b=0.5-_0x5a33a5)*_0x392be5+(_0x2c625a=_0x4f493d)*_0x53ff81,(_0x4dc2ab=_0x2c625a*_0x392be5-_0x2b246b*_0x53ff81)<=0x0)return!0x0;_0xe2c0b7=Math['sqrt'](_0x31deca*_0x31deca+_0x1602ef*_0x1602ef);var _0x370693=Math['sqrt'](_0x31deca*_0x31deca+_0x1602ef*_0x1602ef+_0x4dc2ab*_0x4dc2ab),_0x126615=Math['asin'](_0xe2c0b7/_0x370693)/1.5707963*0.5;if(_0x5d0d91=(-((_0x31deca=_0x126615*_0x31deca/_0xe2c0b7)*_0x5dbc6b+(_0x1602ef=_0x126615*_0x1602ef/_0xe2c0b7)*_0x396c76)*_0x2b89d3*0x2+_0x494f81)/_0x51f190,(_0x4c2028=((_0x31deca*_0x396c76-_0x1602ef*_0x5dbc6b)*_0x2b89d3*0x2+_0x4728c1)/0x1)<0x0||_0x4c2028>0x1||_0x5d0d91<0x0||_0x5d0d91>0x1)return!0x0;}if(_0x2b0852==_0x5dc8af['SR_DE_FISH_PTZ_FLOOR']){if(_0x31deca=_0x5d2537-0.5,_0x1602ef=(_0x2b246b=_0x5a33a5-0.5)*_0x392be5+(_0x2c625a=_0x4f493d)*_0x53ff81,(_0x4dc2ab=_0x2c625a*_0x392be5-_0x2b246b*_0x53ff81)<=0x0)return!0x0;_0xe2c0b7=Math['sqrt'](_0x31deca*_0x31deca+_0x1602ef*_0x1602ef);var _0x5997ed=Math['sqrt'](_0x31deca*_0x31deca+_0x1602ef*_0x1602ef+_0x4dc2ab*_0x4dc2ab),_0x401523=Math['asin'](_0xe2c0b7/_0x5997ed)/1.5707963*0.5;if(_0x5d0d91=(((_0x31deca=_0x401523*_0x31deca/_0xe2c0b7)*_0x5dbc6b+(_0x1602ef=_0x401523*_0x1602ef/_0xe2c0b7)*_0x396c76)*_0x2b89d3*0x2+_0x494f81)/_0x51f190,(_0x4c2028=((_0x31deca*_0x396c76-_0x1602ef*_0x5dbc6b)*_0x2b89d3*0x2+_0x4728c1)/0x1)<0x0||_0x4c2028>0x1||_0x5d0d91<0x0||_0x5d0d91>0x1)return!0x0;}if(_0x2b0852==_0x5dc8af['SR_DE_FISH_PTZ_WALL']){if(_0x4c2028=(_0x31deca=_0x5d2537-0.5)*_0x396c76+(_0x4dc2ab=(_0x2c625a=_0x4f493d)*_0x392be5-(_0x2b246b=_0x5a33a5-0.5)*_0x53ff81)*_0x5dbc6b,_0x5d0d91=_0x1602ef=_0x2b246b*_0x392be5+_0x2c625a*_0x53ff81,(_0x33b99a=_0x4dc2ab*_0x396c76-_0x31deca*_0x5dbc6b)<=0x0)return!0x0;_0xe2c0b7=Math['sqrt'](_0x4c2028*_0x4c2028+_0x5d0d91*_0x5d0d91);var _0x59d539=Math['sqrt'](_0x4c2028*_0x4c2028+_0x5d0d91*_0x5d0d91+_0x33b99a*_0x33b99a),_0x131b0=Math['asin'](_0xe2c0b7/_0x59d539)/1.5707963*0.5;if(_0x5d0d91=(_0x131b0*_0x5d0d91/_0xe2c0b7*_0x2b89d3*0x2+_0x494f81)/_0x51f190,(_0x4c2028=(_0x131b0*_0x4c2028/_0xe2c0b7*_0x2b89d3*0x2+_0x4728c1)/0x1)<0x0||_0x4c2028>0x1||_0x5d0d91<0x0||_0x5d0d91>0x1)return!0x0;}return!0x1;}},{'key':'ComputePTZPoints','value':function(){if(-0x1==this['nWndPort'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];for(var _0xcabdbf=0x0;_0xcabdbf<0x20;++_0xcabdbf)if(null!=this['pRenderParam'][_0xcabdbf]&&(_0x5dc8af['SR_DE_FISH_PTZ_CEILING']==this['pRenderParam'][_0xcabdbf]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_PTZ_FLOOR']==this['pRenderParam'][_0xcabdbf]['nDisplayEffect']||_0x5dc8af['SR_DE_FISH_PTZ_WALL']==this['pRenderParam'][_0xcabdbf]['nDisplayEffect'])){var _0xe9c115=_0x2ffc1c['SR_OK'];if(this['nPTZDisplayMode']==_0x280409['SR_DM_RANGE']){if(_0xe9c115=this['GetRangePoints'](_0xcabdbf),_0x2ffc1c['SR_OK']!=_0xe9c115)continue;if(_0xe9c115=this['TransformPTZRangePoints'](_0xcabdbf),_0x2ffc1c['SR_OK']!=_0xe9c115)continue;}else{if(this['nPTZDisplayMode']==_0x280409['SR_DM_RECT']&&(_0xe9c115=this['GetRectPoints'](_0xcabdbf),_0x2ffc1c['SR_OK']!=_0xe9c115))continue;}}return _0x2ffc1c['SR_OK'];}},{'key':'GetWndPort','value':function(){return this['nWndPort'];}},{'key':'GetPTZDisplayMode','value':function(){return this['nPTZDisplayMode'];}},{'key':'GetPTZColor','value':function(_0x5a4092,_0x5a76ea){return _0x5a4092<0x0||_0x5a4092>=0x20||null==_0x5a76ea?_0x2ffc1c['SR_ERR_PARAM']:(_0x5a76ea['fA']=this['stPTZColor'][_0x5a4092]['fA'],_0x5a76ea['fR']=this['stPTZColor'][_0x5a4092]['fR'],_0x5a76ea['fG']=this['stPTZColor'][_0x5a4092]['fG'],_0x5a76ea['fB']=this['stPTZColor'][_0x5a4092]['fB'],this['pPTZSetColor'][_0x5a4092]['bSetColor']&&(Math['abs'](this['pPTZSetColor'][_0x5a4092]['fA'])<0.000001||Math['abs'](this['pPTZSetColor'][_0x5a4092]['fR'])<0.000001||Math['abs'](this['pPTZSetColor'][_0x5a4092]['fG'])<0.000001||Math['abs'](this['pPTZSetColor'][_0x5a4092]['fB'])<0.000001)&&(_0x5a76ea['fA']=this['pPTZSetColor'][_0x5a4092]['fA'],_0x5a76ea['fR']=this['pPTZSetColor'][_0x5a4092]['fR'],_0x5a76ea['fG']=this['pPTZSetColor'][_0x5a4092]['fG'],_0x5a76ea['fB']=this['pPTZSetColor'][_0x5a4092]['fB']),_0x2ffc1c['SR_OK']);}},{'key':'SetPTZColor','value':function(_0x467cd0,_0x4853ae){return _0x467cd0<0x0||_0x467cd0>=0x20||null==_0x4853ae?_0x2ffc1c['SR_ERR_PARAM']:(this['pPTZSetColor'][_0x467cd0]['fR']=_0x4853ae['fR'],this['pPTZSetColor'][_0x467cd0]['fG']=_0x4853ae['fG'],this['pPTZSetColor'][_0x467cd0]['fB']=_0x4853ae['fB'],this['pPTZSetColor'][_0x467cd0]['fA']=_0x4853ae['fA'],this['pPTZSetColor'][_0x467cd0]['bSetColor']=!0x0,_0x2ffc1c['SR_OK']);}},{'key':'IsPTZSelected','value':function(_0x1821b4){return!(_0x1821b4<0x0||_0x1821b4>=0x20)&&this['bPTZSelected'][_0x1821b4];}},{'key':'GetPTZPort','value':function(_0x320859,_0x482369,_0x1d6f0d){if(-0x1==this['nWndPort'])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==this['pRenderParam'][this['nWndPort']])return _0x2ffc1c['SR_ERR_CALL_ORDER'];var _0xdfc233=0x20,_0x226709={};_0x226709['fX']=_0x320859,_0x226709['fY']=_0x482369;for(var _0x3771ec=0x0;_0x3771ec<0x20;++_0x3771ec)this['bPTZSelected'][_0x3771ec]=!0x1;if(this['nPTZDisplayMode']==_0x280409['SR_DM_RANGE']){switch(this['pRenderParam'][this['nWndPort']]['nDisplayEffect']){case _0x5dc8af['SR_DE_FISH_PANORAMA_FLOOR_360']:this['GetPointPano2FishFloor'](_0x226709,_0x320859,_0x482369);break;case _0x5dc8af['SR_DE_FISH_PANORAMA_CEILING_360']:this['GetPointPano2FishCeiling'](_0x226709,_0x320859,_0x482369);break;case _0x5dc8af['SR_DE_FISH_PANORAMA_WALL']:this['GetPointPano2FishWall'](_0x226709,_0x320859,_0x482369);}for(var _0x32e6a3=0x0;_0x32e6a3<0x20;++_0x32e6a3)if(0x0!=this['nOriPTZPointNum'][_0x32e6a3]){var _0x56f273={};_0x56f273['fX']=this['pOriPTZPoints'][_0x32e6a3][0x0]['fX'],_0x56f273['fY']=this['pOriPTZPoints'][_0x32e6a3][0x0]['fY'];var _0x161b08={};_0x161b08['fX']=this['pOriPTZPoints'][_0x32e6a3][0x0]['fX'],_0x161b08['fY']=this['pOriPTZPoints'][_0x32e6a3][0x0]['fY'];for(var _0x5d5f75=0x1;_0x5d5f75<this['nOriPTZPointNum'][_0x32e6a3];++_0x5d5f75)this['GetPTZRectange'](_0x56f273,_0x161b08,this['pOriPTZPoints'][_0x32e6a3][_0x5d5f75]);if(_0x226709['fX']<=_0x56f273['fX']&&_0x226709['fX']>=_0x161b08['fX']&&_0x226709['fY']>=_0x161b08['fY']&&_0x226709['fY']<=_0x56f273['fY']){_0xdfc233=_0x32e6a3;break;}}}else{if(this['nPTZDisplayMode']!=_0x280409['SR_DM_RECT'])return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];for(var _0xad4503=0x0;_0xad4503<0x20;++_0xad4503)if(_0x226709['fX']<=this['pRectPoints'][_0xad4503][0x2]['fX']&&_0x226709['fX']>=this['pRectPoints'][_0xad4503][0x0]['fX']&&_0x226709['fY']>=this['pRectPoints'][_0xad4503][0x0]['fY']&&_0x226709['fY']<=this['pRectPoints'][_0xad4503][0x2]['fY']){_0xdfc233=_0xad4503;break;}}return _0xdfc233<0x20?(this['bPTZSelected'][_0xdfc233]=!0x0,_0x1d6f0d['nPTZPort']=_0xdfc233,_0x2ffc1c['SR_OK']):_0x2ffc1c['SR_ERR_NOT_SUPPORT'];}},{'key':'SetPTZPort','value':function(_0x1bda4c){if(_0x1bda4c<0x0||_0x1bda4c>=0x20)return _0x2ffc1c['SR_ERR_PARAM'];for(var _0x6cc4d4=0x0;_0x6cc4d4<0x20;++_0x6cc4d4)this['bPTZSelected'][_0x6cc4d4]=!0x1;if(this['nPTZDisplayMode']==_0x280409['SR_DM_RANGE']){if(0x0==this['nOriPTZPointNum'][_0x1bda4c])return _0x2ffc1c['SR_ERR_PARAM'];this['bPTZSelected'][_0x1bda4c]=!0x0;}else{if(0x0==this['nPTZRectNum'][_0x1bda4c])return _0x2ffc1c['SR_ERR_PARAM'];this['bPTZSelected'][_0x1bda4c]=!0x0;}return _0x2ffc1c['SR_OK'];}},{'key':'GetPTZRectange','value':function(_0x3c8ca6,_0x44e3bc,_0x1037b3){return _0x1037b3['fX']<_0x44e3bc['fX']&&(_0x44e3bc['fX']=_0x1037b3['fX']),_0x1037b3['fY']<_0x44e3bc['fY']&&(_0x44e3bc['fY']=_0x1037b3['fY']),_0x1037b3['fX']>_0x3c8ca6['fX']&&(_0x3c8ca6['fX']=_0x1037b3['fX']),_0x1037b3['fY']>_0x3c8ca6['fY']&&(_0x3c8ca6['fY']=_0x1037b3['fY']),_0x2ffc1c['SR_OK'];}},{'key':'GetPTZPoints','value':function(_0x55d4d2,_0x561436,_0x5c80be){return _0x55d4d2<0x0||_0x55d4d2>=0x20?_0x2ffc1c['SR_ERR_PARAM']:null==this['pRenderParam'][this['nWndPort']]?_0x2ffc1c['SR_ERR_CALL_ORDER']:(_0x280409['SR_DM_RANGE']==_0x5c80be?null!=this['pOriPTZPoints'][_0x55d4d2]&&0x0!=this['nOriPTZPointNum'][_0x55d4d2]&&(_0x561436['pstPoints']=this['pOriPTZPoints'][_0x55d4d2],_0x561436['nPointNum']=this['nOriPTZPointNum'][_0x55d4d2]):_0x280409['SR_DM_RECT']==_0x5c80be&&null!=this['pRectPoints'][_0x55d4d2]&&(_0x561436['pstPoints']=this['pRectPoints'][_0x55d4d2],_0x561436['nPointNum']=0x4),_0x2ffc1c['SR_OK']);}},{'key':'SetPTZDisplayMode','value':function(_0x32297f){return this['nPTZDisplayMode']=_0x32297f,this['ComputePTZPoints']();}},{'key':'GetDisplayEffect','value':function(_0x442a3b){return _0x442a3b<0x0||_0x442a3b>=0x20||null==this['pRenderParam']?_0x5dc8af['SR_DE_NULL']:this['pRenderParam'][_0x442a3b]['nDisplayEffect'];}},{'key':'GetPTZFragmentPoints','value':function(_0x22da22,_0x3bc936,_0x43def8){if(_0x22da22<0x0||_0x22da22>=0x20)return _0x2ffc1c['SR_ERR_PARAM'];if(null==this['pPanoPTZPoints'][_0x22da22]||0x0==this['nPanoPTZPointNum'][_0x22da22])return _0x2ffc1c['SR_ERR_PARAM'];var _0x14cfca=this['nPTZFragmentNode'][_0x22da22][_0x43def8];if(_0x3bc936['nPointNum']=this['nPTZFragmentNode'][_0x22da22][_0x43def8+0x1]-this['nPTZFragmentNode'][_0x22da22][_0x43def8],_0x3bc936['nPointNum']<0x0)return _0x2ffc1c['SR_ERR_CALL_ORDER'];_0x3bc936['pstPoints']=[];for(var _0x741928=0x0;_0x741928<_0x3bc936['nPointNum'];++_0x741928){var _0x25bbee={};_0x25bbee['fX']=this['pPanoPTZPoints'][_0x22da22][_0x14cfca+_0x741928]['fX'],_0x25bbee['fY']=this['pPanoPTZPoints'][_0x22da22][_0x14cfca+_0x741928]['fY'],_0x3bc936['pstPoints']['push'](_0x25bbee);}return _0x2ffc1c['SR_OK'];}},{'key':'GetPTZFragmentNum','value':function(_0x23965d){return _0x23965d<0x0||_0x23965d>=0x20||0x0==this['nPTZFragmentNum'][_0x23965d]?0x0:this['nPTZFragmentNum'][_0x23965d];}},{'key':'CalcPTZFragmentPoints','value':function(_0x67292d){if(_0x67292d<0x0||_0x67292d>=0x20)return _0x2ffc1c['SR_ERR_PARAM'];if(null==this['pPanoPTZPoints'][_0x67292d]||0x0==this['nPanoPTZPointNum'][_0x67292d])return _0x2ffc1c['SR_ERR_CALL_ORDER'];this['nPTZFragmentNode'][_0x67292d][0x0]=0x0,this['nPTZFragmentNum'][_0x67292d]=0x1;for(var _0x571d6f=0x0,_0x3f0266=0x0;_0x3f0266<this['nPanoPTZPointNum'][_0x67292d]-0x1;_0x3f0266++)Math['abs'](this['pPanoPTZPoints'][_0x67292d][_0x3f0266+0x1]['fX']-this['pPanoPTZPoints'][_0x67292d][_0x3f0266]['fX'])>0.5&&(_0x571d6f=this['nPTZFragmentNum'][_0x67292d],this['nPTZFragmentNode'][_0x67292d][_0x571d6f]=_0x3f0266+0x1,this['nPTZFragmentNum'][_0x67292d]=this['nPTZFragmentNum'][_0x67292d]+0x1);var _0xfce113=this['nPanoPTZPointNum'][_0x67292d];return Math['abs'](this['pPanoPTZPoints'][_0x67292d][0x0]['fX']-this['pPanoPTZPoints'][_0x67292d][_0xfce113-0x1]['fX'])<0.5&&(this['pPanoPTZPoints'][_0x67292d][_0xfce113]['fX']=this['pPanoPTZPoints'][_0x67292d][0x0]['fX'],this['pPanoPTZPoints'][_0x67292d][_0xfce113]['fY']=this['pPanoPTZPoints'][_0x67292d][0x0]['fY'],this['nPanoPTZPointNum'][_0x67292d]=this['nPanoPTZPointNum'][_0x67292d]+0x1),_0x571d6f=this['nPTZFragmentNum'][_0x67292d],this['nPTZFragmentNode'][_0x67292d][_0x571d6f]=this['nPanoPTZPointNum'][_0x67292d],_0x2ffc1c['SR_OK'];}},{'key':'IsPortAllocated','value':function(_0x536ab7){return this['bPortAllocated'][_0x536ab7];}},{'key':'GetPointFish2PanoCeiling','value':function(_0x55e7ef,_0x5984bf,_0x2fd577){if(null==this['pRenderParam'][this['nWndPort']])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==_0x55e7ef)return _0x2ffc1c['SR_ERR_PARAM'];var _0x8f284b,_0x3c3107;_0x8f284b=(this['fRX2']-this['fRX1'])/(this['fRY2']-this['fRY1']),_0x3c3107=(this['fRX2']-this['fRX1'])/0x2*0x1;var _0x2773f8,_0x562005=0x0;(this['fRX2']>0x1||this['fRY2']>0x1||this['fRX1']<0x0||this['fRY1']<0x0)&&(this['fRX1']<0x0&&(_0x2773f8=0x1*-this['fRX1'])>_0x562005&&(_0x562005=_0x2773f8),this['fRX2']>0x1&&(_0x2773f8=0x1*(this['fRX2']-0x1))>_0x562005&&(_0x562005=_0x2773f8),this['fRY1']<0x0&&(_0x2773f8=-this['fRY1']*_0x8f284b)>_0x562005&&(_0x562005=_0x2773f8),this['fRY2']>0x1&&(_0x2773f8=(this['fRY2']-0x1)*_0x8f284b)>_0x562005&&(_0x562005=_0x2773f8));var _0xd30ad,_0x4e4ed1=_0x562005/_0x3c3107,_0x473b76={'fX':0x0,'fY':0x0};if(Math['abs'](_0x5984bf-0.5)<0.000001&&Math['abs'](_0x2fd577-0.5)<0.000001)return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];var _0x5e72fe={},_0x910686={};_0x5e72fe['fX']=_0x5984bf-0.5,_0x5e72fe['fY']=_0x2fd577-0.5,_0x910686['fX']=-0.5*Math['sin'](this['pRenderParam'][this['nWndPort']]['fAngle']),_0x910686['fY']=0.5*Math['cos'](this['pRenderParam'][this['nWndPort']]['fAngle']);var _0x392617=Math['sqrt'](_0x5e72fe['fX']*_0x5e72fe['fX']+_0x5e72fe['fY']*_0x5e72fe['fY']),_0x1f8ac5=Math['sqrt'](_0x910686['fX']*_0x910686['fX']+_0x910686['fY']*_0x910686['fY']);return _0xd30ad=Math['acos']((_0x5e72fe['fX']*_0x910686['fX']+_0x5e72fe['fY']*_0x910686['fY'])/(_0x392617*_0x1f8ac5)),_0x5e72fe['fX']*_0x910686['fY']-_0x5e72fe['fY']*_0x910686['fX']>0x0&&(_0xd30ad=6.2831852-_0xd30ad),_0x473b76['fX']=_0xd30ad/6.2831853,_0x473b76['fY']=(0x2*(0.5-_0x392617)-_0x4e4ed1)/(0.8-_0x4e4ed1),_0x473b76['fY']>=0x0&&_0x473b76['fX']>=0x0&&_0x473b76['fY']<=0x1&&_0x473b76['fX']<=0x1?(_0x55e7ef['fX']=_0x473b76['fX'],_0x55e7ef['fY']=_0x473b76['fY'],_0x2ffc1c['SR_OK']):_0x2ffc1c['SR_ERR_PARAM'];}},{'key':'GetPointFish2PanoFloor','value':function(_0x398183,_0x48f929,_0x4f204b){if(null==this['pRenderParam'][this['nWndPort']])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==_0x398183)return _0x2ffc1c['SR_ERR_PARAM'];var _0x1b22e1,_0x2ac0a9;_0x1b22e1=(this['fRX2']-this['fRX1'])/(this['fRY2']-this['fRY1']),_0x2ac0a9=(this['fRX2']-this['fRX1'])/0x2*0x1;var _0x46156d,_0x5b29b6=0x0;(this['fRX2']>0x1||this['fRY2']>0x1||this['fRX1']<0x0||this['fRY1']<0x0)&&(this['fRX1']<0x0&&(_0x46156d=0x1*-this['fRX1'])>_0x5b29b6&&(_0x5b29b6=_0x46156d),this['fRX2']>0x1&&(_0x46156d=0x1*(this['fRX2']-0x1))>_0x5b29b6&&(_0x5b29b6=_0x46156d),this['fRY1']<0x0&&(_0x46156d=-this['fRY1']*_0x1b22e1)>_0x5b29b6&&(_0x5b29b6=_0x46156d),this['fRY2']>0x1&&(_0x46156d=(this['fRY2']-0x1)*_0x1b22e1)>_0x5b29b6&&(_0x5b29b6=_0x46156d));var _0x80021b,_0x14c53c=_0x5b29b6/_0x2ac0a9,_0x298ed6={'fX':0x0,'fY':0x0};if(Math['abs'](_0x48f929-0.5)<0.000001&&Math['abs'](_0x4f204b-0.5)<0.000001)return _0x2ffc1c['SR_ERR_NOT_SUPPORT'];var _0x53e564={},_0x280a1c={};_0x53e564['fX']=_0x48f929-0.5,_0x53e564['fY']=_0x4f204b-0.5,_0x280a1c['fX']=-0.5*Math['sin'](this['pRenderParam'][this['nWndPort']]['fAngle']),_0x280a1c['fY']=0.5*Math['cos'](this['pRenderParam'][this['nWndPort']]['fAngle']);var _0x3a3fa5=Math['sqrt'](_0x53e564['fX']*_0x53e564['fX']+_0x53e564['fY']*_0x53e564['fY']),_0x2feee6=Math['sqrt'](_0x280a1c['fX']*_0x280a1c['fX']+_0x280a1c['fY']*_0x280a1c['fY']);return _0x80021b=Math['acos']((_0x53e564['fX']*_0x280a1c['fX']+_0x53e564['fY']*_0x280a1c['fY'])/(_0x3a3fa5*_0x2feee6)),_0x53e564['fX']*_0x280a1c['fY']-_0x53e564['fY']*_0x280a1c['fX']>0x0&&(_0x80021b=6.2831852-_0x80021b),_0x298ed6['fX']=0x1-_0x80021b/6.2831853,_0x298ed6['fY']=0x1-(0x2*(0.5-_0x3a3fa5)-_0x14c53c)/(0.8-_0x14c53c),_0x298ed6['fY']>=0x0&&_0x298ed6['fX']>=0x0&&_0x298ed6['fY']<=0x1&&_0x298ed6['fX']<=0x1?(_0x398183['fX']=_0x298ed6['fX'],_0x398183['fY']=_0x298ed6['fY'],_0x2ffc1c['SR_OK']):_0x2ffc1c['SR_ERR_PARAM'];}},{'key':'GetPointFish2PanoWall','value':function(_0x400d41,_0x6e8b2c,_0x4bbbfe){if(null==this['pRenderParam'][this['nWndPort']])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(null==_0x400d41)return _0x2ffc1c['SR_ERR_PARAM'];var _0x15faf8,_0x53bc7d;_0x15faf8=(this['fRX2']-this['fRX1'])/(this['fRY2']-this['fRY1']),_0x53bc7d=(this['fRX2']-this['fRX1'])/0x2*0x1;var _0x55a08f,_0x28fb50,_0x53a60c,_0x345124,_0x3f2454,_0x420544=0x0,_0x222bae=0x1,_0x162ca4=0.1,_0x362692=0.9;this['fRX1']<0x0&&(_0x55a08f=0x1*-this['fRX1'],_0x420544=_0x55a08f/=0x2*_0x53bc7d),this['fRX2']>0x1&&(_0x28fb50=0x1*(this['fRX2']-0x1),_0x222bae=0x1-(_0x28fb50/=0x2*_0x53bc7d)),this['fRY1']<0x0&&(_0x53a60c=-this['fRY1']*_0x15faf8,_0x162ca4=(_0x53a60c/=0x2*_0x53bc7d)>0.1?_0x53a60c:0.1),this['fRY2']>0x1&&(_0x345124=(this['fRY2']-0x1)*_0x15faf8,_0x362692=(_0x345124/=0x2*_0x53bc7d)>0x1-0.9?0x1-_0x345124:0.9);var _0x5b3dd3={'fX':0x0,'fY':0x0},_0x3edc9d=0x2*_0x6e8b2c*_0x53bc7d,_0x5ac839=0x2*_0x4bbbfe*_0x53bc7d;return _0x3f2454=Math['sqrt'](_0x53bc7d*_0x53bc7d-(_0x5ac839-_0x53bc7d)*(_0x5ac839-_0x53bc7d)),Math['abs'](_0x3f2454)<0.000001?_0x2ffc1c['SR_ERR_PARAM']:(_0x6e8b2c=_0x53bc7d*(_0x3edc9d-_0x53bc7d)/_0x3f2454+_0x53bc7d,_0x4bbbfe=_0x5ac839,_0x5b3dd3['fX']=(_0x6e8b2c-0x2*_0x420544*_0x53bc7d)/(0x2*(_0x222bae-_0x420544)*_0x53bc7d),_0x5b3dd3['fY']=(_0x4bbbfe-0x2*_0x162ca4*_0x53bc7d)/(0x2*(_0x362692-_0x162ca4)*_0x53bc7d),_0x5b3dd3['fY']>=0x0&&_0x5b3dd3['fX']>=0x0&&_0x5b3dd3['fY']<=0x1&&_0x5b3dd3['fX']<=0x1?(_0x400d41['fX']=_0x5b3dd3['fX'],_0x400d41['fY']=_0x5b3dd3['fY'],_0x2ffc1c['SR_OK']):_0x2ffc1c['SR_ERR_PARAM']);}},{'key':'UpdateRangeParam','value':function(_0xa376e0,_0x483498){if(null==this['pRenderParam'][_0xa376e0])return _0x2ffc1c['SR_ERR_CALL_ORDER'];if(_0x483498<0.00001||_0x483498>0.6)return _0x2ffc1c['SR_ERR_PARAM'];var _0x820ff=0x0;return _0x5dc8af['SR_DE_FISH_PTZ_WALL']!=this['pRenderParam'][_0xa376e0]['nDisplayEffect']&&_0x5dc8af['SR_DE_FISH_PTZ_CEILING']!=this['pRenderParam'][_0xa376e0]['nDisplayEffect']&&_0x5dc8af['SR_DE_FISH_PTZ_FLOOR']!=this['pRenderParam'][_0xa376e0]['nDisplayEffect']||(_0x820ff=0x7*_0x483498+0.8,this['IsInImage'](this['fRX1'],this['fRX2'],this['fRY1'],this['fRY2'],this['pRenderParam'][_0xa376e0]['fCosH'],this['pRenderParam'][_0xa376e0]['fSinH'],this['pRenderParam'][_0xa376e0]['fCosV'],this['pRenderParam'][_0xa376e0]['fSinV'],_0x820ff,this['pRenderParam'][_0xa376e0]['nDisplayEffect']))?(this['pRenderParam'][_0xa376e0]['fZoom']=_0x820ff,_0x2ffc1c['SR_OK']):_0x2ffc1c['SR_ERR_PARAM'];}}]),_0x1f24a2;}()),_0x4684d8=_0x42e492['Dv'],_0x55066e=_0x42e492['CF'],_0x1ad956=_0x42e492['bC'],_0x1a1240=(function(){function _0x32f8e3(){_0x32f3fa(this,_0x32f8e3),this['canvas']=null,this['ctx']=null,this['regionSx']=0x0,this['regionSy']=0x0,this['regionSw']=0x0,this['regionSh']=0x0,this['needRect']=!0x1,this['bAntialias']=!0x1,this['bRecreateAntia']=!0x1,this['pfuncCBIn']=null,this['pUserIn']=null,this['pfuncCBOut']=null,this['pUserOut']=null;}return _0x551f25(_0x32f8e3,[{'key':'SR_Init','value':function(_0x258297){this['canvas']=_0x258297,this['ctx']=this['canvas']['getContext']('2d'),this['ctx']||console['log']('your\\x20browser\\x20does\\x20not\\x20support\\x202d\\x20render');}},{'key':'SR_Draw','value':function(_0xe7ff6){return this['needRect']?this['ctx']['drawImage'](_0xe7ff6,this['regionSx'],this['regionSy'],this['regionSw'],this['regionSh'],0x0,0x0,this['canvas']['width'],this['canvas']['height']):this['ctx']['drawImage'](_0xe7ff6,0x0,0x0,_0xe7ff6['displayWidth'],_0xe7ff6['displayHeight'],0x0,0x0,this['canvas']['width'],this['canvas']['height']),null!=this['pfuncCBIn']&&this['pfuncCBIn'](this['pUserIn']),0x1;}},{'key':'GetCanvasData','value':function(_0x1739c8){console['log']('%c\\x20start\\x20time:'+new Date()['getMinutes']()+':'+new Date()['getSeconds']()+'.'+new Date()['getMilliseconds'](),'color:\\x20blue');var _0xf25d11=this['ctx']['getImageData'](0x0,0x0,this['canvas']['width'],this['canvas']['height']);console['log']('%c\\x202\\x20time:'+new Date()['getMinutes']()+':'+new Date()['getSeconds']()+'.'+new Date()['getMilliseconds'](),'color:\\x20blue');var _0x34490c='jpeg',_0x354cae='image/jpeg',_0x4cd49a=document['createElement']('canvas'),_0x5bf190=_0x4cd49a['getContext']('2d');_0x4cd49a['width']=this['canvas']['width'],_0x4cd49a['height']=this['canvas']['height'],_0x5bf190['putImageData'](_0xf25d11,0x0,0x0);var _0x5b6c17=_0x4cd49a['toDataURL'](),_0x573462=document['createElement']('a');_0x573462['download']=new Date()['getTime']()+'.'+_0x34490c,_0x573462['href']=_0x5b6c17,_0x573462['dataset']['downloadurl']=[_0x354cae,_0x573462['download'],_0x573462['href']]['join'](':'),document['body']['appendChild'](_0x573462),_0x573462['click'](),document['body']['removeChild'](_0x573462),console['log']('%c\\x20end\\x20time:'+new Date()['getMinutes']()+':'+new Date()['getSeconds']()+'.'+new Date()['getMilliseconds'](),'color:\\x20blue');}},{'key':'SR_DelSubPort','value':function(_0x2eabaa){return 0x0;}},{'key':'SR_AddSubPort','value':function(_0x258af5){return 0x0;}},{'key':'SR_SetDisplayRect','value':function(_0x5c8392,_0x59b750,_0x2fa819,_0x1a2171){this['regionSx']=_0x5c8392,this['regionSy']=_0x59b750,this['regionSw']=_0x2fa819,this['regionSh']=_0x1a2171,this['needRect']=!0x0;}},{'key':'SR_Destroy','value':function(){this['canvas']=null,this['ctx']=null,this['regionSx']=0x0,this['regionSy']=0x0,this['regionSw']=0x0,this['regionSh']=0x0,this['needRect']=!0x1;}},{'key':'SR_SetCanvasSize','value':function(_0x21002d,_0x15ebfc){this['canvas']['width']=_0x21002d,this['canvas']['height']=_0x15ebfc;}},{'key':'SR_GetCanvasSize','value':function(){console['log']('canvas\\x20width:'+this['canvas']['width']+',height:'+this['canvas']['height']);}},{'key':'SR_SetAntialias','value':function(_0x1c8f93){return _0x1c8f93!=this['bAntialias']?(this['bAntialias']=_0x1c8f93,this['bRecreateAntia']=!0x0):this['bRecreateAntia']=!0x1,this['bRecreateAntia']&&(this['bAntialias']?(this['canvas']['width']=0x5*this['canvas']['width'],this['canvas']['height']=0x5*this['canvas']['height'],this['canvas']['style']['transform']='scale(0.2)',this['canvas']['style']['transformOrigin']='0\\x200'):(this['canvas']['width']=this['canvas']['width']/0x5,this['canvas']['height']=this['canvas']['height']/0x5,this['canvas']['style']['transform']='scale(1)',this['canvas']['style']['transformOrigin']='0\\x200')),0x1;}},{'key':'SR_SetCallBack','value':function(_0x1a0d22,_0x1fdb65,_0x3817fa){switch(_0x3817fa){case _0x1ad956['SRCALLBACKTYPE']['SR_CBT_NULL']:this['pfuncCBIn']=_0x1a0d22,this['pUserIn']=_0x1fdb65;break;case _0x1ad956['SRCALLBACKTYPE']['SR_CBT_OUT']:this['pfuncCBOut']=_0x1a0d22,this['pUserOut']=_0x1fdb65;break;default:return 0x0;}return 0x1;}},{'key':'SR_DrawFont','value':function(_0x2a5233,_0x4bd7b2,_0x165f00,_0x312b31,_0x1985e7,_0x32c2ac,_0x54ac2a,_0x290cad,_0xce15a6){var _0x2e7425=[],_0xab2e43={};return _0xab2e43['bBackground']=_0x32c2ac,_0xab2e43['nFontWidth']=_0x312b31,_0xab2e43['nFontHeight']=_0x1985e7,_0xab2e43['pstBGColor']=_0x54ac2a,_0xab2e43['pstFontColor']=_0x165f00,_0xab2e43['pString']=_0x2a5233,_0xab2e43['pstStartPos']=_0x4bd7b2,_0xab2e43['fRotateAngle']=_0x290cad,_0xab2e43['pFontFamily']=_0xce15a6,_0x2e7425['push'](_0xab2e43),this['SR_DrawFontEx'](_0x2e7425,0x1),0x1;}},{'key':'SR_DrawFontEx','value':function(_0x4c3d26,_0x31a482){for(var _0x1554ea=0x0;_0x1554ea<_0x31a482;_0x1554ea++){this['ctx']['textBaseline']='top';var _0x3803c9=_0x4c3d26[_0x1554ea]['nFontWidth'],_0x206d69=_0x4c3d26[_0x1554ea]['nFontHeight'],_0x2da981=(_0x3803c9=Math['round'](_0x3803c9))<(_0x206d69=Math['round'](_0x206d69))?_0x3803c9:_0x206d69;this['ctx']['font']=_0x2da981['toString']()+'px\\x20'+_0x4c3d26[_0x1554ea]['pFontFamily'];var _0x4ef958=parseInt(0xff*_0x4c3d26[_0x1554ea]['pstFontColor']['fR']),_0xf038a2=parseInt(0xff*_0x4c3d26[_0x1554ea]['pstFontColor']['fG']),_0x2c81a1=parseInt(0xff*_0x4c3d26[_0x1554ea]['pstFontColor']['fB']),_0x1bb661=_0x4ef958<0x10?'0'+_0x4ef958['toString'](0x10):_0x4ef958['toString'](0x10),_0x108cf7=_0xf038a2<0x10?'0'+_0xf038a2['toString'](0x10):_0xf038a2['toString'](0x10),_0x375dba=_0x2c81a1<0x10?'0'+_0x2c81a1['toString'](0x10):_0x2c81a1['toString'](0x10);this['ctx']['fillStyle']='#'+_0x1bb661+_0x108cf7+_0x375dba,this['ctx']['globalAlpha']=_0x4c3d26[_0x1554ea]['pstFontColor']['fA'],this['ctx']['fillText'](_0x4c3d26[_0x1554ea]['pString'],_0x4c3d26[_0x1554ea]['pstStartPos']['fX']*this['canvas']['width'],_0x4c3d26[_0x1554ea]['pstStartPos']['fY']*this['canvas']['height']);}return 0x1;}},{'key':'SR_DrawImage','value':function(_0x34c578,_0x5bf7b1,_0x140a6c,_0x151a32,_0x26cdb7,_0x56c12f){return 0x1;}},{'key':'SR_DrawLinesEx','value':function(_0x5d20bc,_0x4f0712,_0x19c4f3,_0x443343){return 0x1;}}]),_0x32f8e3;}());function _0x5df911(_0x531384,_0x568ada){var _0x52a61c=Object['keys'](_0x531384);if(Object['getOwnPropertySymbols']){var _0x5f58b6=Object['getOwnPropertySymbols'](_0x531384);_0x568ada&&(_0x5f58b6=_0x5f58b6['filter'](function(_0x1752cc){return Object['getOwnPropertyDescriptor'](_0x531384,_0x1752cc)['enumerable'];})),_0x52a61c['push']['apply'](_0x52a61c,_0x5f58b6);}return _0x52a61c;}function _0x2e0aef(_0x42971b){for(var _0x256554=0x1;_0x256554<arguments['length'];_0x256554++){var _0x230453=null!=arguments[_0x256554]?arguments[_0x256554]:{};_0x256554%0x2?_0x5df911(Object(_0x230453),!0x0)['forEach'](function(_0x1a64fe){_0x180d2d(_0x42971b,_0x1a64fe,_0x230453[_0x1a64fe]);}):Object['getOwnPropertyDescriptors']?Object['defineProperties'](_0x42971b,Object['getOwnPropertyDescriptors'](_0x230453)):_0x5df911(Object(_0x230453))['forEach'](function(_0x3138cf){Object['defineProperty'](_0x42971b,_0x3138cf,Object['getOwnPropertyDescriptor'](_0x230453,_0x3138cf));});}return _0x42971b;}var _0x573f02=0x10,_0x5b17bf=0x10,_0x93593d=0x1e,_0x8ee4c0=(function(){function _0x21e10c(_0x4877fe){_0x32f3fa(this,_0x21e10c),this['oVideoRenderHandle']=_0x4877fe,this['renderEngine']='webgl',this['oVideoHandle']=null,this['mainCanvasID']=null,this['curTimestamp']=0x0,this['mainSubPort']=0x0,this['mainVaildSubPort']=0x0,this['mainFECCorrect']=_0x1ad956['SRDISPLAYEFFECT']['SR_DE_NULL'],this['FECErrorCode']=0x0,this['subPortNum']=0x0,this['FECShowMode']=_0x1ad956['SRPTZDISPLAYMODE']['SR_DM_RANGE'],this['pFishParamManager']=null,this['enPixelFormat']=_0x1ad956['SRPIXELFORMAT']['SR_PF_NULL'],this['InitFECParam'](),this['nTimePerFrame']=0x0,this['nFrameRate']=0x0,this['privateNormalLinesInfo']=[],this['maxNormalPrivateLineTimeStamp']=0x0,this['curNormalLinesInfo']=null,this['privateThermalLinesInfo']=[],this['curThermalLinesInfo']=null,this['privateTemLinesInfo']=[],this['maxTemPrivateLineTimeStamp']=0x0,this['curTemLinesInfo']=null,this['m_nTEMDrawLinescount']=0x0,this['m_nTEMDrawFontscount']=0x0,this['privateTargetLinesInfo']=[],this['maxTargetPrivateLineTimeStamp']=0x0,this['curTargetLinesInfo']=null,this['privateMDLinesInfo']=[],this['maxMDPrivateLineTimeStamp']=0x0,this['curMDLinesInfo']=null,this['privateExactLinesInfo']=[],this['maxExactPrivateLineTimeStamp']=0x0,this['curExactLinesInfo']=null,this['privateExactRuleLinesInfo']=[],this['maxExactRulePrivateLineTimeStamp']=0x0,this['curExactRuleLinesInfo']=null,this['DrawlinesParamArray']=[],this['DrawlinesParamArrayAllPointNum']=0x0,this['bDrawlinesParamArrayFill']=0x0,this['DrawMosaiclinesParamArray']=[],this['DrawTargetlinesParamArray']=[],this['DrawPOSFontsParamArray']=[],this['DrawTargetEventIDList']=[],this['privateNormalFontsInfo']=[],this['maxNormalPrivateFontTimeStamp']=0x0,this['curNormalFontsInfo']=null,this['curNormalPOSFontsInfo']=null,this['privateTemFontsInfo']=[],this['maxTemPrivateFontTimeStamp']=0x0,this['curTemFontsInfo']=null,this['privateTargetFontsInfo']=[],this['maxTargetPrivateFontTimeStamp']=0x0,this['curTargetFontsInfo']=null,this['privateExactPOSFontsInfo']=[],this['maxExactPOSPrivateFontTimeStamp']=0x0,this['curExactPOSFontsInfo']=null,this['privateExactFontsInfo']=[],this['maxExactPrivateFontTimeStamp']=0x0,this['curExactFontsInfo']=null,this['DrawFontParamArray']=[],this['privateImageInfo']=[],this['maxPrivateImageTimeStamp']=0x0,this['curImagesInfo']={},this['privatePNGImageInfo']=[],this['m_bEnableIVSEx']=!0x0,this['m_bEnableMDEx']=!0x0,this['m_bEnablePICEx']=!0x1,this['m_bDisPos']=!0x1,this['m_bEnableTEMEx']=!0x1,this['m_bEnableTEMBox']=!0x1,this['m_bEnableTEMLine']=!0x1,this['m_bEnableTEMPoint']=!0x1,this['m_bEnableTrackEx']=!0x1,this['m_bEnableTrackPeople']=!0x0,this['m_bEnableTrackVehicle']=!0x0,this['m_bEnableThermal']=!0x1,this['m_bEnableThermalFireMask']=!0x1,this['m_bEnableThermalRuleGas']=!0x1,this['m_bEnableThermalTargetGas']=!0x1,this['m_bEnableFIREEx']=!0x0,this['m_bEnableFireDis']=!0x0,this['m_bEnableFireMax']=!0x1,this['m_bEnableFireMaxPos']=!0x0,this['m_bEnableFireDistance']=!0x0,this['bSRCallBackFlag']=!0x1,this['hasSetFECParamManager']=!0x1,this['panoramaDisplayEffect']=0x0,this['viewParamType']=0x3,this['viewParamValue']=0.2,this['pstWaterFontParamArray']=[];for(var _0x8d44ac=0x0;_0x8d44ac<_0x573f02;_0x8d44ac++)this['pstWaterFontParamArray'][_0x8d44ac]=[];this['pstWaterFontParam']=null,this['pWaterImageParam']=[],this['waterMarkImageIndex']=0x0,this['waterMarkImageMax']=0x1,this['baseWaterMarkImageTime']=0x0,this['finishDecodeImage']=!0x1,this['aPOSAdaptBuf']=[],this['textCanvas']=null,this['MosaicType']=0x0,this['MosaicSize']=0x0,this['MosaicColorR']=0x0,this['MosaicColorG']=0x0,this['MosaicColorB']=0x0,this['MosaicColorA']=0x0;}return _0x551f25(_0x21e10c,[{'key':'InitDisplay','value':function(_0x3c8ff8,_0x5d71e6,_0x50f000){if(this['renderEngine']=_0x5d71e6,this['mainCanvasID']=_0x3c8ff8,this['printfFlag']=this['oVideoRenderHandle']['printfFlag'],'2d'===this['renderEngine']||'2D'===this['renderEngine'])this['oVideoHandle']=new _0x1a1240(),this['printfFlag']>=0x0&&console['log']('2d\\x20render');else{if(this['oVideoHandle']=new _0x55066e(),this['mainFECCorrect']!=_0x1ad956['SRDISPLAYEFFECT']['SR_DE_NULL'])null==this['pFishParamManager']&&(this['pFishParamManager']=new _0x4684d8()),this['oVideoHandle']['SR_SetFishParamManager'](this['pFishParamManager']),this['hasSetFECParamManager']=!0x0;else{null==this['pFishParamManager']&&(this['pFishParamManager']=new _0x4684d8()),this['oVideoHandle']['SR_SetFishParamManager'](this['pFishParamManager']),this['hasSetFECParamManager']=!0x0;var _0x161376=_0x1ad956['SRDISPLAYEFFECT']['SR_DE_NULL'];_0x161376=0x1==this['panoramaDisplayEffect']?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_PANORAMA_SPHERE']:0x3==this['panoramaDisplayEffect']?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_PANORAMA_PLANET']:_0x1ad956['SRDISPLAYEFFECT']['SR_DE_NULL'],this['mainFECCorrect']=_0x161376;}this['printfFlag']>=0x0&&console['log']('webgl\\x20render\\x20this.printfFlag:'+this['printfFlag']);}return this['enPixelFormat']=_0x50f000,this['oVideoHandle']['SR_Init'](_0x3c8ff8,_0x50f000),this['mainVaildSubPort']=this['oVideoHandle']['SR_AddSubPort'](this['mainFECCorrect']),-0x1==this['mainVaildSubPort']?(console['info']('%c\\x20InitDisplay\\x20SR_AddSubPort\\x20error\\x20subport:%d','color:\\x20red',this['mainVaildSubPort']),0x0):(this['mainFECCorrect']==_0x1ad956['SRDISPLAYEFFECT']['SR_DE_PANORAMA_SPHERE']&&this['oVideoHandle']['SR_SetViewParam'](this['viewParamType'],this['viewParamValue']),0x1);}},{'key':'ReleaseDisplay','value':function(){if(null!=this['oVideoHandle']&&(this['oVideoHandle']['SR_DelSubPort'](this['mainVaildSubPort']),this['oVideoHandle']['SR_Destroy'](),this['oVideoHandle']=null),this['subPortNum']>0x0){for(var _0x53dad6=0x1;_0x53dad6<_0x573f02;_0x53dad6++)0x0!=this['stFishEyeManager'][_0x53dad6]['nSubPort']&&null!=this['stFishEyeManager'][_0x53dad6]['sCanvasID']&&0x0!=this['stFishEyeManager'][_0x53dad6]['bInited']&&(this['FEC_Disable'](_0x53dad6),this['FEC_DelPort'](_0x53dad6));}for(var _0x386b73=0x0;_0x386b73<_0x573f02;_0x386b73++)this['stFishEyeManager'][_0x386b73]['pRender']=null;return this['stFishEyeManager']['splice'](0x0,this['stFishEyeManager']['length']),this['stFishParam']['splice'](0x0,this['stFishParam']['length']),null!=this['pFishParamManager']&&(this['pFishParamManager']['DeInit'](),this['pFishParamManager']=null),this['FECShowMode']=_0x1ad956['SRPTZDISPLAYMODE']['SR_DM_RANGE'],this['DeInitPrivateParam'](),0x1;}},{'key':'DeInitPrivateParam','value':function(){this['privateNormalLinesInfo']['splice'](0x0,this['privateNormalLinesInfo']['length']),this['curNormalLinesInfo']=null,this['privateThermalLinesInfo']['splice'](0x0,this['privateThermalLinesInfo']['length']),this['curThermalLinesInfo']=null,this['privateTemLinesInfo']['splice'](0x0,this['privateTemLinesInfo']['length']),this['curTemLinesInfo']=null,this['privateTargetLinesInfo']['splice'](0x0,this['privateTargetLinesInfo']['length']),this['curTargetLinesInfo']=null,this['privateMDLinesInfo']['splice'](0x0,this['privateMDLinesInfo']['length']),this['curMDLinesInfo']=null,this['privateExactLinesInfo']['splice'](0x0,this['privateExactLinesInfo']['length']),this['curExactLinesInfo']=null,this['privateExactRuleLinesInfo']['splice'](0x0,this['privateExactRuleLinesInfo']['length']),this['curExactRuleLinesInfo']=null,this['privateNormalFontsInfo']['splice'](0x0,this['privateNormalFontsInfo']['length']),this['curNormalFontsInfo']=null,this['curNormalPOSFontsInfo']=null,this['privateTemFontsInfo']['splice'](0x0,this['privateTemFontsInfo']['length']),this['curTemFontsInfo']=null,this['privateTargetFontsInfo']['splice'](0x0,this['privateTargetFontsInfo']['length']),this['curTargetFontsInfo']=null,this['privateExactPOSFontsInfo']['splice'](0x0,this['privateExactPOSFontsInfo']['length']),this['curExactPOSFontsInfo']=null,this['privateExactFontsInfo']['splice'](0x0,this['privateExactFontsInfo']['length']),this['curExactFontsInfo']=null,this['privateImageInfo']['splice'](0x0,this['privateImageInfo']['length']),this['curImagesInfo']=null,this['privatePNGImageInfo']['splice'](0x0,this['privatePNGImageInfo']['length']),this['DrawlinesParamArray']['splice'](0x0,this['DrawlinesParamArray']['length']),this['DrawTargetlinesParamArray']['splice'](0x0,this['DrawTargetlinesParamArray']['length']),this['DrawMosaiclinesParamArray']['splice'](0x0,this['DrawMosaiclinesParamArray']['length']),this['DrawPOSFontsParamArray']['splice'](0x0,this['DrawPOSFontsParamArray']['length']),this['DrawTargetEventIDList']['splice'](0x0,this['DrawTargetEventIDList']['length']),this['DrawFontParamArray']['splice'](0x0,this['DrawFontParamArray']['length']);for(var _0x194f2c=0x0;_0x194f2c<_0x573f02;_0x194f2c++)this['pstWaterFontParamArray'][_0x194f2c]['splice'](0x0,this['pstWaterFontParamArray'][_0x194f2c]['length']);this['pWaterImageParam']['splice'](0x0,this['pWaterImageParam']['length']),this['bSRCallBackFlag']=!0x1,this['textCanvas']=null,this['curLinesInfo']=null,this['pstWaterFontParam']=null;}},{'key':'DisplayFrame','value':function(_0x5b36aa,_0x271929,_0x49a997,_0x135dcd,_0x43fbbd,_0x58bbc5,_0x17b6e9,_0xc8f0ac){var _0x17d258=this;return new Promise(function(_0x474008){null!=_0x5b36aa&&(_0x17d258['curTimestamp']=_0x135dcd),_0x17d258['bSRCallBackFlag']||(null!=_0x17d258['oVideoHandle']&&_0x17d258['oVideoHandle']['SR_SetCallBack'](_0x17d258['WebGLDisplayCallBack'],_0x17d258,_0x1ad956['SRCALLBACKTYPE']['SR_CBT_NULL']),_0x17d258['bSRCallBackFlag']=!0x0);var _0x46acd0=0x1;if(0x2==_0x17d258['panoramaDisplayEffect']&&(_0x271929==0x2*_0x49a997?_0x17d258['SetPanoramaDisplayEffect'](0x1):_0x17d258['SetPanoramaDisplayEffect'](0x0)),null!=_0x5b36aa&&(_0x17d258['nFrameRate']=_0x17b6e9,_0x17d258['nTimePerFrame']=0x3e8/_0x17b6e9,0x0==_0xc8f0ac&&(_0x17d258['FindIntelNodefromList'](_0x17d258['curTimestamp']),_0x17d258['CheckLinesInfo'](),_0x17d258['CheckFontsInfo']()),null!=_0x17d258['oVideoHandle']&&0x1==(_0x46acd0=_0x17d258['oVideoHandle']['SR_UpdateFrameData'](_0x5b36aa,_0x271929,_0x49a997,_0x43fbbd,_0x58bbc5))&&(_0x46acd0=_0x17d258['oVideoHandle']['SR_Display'](!0x1)),_0x17d258['subPortNum']>0x0)){for(var _0x3fe544=0x1;_0x3fe544<_0x573f02;_0x3fe544++)0x0!=_0x17d258['stFishEyeManager'][_0x3fe544]['nSubPort']&&null!=_0x17d258['stFishEyeManager'][_0x3fe544]['sCanvasID']&&0x0!=_0x17d258['stFishEyeManager'][_0x3fe544]['bInited']&&null!=_0x17d258['stFishEyeManager'][_0x3fe544]['pRender']&&0x1==(_0x46acd0=_0x17d258['stFishEyeManager'][_0x3fe544]['pRender']['SR_UpdateFrameData'](_0x5b36aa,_0x271929,_0x49a997,null,null))&&(_0x46acd0=_0x17d258['stFishEyeManager'][_0x3fe544]['pRender']['SR_Display'](!0x1));}_0x474008({'timestamp':_0x17d258['curTimestamp'],'DrawRet':_0x46acd0});});}},{'key':'SetDisplayRect','value':function(_0x116fba,_0x500884,_0x230678,_0x5d93ee){return null!=this['oVideoHandle']&&(this['oVideoHandle']['SR_SetDisplayRect'](_0x116fba,_0x500884,_0x230678,_0x5d93ee,_0x1ad956['SRSETRECTTYPE']['SR_SRT_SRC']),null!=this['pstWaterFontParam']&&this['pstWaterFontParam']['nColorAdapt']&&(this['pstWaterFontParamArray'][0x0]['splice'](0x0,this['pstWaterFontParamArray'][0x0]['length']),this['CalculateWaterMarkParam'](this['oVideoHandle'],0x0,this['pstWaterFontParam']))),0x1;}},{'key':'SetCanvasSize','value':function(_0x3dbf41,_0x76a6ba,_0x32ca52){var _0x22889f=this['oVideoHandle'];if(_0x32ca52>0x0&&(_0x22889f=this['stFishEyeManager'][_0x32ca52]['pRender']),null!=_0x22889f){if(_0x22889f['SR_SetCanvasSize'](_0x3dbf41,_0x76a6ba),0x0!=this['pstWaterFontParamArray'][_0x32ca52]['length']&&null!=this['pstWaterFontParam']){if(0x1==this['pstWaterFontParam']['pstCanvasAdapt']['nCanvasAdaptMode'])this['pstWaterFontParamArray'][_0x32ca52]['splice'](0x0,this['pstWaterFontParamArray'][_0x32ca52]['length']),this['CalculateWaterMarkParam'](_0x22889f,_0x32ca52,this['pstWaterFontParam']);else{if(0x2==this['pstWaterFontParam']['pstCanvasAdapt']['nCanvasAdaptMode']){var _0x176d7f=this['mainCanvasID']['width'],_0x14fe5b=this['mainCanvasID']['height'];_0x32ca52>0x0&&(_0x176d7f=this['stFishEyeManager'][_0x32ca52]['sCanvasID']['width'],_0x14fe5b=this['stFishEyeManager'][_0x32ca52]['sCanvasID']['height']);for(var _0x30db53=0x0;_0x30db53<this['pstWaterFontParamArray'][_0x32ca52]['length'];++_0x30db53)this['pstWaterFontParamArray'][_0x32ca52][_0x30db53]['nFontWidth']=this['pstWaterFontParam']['pstFontSize']['nFontWidth']*_0x176d7f/this['pstWaterFontParam']['pstCanvasAdapt']['nBaseCanvasWidth'],this['pstWaterFontParamArray'][_0x32ca52][_0x30db53]['nFontHeight']=this['pstWaterFontParam']['pstFontSize']['nFontHeight']*_0x14fe5b/this['pstWaterFontParam']['pstCanvasAdapt']['nBaseCanvasHeight'];}}}return 0x1;}return 0x0;}},{'key':'GetCanvasSize','value':function(){return null!=this['oVideoHandle']?this['oVideoHandle']['SR_GetCanvasSize']():0x0;}},{'key':'SetAntialias','value':function(_0x75e61d){return null!=this['oVideoHandle']?this['oVideoHandle']['SR_SetAntialias'](_0x75e61d):0x0;}},{'key':'SetD3DPostProcess','value':function(_0x2f3460,_0x367b9c){var _0x32c409=0x1;return null!=this['oVideoHandle']?(_0x32c409=this['oVideoHandle']['SR_SetImagePostProcess'](_0x2f3460,_0x367b9c),null!=this['pstWaterFontParam']&&this['pstWaterFontParam']['nColorAdapt']&&(this['pstWaterFontParamArray'][0x0]['splice'](0x0,this['pstWaterFontParamArray'][0x0]['length']),this['CalculateWaterMarkParam'](this['oVideoHandle'],0x0,this['pstWaterFontParam']))):_0x32c409=0x0,_0x32c409;}},{'key':'InitFECParam','value':function(){this['stFishEyeManager']=[];for(var _0x295567=0x0;_0x295567<_0x573f02;_0x295567++)this['stFishEyeManager'][_0x295567]={},this['stFishEyeManager'][_0x295567]['pRender']=null,this['stFishEyeManager'][_0x295567]['nSubPort']=0x0,this['stFishEyeManager'][_0x295567]['sCanvasID']=null,this['stFishEyeManager'][_0x295567]['bUsed']=0x0,this['stFishEyeManager'][_0x295567]['bInited']=0x0,this['stFishEyeManager'][_0x295567]['nValidSubPort']=0x0,this['stFishEyeManager'][_0x295567]['emPlaceType']=_0x51aa1d,this['stFishEyeManager'][_0x295567]['emCorrectType']=_0x46d36d,this['stFishEyeManager'][_0x295567]['emEffect']=_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_ORIGINAL'];this['stFishParam']=[];for(var _0x4c294c=0x0;_0x4c294c<_0x573f02;_0x4c294c++)this['stFishParam'][_0x4c294c]={},this['stFishParam'][_0x4c294c]['nUpDateType']=0x0,this['stFishParam'][_0x4c294c]['stPTZParam']={},this['stFishParam'][_0x4c294c]['stPTZParam']['fPTZPositionX']=0x0,this['stFishParam'][_0x4c294c]['stPTZParam']['fPTZPositionY']=0x0,this['stFishParam'][_0x4c294c]['stCycleParam']={},this['stFishParam'][_0x4c294c]['stCycleParam']['fRadiusLeft']=0x0,this['stFishParam'][_0x4c294c]['stCycleParam']['fRadiusRight']=0x0,this['stFishParam'][_0x4c294c]['stCycleParam']['fRadiusTop']=0x0,this['stFishParam'][_0x4c294c]['stCycleParam']['fRadiusBottom']=0x0,this['stFishParam'][_0x4c294c]['fZoom']=0x0,this['stFishParam'][_0x4c294c]['fWideScanOffset']=0x0,this['stFishParam'][_0x4c294c]['stPTZColor']={},this['stFishParam'][_0x4c294c]['stPTZColor']['nR']=0x0,this['stFishParam'][_0x4c294c]['stPTZColor']['nG']=0x0,this['stFishParam'][_0x4c294c]['stPTZColor']['nB']=0x0,this['stFishParam'][_0x4c294c]['stPTZColor']['nAlpha']=0x0,this['stFishParam'][_0x4c294c]['stPTZSelect']={},this['stFishParam'][_0x4c294c]['stPTZSelect']['fTop']=0x0,this['stFishParam'][_0x4c294c]['stPTZSelect']['fBottom']=0x0,this['stFishParam'][_0x4c294c]['stPTZSelect']['fLeft']=0x0,this['stFishParam'][_0x4c294c]['stPTZSelect']['fRight']=0x0,this['stFishParam'][_0x4c294c]['nCut']=0x0;}},{'key':'FEC_SetCanvasID','value':function(_0x1f9896){return this['mainFECCorrect']=_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_ORIGINAL'],0x1;}},{'key':'FEC_ResetCorrectType','value':function(_0x3f305f,_0x4088a9,_0x2c6229){if(!0x1===this['hasSetFECParamManager']&&(null==this['pFishParamManager']&&(this['pFishParamManager']=new _0x4684d8()),this['oVideoHandle']['SR_SetFishParamManager'](this['pFishParamManager']),this['hasSetFECParamManager']=!0x0),_0x2c6229!=_0x46d36d&&_0x2c6229!=_0x5195df&&_0x2c6229!=_0x5c6ecb&&_0x2c6229!=_0x13d414&&_0x2c6229!=_0x1053ee&&_0x2c6229!=_0x100fbf&&_0x2c6229!=_0x4baf73&&_0x2c6229!=_0x3aa96c&&_0x2c6229!=_0x5c3f8c&&_0x2c6229!=_0x867a32&&_0x2c6229!=_0x4401a6)return console['log']('%c\\x20hardDecoder\\x20not\\x20support\\x20correctType:%d','color:red',_0x2c6229),this['FECErrorCode']=0x10,0x0;if(0x1!=this['FECParamJudge'](_0x3f305f,_0x4088a9,_0x2c6229))return 0x0;var _0x30ff0f=_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_ORIGINAL'];if(_0x30ff0f=this['_ConvertDisplayEffect'](_0x4088a9,_0x2c6229),0x0==_0x3f305f&&null==this['stFishEyeManager'][_0x3f305f]['pRender']&&(this['stFishEyeManager'][_0x3f305f]['pRender']=this['oVideoHandle'],this['stFishEyeManager'][_0x3f305f]['nSubPort']=_0x3f305f,this['stFishEyeManager'][_0x3f305f]['sCanvasID']=this['mainCanvasID'],this['stFishEyeManager'][_0x3f305f]['bUsed']=0x1,this['stFishEyeManager'][_0x3f305f]['bInited']=0x1,this['stFishEyeManager'][_0x3f305f]['nValidSubPort']=this['mainVaildSubPort'],this['stFishEyeManager'][_0x3f305f]['emPlaceType']=_0x4088a9,this['stFishEyeManager'][_0x3f305f]['emCorrectType']=_0x2c6229,this['stFishEyeManager'][_0x3f305f]['emEffect']=_0x30ff0f,this['mainFECCorrect']=_0x30ff0f),null!=this['stFishEyeManager'][_0x3f305f]['pRender']){this['stFishEyeManager'][_0x3f305f]['pRender']['SR_DelSubPort'](this['stFishEyeManager'][_0x3f305f]['nValidSubPort']);var _0x4e8634=this['stFishEyeManager'][_0x3f305f]['pRender']['SR_AddSubPort'](_0x30ff0f);if(0x0==_0x3f305f?this['oVideoHandle']['SR_SetCallBack'](this['WebGLDisplayCallBack'],this,_0x1ad956['SRCALLBACKTYPE']['SR_CBT_NULL']):this['stFishEyeManager'][_0x3f305f]['pRender']['SR_SetCallBack'](this['WebGLDisplaySubCallBack'],{'nUser':this,'handle':this['stFishEyeManager'][_0x3f305f]['pRender'],'nSubPort':_0x3f305f},_0x1ad956['SRCALLBACKTYPE']['SR_CBT_NULL']),null!=this['pstWaterFontParam']&&this['pstWaterFontParam']['nColorAdapt']&&(this['pstWaterFontParamArray'][_0x3f305f]['splice'](0x0,this['pstWaterFontParamArray'][_0x3f305f]['length']),this['CalculateWaterMarkParam'](this['stFishEyeManager'][_0x3f305f]['pRender'],_0x3f305f,this['pstWaterFontParam'])),-0x1==_0x4e8634)return console['info']('%c\\x20FEC_ResetCorrectType\\x20SR_AddSubPort\\x20error\\x20subport:%d','color:\\x20red',_0x4e8634),0x0;if(this['stFishEyeManager'][_0x3f305f]['nValidSubPort']=_0x4e8634,this['stFishEyeManager'][_0x3f305f]['emPlaceType']=_0x4088a9,this['stFishEyeManager'][_0x3f305f]['emCorrectType']=_0x2c6229,this['stFishEyeManager'][_0x3f305f]['emEffect']=_0x30ff0f,_0x13d414<=this['stFishEyeManager'][_0x3f305f]['emCorrectType']){var _0x4ce9d9=this['stFishEyeManager'][_0x3f305f]['pRender']['SR_SetRenderState'](_0x1ad956['SRRENDERSTATETYPE']['SR_RST_BACK_CULL'],0x0);_0x1ad956['ERRCODE']['SR_OK']!=_0x4ce9d9&&console['log']('>>>VideoRender.js\\x20SR_SetRenderState\\x20failed\\x20ret：%08x\\x0a',_0x4ce9d9);}}return this['FECShowMode']>0x0&&null!=this['stFishEyeManager'][_0x3f305f]['pRender']&&this['stFishEyeManager'][_0x3f305f]['pRender']['SR_SetPTZDisplayMode'](this['FECShowMode']),0x0==_0x3f305f&&(this['mainVaildSubPort']=this['stFishEyeManager'][_0x3f305f]['nValidSubPort']),0x1;}},{'key':'FEC_GetPort','value':function(_0x4a78f2,_0x575323){if(_0x575323!=_0x46d36d&&_0x575323!=_0x5195df&&_0x575323!=_0x5c6ecb&&_0x575323!=_0x13d414&&_0x575323!=_0x1053ee&&_0x575323!=_0x100fbf&&_0x575323!=_0x4baf73&&_0x575323!=_0x867a32&&_0x575323!=_0x4401a6)return console['log']('%c\\x2020231112\\x20hardDecoder\\x20not\\x20support\\x20emCorrectType:%d','color:red',_0x575323),this['FECErrorCode']=0x10,-0x1;var _0x1465f0;if(0x1!=this['FECParamJudge'](-0x1,_0x4a78f2,_0x575323))return console['log']('VideoRender.js\\x20FEC_GetPort\\x20FECParamJudge\\x20Get\\x20error'),-0x1;var _0x1d2a43=0x0;for(_0x1465f0=0x1;_0x1465f0<_0x573f02;_0x1465f0++)if(0x0==this['stFishEyeManager'][_0x1465f0]['nSubPort']&&0x0==this['stFishEyeManager'][_0x1465f0]['bUsed']){this['stFishEyeManager'][_0x1465f0]['nSubPort']=_0x1465f0,this['stFishEyeManager'][_0x1465f0]['nValidSubPort']=-0x1,this['stFishEyeManager'][_0x1465f0]['bUsed']=0x1,this['stFishEyeManager'][_0x1465f0]['emPlaceType']=_0x4a78f2,this['stFishEyeManager'][_0x1465f0]['emCorrectType']=_0x575323,_0x1d2a43=_0x1465f0;break;}if(_0x573f02==_0x1465f0)return console['info']('%c\\x20FEC_GetPort-12\\x20fish\\x20subport\\x20max','color:\\x20red'),this['FECErrorCode']=0x504,-0x1;var _0x39f37b=_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_ORIGINAL'];return _0x39f37b=this['_ConvertDisplayEffect'](this['stFishEyeManager'][_0x1d2a43]['emPlaceType'],this['stFishEyeManager'][_0x1d2a43]['emCorrectType']),_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_ORIGINAL']!=_0x39f37b?(0x0==this['stFishEyeManager'][_0x1d2a43]['bInited']&&(this['stFishEyeManager'][_0x1d2a43]['emEffect']=_0x39f37b,this['stFishEyeManager'][_0x1d2a43]['bInited']=0x0,this['stFishParam'][_0x1d2a43]['fZoom']=0.005,this['stFishParam'][_0x1d2a43]['stPTZParam']['fPTZPositionX']=0.5,this['stFishParam'][_0x1d2a43]['stPTZParam']['fPTZPositionY']=0.5,this['stFishParam'][_0x1d2a43]['fWideScanOffset']=0x0),this['FECErrorCode']=0x0,this['subPortNum']++,_0x1d2a43):_0x1d2a43<_0x573f02&&0x0==this['stFishEyeManager'][_0x1d2a43]['bInited']?(this['stFishEyeManager'][_0x1d2a43]['emEffect']=_0x39f37b,this['stFishEyeManager'][_0x1d2a43]['bInited']=0x0,this['stFishParam'][_0x1d2a43]['fZoom']=0x0,this['stFishParam'][_0x1d2a43]['stPTZParam']['fPTZPositionX']=0x0,this['stFishParam'][_0x1d2a43]['stPTZParam']['fPTZPositionY']=0x0,this['stFishParam'][_0x1d2a43]['fWideScanOffset']=0x0,this['FECErrorCode']=0x0,this['subPortNum']++,_0x1d2a43):(this['stFishEyeManager'][_0x1465f0]['pRender']=null,this['stFishEyeManager'][_0x1465f0]['nSubPort']=0x0,this['stFishEyeManager'][_0x1465f0]['sCanvasID']=null,this['stFishEyeManager'][_0x1465f0]['bUsed']=0x0,this['stFishEyeManager'][_0x1465f0]['bInited']=0x0,this['stFishEyeManager'][_0x1465f0]['nValidSubPort']=0x0,this['stFishEyeManager'][_0x1465f0]['emPlaceType']=_0x51aa1d,this['stFishEyeManager'][_0x1465f0]['emCorrectType']=_0x46d36d,this['stFishEyeManager'][_0x1465f0]['emEffect']=_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_ORIGINAL'],this['FECErrorCode']=_0xf71e92,-0x1);}},{'key':'FECParamJudge','value':function(_0x39e6d8,_0x46b6a5,_0x5bb630){if(0x0!=_0x39e6d8){if(_0x5bb630==_0x46d36d||_0x5bb630==_0x5195df||_0x5bb630==_0x5c6ecb||_0x5bb630==_0x100fbf||_0x5bb630==_0x5c3f8c||_0x5bb630==_0x867a32||_0x5bb630==_0x4401a6)return console['log']('VideoRender.js\\x20FECParamJudge\\x201\\x20emCorrectType:'+_0x5bb630),this['FECErrorCode']=_0xf71e92,0x0;if(this['stFishEyeManager'][0x0]['emCorrectType']==_0x4401a6||this['stFishEyeManager'][0x0]['emCorrectType']==_0x867a32)return this['FECErrorCode']=_0xf71e92,console['log']('VideoRender.js\\x20FECParamJudge\\x202\\x20emCorrectType:'+_0x5bb630),0x0;}if(0x0==_0x39e6d8&&(_0x867a32==_0x5bb630||_0x4401a6==_0x5bb630)){for(var _0x2365a7=0x1;_0x2365a7<_0x573f02;_0x2365a7++)if(this['stFishEyeManager'][_0x2365a7]['bUsed'])return this['FECErrorCode']=_0xf71e92,console['log']('VideoRender.js\\x20FECParamJudge\\x203\\x20subPort:'+_0x39e6d8+',emCorrectType:'+_0x5bb630),0x0;}if(!(_0x36ed43!=_0x46b6a5&&_0x51aa1d!=_0x46b6a5||_0x100fbf!=_0x5bb630&&_0x867a32!=_0x5bb630&&_0x4401a6!=_0x5bb630))return console['info']('%c\\x20VideoRender.js\\x20FECParamJudge\\x204\\x20floor\\x20and\\x20ceiling\\x20not\\x20support\\x20lat','color:\\x20red'),this['FECErrorCode']=_0xf71e92,0x0;if(_0x527ccc==_0x46b6a5&&(_0x4baf73==_0x5bb630||_0x3aa96c==_0x5bb630||_0x5195df==_0x5bb630))return console['info']('%c\\x20VideoRender.js\\x20FECParamJudge\\x205\\x20wall\\x20not\\x20support\\x20cylinger','color:\\x20red'),this['FECErrorCode']=_0xf71e92,0x0;if(_0x527ccc!=_0x46b6a5&&_0x36ed43!=_0x46b6a5&&_0x51aa1d!=_0x46b6a5)return console['info']('%c\\x20VideoRender.js\\x20FECParamJudge\\x206\\x20emPlaceType\\x20only\\x20support\\x20floor,\\x20ceiling\\x20and\\x20wall','color:\\x20red'),this['FECErrorCode']=MP_E_SUPPORT,0x0;if(0x0!=_0x5bb630&&_0x5bb630!=_0x1053ee&&_0x5bb630!=_0x5195df&&_0x5bb630!=_0x5c6ecb&&_0x5bb630!=_0x100fbf&&_0x5bb630!=_0x13d414&&_0x5bb630!=_0x4baf73&&_0x5bb630!=_0x3aa96c&&_0x5bb630!=_0x5c3f8c&&_0x5bb630!=_0x867a32&&_0x5bb630!=_0x4401a6)return console['info']('%c\\x20VideoRender.js\\x20FECParamJudge\\x207\\x20emCorrectType\\x20error','color:\\x20red'),this['FECErrorCode']=MP_E_SUPPORT,0x0;for(var _0x2f7af0=0x0;_0x2f7af0<_0x573f02;_0x2f7af0++){if(this['stFishEyeManager'][_0x2f7af0]['bUsed']&&this['stFishEyeManager'][_0x2f7af0]['emPlaceType']!=_0x46b6a5)return console['info']('%c\\x20VideoRender.js\\x20FECParamJudge\\x208\\x20emPlaceType\\x20changed','color:\\x20red'),this['FECErrorCode']=0x517,0x0;if(_0x2f7af0!=_0x39e6d8){if(this['stFishEyeManager'][_0x2f7af0]['bUsed']&&this['stFishEyeManager'][_0x2f7af0]['emCorrectType']!=_0x1053ee&&this['stFishEyeManager'][_0x2f7af0]['emCorrectType']!=_0x13d414&&this['stFishEyeManager'][_0x2f7af0]['emCorrectType']!=_0x4baf73&&this['stFishEyeManager'][_0x2f7af0]['emCorrectType']!=_0x3aa96c&&this['stFishEyeManager'][_0x2f7af0]['emCorrectType']!=_0x5c3f8c&&this['stFishEyeManager'][_0x2f7af0]['emCorrectType']!=_0x867a32&&this['stFishEyeManager'][_0x2f7af0]['emCorrectType']!=_0x4401a6&&_0x5bb630!=_0x1053ee&&_0x5bb630!=_0x13d414&&_0x5bb630!=_0x4baf73&&_0x5bb630!=_0x3aa96c&&_0x5bb630!=_0x5c3f8c&&_0x5bb630!=_0x867a32&&_0x5bb630!=_0x4401a6)return console['info']('%c\\x20VideoRender.js\\x20FECParamJudge\\x209\\x20origin/180/360/lat\\x20only\\x20display\\x20one\\x20port','color:\\x20red'),this['FECErrorCode']=0x518,0x0;if(this['stFishEyeManager'][_0x2f7af0]['bUsed']&&(this['stFishEyeManager'][_0x2f7af0]['emCorrectType']==_0x1053ee&&_0x5bb630==_0x5195df||this['stFishEyeManager'][_0x2f7af0]['emCorrectType']==_0x5195df&&_0x5bb630==_0x1053ee))return console['info']('%c\\x20VideoRender.js\\x20FECParamJudge\\x2010\\x20180\\x20cannot\\x20support\\x20ptz','color:\\x20red'),this['FECErrorCode']=0x518,0x0;}}return 0x1;}},{'key':'FEC_Enable','value':function(_0x14f3f8){return _0x14f3f8<0x1||_0x14f3f8>0x1f||null==_0x14f3f8?(console['info']('%c\\x20FEC_Enable-1\\x20nSubPort:%d','color:\\x20red',_0x14f3f8),this['FECErrorCode']=_0x1f9ba7,0x0):null!==this['stFishEyeManager'][_0x14f3f8]['pRender']?(console['info']('%c\\x20FEC_Enable-2\\x20nSubPort:%d','color:\\x20red',_0x14f3f8),this['FECErrorCode']=0x515,0x0):(null==this['stFishEyeManager'][_0x14f3f8]['pRender']&&(this['stFishEyeManager'][_0x14f3f8]['pRender']=new _0x55066e(),null==this['pFishParamManager']&&(this['pFishParamManager']=new _0x4684d8()),this['stFishEyeManager'][_0x14f3f8]['pRender']['SR_SetFishParamManager'](this['pFishParamManager'])),0x1);}},{'key':'FEC_SetWnd','value':function(_0x126405,_0x2ff218){if(_0x126405<0x1||_0x126405>0x1f||null==_0x126405)return console['info']('%c\\x20FEC_SetWnd-1\\x20nSubPort:%d','color:\\x20red',_0x126405),this['FECErrorCode']=_0x1f9ba7,0x0;if(null==this['stFishEyeManager'][_0x126405]['pRender'])return console['info']('%c\\x20FEC_SetWnd-2\\x20nSubPort:%d\\x20pRender\\x20is\\x20null','color:\\x20red',_0x126405),this['FECErrorCode']=_0xd86f77,0x0;if(0x0==this['stFishEyeManager'][_0x126405]['bUsed'])return console['info']('%c\\x20FEC_SetWnd-3\\x20nSubPort:%d\\x20bUsed:%d','color:\\x20red',_0x126405,this['stFishEyeManager'][_0x126405]['bUsed']),this['FECErrorCode']=_0x32049a,0x0;if(null==_0x2ff218)return console['info']('%c\\x20FEC_SetWnd-4\\x20nSubPort:%d\\x20sCanvasID:%s','color:\\x20red',_0x126405,_0x2ff218),this['FECErrorCode']=0x519,0x0;if(0x0!=this['stFishEyeManager'][_0x126405]['nSubPort']&&0x0!=this['stFishEyeManager'][_0x126405]['bUsed']){if(0x0!=this['stFishEyeManager'][_0x126405]['bInited']&&null!=this['stFishEyeManager'][_0x126405]['sCanvasID'])return _0x2ff218!=this['stFishEyeManager'][_0x126405]['sCanvasID']?(console['info']('%c\\x20FEC_SetWnd-5\\x20nSubPort:%d\\x20sCanvasID:%s\\x20already\\x20init','color:\\x20red',_0x126405,_0x2ff218),this['FECErrorCode']=0x506,0x0):0x1;var _0x583965=_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_ORIGINAL'];_0x583965=this['_ConvertDisplayEffect'](this['stFishEyeManager'][_0x126405]['emPlaceType'],this['stFishEyeManager'][_0x126405]['emCorrectType']);var _0x3175f3=this['stFishEyeManager'][_0x126405]['pRender']['SR_Init'](_0x2ff218,this['enPixelFormat']),_0x1e367f=this['stFishEyeManager'][_0x126405]['pRender']['SR_AddSubPort'](_0x583965);if(-0x1==_0x1e367f)return console['info']('%c\\x20FEC_SetWnd\\x20SR_AddSubPort\\x20error\\x20subport:%d','color:\\x20red',_0x126405),0x0;if(this['stFishEyeManager'][_0x126405]['nValidSubPort']=_0x1e367f,_0x1ad956['ERRCODE']['SR_OK']!=_0x3175f3)return this['stFishEyeManager'][_0x126405]['bInited']=0x0,this['stFishEyeManager'][_0x126405]['sCanvasID']=null,this['FECErrorCode']=_0x32049a,0x0;if(this['stFishEyeManager'][_0x126405]['bInited']=0x1,this['stFishEyeManager'][_0x126405]['sCanvasID']=_0x2ff218,_0x13d414<=this['stFishEyeManager'][_0x126405]['emCorrectType']){var _0xe5f27f=this['stFishEyeManager'][_0x126405]['pRender']['SR_SetRenderState'](_0x1ad956['SRRENDERSTATETYPE']['SR_RST_BACK_CULL'],0x0);_0x1ad956['ERRCODE']['SR_OK']!=_0xe5f27f&&console['log']('>>>VideoRender.js\\x20SR_SetRenderState\\x20failed\\x20ret：%08x\\x0a',_0xe5f27f);}return this['stFishEyeManager'][_0x126405]['pRender']['SR_SetCallBack'](this['WebGLDisplaySubCallBack'],{'nUser':this,'handle':this['stFishEyeManager'][_0x126405]['pRender'],'nSubPort':_0x126405},_0x1ad956['SRCALLBACKTYPE']['SR_CBT_NULL']),null!=this['pstWaterFontParam']&&this['SetWaterMarkFont'](this['pstWaterFontParam']),this['FECShowMode']>0x0&&this['stFishEyeManager'][_0x126405]['pRender']['SR_SetPTZDisplayMode'](this['FECShowMode']),0x1;}return this['FECErrorCode']=_0x32049a,0x0;}},{'key':'FEC_Disable','value':function(_0x464c25,_0x5a54a4,_0x171e58){if(_0x464c25<0x1||_0x464c25>0x1f||null==_0x464c25)return console['info']('%c\\x20FEC_Disable-1\\x20nSubPort:%d','color:\\x20red',_0x464c25),this['FECErrorCode']=_0x1f9ba7,0x0;if(0x1==this['stFishEyeManager'][_0x464c25]['bInited']&&null!=this['stFishEyeManager'][_0x464c25]['pRender']){if(_0x1ad956['ERRCODE']['SR_OK']!=this['stFishEyeManager'][_0x464c25]['pRender']['SR_DelSubPort'](this['stFishEyeManager'][_0x464c25]['nValidSubPort']))return console['info']('%c\\x20FEC_Disable-2\\x20SR_DelSubPort\\x20error\\x20nSubPort:%d','color:\\x20red',_0x464c25),0x0;this['stFishEyeManager'][_0x464c25]['bInited']=0x0,this['stFishEyeManager'][_0x464c25]['nValidSubPort']=-0x1,this['stFishEyeManager'][_0x464c25]['pRender']['SR_Destroy'](),this['stFishEyeManager'][_0x464c25]['pRender']=null;}return 0x1;}},{'key':'FEC_DelPort','value':function(_0x2ae8ab){return _0x2ae8ab<0x1||_0x2ae8ab>0x1f||null==_0x2ae8ab?(console['info']('%c\\x20FEC_DelPort-1\\x20nSubPort:%d','color:\\x20red',_0x2ae8ab),this['FECErrorCode']=_0x1f9ba7,0x0):0x0==this['stFishEyeManager'][_0x2ae8ab]['bUsed']?(console['info']('%c\\x20FEC_DelPort-2\\x20nSubPort:%d\\x20bUsed：%d','color:\\x20red',_0x2ae8ab,this['stFishEyeManager'][_0x2ae8ab]['bUsed']),this['FECErrorCode']=_0x32049a,0x0):(this['stFishEyeManager'][_0x2ae8ab]['nSubPort']=0x0,this['stFishEyeManager'][_0x2ae8ab]['sCanvasID']=null,this['stFishEyeManager'][_0x2ae8ab]['bUsed']=0x0,this['stFishEyeManager'][_0x2ae8ab]['bInited']=0x0,this['stFishEyeManager'][_0x2ae8ab]['nValidSubPort']=0x0,this['stFishEyeManager'][_0x2ae8ab]['emPlaceType']=_0x51aa1d,this['stFishEyeManager'][_0x2ae8ab]['emCorrectType']=_0x46d36d,this['stFishEyeManager'][_0x2ae8ab]['emEffect']=_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_ORIGINAL'],this['stFishParam'][_0x2ae8ab]['stCycleParam']['fRadiusLeft']=0x0,this['stFishParam'][_0x2ae8ab]['stCycleParam']['fRadiusRight']=0x1,this['stFishParam'][_0x2ae8ab]['stCycleParam']['fRadiusTop']=0x0,this['stFishParam'][_0x2ae8ab]['stCycleParam']['fRadiusBottom']=0x1,this['subPortNum']>0x0&&this['subPortNum']--,0x1);}},{'key':'FEC_SetParam','value':function(_0x6d2ecd,_0x3f1615){if(this['FECErrorCode']=0x0,_0x6d2ecd<0x0||_0x6d2ecd>0x1f||null==_0x6d2ecd)return console['info']('%c\\x20FEC_SetParam-1\\x20nSubPort:%d','color:\\x20red',_0x6d2ecd),this['FECErrorCode']=_0x1f9ba7,0x0;if(null==this['stFishEyeManager'][_0x6d2ecd]['pRender'])return console['info']('%c\\x20FEC_SetParam-2\\x20nSubPort:%d\\x20pRender:%d','color:\\x20red',_0x6d2ecd,this['stFishEyeManager'][_0x6d2ecd]['pRender']),this['FECErrorCode']=_0xd86f77,0x0;if(0x0==this['stFishEyeManager'][_0x6d2ecd]['bUsed'])return console['info']('%c\\x20FEC_SetParam-3\\x20nSubPort:%d\\x20bUsed:%d','color:\\x20red',_0x6d2ecd,this['stFishEyeManager'][_0x6d2ecd]['bUsed']),this['FECErrorCode']=_0x32049a,0x0;if(this['stFishEyeManager'][_0x6d2ecd]['emCorrectType']>=_0x13d414&&this['stFishEyeManager'][_0x6d2ecd]['emCorrectType']<=_0x4401a6&&0x1e&_0x3f1615['upDateType'])return console['info']('%c\\x20FEC_SetParam-4\\x20nSubPort:%d\\x20not\\x203D','color:\\x20red',_0x6d2ecd),this['FECErrorCode']=_0x53fb4d,0x0;if(_0x5782f0&_0x3f1615['upDateType']){if(null==_0x3f1615['stCycleParam'])return this['FECErrorCode']=_0x489408,0x0;for(var _0x136df3=0x1;_0x136df3<_0x573f02;_0x136df3++){if(this['stFishEyeManager'][_0x136df3]['bUsed']&&this['stFishEyeManager'][_0x136df3]['nSubPort']&&_0x867a32==this['stFishEyeManager'][_0x136df3]['emCorrectType']&&(_0x3f1615['stCycleParam']['fRadiusLeft']<=-0.5||_0x3f1615['stCycleParam']['fRadiusLeft']>=0.4||_0x3f1615['stCycleParam']['fRadiusRight']<=0.6||_0x3f1615['stCycleParam']['fRadiusRight']>=1.5||_0x3f1615['stCycleParam']['fRadiusTop']<=-0.5||_0x3f1615['stCycleParam']['fRadiusTop']>0x0||_0x3f1615['stCycleParam']['fRadiusBottom']<0x1||_0x3f1615['stCycleParam']['fRadiusBottom']>=1.5||_0x3f1615['stCycleParam']['fRadiusLeft']+_0x3f1615['stCycleParam']['fRadiusRight']<=0.8||_0x3f1615['stCycleParam']['fRadiusLeft']+_0x3f1615['stCycleParam']['fRadiusRight']>=1.2||_0x3f1615['stCycleParam']['fRadiusTop']+_0x3f1615['stCycleParam']['fRadiusBottom']<=0.8||_0x3f1615['stCycleParam']['fRadiusTop']+_0x3f1615['stCycleParam']['fRadiusBottom']>=1.2))return this['FECErrorCode']=_0x489408,0x0;if(this['stFishEyeManager'][_0x136df3]['bUsed']&&this['stFishEyeManager'][_0x136df3]['nSubPort']&&_0x4401a6==this['stFishEyeManager'][_0x136df3]['emCorrectType']&&(_0x3f1615['stCycleParam']['fRadiusLeft']<=-0.5||_0x3f1615['stCycleParam']['fRadiusLeft']>0x0||_0x3f1615['stCycleParam']['fRadiusRight']<0x1||_0x3f1615['stCycleParam']['fRadiusRight']>=1.5||_0x3f1615['stCycleParam']['fRadiusTop']<=-0.5||_0x3f1615['stCycleParam']['fRadiusTop']>=0.4||_0x3f1615['stCycleParam']['fRadiusBottom']<=0.6||_0x3f1615['stCycleParam']['fRadiusBottom']>=1.5||_0x3f1615['stCycleParam']['fRadiusLeft']+_0x3f1615['stCycleParam']['fRadiusRight']<=0.8||_0x3f1615['stCycleParam']['fRadiusLeft']+_0x3f1615['stCycleParam']['fRadiusRight']>=1.2||_0x3f1615['stCycleParam']['fRadiusTop']+_0x3f1615['stCycleParam']['fRadiusBottom']<=0.8||_0x3f1615['stCycleParam']['fRadiusTop']+_0x3f1615['stCycleParam']['fRadiusBottom']>=1.2))return this['FECErrorCode']=_0x489408,0x0;}}if(0x0==this['stFishEyeManager'][_0x6d2ecd]['bInited']){if(_0xd7ec59&_0x3f1615['upDateType']){if(_0x5195df!=this['stFishEyeManager'][_0x6d2ecd]['emCorrectType']&&_0x5c6ecb!=this['stFishEyeManager'][_0x6d2ecd]['emCorrectType']||_0x527ccc==this['stFishEyeManager'][_0x6d2ecd]['emPlaceType'])return this['FECErrorCode']=_0x53fb4d,0x0;for(var _0x46d964=0x1;_0x46d964<_0x573f02;_0x46d964++)if(this['stFishEyeManager'][_0x46d964]['nSubPort']&&this['stFishEyeManager'][_0x46d964]['bUsed']&&this['stFishEyeManager'][_0x46d964]['emCorrectType']==_0x1053ee)return this['FECErrorCode']=_0x115f84,0x0;this['stFishParam'][_0x6d2ecd]['fWideScanOffset']=_0x3f1615['fValue'];}if(_0x109884&_0x3f1615['upDateType']){if(null==_0x3f1615['stPTZColor'])return this['FECErrorCode']=_0x489408,0x0;if(_0x3f1615['stPTZColor']['nR']>0xff||_0x3f1615['stPTZColor']['nG']>0xff||_0x3f1615['stPTZColor']['nB']>0xff||_0x3f1615['stPTZColor']['nAlpha']>0xff)return this['FECErrorCode']=_0x53fb4d,0x0;this['stFishParam'][_0x6d2ecd]['stPTZColor']['nR']=_0x3f1615['stPTZColor']['nR'],this['stFishParam'][_0x6d2ecd]['stPTZColor']['nG']=_0x3f1615['stPTZColor']['nG'],this['stFishParam'][_0x6d2ecd]['stPTZColor']['nB']=_0x3f1615['stPTZColor']['nB'],this['stFishParam'][_0x6d2ecd]['stPTZColor']['nAlpha']=_0x3f1615['stPTZColor']['nAlpha'];}if(_0x12d349&_0x3f1615['upDateType']){if(_0x1053ee!=this['stFishEyeManager'][_0x6d2ecd]['emCorrectType'])return this['FECErrorCode']=_0x53fb4d,0x0;this['stFishParam'][_0x6d2ecd]['stPTZParam']['fPTZPositionX']=_0x3f1615['fPTZParam']['fPTZPositionX'],this['stFishParam'][_0x6d2ecd]['stPTZParam']['fPTZPositionY']=_0x3f1615['fPTZParam']['fPTZPositionY'];}if(_0x207e41&_0x3f1615['upDateType']){if(_0x1053ee!=this['stFishEyeManager'][_0x6d2ecd]['emCorrectType'])return this['FECErrorCode']=_0x53fb4d,0x0;this['stFishParam'][_0x6d2ecd]['fZoom']=_0x3f1615['fPTZZoom'];}if(_0x13bc33&_0x3f1615['upDateType']){if(null==this['stFishParam']['stPTZSelect'])return 0x0;if(_0x1053ee!=this['stFishEyeManager'][_0x6d2ecd]['emCorrectType'])return this['FECErrorCode']=_0x53fb4d,0x0;this['stFishParam']['stPTZSelect']['fTop']=_0x3f1615['stPTZSelect']['fTop'],this['stFishParam']['stPTZSelect']['fBottom']=_0x3f1615['stPTZSelect']['fBottom'],this['stFishParam']['stPTZSelect']['fLeft']=_0x3f1615['stPTZSelect']['fLeft'],this['stFishParam']['stPTZSelect']['fRight']=_0x3f1615['stPTZSelect']['fRight'];}if(_0x5782f0&_0x3f1615['upDateType']){if(null==_0x3f1615['stCycleParam'])return this['FECErrorCode']=_0x489408,0x0;if(0x0==this['_IsValidRadiusParam'](_0x3f1615['stCycleParam']))return this['FECErrorCode']=_0x489408,0x0;this['stFishParam'][0x0]['stCycleParam']['fRadiusLeft']=_0x3f1615['stCycleParam']['fRadiusLeft'],this['stFishParam'][0x0]['stCycleParam']['fRadiusRight']=_0x3f1615['stCycleParam']['fRadiusRight'],this['stFishParam'][0x0]['stCycleParam']['fRadiusTop']=_0x3f1615['stCycleParam']['fRadiusTop'],this['stFishParam'][0x0]['stCycleParam']['fRadiusBottom']=_0x3f1615['stCycleParam']['fRadiusBottom'];}return 0x1;}if(_0xd7ec59&_0x3f1615['upDateType']){if(_0x5195df!=this['stFishEyeManager'][_0x6d2ecd]['emCorrectType']&&_0x5c6ecb!=this['stFishEyeManager'][_0x6d2ecd]['emCorrectType']||_0x527ccc==this['stFishEyeManager'][_0x6d2ecd]['emPlaceType'])return this['FECErrorCode']=_0x53fb4d,0x0;for(var _0x3124b6=0x1;_0x3124b6<_0x573f02;_0x3124b6++)if(this['stFishEyeManager'][_0x3124b6]['nSubPort']&&this['stFishEyeManager'][_0x3124b6]['bUsed']&&this['stFishEyeManager'][_0x3124b6]['emCorrectType']==_0x1053ee)return this['FECErrorCode']=_0x115f84,0x0;var _0x2b0990={};if(_0x2b0990['nFishParamType']=_0x1ad956['SRFISHPARAMTYPE']['SR_FPT_ANGLE'],_0x2b0990['bBlack']=0x0,_0x2b0990['fAngle']=_0x3f1615['fValue'],_0x1ad956['ERRCODE']['SR_OK']!=this['stFishEyeManager'][_0x6d2ecd]['pRender']['SR_SetFishParam'](_0x2b0990))return this['FECErrorCode']=_0x115f84,0x0;this['stFishParam'][_0x6d2ecd]['fWideScanOffset']=_0x3f1615['fValue'];}if(_0x109884&_0x3f1615['upDateType']){if(null==_0x3f1615['stPTZColor'])return this['FECErrorCode']=_0x53fb4d,0x0;if(_0x3f1615['stPTZColor']['nR']>0xff||_0x3f1615['stPTZColor']['nG']>0xff||_0x3f1615['stPTZColor']['nB']>0xff||_0x3f1615['stPTZColor']['nAlpha']>0xff)return this['FECErrorCode']=_0x53fb4d,0x0;var _0x332f9b={};if(_0x332f9b['fR']=_0x3f1615['stPTZColor']['nR']/0xff,_0x332f9b['fG']=_0x3f1615['stPTZColor']['nG']/0xff,_0x332f9b['fB']=_0x3f1615['stPTZColor']['nB']/0xff,_0x332f9b['fA']=_0x3f1615['stPTZColor']['nAlpha']/0xff,_0x1ad956['ERRCODE']['SR_OK']!=this['stFishEyeManager'][_0x6d2ecd]['pRender']['SR_SetPTZColor'](_0x6d2ecd,_0x332f9b))return this['FECErrorCode']=_0x115f84,_0x115f84;this['stFishParam'][_0x6d2ecd]['stPTZColor']['nR']=_0x3f1615['stPTZColor']['nR'],this['stFishParam'][_0x6d2ecd]['stPTZColor']['nG']=_0x3f1615['stPTZColor']['nG'],this['stFishParam'][_0x6d2ecd]['stPTZColor']['nB']=_0x3f1615['stPTZColor']['nB'],this['stFishParam'][_0x6d2ecd]['stPTZColor']['nAlpha']=_0x3f1615['stPTZColor']['nAlpha'];}if(_0x12d349&_0x3f1615['upDateType']){if(_0x1053ee!=this['stFishEyeManager'][_0x6d2ecd]['emCorrectType'])return this['FECErrorCode']=_0x53fb4d,0x0;var _0x269651={};_0x269651['nFishParamType']=_0x1ad956['SRFISHPARAMTYPE']['SR_FPT_PTZ'],_0x269651['bBlack']=0x0,_0x269651['fPTZX']=_0x3f1615['fPTZParam']['fPTZPositionX'],_0x269651['fPTZY']=_0x3f1615['fPTZParam']['fPTZPositionY'];var _0x29ac74=this['stFishEyeManager'][_0x6d2ecd]['pRender']['SR_SetFishParam'](_0x269651);if(_0x1ad956['ERRCODE']['SR_OK']!=_0x29ac74)return this['FECErrorCode']=_0x115f84,0x0;this['stFishParam'][_0x6d2ecd]['stPTZParam']['fPTZPositionX']=_0x3f1615['fPTZParam']['fPTZPositionX'],this['stFishParam'][_0x6d2ecd]['stPTZParam']['fPTZPositionY']=_0x3f1615['fPTZParam']['fPTZPositionY'];}if(_0x207e41&_0x3f1615['upDateType']){if(_0x1053ee!=this['stFishEyeManager'][_0x6d2ecd]['emCorrectType'])return this['FECErrorCode']=_0x53fb4d,0x0;var _0x2a7662={};if(_0x2a7662['nFishParamType']=_0x1ad956['SRFISHPARAMTYPE']['SR_FPT_ZOOM'],_0x2a7662['bBlack']=0x0,_0x2a7662['fZoom']=_0x3f1615['fPTZZoom'],_0x1ad956['ERRCODE']['SR_OK']!=this['stFishEyeManager'][_0x6d2ecd]['pRender']['SR_SetFishParam'](_0x2a7662))return this['FECErrorCode']=_0x115f84,0x0;this['stFishParam'][_0x6d2ecd]['fZoom']=_0x3f1615['fPTZZoom'];}if(_0x5782f0&_0x3f1615['upDateType']){if(0x0==this['_IsValidRadiusParam'](_0x3f1615['stCycleParam']))return this['FECErrorCode']=_0x489408,0x0;var _0x5f30e4={};if(_0x5f30e4['nFishParamType']=_0x1ad956['SRFISHPARAMTYPE']['SR_FPT_CENTER'],_0x5f30e4['bBlack']=0x1,_0x5f30e4['fRXLeft']=_0x3f1615['stCycleParam']['fRadiusLeft'],_0x5f30e4['fRXRight']=_0x3f1615['stCycleParam']['fRadiusRight'],_0x5f30e4['fRYTop']=_0x3f1615['stCycleParam']['fRadiusTop'],_0x5f30e4['fRYBottom']=_0x3f1615['stCycleParam']['fRadiusBottom'],_0x1ad956['ERRCODE']['SR_OK']!=this['stFishEyeManager'][_0x6d2ecd]['pRender']['SR_SetFishParam'](this['stFishEyeManager'][_0x6d2ecd]['nValidSubPort'],_0x5f30e4))return this['FECErrorCode']=_0x489408,0x0;this['stFishParam'][0x0]['stCycleParam']['fRadiusLeft']=_0x3f1615['stCycleParam']['fRadiusLeft'],this['stFishParam'][0x0]['stCycleParam']['fRadiusRight']=_0x3f1615['stCycleParam']['fRadiusRight'],this['stFishParam'][0x0]['stCycleParam']['fRadiusTop']=_0x3f1615['stCycleParam']['fRadiusTop'],this['stFishParam'][0x0]['stCycleParam']['fRadiusBottom']=_0x3f1615['stCycleParam']['fRadiusBottom'];}return _0x13bc33&_0x3f1615['upDateType']&&_0x1053ee==this['stFishEyeManager'][_0x6d2ecd]['emCorrectType']&&_0x1ad956['ERRCODE']['SR_OK']!=this['stFishEyeManager'][_0x6d2ecd]['pRender']['SR_SetFishParam'](this['stFishEyeManager'][_0x6d2ecd]['stPTZSelect'])?(this['FECErrorCode']=0x513,0x0):(null!=this['pstWaterFontParam']&&this['pstWaterFontParam']['nColorAdapt']&&(this['pstWaterFontParamArray'][_0x6d2ecd]['splice'](_0x6d2ecd,this['pstWaterFontParamArray'][_0x6d2ecd]['length']),this['CalculateWaterMarkParam'](this['stFishEyeManager'][_0x6d2ecd]['pRender'],_0x6d2ecd,this['pstWaterFontParam'])),0x1);}},{'key':'FEC_GetParam','value':function(_0x513c1f,_0x12116e){return _0x513c1f<0x0||_0x513c1f>0x1f||null==_0x513c1f?(console['info']('%c\\x20FEC_GetParam-1\\x20nSubPort:%d','color:\\x20red',_0x513c1f),this['FECErrorCode']=_0x1f9ba7,0x0):null==this['stFishEyeManager'][_0x513c1f]['pRender']?(console['info']('%c\\x20FEC_GetParam-2\\x20pRender:%d','color:\\x20red',this['stFishEyeManager'][_0x513c1f]['pRender']),this['FECErrorCode']=_0xd86f77,0x0):(this['stFishEyeManager'][_0x513c1f]['pRender']['SR_GetFishParam'](_0x12116e),_0x12116e['emCorrectType']=this['stFishEyeManager'][_0x513c1f]['emCorrectType'],0x1);}},{'key':'_IsValidRadiusParam','value':function(_0x406859){return _0x406859['fRadiusBottom']<=_0x406859['fRadiusTop']||_0x406859['fRadiusRight']<=_0x406859['fRadiusLeft']?0x0:0x1;}},{'key':'FEC_SetViewParam','value':function(_0x2ff0b6,_0x3b8141,_0x1cebcd){return _0x2ff0b6<0x0||_0x2ff0b6>0x1f||null==_0x2ff0b6?(console['info']('%c\\x20FEC_SetViewParam-1\\x20nSubPort:%d','color:\\x20red',_0x2ff0b6),this['FECErrorCode']=_0x1f9ba7,0x0):null==this['stFishEyeManager'][_0x2ff0b6]['pRender']?(console['info']('%c\\x20FEC_SetViewParam-2\\x20pRender:%d','color:\\x20red',this['stFishEyeManager'][_0x2ff0b6]['pRender']),this['FECErrorCode']=_0xd86f77,0x0):_0x3b8141<_0x1ad956['SRVIEWTYPE']['SR_VT_ROTATION_X']||_0x3b8141>_0x1ad956['SRVIEWTYPE']['SR_VT_SCALE']?(this['FECErrorCode']=_0x5e80ef,0x0):(this['FECErrorCode']=0x0,0x0==this['stFishEyeManager'][_0x2ff0b6]['bInited']?(this['FECErrorCode']=_0x32049a,0x0):_0x13d414<=this['stFishEyeManager'][_0x2ff0b6]['emCorrectType']?_0x1ad956['ERRCODE']['SR_OK']!=this['stFishEyeManager'][_0x2ff0b6]['pRender']['SR_SetViewParam'](_0x3b8141,_0x1cebcd)?(this['FECErrorCode']=_0x5e80ef,0x0):(null!=this['pstWaterFontParam']&&this['pstWaterFontParam']['nColorAdapt']&&(this['pstWaterFontParamArray'][_0x2ff0b6]['splice'](0x0,this['pstWaterFontParamArray'][_0x2ff0b6]['length']),this['CalculateWaterMarkParam'](this['stFishEyeManager'][_0x2ff0b6]['pRender'],_0x2ff0b6,this['pstWaterFontParam'])),0x1):(this['FECErrorCode']=_0x53fb4d,0x0));}},{'key':'FEC_GetViewParam','value':function(_0x5907e3,_0x42ec41,_0x2b3138){if(_0x2b3138['fValue']=-0x1,_0x5907e3<0x0||_0x5907e3>0x1f||null==_0x5907e3)return console['info']('%c\\x20FEC_GetViewParam-1\\x20nSubPort:%d','color:\\x20red',_0x5907e3),this['FECErrorCode']=_0x1f9ba7,0x0;if(null==this['stFishEyeManager'][_0x5907e3]['pRender'])return console['info']('%c\\x20FEC_GetViewParam-2\\x20pRender:%d','color:\\x20red',this['stFishEyeManager'][_0x5907e3]['pRender']),this['FECErrorCode']=_0xd86f77,0x0;if(_0x42ec41<0x1||_0x42ec41>0x3||0x0==this['stFishEyeManager'][_0x5907e3]['bInited'])return 0x0;if(_0x13d414<=this['stFishEyeManager'][_0x5907e3]['emCorrectType'])this['stFishEyeManager'][_0x5907e3]['pRender']['SR_GetViewParam'](_0x42ec41,_0x2b3138);return 0x1;}},{'key':'FEC_SetDisplayRegion','value':function(_0x56d298,_0xb6d38c,_0x5034ed,_0x1ee7e8,_0x400273,_0x41b75b,_0x453435){return _0x56d298<0x0||_0x56d298>0x1f||null==_0x56d298?(console['info']('%c\\x20FEC_SetDisplayRegion-1\\x20nSubPort:%d','color:\\x20red',_0x56d298),this['FECErrorCode']=_0x1f9ba7,0x0):null==this['stFishEyeManager'][_0x56d298]['pRender']?(console['info']('%c\\x20FEC_SetDisplayRegion-2\\x20pRender:%d','color:\\x20red',this['stFishEyeManager'][_0x56d298]['pRender']),this['FECErrorCode']=_0xd86f77,0x0):0x0!=_0xb6d38c||0x0!=_0x5034ed?(this['FECErrorCode']=_0x5e80ef,0x0):this['stFishEyeManager'][_0x56d298]['emCorrectType']!=_0x46d36d&&this['stFishEyeManager'][_0x56d298]['emCorrectType']!=_0x5195df&&this['stFishEyeManager'][_0x56d298]['emCorrectType']!=_0x5c6ecb&&this['stFishEyeManager'][_0x56d298]['emCorrectType']!=_0x100fbf?(this['FECErrorCode']=_0xf71e92,0x0):0x0==this['stFishEyeManager'][_0x56d298]['bInited']?(this['FECErrorCode']=_0x32049a,0x0):_0x1ee7e8<0x0||_0x400273<0x0||_0x41b75b<0x0||_0x453435<0x0?(this['FECErrorCode']=_0x5e80ef,0x0):_0x1ad956['ERRCODE']['SR_OK']!=this['stFishEyeManager'][_0x56d298]['pRender']['SR_SetDisplayRect'](_0x1ee7e8,_0x400273,_0x41b75b,_0x453435,_0x1ad956['SRSETRECTTYPE']['SR_SRT_SRC'])?(this['FECErrorCode']=0x511,0x0):(null!=this['pstWaterFontParam']&&this['pstWaterFontParam']['nColorAdapt']&&(this['pstWaterFontParamArray'][_0x56d298]['splice'](0x0,this['pstWaterFontParamArray'][_0x56d298]['length']),this['CalculateWaterMarkParam'](this['stFishEyeManager'][_0x56d298]['pRender'],_0x56d298,this['pstWaterFontParam'])),0x1);}},{'key':'FEC_SetBackCilling','value':function(_0xbea67c,_0x1f2a49){return _0xbea67c<0x0||_0xbea67c>0x1f||null==_0xbea67c?(this['FECErrorCode']=_0x1f9ba7,0x0):null==this['stFishEyeManager'][_0xbea67c]['pRender']?(this['FECErrorCode']=_0xd86f77,0x0):0x0==this['stFishEyeManager'][_0xbea67c]['bInited']?(this['FECErrorCode']=_0x32049a,0x0):_0x1ad956['ERRCODE']['SR_OK']!=this['stFishEyeManager'][_0xbea67c]['pRender']['SR_SetRenderState'](_0x1ad956['SRRENDERSTATETYPE']['SR_RST_BACK_CULL'],_0x1f2a49)?(this['FECErrorCode']=0x511,0x0):(null!=this['pstWaterFontParam']&&this['pstWaterFontParam']['nColorAdapt']&&(this['pstWaterFontParamArray'][_0xbea67c]['splice'](0x0,this['pstWaterFontParamArray'][_0xbea67c]['length']),this['CalculateWaterMarkParam'](this['stFishEyeManager'][_0xbea67c]['pRender'],_0xbea67c,this['pstWaterFontParam'])),0x1);}},{'key':'FEC_GetPTZPort','value':function(_0x34e8cf,_0x3dd75c,_0x3ba751){if(null!=this['stFishEyeManager'][_0x34e8cf]['pRender']){var _0xba376f={'nPTZPort':-0x1};if(this['stFishEyeManager'][_0x34e8cf]['pRender']['SR_GetPTZPort'](_0x3dd75c,_0x3ba751,_0xba376f)==_0x1ad956['ERRCODE']['SR_OK'])return _0xba376f['nPTZPort'];}return-0x1;}},{'key':'FEC_SetPTZDisplayMode','value':function(_0x15a62d){return _0x15a62d>=0x0&&_0x15a62d<=0x2?(null!=this['stFishEyeManager'][0x0]['pRender']&&this['stFishEyeManager'][0x0]['pRender']['SR_SetPTZDisplayMode'](_0x15a62d),this['FECShowMode']=_0x15a62d,0x1):(console['info']('%c\\x20FEC_SetPTZDisplayMode\\x20ptzMode:%d','color:\\x20red',_0x15a62d),0x0);}},{'key':'FEC_Capture','value':function(_0x4d3682,_0xc56c9b){if(null!=this['stFishEyeManager'][_0x4d3682]['pRender']){var _0x59843d={'nWidth':0x0,'nHeight':0x0,'nBufferLen':0x0},_0x7a0032=this['stFishEyeManager'][_0x4d3682]['pRender']['SR_GetCaptureSize'](_0x59843d);if(_0x1ad956['ERRCODE']['SR_OK']!=_0x7a0032||_0x59843d['nBufferLen']<=0x0)return _0xc56c9b(null,0x0,0x0,_0x4d3682),0x0;var _0x46710a=new Uint8Array(_0x59843d['nBufferLen']);if(null==_0x46710a)return _0xc56c9b(null,0x0,0x0,_0x4d3682),0x0;var _0x11cf0f={};return _0x11cf0f['pBuffer']=_0x46710a,this['stFishEyeManager'][_0x4d3682]['pRender']['SR_CaptureScreen'](_0x11cf0f),_0xc56c9b(_0x46710a,_0x59843d['nWidth'],_0x59843d['nHeight'],_0x4d3682),_0x46710a=null,0x1;}return _0xc56c9b(null,0x0,0x0,_0x4d3682),0x0;}},{'key':'CheckFrameRGB','value':function(_0x358bd0,_0x23c4a6,_0x2f9b44,_0x580525,_0x29ea60,_0x316fd8){if(null==_0x358bd0||null==_0x358bd0['width']||null==_0x358bd0['height']||null==_0x358bd0['pBuffer']||_0x358bd0['width']<=0x0||_0x358bd0['height']<=0x0||_0x358bd0['pBuffer']['length']<=0x0)return 0x0;for(var _0x1ac5b4=_0x358bd0['width']/(_0x580525-0x1),_0x25a4c9=_0x358bd0['height']/(_0x2f9b44-0x1),_0x26b97e=0x0,_0x6fdcfc=0x0,_0x44b8b3=[],_0x3a9df9=0x0;_0x3a9df9<_0x2f9b44*_0x580525;_0x3a9df9++)_0x44b8b3[_0x3a9df9]=0x0,this['aPOSAdaptBuf'][_0x3a9df9]=0x0;if(_0x23c4a6){for(var _0x29b51e=0x0,_0x2eef78=0x0;_0x2eef78<_0x358bd0['height'];_0x2eef78++)for(var _0x24adab=0x0;_0x24adab<_0x358bd0['width'];_0x24adab++){_0x26b97e=(_0x26b97e=Math['round'](_0x24adab/(_0x1ac5b4/0x2)/0x2))<_0x580525?_0x26b97e:_0x580525-0x1,_0x6fdcfc=(_0x6fdcfc=Math['round'](_0x2eef78/(_0x25a4c9/0x2)/0x2))<_0x2f9b44?_0x6fdcfc:_0x2f9b44-0x1;var _0x2260b0=_0x358bd0['pBuffer'][_0x29b51e],_0x5b05a8=_0x358bd0['pBuffer'][_0x29b51e+0x1],_0xd58174=_0x358bd0['pBuffer'][_0x29b51e+0x2],_0x2de949=Math['round'](0.299*_0x2260b0+0.587*_0x5b05a8+0.114*_0xd58174);this['aPOSAdaptBuf'][_0x26b97e+_0x6fdcfc*_0x580525]+=_0x2de949,_0x44b8b3[_0x26b97e+_0x6fdcfc*_0x580525]++,_0x29b51e+=0x4;}for(var _0x3ac4ed=0x0,_0x32ceb6=0x0;_0x32ceb6<_0x2f9b44*_0x580525;_0x32ceb6++)_0x3ac4ed=this['aPOSAdaptBuf'][_0x32ceb6]/_0x44b8b3[_0x32ceb6],this['aPOSAdaptBuf'][_0x32ceb6]=_0x3ac4ed>0x80?0x0:0x1;}else{var _0x105fed=Math['round'](_0x29ea60*_0x358bd0['width']),_0xf1c8b2=Math['round'](_0x316fd8*_0x358bd0['height']),_0x80845d=_0x105fed-0x2;_0x80845d=(_0x80845d=_0x80845d>0x0?_0x80845d:0x0)<_0x358bd0['width']?_0x80845d:_0x358bd0['width']-0x1;var _0x395adf=_0x105fed+0x2;_0x395adf=(_0x395adf=_0x395adf>0x0?_0x395adf:0x0)<_0x358bd0['width']?_0x395adf:_0x358bd0['width']-0x1;var _0x1c6d41=_0xf1c8b2-0x2;_0x1c6d41=(_0x1c6d41=_0x1c6d41>0x0?_0x1c6d41:0x0)<_0x358bd0['height']?_0x1c6d41:_0x358bd0['height']-0x1;var _0x2a9797=_0xf1c8b2+0x2;_0x2a9797=(_0x2a9797=_0x2a9797>0x0?_0x2a9797:0x0)<_0x358bd0['height']?_0x2a9797:_0x358bd0['height']-0x1;for(var _0x51fa05=_0x1c6d41;_0x51fa05<_0x2a9797;_0x51fa05++)for(var _0x5c3007=_0x80845d;_0x5c3007<_0x395adf;_0x5c3007++){var _0xc139a3=0x4*Math['floor']((0x4*_0x5c3007+_0x51fa05*_0x358bd0['width']*0x4)/0x4),_0x9ee436=_0x358bd0['pBuffer'][_0xc139a3],_0x2a8dab=_0x358bd0['pBuffer'][_0xc139a3+0x1],_0x30af89=_0x358bd0['pBuffer'][_0xc139a3+0x2],_0x226c53=Math['round'](0.299*_0x9ee436+0.587*_0x2a8dab+0.114*_0x30af89);this['aPOSAdaptBuf'][0x0]+=_0x226c53,_0x44b8b3[0x0]++;}this['aPOSAdaptBuf'][0x0]=this['aPOSAdaptBuf'][0x0]/_0x44b8b3[0x0]>0x80?0x0:0x1;}return 0x1;}},{'key':'GetWaterFontParam','value':function(_0x1fe68b,_0x5e48e9,_0x3ef07e,_0x489f51,_0x10956e,_0x16cd74,_0x260630){var _0x766b00=_0x3ef07e['pFontString']['length'],_0x51428d=_0x3ef07e['pstFontRotate']['fRotateAngle']%0x168/0x168*0x2*Math['PI'],_0x3fea95=Math['min'](_0x3ef07e['pstFontSize']['nFontWidth'],_0x3ef07e['pstFontSize']['nFontHeight']);if(0x2==_0x3ef07e['pstCanvasAdapt']['nCanvasAdaptMode']){var _0x18fe5f=_0x3ef07e['pstFontSize']['nFontWidth']*_0x489f51/_0x3ef07e['pstCanvasAdapt']['nBaseCanvasWidth'],_0xfb69ee=_0x3ef07e['pstFontSize']['nFontHeight']*_0x10956e/_0x3ef07e['pstCanvasAdapt']['nBaseCanvasHeight'];_0x3fea95=Math['min'](_0x18fe5f,_0xfb69ee);}var _0xc01911=_0x3fea95/_0x489f51,_0x833037=_0x3fea95/_0x10956e,_0x2dfdf5=_0xc01911*Math['cos'](Math['PI']/0x2-_0x51428d)*_0x3ef07e['pSpace'],_0x4e61a9=_0x833037*Math['sin'](Math['PI']/0x2-_0x51428d)*_0x3ef07e['pSpace'],_0x411fef=[],_0x4168d4=[],_0x2a3602=[];if(_0x3ef07e['nFontAlign']){for(var _0x533a50=0x0;_0x533a50<_0x766b00;_0x533a50++)_0x411fef[_0x533a50]=_0x3ef07e['pFontString'][0x0]['length']*_0xc01911/0x6,_0x4168d4[_0x533a50]=Math['atan2'](_0x411fef[0x0],_0x4e61a9),_0x2a3602[_0x533a50]=Math['sqrt'](_0x411fef[0x0]*_0x411fef[0x0],_0x4e61a9*_0x4e61a9);}else{for(var _0x5989f0=0x0;_0x5989f0<_0x766b00;_0x5989f0++)_0x411fef[_0x5989f0]=0x0,_0x4168d4[_0x5989f0]=0x0,_0x2a3602[_0x5989f0]=0x0;}var _0x495db4={};if(this['pstWaterFontParam']['nColorAdapt']){var _0x2a60c0={'nWidth':0x10,'nHeight':0x10,'nBufferLen':0x0},_0x5b3bdd=_0x1fe68b['SR_GetCaptureSize'](_0x2a60c0);if(_0x1ad956['ERRCODE']['SR_OK']==_0x5b3bdd){var _0x2302c1=new Uint8Array(_0x2a60c0['nBufferLen']);_0x495db4['pBuffer']=_0x2302c1,_0x1fe68b['SR_CaptureScreen'](_0x495db4,!0x0),_0x495db4['width']=_0x2a60c0['nWidth'],_0x495db4['height']=_0x2a60c0['nHeight'],_0x2302c1=null;}}var _0x4be447=_0x16cd74*_0x260630;if(_0x3ef07e['pstFontRotate']['fFillFullScreen']){var _0x5f2ebb=[],_0x2fa4da=[];if(0x1==_0x3ef07e['pstCanvasAdapt']['nCanvasAdaptMode']){if(_0x260630<_0x5b17bf){for(var _0x1bf653=0x0;_0x1bf653*_0x3ef07e['pstCanvasAdapt']['ntotalColSpace']<=_0x489f51;_0x1bf653++)_0x2fa4da[_0x1bf653]=(_0x1bf653*_0x3ef07e['pstCanvasAdapt']['ntotalColSpace']+_0x3ef07e['pstCanvasAdapt']['nColSpace']/0x2)/_0x489f51;}else{for(var _0x38ff09=0x1/(_0x260630-0x1),_0x3515a7=0x0;_0x3515a7<_0x260630;_0x3515a7++)_0x2fa4da[_0x3515a7]=_0x38ff09*_0x3515a7+_0x2dfdf5*((_0x766b00-0x1)/0x2);}if(_0x16cd74<_0x5b17bf){for(var _0x560f8a=0x0;_0x560f8a*_0x3ef07e['pstCanvasAdapt']['ntotalRowSpace']<=_0x10956e;_0x560f8a++)_0x5f2ebb[_0x560f8a]=(_0x560f8a*_0x3ef07e['pstCanvasAdapt']['ntotalRowSpace']+_0x3ef07e['pstCanvasAdapt']['nRowSpace']/0x2)/_0x10956e;}else{for(var _0x4f4e18=0x1/(_0x16cd74-0x1),_0x4be085=0x0;_0x4be085<_0x16cd74;_0x4be085++)_0x5f2ebb[_0x4be085]=_0x4f4e18*_0x4be085-_0x4e61a9*((_0x766b00-0x1)/0x2);}for(var _0x57e361=0x0;_0x57e361<_0x766b00;_0x57e361++)_0x411fef[_0x57e361]=0x0,_0x4168d4[_0x57e361]=0x0,_0x2a3602[_0x57e361]=0x0;}else{if(0x1==_0x16cd74)_0x5f2ebb[0x0]=0.5;else{for(var _0x3b21f8=0x1/(_0x16cd74-0x1),_0x220142=0x0;_0x220142<_0x16cd74;_0x220142++)_0x5f2ebb[_0x220142]=_0x3b21f8*_0x220142-_0x4e61a9*((_0x766b00-0x1)/0x2);}if(0x1==_0x260630)_0x2fa4da[0x0]=0.5;else{for(var _0xaadc3d=0x1/(_0x260630-0x1),_0x38e0e3=0x0;_0x38e0e3<_0x260630;_0x38e0e3++)_0x2fa4da[_0x38e0e3]=_0xaadc3d*_0x38e0e3+_0x2dfdf5*((_0x766b00-0x1)/0x2);}}this['pstWaterFontParamArray'][_0x5e48e9]=[];for(var _0x12938b=0x0;_0x12938b<_0x4be447;++_0x12938b)for(var _0xc15416=0x0;_0xc15416<_0x766b00;_0xc15416++){this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]={},this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['pString']=_0x3ef07e['pFontString'][_0xc15416],this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['nFontWidth']=_0x3fea95,this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['nFontHeight']=_0x3fea95,this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['pstStartPos']={};var _0x15d266=_0x12938b%_0x260630,_0x2993d1=Math['floor'](_0x12938b/_0x260630),_0x2d6d19=Math['PI']/0x2-_0x51428d+_0x4168d4[_0xc15416];this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['pstStartPos']['fX']=_0x2fa4da[_0x15d266]-_0xc15416*_0x2dfdf5+_0x2a3602[_0xc15416]*Math['cos'](_0x2d6d19),this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['pstStartPos']['fY']=_0x5f2ebb[_0x2993d1]+_0xc15416*_0x4e61a9-_0x2a3602[_0xc15416]*Math['sin'](_0x2d6d19),_0x3ef07e['nColorAdapt']?(0x0==_0xc15416&&this['CheckFrameRGB'](_0x495db4,0x0,0x1,0x1,this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['pstStartPos']['fX'],this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['pstStartPos']['fY']),this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['pstFontColor']={},this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['pstFontColor']['fR']=this['aPOSAdaptBuf'][0x0],this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['pstFontColor']['fG']=this['aPOSAdaptBuf'][0x0],this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['pstFontColor']['fB']=this['aPOSAdaptBuf'][0x0],this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['pstFontColor']['fA']=_0x3ef07e['pstFontColor']['fA']):this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['pstFontColor']=_0x3ef07e['pstFontColor'],this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['bBackGround']=!0x1,this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['pstBGColor']=null,this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['fRotateAngle']=_0x3ef07e['pstFontRotate']['fRotateAngle'],this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['pFontFamily']=_0x3ef07e['pFontFamily'],_0x3ef07e['nFontAlign']?(this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['textAlign']='left',this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['textBaseline']='top'):(this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['textAlign']='center',this['pstWaterFontParamArray'][_0x5e48e9][_0x766b00*_0x12938b+_0xc15416]['textBaseline']='middle');}}else{for(var _0x1587f3=0x0;_0x1587f3<_0x3ef07e['pFontString']['length'];_0x1587f3++)this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]={},this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['pString']=_0x3ef07e['pFontString'][_0x1587f3],this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['nFontWidth']=_0x3fea95,this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['nFontHeight']=_0x3fea95,this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['pstStartPos']={},this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['pstStartPos']['fX']=_0x3ef07e['pstStartPos']['fX']-_0x1587f3*_0x2dfdf5,this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['pstStartPos']['fY']=_0x3ef07e['pstStartPos']['fY']+_0x1587f3*_0x4e61a9,_0x3ef07e['nColorAdapt']?(this['CheckFrameRGB'](_0x495db4,0x0,0x1,0x1,this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['pstStartPos']['fX'],this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['pstStartPos']['fY']),this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['pstFontColor']={},this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['pstFontColor']['fR']=this['aPOSAdaptBuf'][0x0],this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['pstFontColor']['fG']=this['aPOSAdaptBuf'][0x0],this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['pstFontColor']['fB']=this['aPOSAdaptBuf'][0x0],this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['pstFontColor']['fA']=_0x3ef07e['pstFontColor']['fA']):this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['pstFontColor']=_0x3ef07e['pstFontColor'],this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['bBackGround']=!0x1,this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['pstBGColor']=null,this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['fRotateAngle']=_0x3ef07e['pstFontRotate']['fRotateAngle'],this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['pFontFamily']=_0x3ef07e['pFontFamily'],_0x3ef07e['nFontAlign']?(this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['textAlign']='left',this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['textBaseline']='top'):(this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['textAlign']='center',this['pstWaterFontParamArray'][_0x5e48e9][_0x1587f3]['textBaseline']='middle');}return 0x1;}},{'key':'CalculateWaterMarkParam','value':function(_0x48d0d9,_0x371532,_0x3672f9){var _0x4087e5=this['mainCanvasID']['width'],_0x5f4f71=this['mainCanvasID']['height'];_0x371532>0x0&&(_0x4087e5=this['stFishEyeManager'][_0x371532]['sCanvasID']['width'],_0x5f4f71=this['stFishEyeManager'][_0x371532]['sCanvasID']['height']);var _0x319989=Math['floor'](_0x3672f9['pstFontNumber']['nRowNumber']),_0x5afc1c=Math['floor'](_0x3672f9['pstFontNumber']['nColNumber']);0x1==_0x3672f9['pstCanvasAdapt']['nCanvasAdaptMode']&&(_0x319989=(_0x319989=(_0x319989=Math['floor'](_0x5f4f71/_0x3672f9['pstCanvasAdapt']['ntotalRowSpace']+0x1))<0x1?0x1:_0x319989)>_0x5b17bf?_0x5b17bf:_0x319989,_0x5afc1c=(_0x5afc1c=(_0x5afc1c=Math['floor'](_0x4087e5/_0x3672f9['pstCanvasAdapt']['ntotalColSpace']+0x1))<0x1?0x1:_0x5afc1c)>_0x5b17bf?_0x5b17bf:_0x5afc1c),this['GetWaterFontParam'](_0x48d0d9,_0x371532,_0x3672f9,_0x4087e5,_0x5f4f71,_0x319989,_0x5afc1c);}},{'key':'SetWaterMarkFont','value':function(_0x4b6c47){if(0x0!=this['pstWaterFontParamArray']['length']){for(var _0x3c7507=0x0;_0x3c7507<_0x573f02;_0x3c7507++)this['pstWaterFontParamArray'][_0x3c7507]['splice'](0x0,this['pstWaterFontParamArray'][_0x3c7507]['length']);}if(this['pstWaterFontParam']=_0x4b6c47,null===_0x4b6c47)return 0x1;this['CalculateWaterMarkParam'](this['oVideoHandle'],0x0,_0x4b6c47);for(var _0x15fdb3=0x1;_0x15fdb3<_0x573f02;_0x15fdb3++)null!=this['stFishEyeManager'][_0x15fdb3]['pRender']&&this['CalculateWaterMarkParam'](this['stFishEyeManager'][_0x15fdb3]['pRender'],_0x15fdb3,_0x4b6c47);return 0x1;}},{'key':'SetMosaicType','value':function(_0x387af1){return this['MosaicType']=_0x387af1['nMosaicType'],this['MosaicSize']=_0x387af1['nMosaicSize'],this['MosaicColorR']=_0x387af1['pstMosaicColor']['fMosaicColorR']/0xff,this['MosaicColorG']=_0x387af1['pstMosaicColor']['fMosaicColorG']/0xff,this['MosaicColorB']=_0x387af1['pstMosaicColor']['fMosaicColorB']/0xff,this['MosaicColorA']=_0x387af1['pstMosaicColor']['fMosaicColorA']/0x64,0x1;}},{'key':'SetTextCanvas','value':function(_0x343ef0){return this['textCanvas']=_0x343ef0,0x1;}},{'key':'SetPrintLogFlag','value':function(_0x384767){return this['printfFlag']=_0x384767,0x1;}},{'key':'SetRotateAngle','value':function(_0x34d10f){if(null!=this['oVideoHandle']){var _0x43d8a6;if(_0x43d8a6=this['oVideoHandle']['SR_SetRenderState'](_0x1ad956['SRRENDERSTATETYPE']['SR_RST_IMAGE_ROTATE'],_0x34d10f),null!=this['pstWaterFontParam']&&this['pstWaterFontParam']['nColorAdapt']&&(this['pstWaterFontParamArray'][0x0]['splice'](0x0,this['pstWaterFontParamArray'][0x0]['length']),this['CalculateWaterMarkParam'](this['oVideoHandle'],0x0,this['pstWaterFontParam'])),_0x43d8a6==_0x1ad956['ERRCODE']['SR_OK'])return 0x1;}return 0x0;}},{'key':'ImageDecoder','value':function(_0x52ed3f,_0x11e77a,_0x276ada){var _0x297fa4=this;_0x52ed3f['decode']({'frameIndex':_0x276ada})['then'](function(_0x2023dc){_0x297fa4['pWaterImageParam'][_0x276ada]={},_0x297fa4['pWaterImageParam'][_0x276ada]['videoStream']=_0x2023dc['image'],_0x297fa4['pWaterImageParam'][_0x276ada]['nImageWidth']=_0x2023dc['image']['displayWidth'],_0x297fa4['pWaterImageParam'][_0x276ada]['nImageHeight']=_0x2023dc['image']['displayHeight'],_0x297fa4['pWaterImageParam'][_0x276ada]['timeStamp']=_0x2023dc['image']['timestamp']/0x3e8,_0x297fa4['pWaterImageParam'][_0x276ada]['duration']=_0x2023dc['image']['duration']/0x3e8,null!=_0x11e77a['pstRectPos']?_0x297fa4['pWaterImageParam'][_0x276ada]['pstRectPos']=_0x11e77a['pstRectPos']:_0x297fa4['pWaterImageParam'][_0x276ada]['pstRectPos']={'fLeft':0x0,'fRight':0.1,'fTop':0x0,'fBottom':0.1},null!=_0x11e77a['fAlpha']&&_0x11e77a['fAlpha']<=0x1&&_0x11e77a['fAlpha']>=0x0?_0x297fa4['pWaterImageParam'][_0x276ada]['fAlpha']=_0x11e77a['fAlpha']:_0x297fa4['pWaterImageParam'][_0x276ada]['fAlpha']=0x1,_0x297fa4['waterMarkImageMax']=_0x52ed3f['tracks']['selectedTrack']['frameCount'],_0x276ada<_0x52ed3f['tracks']['selectedTrack']['frameCount']-0x1?_0x297fa4['ImageDecoder'](_0x52ed3f,_0x11e77a,_0x276ada+0x1):(_0x297fa4['baseWaterMarkImageTime']=_0x297fa4['curTimestamp'],_0x297fa4['finishDecodeImage']=!0x0);});}},{'key':'SetWaterMarkImage','value':function(_0x4f1a09){var _0x49dbfb=this;if(this['pWaterImageParam']['splice'](0x0,this['pWaterImageParam']['length']),null===_0x4f1a09)return 0x1;if(null!=_0x4f1a09['pImageData']){var _0x534b79=new ImageDecoder({'data':_0x4f1a09['pImageData'],'type':'image/'+_0x4f1a09['pImageType']});_0x534b79['tracks']['ready']['then'](function(){_0x534b79['completed']['then'](function(){_0x49dbfb['ImageDecoder'](_0x534b79,_0x4f1a09,0x0);});});}return this['waterMarkImageIndex']=0x0,0x1;}},{'key':'SelectIntelInfoFeatureToDraw','value':function(_0x3bee4d){if(this['DrawTargetEventIDList']['splice'](0x0,this['DrawTargetEventIDList']['length']),null===_0x3bee4d)return 0x0;if(pImageParam['NodeNumber']>0x0){for(var _0xde1f4f=0x0;_0xde1f4f<pImageParam['NodeNumber'];_0xde1f4f++)this['DrawTargetEventIDList']['push'](_0x3bee4d['pIntelInfoNode'][_0xde1f4f]);}return 0x1;}},{'key':'_ConvertDisplayEffect','value':function(_0x1b3fb0,_0x5d7973){switch(_0x1b3fb0){case _0x527ccc:return _0x1053ee==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_PTZ_WALL']:_0x5c6ecb==_0x5d7973||_0x100fbf==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_PANORAMA_WALL']:_0x13d414==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_SEMISPHERE']:_0x5c3f8c==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_PLANET']:_0x867a32==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL']:_0x4401a6==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_ARCSPHERE_VERTICAL_WALL']:_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_ORIGINAL'];case _0x36ed43:return _0x1053ee==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_PTZ_FLOOR']:_0x5c6ecb==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_PANORAMA_FLOOR_360']:_0x5195df==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_PANORAMA_FLOOR_180']:_0x13d414==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_SEMISPHERE']:_0x4baf73==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_CYLINDER_FLOOR']:_0x3aa96c==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_CYLINDER_SPLIT_FLOOR']:_0x5c3f8c==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_PLANET']:_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_ORIGINAL'];case _0x51aa1d:return _0x1053ee==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_PTZ_CEILING']:_0x5c6ecb==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_PANORAMA_CEILING_360']:_0x5195df==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_PANORAMA_CEILING_180']:_0x13d414==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_SEMISPHERE']:_0x4baf73==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_CYLINDER_CEILING']:_0x3aa96c==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_CYLINDER_SPLIT_CEILING']:_0x5c3f8c==_0x5d7973?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_PLANET']:_0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_ORIGINAL'];default:return _0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_ORIGINAL'];}return _0x1ad956['SRDISPLAYEFFECT']['SR_DE_FISH_ORIGINAL'];}},{'key':'GetCanvasData','value':function(_0x2bfe3c){var _0x49b187=arguments['length']>0x1&&void 0x0!==arguments[0x1]?arguments[0x1]:0x0,_0x4a6317=arguments['length']>0x2&&void 0x0!==arguments[0x2]?arguments[0x2]:0x0,_0x1283cc=arguments['length']>0x3&&void 0x0!==arguments[0x3]?arguments[0x3]:0x0,_0xadf66a={};_0xadf66a['nWidth']=_0x49b187,_0xadf66a['nHeight']=_0x4a6317,_0xadf66a['nBufferLen']=0x0;var _0x4c66e1=this['oVideoHandle']['SR_GetCaptureSize'](_0xadf66a,_0x1283cc);if(_0x1ad956['ERRCODE']['SR_OK']!=_0x4c66e1||_0xadf66a['nBufferLen']<=0x0)_0x2bfe3c(null);else{var _0x2b0e95=new Uint8Array(_0xadf66a['nBufferLen']);if(null!=_0x2b0e95){var _0xb5a393={};_0xb5a393['pBuffer']=_0x2b0e95,this['oVideoHandle']['SR_CaptureScreen'](_0xb5a393),_0x2bfe3c(_0x2b0e95,_0xadf66a['nWidth'],_0xadf66a['nHeight']);}else _0x2bfe3c(null);}}},{'key':'FindIntelNodefromList','value':function(_0x516b92){if(0x0!=this['privateNormalLinesInfo']['length']){for(var _0x2b5477=!0x1,_0x4ec148=0x0,_0x4696a1=!0x1,_0x5259c9=0x0,_0x1f9727=0x0,_0x23fe87=0x5f5e100,_0x390570=0x0;_0x390570<this['privateNormalLinesInfo']['length'];_0x390570++){if(0x0==(_0x1f9727=Math['abs'](this['privateNormalLinesInfo'][_0x390570]['absTimeStamp']-_0x516b92))){_0x4696a1=!0x0,_0x5259c9=_0x390570;break;}_0x1f9727<=this['nTimePerFrame']+0x3e8&&_0x1f9727<_0x23fe87&&(_0x2b5477=!0x0,_0x4ec148=_0x390570,_0x23fe87=_0x1f9727);}_0x4696a1?(this['curNormalLinesInfo']=this['privateNormalLinesInfo'][_0x5259c9],this['privateNormalLinesInfo']['shift']()):_0x2b5477&&(this['curNormalLinesInfo']=this['privateNormalLinesInfo'][_0x4ec148],this['privateNormalLinesInfo']['shift']());}if(0x0!=this['privateThermalLinesInfo']['length']&&(this['curThermalLinesInfo']=this['privateThermalLinesInfo'][0x0]),0x0!=this['privateTemLinesInfo']['length']){for(var _0x58a9b2=!0x1,_0x35f1b2=0x0,_0x432f5f=!0x1,_0x514541=0x0,_0x383203=0x0,_0x505148=0x5f5e100,_0x556393=0x0;_0x556393<this['privateTemLinesInfo']['length'];_0x556393++){if(0x0==(_0x383203=Math['abs'](this['privateTemLinesInfo'][_0x556393]['absTimeStamp']-_0x516b92))){_0x432f5f=!0x0,_0x514541=_0x556393;break;}_0x383203<=this['nTimePerFrame']+0x3e8&&_0x383203<_0x505148&&(_0x58a9b2=!0x0,_0x35f1b2=_0x556393,_0x505148=_0x383203);}_0x432f5f?(this['curTemLinesInfo']=this['privateTemLinesInfo'][_0x514541],this['privateTemLinesInfo']['shift']()):_0x58a9b2?(this['curTemLinesInfo']=this['privateTemLinesInfo'][_0x35f1b2],this['privateTemLinesInfo']['shift']()):this['nFrameRate']<=0x1e?this['m_nTEMDrawLinescount']<=0x1e?this['m_nTEMDrawLinescount']++:this['curTemLinesInfo']=null:this['m_nTEMDrawLinescount']<=0x3c?this['m_nTEMDrawLinescount']++:this['curTemLinesInfo']=null;}else this['nFrameRate']<=0x1e?this['m_nTEMDrawLinescount']<=0x1e?this['m_nTEMDrawLinescount']++:this['curTemLinesInfo']=null:this['m_nTEMDrawLinescount']<=0x3c?this['m_nTEMDrawLinescount']++:this['curTemLinesInfo']=null;if(0x0!=this['privateTargetLinesInfo']['length']){for(var _0x275a15=!0x1,_0x34edf6=0x0,_0x42870b=!0x1,_0x4c543b=0x0,_0xc27213=0x0,_0x3f6f30=0x5f5e100,_0x1845f7=0x0;_0x1845f7<this['privateTargetLinesInfo']['length'];_0x1845f7++){if(0x0==(_0xc27213=Math['abs'](this['privateTargetLinesInfo'][_0x1845f7]['absTimeStamp']-_0x516b92))){_0x42870b=!0x0,_0x4c543b=_0x1845f7;break;}_0xc27213<=this['nTimePerFrame']+0x3e8&&_0xc27213<_0x3f6f30&&(_0x275a15=!0x0,_0x34edf6=_0x1845f7,_0x3f6f30=_0xc27213);}_0x42870b?(this['curTargetLinesInfo']=this['privateTargetLinesInfo'][_0x4c543b],this['privateTargetLinesInfo']['shift']()):_0x275a15?(this['curTargetLinesInfo']=this['privateTargetLinesInfo'][_0x34edf6],this['privateTargetLinesInfo']['shift']()):this['curTargetLinesInfo']=null;}else this['curTargetLinesInfo']=null;if(0x0!=this['privateMDLinesInfo']['length']){for(var _0x46b102=!0x1,_0x141d94=0x0,_0x49384e=!0x1,_0x3ee250=0x0,_0x257e9b=0x0,_0x36db11=0x5f5e100,_0x438b1f=0x0;_0x438b1f<this['privateMDLinesInfo']['length'];_0x438b1f++){if(0x0==(_0x257e9b=Math['abs'](this['privateMDLinesInfo'][_0x438b1f]['absTimeStamp']-_0x516b92))){_0x49384e=!0x0,_0x3ee250=_0x438b1f;break;}_0x257e9b<=this['nTimePerFrame']+0x3e8&&_0x257e9b<_0x36db11&&(_0x46b102=!0x0,_0x141d94=_0x438b1f,_0x36db11=_0x257e9b);}_0x49384e?(this['curMDLinesInfo']=this['privateMDLinesInfo'][_0x3ee250],this['privateMDLinesInfo']['shift']()):_0x46b102?(this['curMDLinesInfo']=this['privateMDLinesInfo'][_0x141d94],this['privateMDLinesInfo']['shift']()):this['curMDLinesInfo']=null;}else this['curMDLinesInfo']=null;if(0x0!=this['privateExactLinesInfo']['length']){for(var _0x2c61df=!0x1,_0x54a3f3=0x0,_0x1c1200=!0x1,_0x5c84eb=0x0,_0x2fc8fd=0x0,_0x4b8175=0x5f5e100,_0x200997=0x0;_0x200997<this['privateExactLinesInfo']['length'];_0x200997++){if(0x0==(_0x2fc8fd=Math['abs'](this['privateExactLinesInfo'][_0x200997]['absTimeStamp']-_0x516b92))){_0x1c1200=!0x0,_0x5c84eb=_0x200997;break;}_0x2fc8fd<=this['nTimePerFrame']/0x2&&_0x2fc8fd<_0x4b8175&&(_0x2c61df=!0x0,_0x54a3f3=_0x200997,_0x4b8175=_0x2fc8fd);}_0x1c1200?(this['curExactLinesInfo']=this['privateExactLinesInfo'][_0x5c84eb],this['privateExactLinesInfo']['shift']()):_0x2c61df?(this['curExactLinesInfo']=this['privateExactLinesInfo'][_0x54a3f3],this['privateExactLinesInfo']['shift']()):this['curExactLinesInfo']=null;}else this['curExactLinesInfo']=null;if(0x0!=this['privateExactRuleLinesInfo']['length']){for(var _0x5f1ac9=!0x1,_0x53d970=0x0,_0x1fffb7=!0x1,_0x6b7db7=0x0,_0x190e29=0x0,_0x107316=0x5f5e100,_0xfef014=0x0;_0xfef014<this['privateExactRuleLinesInfo']['length'];_0xfef014++){if(0x0==(_0x190e29=Math['abs'](this['privateExactRuleLinesInfo'][_0xfef014]['absTimeStamp']-_0x516b92))){_0x1fffb7=!0x0,_0x6b7db7=_0xfef014;break;}_0x190e29<=this['nTimePerFrame']/0x2&&_0x190e29<_0x107316&&(_0x5f1ac9=!0x0,_0x53d970=_0xfef014,_0x107316=_0x190e29);}_0x1fffb7?(this['curExactRuleLinesInfo']=this['privateExactRuleLinesInfo'][_0x6b7db7],this['privateExactRuleLinesInfo']['shift']()):_0x5f1ac9&&(this['curExactRuleLinesInfo']=this['privateExactRuleLinesInfo'][_0x53d970],this['privateExactRuleLinesInfo']['shift']());}if(0x0!=this['privateNormalFontsInfo']['length']){for(var _0x6155ce=!0x1,_0x4d4994=0x0,_0x12f125=!0x1,_0x70a10a=0x0,_0x1ff3fc=0x0,_0x3ef2ca=0x5f5e100,_0x58e22c=0x0;_0x58e22c<this['privateNormalFontsInfo']['length'];_0x58e22c++){if(0x0==(_0x1ff3fc=Math['abs'](this['privateNormalFontsInfo'][_0x58e22c]['absTimeStamp']-_0x516b92))){_0x12f125=!0x0,_0x70a10a=_0x58e22c;break;}_0x1ff3fc<=this['nTimePerFrame']+0x3e8&&_0x1ff3fc<_0x3ef2ca&&(_0x6155ce=!0x0,_0x4d4994=_0x58e22c,_0x3ef2ca=_0x1ff3fc);}_0x12f125?(this['curNormalFontsInfo']=this['privateNormalFontsInfo'][_0x70a10a],this['privateNormalFontsInfo']['shift']()):_0x6155ce&&(this['curNormalFontsInfo']=this['privateNormalFontsInfo'][_0x4d4994],this['privateNormalFontsInfo']['shift']());}if(0x0!=this['privateTemFontsInfo']['length']){for(var _0xf99929=!0x1,_0x1d67f6=0x0,_0x49e363=!0x1,_0xfe9ab4=0x0,_0x5cb63a=0x0,_0x15428d=0x5f5e100,_0x4f77c8=0x0;_0x4f77c8<this['privateTemFontsInfo']['length'];_0x4f77c8++){if(0x0==(_0x5cb63a=Math['abs'](this['privateTemFontsInfo'][_0x4f77c8]['absTimeStamp']-_0x516b92))){_0x49e363=!0x0,_0xfe9ab4=_0x4f77c8;break;}_0x5cb63a<=this['nTimePerFrame']+0x3e8&&_0x5cb63a<_0x15428d&&(_0xf99929=!0x0,_0x1d67f6=_0x4f77c8,_0x15428d=_0x5cb63a);}_0x49e363?(this['curTemFontsInfo']=this['privateTemFontsInfo'][_0xfe9ab4],this['privateTemFontsInfo']['shift']()):_0xf99929?(this['curTemFontsInfo']=this['privateTemFontsInfo'][_0x1d67f6],this['privateTemFontsInfo']['shift']()):this['nFrameRate']<=0x1e?this['m_nTEMDrawFontscount']<=0x1e?this['m_nTEMDrawFontscount']++:this['curTemFontsInfo']=null:this['m_nTEMDrawFontscount']<=0x3c?this['m_nTEMDrawFontscount']++:this['curTemFontsInfo']=null;}else this['nFrameRate']<=0x1e?this['m_nTEMDrawFontscount']<=0x1e?this['m_nTEMDrawFontscount']++:this['curTemFontsInfo']=null:this['m_nTEMDrawFontscount']<=0x3c?this['m_nTEMDrawFontscount']++:this['curTemFontsInfo']=null;if(0x0!=this['privateTargetFontsInfo']['length']){for(var _0x15fa07=!0x1,_0x1f1d1c=0x0,_0x2f1431=!0x1,_0x175eda=0x0,_0x5c6383=0x0,_0x52d265=0x5f5e100,_0x31438a=0x0;_0x31438a<this['privateTargetFontsInfo']['length'];_0x31438a++){if(0x0==(_0x5c6383=Math['abs'](this['privateTargetFontsInfo'][_0x31438a]['absTimeStamp']-_0x516b92))){_0x2f1431=!0x0,_0x175eda=_0x31438a;break;}_0x5c6383<=this['nTimePerFrame']+0x3e8&&_0x5c6383<_0x52d265&&(_0x15fa07=!0x0,_0x1f1d1c=_0x31438a,_0x52d265=_0x5c6383);}_0x2f1431?(this['curTargetFontsInfo']=this['privateTargetFontsInfo'][_0x175eda],this['privateTargetFontsInfo']['shift']()):_0x15fa07?(this['curTargetFontsInfo']=this['privateTargetFontsInfo'][_0x1f1d1c],this['privateTargetFontsInfo']['shift']()):this['curTargetFontsInfo']=null;}else this['curTargetFontsInfo']=null;if(0x0!=this['privateExactPOSFontsInfo']['length']){for(var _0x3eabb9=!0x1,_0x35930b=0x0,_0x1f7d0a=!0x1,_0x41b960=0x0,_0x165ff4=0x0,_0x46c895=0x5f5e100,_0x43cd19=0x0;_0x43cd19<this['privateExactPOSFontsInfo']['length'];_0x43cd19++){if(0x0==(_0x165ff4=Math['abs'](this['privateExactPOSFontsInfo'][_0x43cd19]['absTimeStamp']-_0x516b92))){_0x1f7d0a=!0x0,_0x41b960=_0x43cd19;break;}_0x165ff4<=this['nTimePerFrame']/0x2&&_0x165ff4<_0x46c895&&(_0x3eabb9=!0x0,_0x35930b=_0x43cd19,_0x46c895=_0x165ff4);}_0x1f7d0a?(this['curExactPOSFontsInfo']=this['privateExactPOSFontsInfo'][_0x41b960],this['privateExactPOSFontsInfo']['shift']()):_0x3eabb9?(this['curExactPOSFontsInfo']=this['privateExactPOSFontsInfo'][_0x35930b],this['privateExactPOSFontsInfo']['shift']()):this['curExactPOSFontsInfo']=null;}else this['curExactPOSFontsInfo']=null;if(0x0!=this['privateExactFontsInfo']['length']){for(var _0x2f3296=!0x1,_0x4ffca8=0x0,_0x4a396f=!0x1,_0x223d89=0x0,_0x33ab39=0x0,_0x5bf4c3=0x5f5e100,_0x4fb5a0=0x0;_0x4fb5a0<this['privateExactFontsInfo']['length'];_0x4fb5a0++){if(0x0==(_0x33ab39=Math['abs'](this['privateExactFontsInfo'][_0x4fb5a0]['absTimeStamp']-_0x516b92))){_0x4a396f=!0x0,_0x223d89=_0x4fb5a0;break;}_0x33ab39<=this['nTimePerFrame']/0x2&&_0x33ab39<_0x5bf4c3&&(_0x2f3296=!0x0,_0x4ffca8=_0x4fb5a0,_0x5bf4c3=_0x33ab39);}_0x4a396f?(this['curExactFontsInfo']=this['privateExactFontsInfo'][_0x223d89],this['privateExactFontsInfo']['shift']()):_0x2f3296?(this['curExactFontsInfo']=this['privateExactFontsInfo'][_0x4ffca8],this['privateExactFontsInfo']['shift']()):this['curExactFontsInfo']=null;}else this['curExactFontsInfo']=null;if(0x0!=this['privateImageInfo']['length']){for(var _0x103b0f=!0x1,_0x9d18d9=0x0,_0x5dfce1=!0x1,_0x22d109=0x0,_0x23a207=0x0,_0x5d3992=0x5f5e100,_0x44b374=0x0;_0x44b374<this['privateImageInfo']['length'];_0x44b374++){if(0x0==(_0x23a207=Math['abs'](this['privateImageInfo'][_0x44b374]['absTimeStamp']-_0x516b92))){_0x5dfce1=!0x0,_0x22d109=_0x44b374;break;}_0x23a207<=this['nTimePerFrame']+0x5f5e100&&_0x23a207<_0x5d3992&&(_0x103b0f=!0x0,_0x9d18d9=_0x44b374,_0x5d3992=_0x23a207);}_0x5dfce1?(this['curImagesInfo']=this['privateImageInfo'][_0x22d109],this['privateImageInfo']['shift']()):_0x103b0f&&(this['curImagesInfo']=this['privateImageInfo'][_0x9d18d9],this['privateImageInfo']['shift']());}return 0x1;}},{'key':'RenderPrivateData','value':function(_0x5afb8f,_0xbbf5f4){return 0x1&_0x5afb8f&&(this['m_bEnableIVSEx']=_0xbbf5f4),0x2&_0x5afb8f&&(this['m_bEnableMDEx']=_0xbbf5f4),0x4&_0x5afb8f&&(this['m_bDisPos']=_0xbbf5f4),0x8&_0x5afb8f&&(this['m_bEnablePICEx']=_0xbbf5f4),0x10&_0x5afb8f&&(this['m_bEnableFIREEx']=_0xbbf5f4),0x20&_0x5afb8f&&(this['m_bEnableTEMEx']=_0xbbf5f4),0x40&_0x5afb8f&&(this['m_bEnableTrackEx']=_0xbbf5f4),0x80&_0x5afb8f&&(this['m_bEnableThermal']=_0xbbf5f4),0x1;}},{'key':'RenderPrivateDataEx','value':function(_0x427275,_0x967765,_0x8c7f69){return 0x10==_0x427275&&(0x1&_0x967765&&(this['m_bEnableFireDis']=_0x8c7f69),0x4&_0x967765&&(this['m_bEnableFireMaxPos']=_0x8c7f69),0x8&_0x967765&&(this['m_bEnableFireDistance']=_0x8c7f69)),0x20==_0x427275&&(0x1&_0x967765&&(this['m_bEnableTEMBox']=_0x8c7f69),0x2&_0x967765&&(this['m_bEnableTEMLine']=_0x8c7f69),0x4&_0x967765&&(this['m_bEnableTEMPoint']=_0x8c7f69)),0x40==_0x427275&&(0x1&_0x967765&&(this['m_bEnableTrackPeople']=_0x8c7f69),0x2&_0x967765&&(this['m_bEnableTrackVehicle']=_0x8c7f69)),0x80==_0x427275&&(0x1&_0x967765&&(this['m_bEnableThermalFireMask']=_0x8c7f69),0x2&_0x967765&&(this['m_bEnableThermalRuleGas']=_0x8c7f69),0x4&_0x967765&&(this['m_bEnableThermalTargetGas']=_0x8c7f69)),0x1;}},{'key':'InputPrivateInfo','value':function(_0x4e19b6,_0x587bfe,_0x522bad){var _0x506d51=this,_0x372604=!0x1,_0x5a686c=0x0;if(_0x4e19b6['linesNum']>0x0){var _0x4b1c92={'linesNum':0x0};_0x4b1c92['absTimeStamp']=_0x4e19b6['absTimeStamp'],_0x4b1c92['stDrawLinesArray']=[];var _0x3db47b={'linesNum':0x0};_0x3db47b['absTimeStamp']=_0x4e19b6['absTimeStamp'],_0x3db47b['stDrawLinesArray']=[];var _0x146353={'linesNum':0x0};_0x146353['absTimeStamp']=_0x4e19b6['absTimeStamp'],_0x146353['stDrawLinesArray']=[];var _0x109071={'linesNum':0x0};_0x109071['absTimeStamp']=_0x4e19b6['absTimeStamp'],_0x109071['stDrawLinesArray']=[];var _0x40befd={'linesNum':0x0};_0x40befd['absTimeStamp']=_0x4e19b6['absTimeStamp'],_0x40befd['stDrawLinesArray']=[];var _0xdfb677={'linesNum':0x0};_0xdfb677['absTimeStamp']=_0x4e19b6['absTimeStamp'],_0xdfb677['stDrawLinesArray']=[];var _0x444c43={'linesNum':0x0};_0x444c43['absTimeStamp']=_0x4e19b6['absTimeStamp'],_0x444c43['stDrawLinesArray']=[];for(var _0x2ca3d3=0x0;_0x2ca3d3<_0x4e19b6['linesNum'];_0x2ca3d3++)0x1==_0x4e19b6['stDrawLinesArray'][_0x2ca3d3]['dwMatchType']?0x2==_0x4e19b6['stDrawLinesArray'][_0x2ca3d3]['dwIntelFlag']?(_0xdfb677['stDrawLinesArray']['push'](_0x4e19b6['stDrawLinesArray'][_0x2ca3d3]),++_0xdfb677['linesNum']):(_0x40befd['stDrawLinesArray']['push'](_0x4e19b6['stDrawLinesArray'][_0x2ca3d3]),++_0x40befd['linesNum']):0x1==_0x4e19b6['stDrawLinesArray'][_0x2ca3d3]['dwIntelFlag']?(_0x4b1c92['stDrawLinesArray']['push'](_0x4e19b6['stDrawLinesArray'][_0x2ca3d3]),++_0x4b1c92['linesNum']):0x4==_0x4e19b6['stDrawLinesArray'][_0x2ca3d3]['dwIntelFlag']?(this['m_nTEMDrawLinescount']=0x0,_0x3db47b['stDrawLinesArray']['push'](_0x4e19b6['stDrawLinesArray'][_0x2ca3d3]),++_0x3db47b['linesNum']):0x6==_0x4e19b6['stDrawLinesArray'][_0x2ca3d3]['dwIntelFlag']?(_0x146353['stDrawLinesArray']['push'](_0x4e19b6['stDrawLinesArray'][_0x2ca3d3]),++_0x146353['linesNum']):0x8!=_0x4e19b6['stDrawLinesArray'][_0x2ca3d3]['dwIntelFlag']||0x1!=_0x4e19b6['stDrawLinesArray'][_0x2ca3d3]['dwSubIntelFlag']&&0x2!=_0x4e19b6['stDrawLinesArray'][_0x2ca3d3]['dwSubIntelFlag']?(_0x109071['stDrawLinesArray']['push'](_0x4e19b6['stDrawLinesArray'][_0x2ca3d3]),++_0x109071['linesNum']):(_0x444c43['stDrawLinesArray']['push'](_0x4e19b6['stDrawLinesArray'][_0x2ca3d3]),++_0x444c43['linesNum']);if(_0x40befd['linesNum']>0x0){if(_0x40befd['absTimeStamp']<=this['maxExactPrivateLineTimeStamp']){var _0x2a3a3a=0x0;for(_0x2a3a3a=0x0;_0x2a3a3a<this['privateExactLinesInfo']['length'];_0x2a3a3a++)if(this['privateExactLinesInfo'][_0x2a3a3a]['absTimeStamp']==_0x40befd['absTimeStamp']){_0x372604=!0x0,_0x5a686c=_0x2a3a3a;break;}}if(_0x372604){this['privateExactLinesInfo'][_0x5a686c]['linesNum']=_0x40befd['linesNum'];for(var _0x3a5f52=0x0;_0x3a5f52<_0x40befd['linesNum'];_0x3a5f52++){this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]={},this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]['vertex_num']=_0x40befd['stDrawLinesArray'][_0x3a5f52]['vertex_num'],this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]['lineWidth']=_0x40befd['stDrawLinesArray'][_0x3a5f52]['lineWidth'],this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]['bFill']=_0x40befd['stDrawLinesArray'][_0x3a5f52]['bFill'],this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]['bLoop']=_0x40befd['stDrawLinesArray'][_0x3a5f52]['bLoop'],this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]['dwMatchType']=_0x40befd['stDrawLinesArray'][_0x3a5f52]['dwMatchType'],this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]['dwIntelFlag']=_0x40befd['stDrawLinesArray'][_0x3a5f52]['dwIntelFlag'],this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]['dwSubIntelFlag']=_0x40befd['stDrawLinesArray'][_0x3a5f52]['dwSubIntelFlag'],this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]['color']={},this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]['color']['R']=_0x40befd['stDrawLinesArray'][_0x3a5f52]['color']['R'],this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]['color']['G']=_0x40befd['stDrawLinesArray'][_0x3a5f52]['color']['G'],this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]['color']['B']=_0x40befd['stDrawLinesArray'][_0x3a5f52]['color']['B'],this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]['color']['A']=_0x40befd['stDrawLinesArray'][_0x3a5f52]['color']['A'],this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]['stPoint']=[];for(var _0x29879f=0x0;_0x29879f<_0x40befd['stDrawLinesArray'][_0x3a5f52]['vertex_num'];_0x29879f++)this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]['stPoint'][_0x29879f]={},this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]['stPoint'][_0x29879f]['x']=_0x40befd['stDrawLinesArray'][_0x3a5f52]['stPoint'][_0x29879f]['x'],this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]['stPoint'][_0x29879f]['y']=_0x40befd['stDrawLinesArray'][_0x3a5f52]['stPoint'][_0x29879f]['y'];this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]['dwFillPicID']=_0x40befd['stDrawLinesArray'][_0x3a5f52]['dwFillPicID'],this['privateExactLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x3a5f52]['eventid']=_0x40befd['stDrawLinesArray'][_0x3a5f52]['dwEventID'];}}else this['maxExactPrivateLineTimeStamp']<_0x40befd['absTimeStamp']&&(this['maxExactPrivateLineTimeStamp']=_0x40befd['absTimeStamp']),this['privateExactLinesInfo']['push'](_0x40befd);}if(_0x372604=!0x1,_0x5a686c=0x0,_0x109071['linesNum']>0x0){if(this['privateNormalLinesInfo']['length']>=_0x93593d&&this['privateNormalLinesInfo']['shift'](),_0x109071['absTimeStamp']<=this['maxNormalPrivateLineTimeStamp']){var _0x2154d1=0x0;for(_0x2154d1=0x0;_0x2154d1<this['privateNormalLinesInfo']['length'];_0x2154d1++)if(this['privateNormalLinesInfo'][_0x2154d1]['absTimeStamp']==_0x109071['absTimeStamp']){_0x372604=!0x0,_0x5a686c=_0x2154d1;break;}}if(_0x372604){for(var _0x5d115f=0x0;_0x5d115f<_0x109071['linesNum'];_0x5d115f++)this['privateNormalLinesInfo'][_0x5a686c]['stDrawLinesArray']['push'](_0x109071['stDrawLinesArray'][_0x5d115f]),++this['privateNormalLinesInfo'][_0x5a686c]['linesNum'];}else this['maxNormalPrivateLineTimeStamp']<_0x109071['absTimeStamp']&&(this['maxNormalPrivateLineTimeStamp']=_0x109071['absTimeStamp']),this['privateNormalLinesInfo']['push'](_0x109071);}if(_0x444c43['linesNum']>0x0){if(this['privateThermalLinesInfo']['length']>=_0x93593d&&this['privateThermalLinesInfo']['shift'](),0x0!=this['privateThermalLinesInfo']['length']){this['privateThermalLinesInfo'][0x0]['linesNum']=_0x444c43['linesNum'];for(var _0xcba126=0x0;_0xcba126<_0x444c43['linesNum'];_0xcba126++){this['privateThermalLinesInfo'][0x0]['stDrawLinesArray'][_0xcba126]={},this['privateThermalLinesInfo'][0x0]['stDrawLinesArray'][_0xcba126]['vertex_num']=_0x444c43['stDrawLinesArray'][_0xcba126]['vertex_num'],this['privateThermalLinesInfo'][0x0]['stDrawLinesArray'][_0xcba126]['lineWidth']=_0x444c43['stDrawLinesArray'][_0xcba126]['lineWidth'],this['privateThermalLinesInfo'][0x0]['stDrawLinesArray'][_0xcba126]['bFill']=_0x444c43['stDrawLinesArray'][_0xcba126]['bFill'],this['privateThermalLinesInfo'][0x0]['stDrawLinesArray'][_0xcba126]['bLoop']=_0x444c43['stDrawLinesArray'][_0xcba126]['bLoop'],this['privateThermalLinesInfo'][0x0]['stDrawLinesArray'][_0xcba126]['dwMatchType']=_0x444c43['stDrawLinesArray'][_0xcba126]['dwMatchType'],this['privateThermalLinesInfo'][0x0]['stDrawLinesArray'][_0xcba126]['dwIntelFlag']=_0x444c43['stDrawLinesArray'][_0xcba126]['dwIntelFlag'],this['privateThermalLinesInfo'][0x0]['stDrawLinesArray'][_0xcba126]['dwSubIntelFlag']=_0x444c43['stDrawLinesArray'][_0xcba126]['dwSubIntelFlag'],this['privateThermalLinesInfo'][0x0]['stDrawLinesArray'][_0xcba126]['color']={},this['privateThermalLinesInfo'][0x0]['stDrawLinesArray'][_0xcba126]['color']['R']=_0x444c43['stDrawLinesArray'][_0xcba126]['color']['R'],this['privateThermalLinesInfo'][0x0]['stDrawLinesArray'][_0xcba126]['color']['G']=_0x444c43['stDrawLinesArray'][_0xcba126]['color']['G'],this['privateThermalLinesInfo'][0x0]['stDrawLinesArray'][_0xcba126]['color']['B']=_0x444c43['stDrawLinesArray'][_0xcba126]['color']['B'],this['privateThermalLinesInfo'][0x0]['stDrawLinesArray'][_0xcba126]['color']['A']=_0x444c43['stDrawLinesArray'][_0xcba126]['color']['A'],this['privateThermalLinesInfo'][0x0]['stDrawLinesArray'][_0xcba126]['stPoint']=[];for(var _0x4e1c9a=0x0;_0x4e1c9a<_0x444c43['stDrawLinesArray'][_0xcba126]['vertex_num'];_0x4e1c9a++)this['privateThermalLinesInfo'][0x0]['stDrawLinesArray'][_0xcba126]['stPoint'][_0x4e1c9a]={},this['privateThermalLinesInfo'][0x0]['stDrawLinesArray'][_0xcba126]['stPoint'][_0x4e1c9a]['x']=_0x444c43['stDrawLinesArray'][_0xcba126]['stPoint'][_0x4e1c9a]['x'],this['privateThermalLinesInfo'][0x0]['stDrawLinesArray'][_0xcba126]['stPoint'][_0x4e1c9a]['y']=_0x444c43['stDrawLinesArray'][_0xcba126]['stPoint'][_0x4e1c9a]['y'];}}else this['privateThermalLinesInfo']['push'](_0x444c43);}if(_0x372604=!0x1,_0x5a686c=0x0,_0xdfb677['linesNum']>0x0){if(_0xdfb677['absTimeStamp']<=this['maxExactRulePrivateLineTimeStamp']){var _0x36e12b=0x0;for(_0x36e12b=0x0;_0x36e12b<this['privateExactRuleLinesInfo']['length'];_0x36e12b++)if(this['privateExactRuleLinesInfo'][_0x36e12b]['absTimeStamp']==_0xdfb677['absTimeStamp']){_0x372604=!0x0,_0x5a686c=_0x36e12b;break;}}if(_0x372604){this['privateExactRuleLinesInfo'][_0x5a686c]['linesNum']=_0xdfb677['linesNum'];for(var _0x5b6cf2=0x0;_0x5b6cf2<_0xdfb677['linesNum'];_0x5b6cf2++){this['privateExactRuleLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x5b6cf2]={},this['privateExactRuleLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x5b6cf2]['vertex_num']=_0xdfb677['stDrawLinesArray'][_0x5b6cf2]['vertex_num'],this['privateExactRuleLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x5b6cf2]['lineWidth']=_0xdfb677['stDrawLinesArray'][_0x5b6cf2]['lineWidth'],this['privateExactRuleLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x5b6cf2]['bFill']=_0xdfb677['stDrawLinesArray'][_0x5b6cf2]['bFill'],this['privateExactRuleLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x5b6cf2]['bLoop']=_0xdfb677['stDrawLinesArray'][_0x5b6cf2]['bLoop'],this['privateExactRuleLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x5b6cf2]['dwMatchType']=_0xdfb677['stDrawLinesArray'][_0x5b6cf2]['dwMatchType'],this['privateExactRuleLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x5b6cf2]['dwIntelFlag']=_0xdfb677['stDrawLinesArray'][_0x5b6cf2]['dwIntelFlag'],this['privateExactRuleLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x5b6cf2]['dwSubIntelFlag']=_0xdfb677['stDrawLinesArray'][_0x5b6cf2]['dwSubIntelFlag'],this['privateExactRuleLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x5b6cf2]['color']={},this['privateExactRuleLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x5b6cf2]['color']['R']=_0xdfb677['stDrawLinesArray'][_0x5b6cf2]['color']['R'],this['privateExactRuleLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x5b6cf2]['color']['G']=_0xdfb677['stDrawLinesArray'][_0x5b6cf2]['color']['G'],this['privateExactRuleLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x5b6cf2]['color']['B']=_0xdfb677['stDrawLinesArray'][_0x5b6cf2]['color']['B'],this['privateExactRuleLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x5b6cf2]['color']['A']=_0xdfb677['stDrawLinesArray'][_0x5b6cf2]['color']['A'],this['privateExactRuleLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x5b6cf2]['stPoint']=[];for(var _0x332c3b=0x0;_0x332c3b<_0xdfb677['stDrawLinesArray'][_0x5b6cf2]['vertex_num'];_0x332c3b++)this['privateExactRuleLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x5b6cf2]['stPoint'][_0x332c3b]={},this['privateExactRuleLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x5b6cf2]['stPoint'][_0x332c3b]['x']=_0xdfb677['stDrawLinesArray'][_0x5b6cf2]['stPoint'][_0x332c3b]['x'],this['privateExactRuleLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x5b6cf2]['stPoint'][_0x332c3b]['y']=_0xdfb677['stDrawLinesArray'][_0x5b6cf2]['stPoint'][_0x332c3b]['y'];}}else this['maxExactRulePrivateLineTimeStamp']<_0xdfb677['absTimeStamp']&&(this['maxExactRulePrivateLineTimeStamp']=_0xdfb677['absTimeStamp']),this['privateExactRuleLinesInfo']['push'](_0xdfb677);}if(_0x372604=!0x1,_0x5a686c=0x0,_0x4b1c92['linesNum']>0x0){if(_0x4b1c92['absTimeStamp']<=this['maxTargetPrivateLineTimeStamp']){var _0xf1adc=0x0;for(_0xf1adc=0x0;_0xf1adc<this['privateTargetLinesInfo']['length'];_0xf1adc++)if(this['privateTargetLinesInfo'][_0xf1adc]['absTimeStamp']==_0x4b1c92['absTimeStamp']){_0x372604=!0x0,_0x5a686c=_0xf1adc;break;}}if(_0x372604){this['privateTargetLinesInfo'][_0x5a686c]['linesNum']=_0x4b1c92['linesNum'];for(var _0x284cbc=0x0;_0x284cbc<_0x4b1c92['linesNum'];_0x284cbc++){this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]={},this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]['vertex_num']=_0x4b1c92['stDrawLinesArray'][_0x284cbc]['vertex_num'],this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]['lineWidth']=_0x4b1c92['stDrawLinesArray'][_0x284cbc]['lineWidth'],this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]['bFill']=_0x4b1c92['stDrawLinesArray'][_0x284cbc]['bFill'],this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]['bLoop']=_0x4b1c92['stDrawLinesArray'][_0x284cbc]['bLoop'],this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]['dwMatchType']=_0x4b1c92['stDrawLinesArray'][_0x284cbc]['dwMatchType'],this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]['dwIntelFlag']=_0x4b1c92['stDrawLinesArray'][_0x284cbc]['dwIntelFlag'],this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]['dwSubIntelFlag']=_0x4b1c92['stDrawLinesArray'][_0x284cbc]['dwSubIntelFlag'],this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]['color']={},this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]['color']['R']=_0x4b1c92['stDrawLinesArray'][_0x284cbc]['color']['R'],this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]['color']['G']=_0x4b1c92['stDrawLinesArray'][_0x284cbc]['color']['G'],this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]['color']['B']=_0x4b1c92['stDrawLinesArray'][_0x284cbc]['color']['B'],this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]['color']['A']=_0x4b1c92['stDrawLinesArray'][_0x284cbc]['color']['A'],this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]['stPoint']=[];for(var _0x5b76a8=0x0;_0x5b76a8<_0x4b1c92['stDrawLinesArray'][_0x284cbc]['vertex_num'];_0x5b76a8++)this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]['stPoint'][_0x5b76a8]={},this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]['stPoint'][_0x5b76a8]['x']=_0x4b1c92['stDrawLinesArray'][_0x284cbc]['stPoint'][_0x5b76a8]['x'],this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]['stPoint'][_0x5b76a8]['y']=_0x4b1c92['stDrawLinesArray'][_0x284cbc]['stPoint'][_0x5b76a8]['y'];this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]['dwFillPicID']=_0x4b1c92['stDrawLinesArray'][_0x284cbc]['dwFillPicID'],this['privateTargetLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x284cbc]['eventid']=_0x4b1c92['stDrawLinesArray'][_0x284cbc]['dwEventID'];}}else this['maxTargetPrivateLineTimeStamp']<_0x4b1c92['absTimeStamp']&&(this['maxTargetPrivateLineTimeStamp']=_0x4b1c92['absTimeStamp']),this['privateTargetLinesInfo']['push'](_0x4b1c92);}if(_0x372604=!0x1,_0x5a686c=0x0,_0x146353['linesNum']>0x0){if(this['privateMDLinesInfo']['length']>=_0x93593d&&this['privateMDLinesInfo']['shift'](),_0x146353['absTimeStamp']<=this['maxMDPrivateLineTimeStamp']){var _0xf282e7=0x0;for(_0xf282e7=0x0;_0xf282e7<this['privateMDLinesInfo']['length'];_0xf282e7++)if(this['privateMDLinesInfo'][_0xf282e7]['absTimeStamp']==_0x146353['absTimeStamp']){_0x372604=!0x0,_0x5a686c=_0xf282e7;break;}}if(_0x372604){this['privateMDLinesInfo'][_0x5a686c]['linesNum']=_0x146353['linesNum'];for(var _0x1f7d53=0x0;_0x1f7d53<_0x146353['linesNum'];_0x1f7d53++){this['privateMDLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x1f7d53]={},this['privateMDLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x1f7d53]['vertex_num']=_0x146353['stDrawLinesArray'][_0x1f7d53]['vertex_num'],this['privateMDLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x1f7d53]['lineWidth']=_0x146353['stDrawLinesArray'][_0x1f7d53]['lineWidth'],this['privateMDLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x1f7d53]['bFill']=_0x146353['stDrawLinesArray'][_0x1f7d53]['bFill'],this['privateMDLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x1f7d53]['bLoop']=_0x146353['stDrawLinesArray'][_0x1f7d53]['bLoop'],this['privateMDLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x1f7d53]['dwMatchType']=_0x146353['stDrawLinesArray'][_0x1f7d53]['dwMatchType'],this['privateMDLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x1f7d53]['dwIntelFlag']=_0x146353['stDrawLinesArray'][_0x1f7d53]['dwIntelFlag'],this['privateMDLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x1f7d53]['dwSubIntelFlag']=_0x146353['stDrawLinesArray'][_0x1f7d53]['dwSubIntelFlag'],this['privateMDLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x1f7d53]['color']={},this['privateMDLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x1f7d53]['color']['R']=_0x146353['stDrawLinesArray'][_0x1f7d53]['color']['R'],this['privateMDLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x1f7d53]['color']['G']=_0x146353['stDrawLinesArray'][_0x1f7d53]['color']['G'],this['privateMDLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x1f7d53]['color']['B']=_0x146353['stDrawLinesArray'][_0x1f7d53]['color']['B'],this['privateMDLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x1f7d53]['color']['A']=_0x146353['stDrawLinesArray'][_0x1f7d53]['color']['A'],this['privateMDLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x1f7d53]['stPoint']=[];for(var _0x2afb88=0x0;_0x2afb88<_0x146353['stDrawLinesArray'][_0x1f7d53]['vertex_num'];_0x2afb88++)this['privateMDLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x1f7d53]['stPoint'][_0x2afb88]={},this['privateMDLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x1f7d53]['stPoint'][_0x2afb88]['x']=_0x146353['stDrawLinesArray'][_0x1f7d53]['stPoint'][_0x2afb88]['x'],this['privateMDLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x1f7d53]['stPoint'][_0x2afb88]['y']=_0x146353['stDrawLinesArray'][_0x1f7d53]['stPoint'][_0x2afb88]['y'];}}else this['maxMDPrivateLineTimeStamp']<_0x146353['absTimeStamp']&&(this['maxMDPrivateLineTimeStamp']=_0x146353['absTimeStamp']),this['privateMDLinesInfo']['push'](_0x146353);}if(_0x372604=!0x1,_0x5a686c=0x0,_0x3db47b['linesNum']>0x0){if(this['privateTemLinesInfo']['length']>=_0x93593d&&this['privateTemLinesInfo']['shift'](),_0x3db47b['absTimeStamp']<=this['maxTemPrivateLineTimeStamp']){var _0x2d7e66=0x0;for(_0x2d7e66=0x0;_0x2d7e66<this['privateTemLinesInfo']['length'];_0x2d7e66++)if(this['privateTemLinesInfo'][_0x2d7e66]['absTimeStamp']==_0x3db47b['absTimeStamp']){_0x372604=!0x0,_0x5a686c=_0x2d7e66;break;}}if(_0x372604){this['privateTemLinesInfo'][_0x5a686c]['linesNum']=_0x3db47b['linesNum'];for(var _0x166951=0x0;_0x166951<_0x3db47b['linesNum'];_0x166951++){this['privateTemLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x166951]={},this['privateTemLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x166951]['vertex_num']=_0x3db47b['stDrawLinesArray'][_0x166951]['vertex_num'],this['privateTemLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x166951]['lineWidth']=_0x3db47b['stDrawLinesArray'][_0x166951]['lineWidth'],this['privateTemLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x166951]['bFill']=_0x3db47b['stDrawLinesArray'][_0x166951]['bFill'],this['privateTemLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x166951]['bLoop']=_0x3db47b['stDrawLinesArray'][_0x166951]['bLoop'],this['privateTemLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x166951]['dwMatchType']=_0x3db47b['stDrawLinesArray'][_0x166951]['dwMatchType'],this['privateTemLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x166951]['dwIntelFlag']=_0x3db47b['stDrawLinesArray'][_0x166951]['dwIntelFlag'],this['privateTemLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x166951]['dwSubIntelFlag']=_0x3db47b['stDrawLinesArray'][_0x166951]['dwSubIntelFlag'],this['privateTemLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x166951]['color']={},this['privateTemLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x166951]['color']['R']=_0x3db47b['stDrawLinesArray'][_0x166951]['color']['R'],this['privateTemLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x166951]['color']['G']=_0x3db47b['stDrawLinesArray'][_0x166951]['color']['G'],this['privateTemLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x166951]['color']['B']=_0x3db47b['stDrawLinesArray'][_0x166951]['color']['B'],this['privateTemLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x166951]['color']['A']=_0x3db47b['stDrawLinesArray'][_0x166951]['color']['A'],this['privateTemLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x166951]['stPoint']=[];for(var _0x4e3ae0=0x0;_0x4e3ae0<_0x3db47b['stDrawLinesArray'][_0x166951]['vertex_num'];_0x4e3ae0++)this['privateTemLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x166951]['stPoint'][_0x4e3ae0]={},this['privateTemLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x166951]['stPoint'][_0x4e3ae0]['x']=_0x3db47b['stDrawLinesArray'][_0x166951]['stPoint'][_0x4e3ae0]['x'],this['privateTemLinesInfo'][_0x5a686c]['stDrawLinesArray'][_0x166951]['stPoint'][_0x4e3ae0]['y']=_0x3db47b['stDrawLinesArray'][_0x166951]['stPoint'][_0x4e3ae0]['y'];}}else this['maxTemPrivateLineTimeStamp']<_0x3db47b['absTimeStamp']&&(this['maxTemPrivateLineTimeStamp']=_0x3db47b['absTimeStamp']),this['privateTemLinesInfo']['push'](_0x3db47b);}}if(_0x587bfe['nFontsNum']>0x0){var _0x51447a={'nFontsNum':0x0};_0x51447a['absTimeStamp']=_0x587bfe['absTimeStamp'],_0x51447a['stDrawFontsArray']=[];var _0x154cd5={'nFontsNum':0x0};_0x154cd5['absTimeStamp']=_0x587bfe['absTimeStamp'],_0x154cd5['stDrawFontsArray']=[];var _0x269ced={'nFontsNum':0x0};_0x269ced['absTimeStamp']=_0x587bfe['absTimeStamp'],_0x269ced['stDrawFontsArray']=[];var _0x46a7b5={'nFontsNum':0x0};_0x46a7b5['absTimeStamp']=_0x587bfe['absTimeStamp'],_0x46a7b5['stDrawFontsArray']=[];var _0x1a57c1={'nFontsNum':0x0};_0x1a57c1['absTimeStamp']=_0x587bfe['absTimeStamp'],_0x1a57c1['stDrawFontsArray']=[];var _0x4f244f={'nFontsNum':0x0};_0x4f244f['absTimeStamp']=_0x587bfe['absTimeStamp'],_0x4f244f['stDrawFontsArray']=[];for(var _0x1e9a1b=0x0;_0x1e9a1b<_0x587bfe['nFontsNum'];_0x1e9a1b++)0x1==_0x587bfe['stDrawFontsArray'][_0x1e9a1b]['dwMatchType']?0x1==_0x587bfe['stDrawFontsArray'][_0x1e9a1b]['dwIntelFlag']?(_0x1a57c1['stDrawFontsArray']['push'](_0x587bfe['stDrawFontsArray'][_0x1e9a1b]),++_0x1a57c1['nFontsNum']):0x3==_0x587bfe['stDrawFontsArray'][_0x1e9a1b]['dwIntelFlag']&&(_0x4f244f['stDrawFontsArray']['push'](_0x587bfe['stDrawFontsArray'][_0x1e9a1b]),++_0x4f244f['nFontsNum']):0x1==_0x587bfe['stDrawFontsArray'][_0x1e9a1b]['dwIntelFlag']?(_0x51447a['stDrawFontsArray']['push'](_0x587bfe['stDrawFontsArray'][_0x1e9a1b]),++_0x51447a['nFontsNum']):0x4==_0x587bfe['stDrawFontsArray'][_0x1e9a1b]['dwIntelFlag']?(this['m_nTEMDrawFontscount']=0x0,_0x154cd5['stDrawFontsArray']['push'](_0x587bfe['stDrawFontsArray'][_0x1e9a1b]),++_0x154cd5['nFontsNum']):0x3==_0x587bfe['stDrawFontsArray'][_0x1e9a1b]['dwIntelFlag']?_0x587bfe['stDrawFontsArray'][_0x1e9a1b]['NeedClearNormalPos']?this['curNormalPOSFontsInfo']=null:(_0x46a7b5['stDrawFontsArray']['push'](_0x587bfe['stDrawFontsArray'][_0x1e9a1b]),++_0x46a7b5['nFontsNum']):(_0x269ced['stDrawFontsArray']['push'](_0x587bfe['stDrawFontsArray'][_0x1e9a1b]),++_0x269ced['nFontsNum']);if(_0x372604=!0x1,_0x5a686c=0x0,_0x4f244f['nFontsNum']>0x0){if(this['privateExactPOSFontsInfo']['length']>=_0x93593d&&this['privateExactPOSFontsInfo']['shift'](),_0x4f244f['absTimeStamp']<=this['maxExactPOSPrivateFontTimeStamp']){var _0x545d38=0x0;for(_0x545d38=0x0;_0x545d38<this['privateExactPOSFontsInfo']['length'];_0x545d38++)if(this['privateExactPOSFontsInfo'][_0x545d38]['absTimeStamp']==_0x4f244f['absTimeStamp']){_0x372604=!0x0,_0x5a686c=_0x545d38;break;}}if(_0x372604){this['privateExactPOSFontsInfo'][_0x5a686c]['nFontsNum']=_0x4f244f['nFontsNum'];for(var _0x2a3741=0x0;_0x2a3741<_0x4f244f['nFontsNum'];_0x2a3741++)this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]={},this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['nFontSizeW']=_0x4f244f['stDrawFontsArray'][_0x2a3741]['nFontSizeW'],this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['nFontSizeH']=_0x4f244f['stDrawFontsArray'][_0x2a3741]['nFontSizeH'],this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['dwMatchType']=_0x4f244f['stDrawFontsArray'][_0x2a3741]['dwMatchType'],this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['dwIntelFlag']=_0x4f244f['stDrawFontsArray'][_0x2a3741]['dwIntelFlag'],this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['dwSubIntelFlag']=_0x4f244f['stDrawFontsArray'][_0x2a3741]['dwSubIntelFlag'],this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['color']={},this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['color']['R']=_0x4f244f['stDrawFontsArray'][_0x2a3741]['color']['R'],this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['color']['G']=_0x4f244f['stDrawFontsArray'][_0x2a3741]['color']['G'],this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['color']['B']=_0x4f244f['stDrawFontsArray'][_0x2a3741]['color']['B'],this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['color']['A']=_0x4f244f['stDrawFontsArray'][_0x2a3741]['color']['A'],this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['stPoint']={},this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['stPoint']['x']=_0x4f244f['stDrawFontsArray'][_0x2a3741]['stPoint']['x'],this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['stPoint']['y']=_0x4f244f['stDrawFontsArray'][_0x2a3741]['stPoint']['y'],this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['fontString']=_0x4f244f['stDrawFontsArray'][_0x2a3741]['fontString'],this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['BGcolor']={},this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['BGcolor']['R']=_0x4f244f['stDrawFontsArray'][_0x2a3741]['BGcolor']['R'],this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['BGcolor']['G']=_0x4f244f['stDrawFontsArray'][_0x2a3741]['BGcolor']['G'],this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['BGcolor']['B']=_0x4f244f['stDrawFontsArray'][_0x2a3741]['BGcolor']['B'],this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['BGcolor']['A']=_0x4f244f['stDrawFontsArray'][_0x2a3741]['BGcolor']['A'],this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['bBackGround']=_0x4f244f['stDrawFontsArray'][_0x2a3741]['bBackGround'],this['privateExactPOSFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x2a3741]['EventID']=_0x4f244f['stDrawFontsArray'][_0x2a3741]['dwEventID'];}else this['maxExactPOSPrivateFontTimeStamp']<_0x4f244f['absTimeStamp']&&(this['maxExactPOSPrivateFontTimeStamp']=_0x4f244f['absTimeStamp']),this['privateExactPOSFontsInfo']['push'](_0x4f244f);}if(_0x372604=!0x1,_0x5a686c=0x0,_0x1a57c1['nFontsNum']>0x0){if(this['privateExactFontsInfo']['length']>=_0x93593d&&this['privateExactFontsInfo']['shift'](),_0x1a57c1['absTimeStamp']<=this['maxExactPrivateFontTimeStamp']){var _0x301f78=0x0;for(_0x301f78=0x0;_0x301f78<this['privateExactFontsInfo']['length'];_0x301f78++)if(this['privateExactFontsInfo'][_0x301f78]['absTimeStamp']==_0x1a57c1['absTimeStamp']){_0x372604=!0x0,_0x5a686c=_0x301f78;break;}}if(_0x372604){for(var _0x56735a=0x0;_0x56735a<_0x1a57c1['nFontsNum'];_0x56735a++)this['privateExactFontsInfo'][_0x5a686c]['stDrawFontsArray']['push'](_0x1a57c1['stDrawFontsArray'][_0x56735a]),++this['privateExactFontsInfo'][_0x5a686c]['nFontsNum'];}else this['maxExactPrivateFontTimeStamp']<_0x1a57c1['absTimeStamp']&&(this['maxExactPrivateFontTimeStamp']=_0x1a57c1['absTimeStamp']),this['privateExactFontsInfo']['push'](_0x1a57c1);}if(_0x372604=!0x1,_0x5a686c=0x0,_0x269ced['nFontsNum']>0x0){if(this['privateNormalFontsInfo']['length']>=_0x93593d&&this['privateNormalFontsInfo']['shift'](),_0x269ced['absTimeStamp']<=this['maxNormalPrivateFontTimeStamp']){var _0x311bac=0x0;for(_0x311bac=0x0;_0x311bac<this['privateNormalFontsInfo']['length'];_0x311bac++)if(this['privateNormalFontsInfo'][_0x311bac]['absTimeStamp']==_0x269ced['absTimeStamp']){_0x372604=!0x0,_0x5a686c=_0x311bac;break;}}if(_0x372604){for(var _0x4c7237=0x0;_0x4c7237<_0x269ced['nFontsNum'];_0x4c7237++)this['privateNormalFontsInfo'][_0x5a686c]['stDrawFontsArray']['push'](_0x269ced['stDrawFontsArray'][_0x4c7237]),++this['privateNormalFontsInfo'][_0x5a686c]['nFontsNum'];}else this['maxNormalPrivateFontTimeStamp']<_0x269ced['absTimeStamp']&&(this['maxNormalPrivateFontTimeStamp']=_0x269ced['absTimeStamp']),this['privateNormalFontsInfo']['push'](_0x269ced);}if(_0x46a7b5['nFontsNum']>0x0){if(null==this['curNormalPOSFontsInfo'])this['curNormalPOSFontsInfo']=_0x46a7b5;else{this['curNormalPOSFontsInfo']['nFontsNum']=_0x46a7b5['nFontsNum'],this['curNormalPOSFontsInfo']['absTimeStamp']=_0x46a7b5['absTimeStamp'];for(var _0x4ffaa7=0x0;_0x4ffaa7<_0x46a7b5['nFontsNum'];_0x4ffaa7++)this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]={},this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['nFontSizeW']=_0x46a7b5['stDrawFontsArray'][_0x4ffaa7]['nFontSizeW'],this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['nFontSizeH']=_0x46a7b5['stDrawFontsArray'][_0x4ffaa7]['nFontSizeH'],this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['dwMatchType']=_0x46a7b5['stDrawFontsArray'][_0x4ffaa7]['dwMatchType'],this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['dwIntelFlag']=_0x46a7b5['stDrawFontsArray'][_0x4ffaa7]['dwIntelFlag'],this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['dwSubIntelFlag']=_0x46a7b5['stDrawFontsArray'][_0x4ffaa7]['dwSubIntelFlag'],this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['color']={},this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['color']['R']=_0x46a7b5['stDrawFontsArray'][_0x4ffaa7]['color']['R'],this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['color']['G']=_0x46a7b5['stDrawFontsArray'][_0x4ffaa7]['color']['G'],this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['color']['B']=_0x46a7b5['stDrawFontsArray'][_0x4ffaa7]['color']['B'],this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['color']['A']=_0x46a7b5['stDrawFontsArray'][_0x4ffaa7]['color']['A'],this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['stPoint']={},this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['stPoint']['x']=_0x46a7b5['stDrawFontsArray'][_0x4ffaa7]['stPoint']['x'],this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['stPoint']['y']=_0x46a7b5['stDrawFontsArray'][_0x4ffaa7]['stPoint']['y'],this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['fontString']=_0x46a7b5['stDrawFontsArray'][_0x4ffaa7]['fontString'],this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['BGcolor']={},this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['BGcolor']['R']=_0x46a7b5['stDrawFontsArray'][_0x4ffaa7]['BGcolor']['R'],this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['BGcolor']['G']=_0x46a7b5['stDrawFontsArray'][_0x4ffaa7]['BGcolor']['G'],this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['BGcolor']['B']=_0x46a7b5['stDrawFontsArray'][_0x4ffaa7]['BGcolor']['B'],this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['BGcolor']['A']=_0x46a7b5['stDrawFontsArray'][_0x4ffaa7]['BGcolor']['A'],this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['bBackGround']=_0x46a7b5['stDrawFontsArray'][_0x4ffaa7]['bBackGround'],this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x4ffaa7]['EventID']=_0x46a7b5['stDrawFontsArray'][_0x4ffaa7]['dwEventID'];}}if(_0x372604=!0x1,_0x5a686c=0x0,_0x51447a['nFontsNum']>0x0){if(this['privateTargetFontsInfo']['length']>=_0x93593d&&this['privateTargetFontsInfo']['shift'](),_0x51447a['absTimeStamp']<=this['maxTargetPrivateFontTimeStamp']){var _0x4fbcf0=0x0;for(_0x4fbcf0=0x0;_0x4fbcf0<this['privateTargetFontsInfo']['length'];_0x4fbcf0++)if(this['privateTargetFontsInfo'][_0x4fbcf0]['absTimeStamp']==_0x51447a['absTimeStamp']){_0x372604=!0x0,_0x5a686c=_0x4fbcf0;break;}}if(_0x372604){this['privateTargetFontsInfo'][_0x5a686c]['nFontsNum']=_0x51447a['nFontsNum'];for(var _0x5c9461=0x0;_0x5c9461<_0x51447a['nFontsNum'];_0x5c9461++)this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]={},this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['nFontSizeW']=_0x51447a['stDrawFontsArray'][_0x5c9461]['nFontSizeW'],this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['nFontSizeH']=_0x51447a['stDrawFontsArray'][_0x5c9461]['nFontSizeH'],this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['dwMatchType']=_0x51447a['stDrawFontsArray'][_0x5c9461]['dwMatchType'],this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['dwIntelFlag']=_0x51447a['stDrawFontsArray'][_0x5c9461]['dwIntelFlag'],this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['dwSubIntelFlag']=_0x51447a['stDrawFontsArray'][_0x5c9461]['dwSubIntelFlag'],this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['color']={},this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['color']['R']=_0x51447a['stDrawFontsArray'][_0x5c9461]['color']['R'],this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['color']['G']=_0x51447a['stDrawFontsArray'][_0x5c9461]['color']['G'],this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['color']['B']=_0x51447a['stDrawFontsArray'][_0x5c9461]['color']['B'],this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['color']['A']=_0x51447a['stDrawFontsArray'][_0x5c9461]['color']['A'],this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['stPoint']={},this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['stPoint']['x']=_0x51447a['stDrawFontsArray'][_0x5c9461]['stPoint']['x'],this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['stPoint']['y']=_0x51447a['stDrawFontsArray'][_0x5c9461]['stPoint']['y'],this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['fontString']=_0x51447a['stDrawFontsArray'][_0x5c9461]['fontString'],this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['BGcolor']={},this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['BGcolor']['R']=_0x51447a['stDrawFontsArray'][_0x5c9461]['BGcolor']['R'],this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['BGcolor']['G']=_0x51447a['stDrawFontsArray'][_0x5c9461]['BGcolor']['G'],this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['BGcolor']['B']=_0x51447a['stDrawFontsArray'][_0x5c9461]['BGcolor']['B'],this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['BGcolor']['A']=_0x51447a['stDrawFontsArray'][_0x5c9461]['BGcolor']['A'],this['privateTargetFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x5c9461]['bBackGround']=_0x51447a['stDrawFontsArray'][_0x5c9461]['bBackGround'];}else this['maxTargetPrivateFontTimeStamp']<_0x51447a['absTimeStamp']&&(this['maxTargetPrivateFontTimeStamp']=_0x51447a['absTimeStamp']),this['privateTargetFontsInfo']['push'](_0x51447a);}if(_0x372604=!0x1,_0x5a686c=0x0,_0x154cd5['nFontsNum']>0x0){if(this['privateTemFontsInfo']['length']>=_0x93593d&&this['privateTemFontsInfo']['shift'](),_0x154cd5['absTimeStamp']<=this['maxTemPrivateFontTimeStamp']){var _0x401d31=0x0;for(_0x401d31=0x0;_0x401d31<this['privateTemFontsInfo']['length'];_0x401d31++)if(this['privateTemFontsInfo'][_0x401d31]['absTimeStamp']==_0x154cd5['absTimeStamp']){_0x372604=!0x0,_0x5a686c=_0x401d31;break;}}if(_0x372604){this['privateTemFontsInfo'][_0x5a686c]['nFontsNum']=_0x154cd5['nFontsNum'];for(var _0x24260d=0x0;_0x24260d<_0x154cd5['nFontsNum'];_0x24260d++)this['privateTemFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x24260d]={},this['privateTemFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x24260d]['nFontSizeW']=_0x154cd5['stDrawFontsArray'][_0x24260d]['nFontSizeW'],this['privateTemFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x24260d]['nFontSizeH']=_0x154cd5['stDrawFontsArray'][_0x24260d]['nFontSizeH'],this['privateTemFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x24260d]['dwMatchType']=_0x154cd5['stDrawFontsArray'][_0x24260d]['dwMatchType'],this['privateTemFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x24260d]['dwIntelFlag']=_0x154cd5['stDrawFontsArray'][_0x24260d]['dwIntelFlag'],this['privateTemFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x24260d]['dwSubIntelFlag']=_0x154cd5['stDrawFontsArray'][_0x24260d]['dwSubIntelFlag'],this['privateTemFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x24260d]['color']={},this['privateTemFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x24260d]['color']['R']=_0x154cd5['stDrawFontsArray'][_0x24260d]['color']['R'],this['privateTemFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x24260d]['color']['G']=_0x154cd5['stDrawFontsArray'][_0x24260d]['color']['G'],this['privateTemFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x24260d]['color']['B']=_0x154cd5['stDrawFontsArray'][_0x24260d]['color']['B'],this['privateTemFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x24260d]['color']['A']=_0x154cd5['stDrawFontsArray'][_0x24260d]['color']['A'],this['privateTemFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x24260d]['stPoint']={},this['privateTemFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x24260d]['stPoint']['x']=_0x154cd5['stDrawFontsArray'][_0x24260d]['stPoint']['x'],this['privateTemFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x24260d]['stPoint']['y']=_0x154cd5['stDrawFontsArray'][_0x24260d]['stPoint']['y'],this['privateTemFontsInfo'][_0x5a686c]['stDrawFontsArray'][_0x24260d]['fontString']=_0x154cd5['stDrawFontsArray'][_0x24260d]['fontString'];}else this['maxTemPrivateFontTimeStamp']<_0x154cd5['absTimeStamp']&&(this['maxTemPrivateFontTimeStamp']=_0x154cd5['absTimeStamp']),this['privateTemFontsInfo']['push'](_0x154cd5);}}if(_0x372604=!0x1,_0x5a686c=0x0,0x4==_0x522bad['nPixelFormat']){if(this['privateImageInfo']['length']>=_0x93593d&&this['privateImageInfo']['shift'](),_0x522bad['absTimeStamp']<=this['maxPrivateImageTimeStamp']){var _0x1d0e34=0x0;for(_0x1d0e34=0x0;_0x1d0e34<this['privateImageInfo']['length'];_0x1d0e34++)if(this['privateImageInfo'][_0x1d0e34]['absTimeStamp']==_0x522bad['absTimeStamp']){_0x372604=!0x0,_0x5a686c=_0x1d0e34;break;}}_0x372604?(this['privateImageInfo'][_0x5a686c]['nWidth']=_0x522bad['nWidth'],this['privateImageInfo'][_0x5a686c]['nHeight']=_0x522bad['nHeight'],this['privateImageInfo'][_0x5a686c]['pstRect']={},this['privateImageInfo'][_0x5a686c]['pstRect']['fTop']=_0x522bad['pstRect']['fTop'],this['privateImageInfo'][_0x5a686c]['pstRect']['fBottom']=_0x522bad['pstRect']['fBottom'],this['privateImageInfo'][_0x5a686c]['pstRect']['fLeft']=_0x522bad['pstRect']['fLeft'],this['privateImageInfo'][_0x5a686c]['pstRect']['fRight']=_0x522bad['pstRect']['fRight'],this['privateImageInfo'][_0x5a686c]['nPixelFormat']=_0x522bad['nPixelFormat'],this['privateImageInfo'][_0x5a686c]['fAlpha']=_0x522bad['fAlpha'],this['privateImageInfo'][_0x5a686c]['picImageData']=_0x522bad['picImageData']):(this['maxPrivateImageTimeStamp']<_0x522bad['absTimeStamp']&&(this['maxPrivateImageTimeStamp']=_0x522bad['absTimeStamp']),this['privateImageInfo']['push'](_0x522bad));}else{if(0x100==_0x522bad['nPixelFormat']&&null!=_0x522bad['picImageData'])try{var _0x3ce67a=new ImageDecoder({'data':_0x522bad['picImageData'],'type':'image/png'});_0x3ce67a['tracks']['ready']['then'](function(){return _0x3ce67a['completed'];})['then'](function(){return _0x3ce67a['decode']({'frameIndex':0x0});})['then'](function(_0x1336b2){_0x506d51['privatePNGImageInfo']['length']>=0x14&&_0x506d51['privatePNGImageInfo']['shift']();var _0x799f20=_0x506d51['privatePNGImageInfo']['findIndex'](function(_0x13a3bd){return _0x13a3bd['PicID']===_0x522bad['PicID'];});-0x1!==_0x799f20?_0x506d51['privatePNGImageInfo'][_0x799f20]=_0x2e0aef(_0x2e0aef({},_0x506d51['privatePNGImageInfo'][_0x799f20]),{},{'PicID':_0x522bad['PicID'],'videoStream':_0x1336b2['image'],'nImageWidth':_0x1336b2['image']['displayWidth'],'nImageHeight':_0x1336b2['image']['displayHeight'],'pstRectPos':{'fTop':_0x522bad['pstRect']['fTop'],'fBottom':_0x522bad['pstRect']['fBottom'],'fLeft':_0x522bad['pstRect']['fLeft'],'fRight':_0x522bad['pstRect']['fRight']},'nPixelFormat':_0x522bad['nPixelFormat'],'fAlpha':_0x522bad['fAlpha']}):_0x506d51['privatePNGImageInfo']['push']({'PicID':_0x522bad['PicID'],'videoStream':_0x1336b2['image'],'nImageWidth':_0x1336b2['image']['displayWidth'],'nImageHeight':_0x1336b2['image']['displayHeight'],'pstRectPos':{'fTop':_0x522bad['pstRect']['fTop'],'fBottom':_0x522bad['pstRect']['fBottom'],'fLeft':_0x522bad['pstRect']['fLeft'],'fRight':_0x522bad['pstRect']['fRight']},'nPixelFormat':_0x522bad['nPixelFormat'],'fAlpha':_0x522bad['fAlpha']});})['catch'](function(_0xd1cdbb){console['error']('Image\\x20processing\\x20failed:',_0xd1cdbb);});}catch(_0x34c7ac){console['error']('ImageDecoder\\x20initialization\\x20failed:',_0x34c7ac);}}return 0x1;}},{'key':'CheckLinesInfo','value':function(){if(this['DrawlinesParamArray']['splice'](0x0,this['DrawlinesParamArray']['length']),this['DrawlinesParamArrayAllPointNum']=0x0,this['bDrawlinesParamArrayFill']=0x0,this['DrawMosaiclinesParamArray']['splice'](0x0,this['DrawMosaiclinesParamArray']['length']),this['DrawTargetlinesParamArray']['splice'](0x0,this['DrawTargetlinesParamArray']['length']),null!=this['curNormalLinesInfo']){for(var _0x431599=[],_0x20f085=0x0,_0x402d75=0x0;_0x402d75<this['curNormalLinesInfo']['linesNum'];_0x402d75++)if(0x2==this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['dwIntelFlag']&&0x1==this['m_bEnableIVSEx']||0x7==this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['dwIntelFlag']&&0x1==this['m_bEnableFIREEx']&&(0x1==this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['dwSubIntelFlag']&&0x1==this['m_bEnableFireDis']||0x4==this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['dwSubIntelFlag']&&0x1==this['m_bEnableFireMaxPos'])||0x8==this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['dwIntelFlag']&&0x1==this['m_bEnableThermal']&&0x4==this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['dwSubIntelFlag']&&0x1==this['m_bEnableThermalTargetGas']||0x9==this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['dwIntelFlag']&&0x1==this['m_bEnableTrackEx']&&(0x1==this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['dwSubIntelFlag']&&0x1==this['m_bEnableTrackPeople']||0x2==this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['dwSubIntelFlag']&&0x1==this['m_bEnableTrackVehicle'])){_0x431599[_0x20f085]={},_0x431599[_0x20f085]['nPointNum']=this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['vertex_num'],_0x431599[_0x20f085]['nLineWidth']=this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['lineWidth'],this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['bFill'],_0x431599[_0x20f085]['bLoop']=this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['bLoop'],_0x431599[_0x20f085]['pstColor']={},_0x431599[_0x20f085]['pstColor']['fR']=this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['color']['R'],_0x431599[_0x20f085]['pstColor']['fG']=this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['color']['G'],_0x431599[_0x20f085]['pstColor']['fB']=this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['color']['B'],_0x431599[_0x20f085]['pstColor']['fA']=this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['color']['A'],_0x431599[_0x20f085]['pstPoints']=[];for(var _0x26a96a=0x0;_0x26a96a<_0x431599[_0x20f085]['nPointNum'];_0x26a96a++)_0x431599[_0x20f085]['pstPoints'][_0x26a96a]={},_0x431599[_0x20f085]['pstPoints'][_0x26a96a]['fX']=this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['stPoint'][_0x26a96a]['x'],_0x431599[_0x20f085]['pstPoints'][_0x26a96a]['fY']=this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['stPoint'][_0x26a96a]['y'];_0x431599[_0x20f085]['dwMosaictype']=this['curNormalLinesInfo']['stDrawLinesArray'][_0x402d75]['dwMosaictype'],_0x431599[_0x20f085]['dwMosaictype']?this['DrawMosaiclinesParamArray']['push'](_0x431599[_0x20f085]):(this['DrawlinesParamArray']['push'](_0x431599[_0x20f085]),this['DrawlinesParamArrayAllPointNum']+=_0x431599[_0x20f085]['nPointNum'],_0x431599[_0x20f085]['nPointNum']),++_0x20f085;}}if(null!=this['curThermalLinesInfo']){for(var _0x270e4d=[],_0x483290=0x0,_0x4f697d=0x0;_0x4f697d<this['curThermalLinesInfo']['linesNum'];_0x4f697d++)if(0x8==this['curThermalLinesInfo']['stDrawLinesArray'][_0x4f697d]['dwIntelFlag']&&0x1==this['m_bEnableThermal']&&(0x1==this['curThermalLinesInfo']['stDrawLinesArray'][_0x4f697d]['dwSubIntelFlag']&&0x1==this['m_bEnableThermalFireMask']||0x2==this['curThermalLinesInfo']['stDrawLinesArray'][_0x4f697d]['dwSubIntelFlag']&&0x1==this['m_bEnableThermalRuleGas'])){_0x270e4d[_0x483290]={},_0x270e4d[_0x483290]['nPointNum']=this['curThermalLinesInfo']['stDrawLinesArray'][_0x4f697d]['vertex_num'],_0x270e4d[_0x483290]['nLineWidth']=this['curThermalLinesInfo']['stDrawLinesArray'][_0x4f697d]['lineWidth'],this['curThermalLinesInfo']['stDrawLinesArray'][_0x4f697d]['bFill'],_0x270e4d[_0x483290]['bLoop']=this['curThermalLinesInfo']['stDrawLinesArray'][_0x4f697d]['bLoop'],_0x270e4d[_0x483290]['pstColor']={},_0x270e4d[_0x483290]['pstColor']['fR']=this['curThermalLinesInfo']['stDrawLinesArray'][_0x4f697d]['color']['R'],_0x270e4d[_0x483290]['pstColor']['fG']=this['curThermalLinesInfo']['stDrawLinesArray'][_0x4f697d]['color']['G'],_0x270e4d[_0x483290]['pstColor']['fB']=this['curThermalLinesInfo']['stDrawLinesArray'][_0x4f697d]['color']['B'],_0x270e4d[_0x483290]['pstColor']['fA']=this['curThermalLinesInfo']['stDrawLinesArray'][_0x4f697d]['color']['A'],_0x270e4d[_0x483290]['pstPoints']=[];for(var _0x1d0063=0x0;_0x1d0063<_0x270e4d[_0x483290]['nPointNum'];_0x1d0063++)_0x270e4d[_0x483290]['pstPoints'][_0x1d0063]={},_0x270e4d[_0x483290]['pstPoints'][_0x1d0063]['fX']=this['curThermalLinesInfo']['stDrawLinesArray'][_0x4f697d]['stPoint'][_0x1d0063]['x'],_0x270e4d[_0x483290]['pstPoints'][_0x1d0063]['fY']=this['curThermalLinesInfo']['stDrawLinesArray'][_0x4f697d]['stPoint'][_0x1d0063]['y'];this['DrawlinesParamArray']['push'](_0x270e4d[_0x483290]),this['DrawlinesParamArrayAllPointNum']+=_0x270e4d[_0x483290]['nPointNum'],_0x270e4d[_0x483290]['nPointNum'],++_0x483290;}}if(null!=this['curTemLinesInfo']){for(var _0x105410=[],_0x30abe9=0x0,_0x438b26=0x0;_0x438b26<this['curTemLinesInfo']['linesNum'];_0x438b26++)if(0x1==this['m_bEnableTEMEx']&&(0x1==this['curTemLinesInfo']['stDrawLinesArray'][_0x438b26]['dwSubIntelFlag']&&0x1==this['m_bEnableTEMBox']||0x2==this['curTemLinesInfo']['stDrawLinesArray'][_0x438b26]['dwSubIntelFlag']&&0x1==this['m_bEnableTEMLine']||0x4==this['curTemLinesInfo']['stDrawLinesArray'][_0x438b26]['dwSubIntelFlag']&&0x1==this['m_bEnableTEMPoint'])){_0x105410[_0x30abe9]={},_0x105410[_0x30abe9]['nPointNum']=this['curTemLinesInfo']['stDrawLinesArray'][_0x438b26]['vertex_num'],_0x105410[_0x30abe9]['nLineWidth']=this['curTemLinesInfo']['stDrawLinesArray'][_0x438b26]['lineWidth'],this['curTemLinesInfo']['stDrawLinesArray'][_0x438b26]['bFill'],_0x105410[_0x30abe9]['bLoop']=this['curTemLinesInfo']['stDrawLinesArray'][_0x438b26]['bLoop'],_0x105410[_0x30abe9]['pstColor']={},_0x105410[_0x30abe9]['pstColor']['fR']=this['curTemLinesInfo']['stDrawLinesArray'][_0x438b26]['color']['R'],_0x105410[_0x30abe9]['pstColor']['fG']=this['curTemLinesInfo']['stDrawLinesArray'][_0x438b26]['color']['G'],_0x105410[_0x30abe9]['pstColor']['fB']=this['curTemLinesInfo']['stDrawLinesArray'][_0x438b26]['color']['B'],_0x105410[_0x30abe9]['pstColor']['fA']=this['curTemLinesInfo']['stDrawLinesArray'][_0x438b26]['color']['A'],_0x105410[_0x30abe9]['pstPoints']=[];for(var _0x5464ca=0x0;_0x5464ca<_0x105410[_0x30abe9]['nPointNum'];_0x5464ca++)_0x105410[_0x30abe9]['pstPoints'][_0x5464ca]={},_0x105410[_0x30abe9]['pstPoints'][_0x5464ca]['fX']=this['curTemLinesInfo']['stDrawLinesArray'][_0x438b26]['stPoint'][_0x5464ca]['x'],_0x105410[_0x30abe9]['pstPoints'][_0x5464ca]['fY']=this['curTemLinesInfo']['stDrawLinesArray'][_0x438b26]['stPoint'][_0x5464ca]['y'];this['DrawlinesParamArray']['push'](_0x105410[_0x30abe9]),this['DrawlinesParamArrayAllPointNum']+=_0x105410[_0x30abe9]['nPointNum'],_0x105410[_0x30abe9]['nPointNum'],++_0x30abe9;}}if(null!=this['curTargetLinesInfo']){for(var _0x2add9e=[],_0x120e90=0x0,_0x589876=0x0;_0x589876<this['curTargetLinesInfo']['linesNum'];_0x589876++)if(0x1==this['m_bEnableIVSEx']){_0x2add9e[_0x120e90]={},_0x2add9e[_0x120e90]['nPointNum']=this['curTargetLinesInfo']['stDrawLinesArray'][_0x589876]['vertex_num'],_0x2add9e[_0x120e90]['nLineWidth']=this['curTargetLinesInfo']['stDrawLinesArray'][_0x589876]['lineWidth'],this['curTargetLinesInfo']['stDrawLinesArray'][_0x589876]['bFill'],_0x2add9e[_0x120e90]['bLoop']=this['curTargetLinesInfo']['stDrawLinesArray'][_0x589876]['bLoop'],_0x2add9e[_0x120e90]['pstColor']={},_0x2add9e[_0x120e90]['pstColor']['fR']=this['curTargetLinesInfo']['stDrawLinesArray'][_0x589876]['color']['R'],_0x2add9e[_0x120e90]['pstColor']['fG']=this['curTargetLinesInfo']['stDrawLinesArray'][_0x589876]['color']['G'],_0x2add9e[_0x120e90]['pstColor']['fB']=this['curTargetLinesInfo']['stDrawLinesArray'][_0x589876]['color']['B'],_0x2add9e[_0x120e90]['pstColor']['fA']=this['curTargetLinesInfo']['stDrawLinesArray'][_0x589876]['color']['A'],_0x2add9e[_0x120e90]['pstPoints']=[];for(var _0x23e914=0x0;_0x23e914<_0x2add9e[_0x120e90]['nPointNum'];_0x23e914++)_0x2add9e[_0x120e90]['pstPoints'][_0x23e914]={},_0x2add9e[_0x120e90]['pstPoints'][_0x23e914]['fX']=this['curTargetLinesInfo']['stDrawLinesArray'][_0x589876]['stPoint'][_0x23e914]['x'],_0x2add9e[_0x120e90]['pstPoints'][_0x23e914]['fY']=this['curTargetLinesInfo']['stDrawLinesArray'][_0x589876]['stPoint'][_0x23e914]['y'];_0x2add9e[_0x120e90]['dwFillPicID']=this['curTargetLinesInfo']['stDrawLinesArray'][_0x589876]['dwFillPicID'],_0x2add9e[_0x120e90]['eventid']=this['curTargetLinesInfo']['stDrawLinesArray'][_0x589876]['eventid'],this['DrawTargetlinesParamArray']['push'](_0x2add9e[_0x120e90]),++_0x120e90;}}if(null!=this['curMDLinesInfo']){for(var _0x301a20=[],_0x488889=0x0,_0x587018=0x0;_0x587018<this['curMDLinesInfo']['linesNum'];_0x587018++)if(0x1==this['m_bEnableMDEx']){_0x301a20[_0x488889]={},_0x301a20[_0x488889]['nPointNum']=this['curMDLinesInfo']['stDrawLinesArray'][_0x587018]['vertex_num'],_0x301a20[_0x488889]['nLineWidth']=this['curMDLinesInfo']['stDrawLinesArray'][_0x587018]['lineWidth'],this['curMDLinesInfo']['stDrawLinesArray'][_0x587018]['bFill'],_0x301a20[_0x488889]['bLoop']=this['curMDLinesInfo']['stDrawLinesArray'][_0x587018]['bLoop'],_0x301a20[_0x488889]['pstColor']={},_0x301a20[_0x488889]['pstColor']['fR']=this['curMDLinesInfo']['stDrawLinesArray'][_0x587018]['color']['R'],_0x301a20[_0x488889]['pstColor']['fG']=this['curMDLinesInfo']['stDrawLinesArray'][_0x587018]['color']['G'],_0x301a20[_0x488889]['pstColor']['fB']=this['curMDLinesInfo']['stDrawLinesArray'][_0x587018]['color']['B'],_0x301a20[_0x488889]['pstColor']['fA']=this['curMDLinesInfo']['stDrawLinesArray'][_0x587018]['color']['A'],_0x301a20[_0x488889]['pstPoints']=[];for(var _0x30c538=0x0;_0x30c538<_0x301a20[_0x488889]['nPointNum'];_0x30c538++)_0x301a20[_0x488889]['pstPoints'][_0x30c538]={},_0x301a20[_0x488889]['pstPoints'][_0x30c538]['fX']=this['curMDLinesInfo']['stDrawLinesArray'][_0x587018]['stPoint'][_0x30c538]['x'],_0x301a20[_0x488889]['pstPoints'][_0x30c538]['fY']=this['curMDLinesInfo']['stDrawLinesArray'][_0x587018]['stPoint'][_0x30c538]['y'];this['DrawlinesParamArray']['push'](_0x301a20[_0x488889]),this['DrawlinesParamArrayAllPointNum']+=_0x301a20[_0x488889]['nPointNum'],_0x301a20[_0x488889]['nPointNum'],++_0x488889;}}if(null!=this['curExactLinesInfo']){for(var _0x4e05e6=[],_0x39b552=0x0,_0x3310fc=0x0;_0x3310fc<this['curExactLinesInfo']['linesNum'];_0x3310fc++)if(0x1==this['curExactLinesInfo']['stDrawLinesArray'][_0x3310fc]['dwIntelFlag']&&0x1==this['m_bEnableIVSEx']||0x9==this['curExactLinesInfo']['stDrawLinesArray'][_0x3310fc]['dwIntelFlag']&&0x1==this['m_bEnableTrackEx']&&(0x1==this['curExactLinesInfo']['stDrawLinesArray'][_0x3310fc]['dwSubIntelFlag']&&0x1==this['m_bEnableTrackPeople']||0x2==this['curExactLinesInfo']['stDrawLinesArray'][_0x3310fc]['dwSubIntelFlag']&&0x1==this['m_bEnableTrackVehicle'])){_0x4e05e6[_0x39b552]={},_0x4e05e6[_0x39b552]['nPointNum']=this['curExactLinesInfo']['stDrawLinesArray'][_0x3310fc]['vertex_num'],_0x4e05e6[_0x39b552]['nLineWidth']=this['curExactLinesInfo']['stDrawLinesArray'][_0x3310fc]['lineWidth'],this['curExactLinesInfo']['stDrawLinesArray'][_0x3310fc]['bFill'],_0x4e05e6[_0x39b552]['bLoop']=this['curExactLinesInfo']['stDrawLinesArray'][_0x3310fc]['bLoop'],_0x4e05e6[_0x39b552]['pstColor']={},_0x4e05e6[_0x39b552]['pstColor']['fR']=this['curExactLinesInfo']['stDrawLinesArray'][_0x3310fc]['color']['R'],_0x4e05e6[_0x39b552]['pstColor']['fG']=this['curExactLinesInfo']['stDrawLinesArray'][_0x3310fc]['color']['G'],_0x4e05e6[_0x39b552]['pstColor']['fB']=this['curExactLinesInfo']['stDrawLinesArray'][_0x3310fc]['color']['B'],_0x4e05e6[_0x39b552]['pstColor']['fA']=this['curExactLinesInfo']['stDrawLinesArray'][_0x3310fc]['color']['A'],_0x4e05e6[_0x39b552]['pstPoints']=[];for(var _0x4ba139=0x0;_0x4ba139<_0x4e05e6[_0x39b552]['nPointNum'];_0x4ba139++)_0x4e05e6[_0x39b552]['pstPoints'][_0x4ba139]={},_0x4e05e6[_0x39b552]['pstPoints'][_0x4ba139]['fX']=this['curExactLinesInfo']['stDrawLinesArray'][_0x3310fc]['stPoint'][_0x4ba139]['x'],_0x4e05e6[_0x39b552]['pstPoints'][_0x4ba139]['fY']=this['curExactLinesInfo']['stDrawLinesArray'][_0x3310fc]['stPoint'][_0x4ba139]['y'];_0x4e05e6[_0x39b552]['dwFillPicID']=this['curExactLinesInfo']['stDrawLinesArray'][_0x3310fc]['dwFillPicID'],_0x4e05e6[_0x39b552]['eventid']=this['curExactLinesInfo']['stDrawLinesArray'][_0x3310fc]['eventid'],_0x4e05e6[_0x39b552]['dwMosaictype']=this['curExactLinesInfo']['stDrawLinesArray'][_0x3310fc]['dwMosaictype'],_0x4e05e6[_0x39b552]['dwMosaictype']?this['DrawMosaiclinesParamArray']['push'](_0x4e05e6[_0x39b552]):this['DrawTargetlinesParamArray']['push'](_0x4e05e6[_0x39b552]),++_0x39b552;}}if(null!=this['curExactRuleLinesInfo']){for(var _0x1c42c4=[],_0x3e87d0=0x0,_0x442f54=0x0;_0x442f54<this['curExactRuleLinesInfo']['linesNum'];_0x442f54++)if(0x1==this['m_bEnableIVSEx']){_0x1c42c4[_0x3e87d0]={},_0x1c42c4[_0x3e87d0]['nPointNum']=this['curExactRuleLinesInfo']['stDrawLinesArray'][_0x442f54]['vertex_num'],_0x1c42c4[_0x3e87d0]['nLineWidth']=this['curExactRuleLinesInfo']['stDrawLinesArray'][_0x442f54]['lineWidth'],this['curExactRuleLinesInfo']['stDrawLinesArray'][_0x442f54]['bFill'],_0x1c42c4[_0x3e87d0]['bLoop']=this['curExactRuleLinesInfo']['stDrawLinesArray'][_0x442f54]['bLoop'],_0x1c42c4[_0x3e87d0]['pstColor']={},_0x1c42c4[_0x3e87d0]['pstColor']['fR']=this['curExactRuleLinesInfo']['stDrawLinesArray'][_0x442f54]['color']['R'],_0x1c42c4[_0x3e87d0]['pstColor']['fG']=this['curExactRuleLinesInfo']['stDrawLinesArray'][_0x442f54]['color']['G'],_0x1c42c4[_0x3e87d0]['pstColor']['fB']=this['curExactRuleLinesInfo']['stDrawLinesArray'][_0x442f54]['color']['B'],_0x1c42c4[_0x3e87d0]['pstColor']['fA']=this['curExactRuleLinesInfo']['stDrawLinesArray'][_0x442f54]['color']['A'],_0x1c42c4[_0x3e87d0]['pstPoints']=[];for(var _0xce440b=0x0;_0xce440b<_0x1c42c4[_0x3e87d0]['nPointNum'];_0xce440b++)_0x1c42c4[_0x3e87d0]['pstPoints'][_0xce440b]={},_0x1c42c4[_0x3e87d0]['pstPoints'][_0xce440b]['fX']=this['curExactRuleLinesInfo']['stDrawLinesArray'][_0x442f54]['stPoint'][_0xce440b]['x'],_0x1c42c4[_0x3e87d0]['pstPoints'][_0xce440b]['fY']=this['curExactRuleLinesInfo']['stDrawLinesArray'][_0x442f54]['stPoint'][_0xce440b]['y'];this['DrawlinesParamArray']['push'](_0x1c42c4[_0x3e87d0]),this['DrawlinesParamArrayAllPointNum']+=_0x1c42c4[_0x3e87d0]['nPointNum'],_0x1c42c4[_0x3e87d0]['nPointNum'],++_0x3e87d0;}}}},{'key':'CheckFontsInfo','value':function(){if(this['DrawFontParamArray']['splice'](0x0,this['DrawFontParamArray']['length']),this['DrawPOSFontsParamArray']['splice'](0x0,this['DrawPOSFontsParamArray']['length']),null!=this['curNormalFontsInfo']){for(var _0x383762=[],_0x1867de=0x0,_0x5aaa43=0x0;_0x5aaa43<this['curNormalFontsInfo']['nFontsNum'];_0x5aaa43++)0x7==this['curNormalFontsInfo']['stDrawFontsArray'][_0x5aaa43]['dwIntelFlag']&&0x1==this['m_bEnableFIREEx']&&(0x1==this['curNormalFontsInfo']['stDrawFontsArray'][_0x5aaa43]['dwSubIntelFlag']&&0x1==this['m_bEnableFireDis']||0x8==this['curNormalFontsInfo']['stDrawFontsArray'][_0x5aaa43]['dwSubIntelFlag']&&0x1==this['m_bEnableFireDistance'])&&(_0x383762[_0x1867de]={},_0x383762[_0x1867de]['pString']=this['curNormalFontsInfo']['stDrawFontsArray'][_0x5aaa43]['fontString'],_0x383762[_0x1867de]['nFontWidth']=this['curNormalFontsInfo']['stDrawFontsArray'][_0x5aaa43]['nFontSizeW'],_0x383762[_0x1867de]['nFontHeight']=this['curNormalFontsInfo']['stDrawFontsArray'][_0x5aaa43]['nFontSizeH'],_0x383762[_0x1867de]['pstStartPos']={},_0x383762[_0x1867de]['pstStartPos']['fX']=this['curNormalFontsInfo']['stDrawFontsArray'][_0x5aaa43]['stPoint']['x'],_0x383762[_0x1867de]['pstStartPos']['fY']=this['curNormalFontsInfo']['stDrawFontsArray'][_0x5aaa43]['stPoint']['y'],_0x383762[_0x1867de]['pstFontColor']={},_0x383762[_0x1867de]['pstFontColor']['fR']=this['curNormalFontsInfo']['stDrawFontsArray'][_0x5aaa43]['color']['R'],_0x383762[_0x1867de]['pstFontColor']['fG']=this['curNormalFontsInfo']['stDrawFontsArray'][_0x5aaa43]['color']['G'],_0x383762[_0x1867de]['pstFontColor']['fB']=this['curNormalFontsInfo']['stDrawFontsArray'][_0x5aaa43]['color']['B'],_0x383762[_0x1867de]['pstFontColor']['fA']=this['curNormalFontsInfo']['stDrawFontsArray'][_0x5aaa43]['color']['A'],_0x383762[_0x1867de]['bBackGround']=!0x1,_0x383762[_0x1867de]['pstBGColor']=null,_0x383762[_0x1867de]['fRotateAngle']=0x0,_0x383762[_0x1867de]['pFontFamily']='sans-serif',this['DrawFontParamArray']['push'](_0x383762[_0x1867de]),++_0x1867de);}if(null!=this['curNormalPOSFontsInfo']){for(var _0x17fb2c=[],_0x41da70=0x0,_0x30d253=0x0;_0x30d253<this['curNormalPOSFontsInfo']['nFontsNum'];_0x30d253++)0x1==this['m_bDisPos']&&(_0x17fb2c[_0x41da70]={},_0x17fb2c[_0x41da70]['pString']=this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x30d253]['fontString'],_0x17fb2c[_0x41da70]['nFontWidth']=this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x30d253]['nFontSizeW'],_0x17fb2c[_0x41da70]['nFontHeight']=this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x30d253]['nFontSizeH'],_0x17fb2c[_0x41da70]['pstStartPos']={},_0x17fb2c[_0x41da70]['pstStartPos']['fX']=this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x30d253]['stPoint']['x'],_0x17fb2c[_0x41da70]['pstStartPos']['fY']=this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x30d253]['stPoint']['y'],_0x17fb2c[_0x41da70]['pstFontColor']={},_0x17fb2c[_0x41da70]['pstFontColor']['fR']=this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x30d253]['color']['R'],_0x17fb2c[_0x41da70]['pstFontColor']['fG']=this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x30d253]['color']['G'],_0x17fb2c[_0x41da70]['pstFontColor']['fB']=this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x30d253]['color']['B'],_0x17fb2c[_0x41da70]['pstFontColor']['fA']=this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x30d253]['color']['A'],_0x17fb2c[_0x41da70]['bBackGround']=this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x30d253]['bBackGround'],_0x17fb2c[_0x41da70]['pstBGColor']={},_0x17fb2c[_0x41da70]['pstBGColor']['fR']=this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x30d253]['BGcolor']['R'],_0x17fb2c[_0x41da70]['pstBGColor']['fG']=this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x30d253]['BGcolor']['G'],_0x17fb2c[_0x41da70]['pstBGColor']['fB']=this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x30d253]['BGcolor']['B'],_0x17fb2c[_0x41da70]['pstBGColor']['fA']=this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x30d253]['BGcolor']['A'],_0x17fb2c[_0x41da70]['fRotateAngle']=0x0,_0x17fb2c[_0x41da70]['pFontFamily']='sans-serif',_0x17fb2c[_0x41da70]['EventID']=this['curNormalPOSFontsInfo']['stDrawFontsArray'][_0x30d253]['EventID'],this['DrawPOSFontsParamArray']['push'](_0x17fb2c[_0x41da70]),++_0x41da70);}if(null!=this['curTemFontsInfo']){for(var _0x2a84d2=[],_0x5d1b13=0x0,_0x1633bb=0x0;_0x1633bb<this['curTemFontsInfo']['nFontsNum'];_0x1633bb++)0x1==this['m_bEnableTEMEx']&&(0x1==this['curTemFontsInfo']['stDrawFontsArray'][_0x1633bb]['dwSubIntelFlag']&&0x1==this['m_bEnableTEMBox']||0x2==this['curTemFontsInfo']['stDrawFontsArray'][_0x1633bb]['dwSubIntelFlag']&&0x1==this['m_bEnableTEMLine']||0x4==this['curTemFontsInfo']['stDrawFontsArray'][_0x1633bb]['dwSubIntelFlag']&&0x1==this['m_bEnableTEMPoint'])&&(_0x2a84d2[_0x5d1b13]={},_0x2a84d2[_0x5d1b13]['pString']=this['curTemFontsInfo']['stDrawFontsArray'][_0x1633bb]['fontString'],_0x2a84d2[_0x5d1b13]['nFontWidth']=this['curTemFontsInfo']['stDrawFontsArray'][_0x1633bb]['nFontSizeW'],_0x2a84d2[_0x5d1b13]['nFontHeight']=this['curTemFontsInfo']['stDrawFontsArray'][_0x1633bb]['nFontSizeH'],_0x2a84d2[_0x5d1b13]['pstStartPos']={},_0x2a84d2[_0x5d1b13]['pstStartPos']['fX']=this['curTemFontsInfo']['stDrawFontsArray'][_0x1633bb]['stPoint']['x'],_0x2a84d2[_0x5d1b13]['pstStartPos']['fY']=this['curTemFontsInfo']['stDrawFontsArray'][_0x1633bb]['stPoint']['y'],_0x2a84d2[_0x5d1b13]['pstFontColor']={},_0x2a84d2[_0x5d1b13]['pstFontColor']['fR']=this['curTemFontsInfo']['stDrawFontsArray'][_0x1633bb]['color']['R'],_0x2a84d2[_0x5d1b13]['pstFontColor']['fG']=this['curTemFontsInfo']['stDrawFontsArray'][_0x1633bb]['color']['G'],_0x2a84d2[_0x5d1b13]['pstFontColor']['fB']=this['curTemFontsInfo']['stDrawFontsArray'][_0x1633bb]['color']['B'],_0x2a84d2[_0x5d1b13]['pstFontColor']['fA']=this['curTemFontsInfo']['stDrawFontsArray'][_0x1633bb]['color']['A'],_0x2a84d2[_0x5d1b13]['bBackGround']=!0x1,_0x2a84d2[_0x5d1b13]['pstBGColor']=null,_0x2a84d2[_0x5d1b13]['fRotateAngle']=0x0,_0x2a84d2[_0x5d1b13]['pFontFamily']='sans-serif',this['DrawFontParamArray']['push'](_0x2a84d2[_0x5d1b13]),++_0x5d1b13);}if(null!=this['curTargetFontsInfo']){for(var _0x3f2dd6=[],_0x1cd56b=0x0,_0x3391eb=0x0;_0x3391eb<this['curTargetFontsInfo']['nFontsNum'];_0x3391eb++)0x1==this['m_bEnableIVSEx']&&(_0x3f2dd6[_0x1cd56b]={},_0x3f2dd6[_0x1cd56b]['pString']=this['curTargetFontsInfo']['stDrawFontsArray'][_0x3391eb]['fontString'],_0x3f2dd6[_0x1cd56b]['nFontWidth']=this['curTargetFontsInfo']['stDrawFontsArray'][_0x3391eb]['nFontSizeW'],_0x3f2dd6[_0x1cd56b]['nFontHeight']=this['curTargetFontsInfo']['stDrawFontsArray'][_0x3391eb]['nFontSizeH'],_0x3f2dd6[_0x1cd56b]['pstStartPos']={},_0x3f2dd6[_0x1cd56b]['pstStartPos']['fX']=this['curTargetFontsInfo']['stDrawFontsArray'][_0x3391eb]['stPoint']['x'],_0x3f2dd6[_0x1cd56b]['pstStartPos']['fY']=this['curTargetFontsInfo']['stDrawFontsArray'][_0x3391eb]['stPoint']['y'],_0x3f2dd6[_0x1cd56b]['pstFontColor']={},_0x3f2dd6[_0x1cd56b]['pstFontColor']['fR']=this['curTargetFontsInfo']['stDrawFontsArray'][_0x3391eb]['color']['R'],_0x3f2dd6[_0x1cd56b]['pstFontColor']['fG']=this['curTargetFontsInfo']['stDrawFontsArray'][_0x3391eb]['color']['G'],_0x3f2dd6[_0x1cd56b]['pstFontColor']['fB']=this['curTargetFontsInfo']['stDrawFontsArray'][_0x3391eb]['color']['B'],_0x3f2dd6[_0x1cd56b]['pstFontColor']['fA']=this['curTargetFontsInfo']['stDrawFontsArray'][_0x3391eb]['color']['A'],_0x3f2dd6[_0x1cd56b]['bBackGround']=this['curTargetFontsInfo']['stDrawFontsArray'][_0x3391eb]['bBackGround'],_0x3f2dd6[_0x1cd56b]['pstBGColor']={},_0x3f2dd6[_0x1cd56b]['pstBGColor']['fR']=this['curTargetFontsInfo']['stDrawFontsArray'][_0x3391eb]['BGcolor']['R'],_0x3f2dd6[_0x1cd56b]['pstBGColor']['fG']=this['curTargetFontsInfo']['stDrawFontsArray'][_0x3391eb]['BGcolor']['G'],_0x3f2dd6[_0x1cd56b]['pstBGColor']['fB']=this['curTargetFontsInfo']['stDrawFontsArray'][_0x3391eb]['BGcolor']['B'],_0x3f2dd6[_0x1cd56b]['pstBGColor']['fA']=this['curTargetFontsInfo']['stDrawFontsArray'][_0x3391eb]['BGcolor']['A'],_0x3f2dd6[_0x1cd56b]['fRotateAngle']=0x0,_0x3f2dd6[_0x1cd56b]['pFontFamily']='sans-serif',this['DrawFontParamArray']['push'](_0x3f2dd6[_0x1cd56b]),++_0x1cd56b);}if(null!=this['curExactFontsInfo']){for(var _0x52dbe0=[],_0x3aae6=0x0,_0x255692=0x0;_0x255692<this['curExactFontsInfo']['nFontsNum'];_0x255692++)0x1==this['curExactFontsInfo']['stDrawFontsArray'][_0x255692]['dwIntelFlag']&&0x1==this['m_bEnableIVSEx']&&(_0x52dbe0[_0x3aae6]={},_0x52dbe0[_0x3aae6]['pString']=this['curExactFontsInfo']['stDrawFontsArray'][_0x255692]['fontString'],_0x52dbe0[_0x3aae6]['nFontWidth']=this['curExactFontsInfo']['stDrawFontsArray'][_0x255692]['nFontSizeW'],_0x52dbe0[_0x3aae6]['nFontHeight']=this['curExactFontsInfo']['stDrawFontsArray'][_0x255692]['nFontSizeH'],_0x52dbe0[_0x3aae6]['pstStartPos']={},_0x52dbe0[_0x3aae6]['pstStartPos']['fX']=this['curExactFontsInfo']['stDrawFontsArray'][_0x255692]['stPoint']['x'],_0x52dbe0[_0x3aae6]['pstStartPos']['fY']=this['curExactFontsInfo']['stDrawFontsArray'][_0x255692]['stPoint']['y'],_0x52dbe0[_0x3aae6]['pstFontColor']={},_0x52dbe0[_0x3aae6]['pstFontColor']['fR']=this['curExactFontsInfo']['stDrawFontsArray'][_0x255692]['color']['R'],_0x52dbe0[_0x3aae6]['pstFontColor']['fG']=this['curExactFontsInfo']['stDrawFontsArray'][_0x255692]['color']['G'],_0x52dbe0[_0x3aae6]['pstFontColor']['fB']=this['curExactFontsInfo']['stDrawFontsArray'][_0x255692]['color']['B'],_0x52dbe0[_0x3aae6]['pstFontColor']['fA']=this['curExactFontsInfo']['stDrawFontsArray'][_0x255692]['color']['A'],_0x52dbe0[_0x3aae6]['bBackGround']=this['curExactFontsInfo']['stDrawFontsArray'][_0x255692]['bBackGround'],_0x52dbe0[_0x3aae6]['pstBGColor']={},_0x52dbe0[_0x3aae6]['pstBGColor']['fR']=this['curExactFontsInfo']['stDrawFontsArray'][_0x255692]['BGcolor']['R'],_0x52dbe0[_0x3aae6]['pstBGColor']['fG']=this['curExactFontsInfo']['stDrawFontsArray'][_0x255692]['BGcolor']['G'],_0x52dbe0[_0x3aae6]['pstBGColor']['fB']=this['curExactFontsInfo']['stDrawFontsArray'][_0x255692]['BGcolor']['B'],_0x52dbe0[_0x3aae6]['pstBGColor']['fA']=this['curExactFontsInfo']['stDrawFontsArray'][_0x255692]['BGcolor']['A'],_0x52dbe0[_0x3aae6]['fRotateAngle']=0x0,_0x52dbe0[_0x3aae6]['pFontFamily']='sans-serif',this['DrawFontParamArray']['push'](_0x52dbe0[_0x3aae6]),++_0x3aae6);}if(null!=this['curExactPOSFontsInfo']){for(var _0x4f114d=[],_0x481f62=0x0,_0x1295c9=0x0;_0x1295c9<this['curExactPOSFontsInfo']['nFontsNum'];_0x1295c9++)0x3==this['curExactPOSFontsInfo']['stDrawFontsArray'][_0x1295c9]['dwIntelFlag']&&0x1==this['m_bDisPos']&&(_0x4f114d[_0x481f62]={},_0x4f114d[_0x481f62]['pString']=this['curExactPOSFontsInfo']['stDrawFontsArray'][_0x1295c9]['fontString'],_0x4f114d[_0x481f62]['nFontWidth']=this['curExactPOSFontsInfo']['stDrawFontsArray'][_0x1295c9]['nFontSizeW'],_0x4f114d[_0x481f62]['nFontHeight']=this['curExactPOSFontsInfo']['stDrawFontsArray'][_0x1295c9]['nFontSizeH'],_0x4f114d[_0x481f62]['pstStartPos']={},_0x4f114d[_0x481f62]['pstStartPos']['fX']=this['curExactPOSFontsInfo']['stDrawFontsArray'][_0x1295c9]['stPoint']['x'],_0x4f114d[_0x481f62]['pstStartPos']['fY']=this['curExactPOSFontsInfo']['stDrawFontsArray'][_0x1295c9]['stPoint']['y'],_0x4f114d[_0x481f62]['pstFontColor']={},_0x4f114d[_0x481f62]['pstFontColor']['fR']=this['curExactPOSFontsInfo']['stDrawFontsArray'][_0x1295c9]['color']['R'],_0x4f114d[_0x481f62]['pstFontColor']['fG']=this['curExactPOSFontsInfo']['stDrawFontsArray'][_0x1295c9]['color']['G'],_0x4f114d[_0x481f62]['pstFontColor']['fB']=this['curExactPOSFontsInfo']['stDrawFontsArray'][_0x1295c9]['color']['B'],_0x4f114d[_0x481f62]['pstFontColor']['fA']=this['curExactPOSFontsInfo']['stDrawFontsArray'][_0x1295c9]['color']['A'],_0x4f114d[_0x481f62]['bBackGround']=this['curExactPOSFontsInfo']['stDrawFontsArray'][_0x1295c9]['bBackGround'],_0x4f114d[_0x481f62]['pstBGColor']={},_0x4f114d[_0x481f62]['pstBGColor']['fR']=this['curExactPOSFontsInfo']['stDrawFontsArray'][_0x1295c9]['BGcolor']['R'],_0x4f114d[_0x481f62]['pstBGColor']['fG']=this['curExactPOSFontsInfo']['stDrawFontsArray'][_0x1295c9]['BGcolor']['G'],_0x4f114d[_0x481f62]['pstBGColor']['fB']=this['curExactPOSFontsInfo']['stDrawFontsArray'][_0x1295c9]['BGcolor']['B'],_0x4f114d[_0x481f62]['pstBGColor']['fA']=this['curExactPOSFontsInfo']['stDrawFontsArray'][_0x1295c9]['BGcolor']['A'],_0x4f114d[_0x481f62]['fRotateAngle']=0x0,_0x4f114d[_0x481f62]['pFontFamily']='sans-serif',_0x4f114d[_0x481f62]['EventID']=this['curExactPOSFontsInfo']['stDrawFontsArray'][_0x1295c9]['EventID'],this['DrawPOSFontsParamArray']['push'](_0x4f114d[_0x481f62]),++_0x481f62);}}},{'key':'WebGLDisplaySubCallBack','value':function(_0xf73759){null!=_0xf73759['handle']&&0x0!=_0xf73759['nUser']['pstWaterFontParamArray'][_0xf73759['nSubPort']]&&null!=_0xf73759['nUser']['pstWaterFontParam']&&_0xf73759['handle']['SR_DrawFontEx'](_0xf73759['nUser']['pstWaterFontParamArray'][_0xf73759['nSubPort']],_0xf73759['nUser']['pstWaterFontParamArray'][_0xf73759['nSubPort']]['length'],0x1,_0xf73759['nUser']['textCanvas']);}},{'key':'WebGLDisplayCallBack','value':function(_0x429c4e){0x0!=_0x429c4e['DrawlinesParamArray']['length']&&_0x429c4e['oVideoHandle']['SR_DrawLinesEx'](_0x429c4e['DrawlinesParamArray'],_0x429c4e['DrawlinesParamArray']['length'],_0x429c4e['DrawlinesParamArrayAllPointNum'],_0x429c4e['bDrawlinesParamArrayFill']);for(var _0x2c80b9=0x0;_0x2c80b9<_0x429c4e['DrawMosaiclinesParamArray']['length'];_0x2c80b9++){var _0x300d15=_0x429c4e['DrawMosaiclinesParamArray'][_0x2c80b9]['dwMosaictype'],_0x30e9b1=0x0,_0x2d5613={};_0x2d5613['fR']=_0x429c4e['DrawMosaiclinesParamArray'][_0x2c80b9]['pstColor']['fR'],_0x2d5613['fG']=_0x429c4e['DrawMosaiclinesParamArray'][_0x2c80b9]['pstColor']['fG'],_0x2d5613['fB']=_0x429c4e['DrawMosaiclinesParamArray'][_0x2c80b9]['pstColor']['fB'],_0x2d5613['fA']=_0x429c4e['DrawMosaiclinesParamArray'][_0x2c80b9]['pstColor']['fA'],0x0!=_0x429c4e['MosaicType']&&(_0x300d15=_0x429c4e['MosaicType'],_0x30e9b1=_0x429c4e['MosaicSize'],_0x2d5613['fR']=_0x429c4e['MosaicColorR'],_0x2d5613['fG']=_0x429c4e['MosaicColorG'],_0x2d5613['fB']=_0x429c4e['MosaicColorB'],_0x2d5613['fA']=_0x429c4e['MosaicColorA']),_0x30e9b1=0x0==_0x30e9b1?0x32:_0x30e9b1,0x5==(_0x300d15=0x0==_0x300d15?0x1:_0x300d15)?_0x429c4e['oVideoHandle']['SR_DrawLines'](_0x429c4e['DrawMosaiclinesParamArray'][_0x2c80b9]['pstPoints'],_0x429c4e['DrawMosaiclinesParamArray'][_0x2c80b9]['nPointNum'],0x1,_0x429c4e['DrawMosaiclinesParamArray'][_0x2c80b9]['pstColor'],_0x429c4e['DrawMosaiclinesParamArray'][_0x2c80b9]['nLineWidth'],0x0):0x3==_0x300d15?_0x429c4e['oVideoHandle']['SR_DrawLines'](_0x429c4e['DrawMosaiclinesParamArray'][_0x2c80b9]['pstPoints'],_0x429c4e['DrawMosaiclinesParamArray'][_0x2c80b9]['nPointNum'],0x1,_0x2d5613,_0x429c4e['DrawMosaiclinesParamArray'][_0x2c80b9]['nLineWidth'],0x1):_0x429c4e['oVideoHandle']['SR_DrawMosaic'](_0x429c4e['DrawMosaiclinesParamArray'][_0x2c80b9]['pstPoints'][0x0]['fX'],_0x429c4e['DrawMosaiclinesParamArray'][_0x2c80b9]['pstPoints'][0x2]['fX'],_0x429c4e['DrawMosaiclinesParamArray'][_0x2c80b9]['pstPoints'][0x0]['fY'],_0x429c4e['DrawMosaiclinesParamArray'][_0x2c80b9]['pstPoints'][0x2]['fY'],_0x30e9b1);}for(var _0x2b0d59=0x0;_0x2b0d59<_0x429c4e['DrawTargetlinesParamArray']['length'];_0x2b0d59++)if(_0x429c4e['privatePNGImageInfo']['length']>0x0&&-0x1!=_0x429c4e['DrawTargetlinesParamArray'][_0x2b0d59]['dwFillPicID']){for(var _0x9ff4a3=-0x1,_0x5cf68f=0x0,_0xbfed71=0x0;_0xbfed71<_0x429c4e['privatePNGImageInfo']['length'];_0xbfed71++)if(_0x429c4e['DrawTargetlinesParamArray'][_0x2b0d59]['dwFillPicID']==_0x429c4e['privatePNGImageInfo'][_0xbfed71]['PicID']){if(_0x9ff4a3=_0xbfed71,_0x429c4e['DrawTargetEventIDList']['length']>0x0){for(var _0x17af45=0x0;_0x17af45<_0x429c4e['DrawTargetEventIDList']['length'];_0x17af45++)if(_0x429c4e['DrawTargetEventIDList'][_0x17af45]['nID']==_0x429c4e['DrawTargetlinesParamArray'][_0x2b0d59]['eventid']){_0x5cf68f=0x1;break;}}else _0x5cf68f=0x1;break;}-0x1!=_0x9ff4a3&&0x1==_0x5cf68f&&(_0x429c4e['privatePNGImageInfo'][_0x9ff4a3]['pstRectPos']['fTop']=_0x429c4e['DrawTargetlinesParamArray'][_0x2b0d59]['pstPoints'][0x0]['fY'],_0x429c4e['privatePNGImageInfo'][_0x9ff4a3]['pstRectPos']['fBottom']=_0x429c4e['DrawTargetlinesParamArray'][_0x2b0d59]['pstPoints'][0x2]['fY'],_0x429c4e['privatePNGImageInfo'][_0x9ff4a3]['pstRectPos']['fLeft']=_0x429c4e['DrawTargetlinesParamArray'][_0x2b0d59]['pstPoints'][0x0]['fX'],_0x429c4e['privatePNGImageInfo'][_0x9ff4a3]['pstRectPos']['fRight']=_0x429c4e['DrawTargetlinesParamArray'][_0x2b0d59]['pstPoints'][0x2]['fX'],_0x429c4e['oVideoHandle']['SR_DrawImage'](_0x429c4e['privatePNGImageInfo'][_0x9ff4a3]['videoStream'],_0x429c4e['privatePNGImageInfo'][_0x9ff4a3]['nImageWidth'],_0x429c4e['privatePNGImageInfo'][_0x9ff4a3]['nImageHeight'],_0x429c4e['privatePNGImageInfo'][_0x9ff4a3]['pstRectPos'],_0x1ad956['SRPIXELFORMAT']['SR_PF_SURFACE'],_0x429c4e['privatePNGImageInfo'][_0x9ff4a3]['fAlpha']));}else _0x429c4e['oVideoHandle']['SR_DrawLines'](_0x429c4e['DrawTargetlinesParamArray'][_0x2b0d59]['pstPoints'],_0x429c4e['DrawTargetlinesParamArray'][_0x2b0d59]['nPointNum'],_0x429c4e['DrawTargetlinesParamArray'][_0x2b0d59]['bLoop'],_0x429c4e['DrawTargetlinesParamArray'][_0x2b0d59]['pstColor'],_0x429c4e['DrawTargetlinesParamArray'][_0x2b0d59]['nLineWidth'],_0x429c4e['DrawTargetlinesParamArray'][_0x2b0d59]['bFill']);0x0!=_0x429c4e['DrawFontParamArray']['length']&&_0x429c4e['oVideoHandle']['SR_DrawFontEx'](_0x429c4e['DrawFontParamArray'],_0x429c4e['DrawFontParamArray']['length'],0x0,_0x429c4e['textCanvas']);for(var _0x33ef02=_0x429c4e['DrawPOSFontsParamArray']['length']-0x1;_0x33ef02>=0x0;_0x33ef02--){var _0x6f3370=0x0;if(-0x1!=_0x429c4e['DrawPOSFontsParamArray'][_0x33ef02]['EventID']&&_0x429c4e['DrawTargetEventIDList']['length']>0x0){for(var _0x4fc3ee=0x0;_0x4fc3ee<_0x429c4e['DrawTargetEventIDList']['length'];_0x4fc3ee++)if(_0x429c4e['DrawTargetEventIDList'][_0x4fc3ee]['nID']==_0x429c4e['DrawPOSFontsParamArray'][_0x33ef02]['EventID']){_0x6f3370=0x1;break;}}else _0x6f3370=0x1;0x1!=_0x6f3370&&_0x429c4e['DrawPOSFontsParamArray']['splice'](_0x33ef02,0x1);}if(0x0!=_0x429c4e['DrawPOSFontsParamArray']['length']&&_0x429c4e['oVideoHandle']['SR_DrawFontEx'](_0x429c4e['DrawPOSFontsParamArray'],_0x429c4e['DrawPOSFontsParamArray']['length'],0x0,_0x429c4e['textCanvas']),null!=_0x429c4e['curImagesInfo']&&0x0!=_0x429c4e['curImagesInfo']['nWidth']&&0x0!=_0x429c4e['curImagesInfo']['nHeight']&&0x1==_0x429c4e['m_bEnablePICEx']){var _0x2e9bf9=null;null!=_0x429c4e['curImagesInfo']&&null!=_0x429c4e['curImagesInfo']&&null!=_0x429c4e['curImagesInfo']['picImageData']&&null!=_0x429c4e['curImagesInfo']['picImageData']&&(_0x2e9bf9=new Uint16Array(_0x429c4e['curImagesInfo']['picImageData']['buffer'])),null!=_0x429c4e['curImagesInfo']&&_0x429c4e['curImagesInfo']['nPixelFormat']>0x0&&_0x429c4e['oVideoHandle']['SR_DrawImage'](_0x2e9bf9,_0x429c4e['curImagesInfo']['nWidth'],_0x429c4e['curImagesInfo']['nHeight'],_0x429c4e['curImagesInfo']['pstRect'],_0x429c4e['curImagesInfo']['nPixelFormat'],_0x429c4e['curImagesInfo']['fAlpha']);}if(0x0!==_0x429c4e['pstWaterFontParamArray'][0x0]['length']&&null!=_0x429c4e['pstWaterFontParam']&&_0x429c4e['oVideoHandle']['SR_DrawFontEx'](_0x429c4e['pstWaterFontParamArray'][0x0],_0x429c4e['pstWaterFontParamArray'][0x0]['length'],0x1,_0x429c4e['textCanvas']),0x0!==_0x429c4e['pWaterImageParam']['length']&&_0x429c4e['finishDecodeImage']){_0x429c4e['baseWaterMarkImageTime']<=0x0&&(_0x429c4e['baseWaterMarkImageTime']=_0x429c4e['curTimestamp']);var _0x26139d=_0x429c4e['curTimestamp']-_0x429c4e['baseWaterMarkImageTime'];_0x26139d<0x0&&(_0x429c4e['baseWaterMarkImageTime']=_0x429c4e['curTimestamp'],_0x26139d=0x0,_0x429c4e['waterMarkImageIndex']=0x0),_0x26139d>=_0x429c4e['pWaterImageParam'][_0x429c4e['waterMarkImageIndex']]['timeStamp']-_0x429c4e['pWaterImageParam'][0x0]['timeStamp']&&_0x429c4e['waterMarkImageIndex']++,_0x429c4e['waterMarkImageIndex']>=_0x429c4e['waterMarkImageMax']&&(_0x429c4e['waterMarkImageIndex']=0x0,_0x429c4e['baseWaterMarkImageTime']=_0x429c4e['curTimestamp']);var _0x57c657=_0x429c4e['waterMarkImageIndex'];_0x429c4e['oVideoHandle']['SR_DrawImage'](_0x429c4e['pWaterImageParam'][_0x57c657]['videoStream'],_0x429c4e['pWaterImageParam'][_0x57c657]['nImageWidth'],_0x429c4e['pWaterImageParam'][_0x57c657]['nImageHeight'],_0x429c4e['pWaterImageParam'][_0x57c657]['pstRectPos'],_0x1ad956['SRPIXELFORMAT']['SR_PF_SURFACE'],_0x429c4e['pWaterImageParam'][_0x57c657]['fAlpha']);}}},{'key':'SetPanoramaDisplayEffect','value':function(_0x203153){if('2d'===this['renderEngine']||'2D'===this['renderEngine'])return 0x0;if(null!=this['oVideoHandle']){if(_0x203153!=this['panoramaDisplayEffect']){this['panoramaDisplayEffect']=_0x203153,this['oVideoHandle']['SR_DelSubPort'](this['mainVaildSubPort']),this['oVideoHandle']['SR_Destroy'](),this['oVideoHandle']=null,this['oVideoHandle']=new _0x55066e(),null==this['pFishParamManager']&&(this['pFishParamManager']=new _0x4684d8()),this['oVideoHandle']['SR_SetFishParamManager'](this['pFishParamManager']),this['hasSetFECParamManager']=!0x0;var _0x4300ff=_0x1ad956['SRDISPLAYEFFECT']['SR_DE_NULL'];if(_0x4300ff=0x1==this['panoramaDisplayEffect']?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_PANORAMA_SPHERE']:0x3==this['panoramaDisplayEffect']?_0x1ad956['SRDISPLAYEFFECT']['SR_DE_PANORAMA_PLANET']:_0x1ad956['SRDISPLAYEFFECT']['SR_DE_NULL'],this['oVideoHandle']['SR_Init'](this['mainCanvasID'],this['enPixelFormat']),this['mainVaildSubPort']=this['oVideoHandle']['SR_AddSubPort'](_0x4300ff),-0x1==this['mainVaildSubPort'])return console['info']('%c\\x20InitDisplay\\x20SR_AddSubPort\\x20error\\x20subport:%d','color:\\x20red',this['mainVaildSubPort']),0x0;}}else this['panoramaDisplayEffect']=_0x203153;return 0x1;}},{'key':'SetPanoramaSphereViewParam','value':function(_0x292d3d,_0x17e469){return'2d'===this['renderEngine']||'2D'===this['renderEngine']||null==_0x17e469||null==_0x17e469||_0x292d3d<0x1||_0x292d3d>0x3?0x0:(this['viewParamType']=_0x292d3d,this['viewParamValue']=_0x17e469,null!=this['oVideoHandle']?(0x1!=this['panoramaDisplayEffect']&&this['panoramaDisplayEffect'],this['oVideoHandle']['SR_SetViewParam'](_0x292d3d,_0x17e469)!=_0x1ad956['ERRCODE']['SR_OK']?0x0:0x1):0x0);}},{'key':'GetPanoramaSphereViewParam','value':function(_0x4660e3,_0x5ccb91){return'2d'===this['renderEngine']||'2D'===this['renderEngine']||null==_0x5ccb91||null==_0x5ccb91||_0x4660e3<0x1||_0x4660e3>0x3?0x0:null!=this['oVideoHandle']?(0x1!=this['panoramaDisplayEffect']&&this['panoramaDisplayEffect'],_0x5ccb91['fValue']=-0x1,this['oVideoHandle']['SR_GetViewParam'](_0x4660e3,_0x5ccb91)!=_0x1ad956['ERRCODE']['SR_OK']?0x0:0x1):0x0;}}]),_0x21e10c;}()),_0x130022=(function(){function _0x4286c2(_0x820e8,_0x1e0ff3){_0x32f3fa(this,_0x4286c2),this['EncoderObj']=null,this['FirstFrame']=!0x0,this['frameRate']=0x19,this['EncoderCurStatus']=0x2,this['frameCounter']=0x0,this['frameNum']=0x0,this['stopEncodflag']=!0x1,this['encodeFrameGlobalTime']=[],this['oPlayCtrlHandle']=null,null!=_0x820e8&&(this['oPlayCtrlHandle']=_0x820e8),this['player']=null,null!=_0x1e0ff3&&(this['player']=_0x1e0ff3),this['output']=this['output']['bind'](this),this['reportError']=this['reportError']['bind'](this),this['userAgent']=0x0,this['bWriteData']=!0x1,this['aTotalBuffer']=[],this['iFrameNum']=0x0;}return _0x551f25(_0x4286c2,[{'key':'initEncoder','value':function(_0x4cd733,_0x40dc5a,_0x39775a){if(this['codecString']=_0x4cd733,this['encodeWidth']=_0x40dc5a['encodeWidth'],this['encodeHeight']=_0x40dc5a['encodeHeight'],this['bitrate']=_0x40dc5a['bitrate'],this['frameRate']=_0x40dc5a['frameRate'],0x0==_0x40dc5a['bitrateMode']?this['bitrateMode']='variable':this['bitrateMode']='constant',0x0==_0x40dc5a['latencyMode']?this['latencyMode']='realtime':this['latencyMode']='quality',this['rawDataCB']=_0x39775a,this['FirstFrame']=!0x0,this['EncoderCurStatus']=0x2,this['frameCounter']=0x0,this['frameNum']=0x0,this['stopEncodflag']=!0x1,null==this['EncoderObj']){var _0x23c7b1={'output':this['output'],'error':this['reportError']};this['EncoderObj']=new VideoEncoder(_0x23c7b1);}this['format']='annexb';var _0x271d89=navigator['userAgent']||navigator['vendor']||window['opera'];_0x271d89['indexOf']('Windows\\x20NT')>-0x1?this['userAgent']=0x0:_0x271d89['indexOf']('Linux')>-0x1?this['userAgent']=0x1:_0x271d89['indexOf']('Mac\\x20OS\\x20X')>-0x1?(this['userAgent']=0x2,this['format']='avc'):/Android/['test'](_0x271d89)?this['userAgent']=0x3:/like Mac OS X/['test'](_0x271d89)?this['userAgent']=0x4:this['userAgent']=0x0;var _0x4432ff={'codec':_0x4cd733,'width':this['encodeWidth'],'height':this['encodeHeight'],'displayWidth':this['encodeWidth'],'displayHeight':this['encodeHeight'],'bitrate':this['bitrate'],'framerate':this['frameRate'],'bitrateMode':this['bitrateMode'],'latencyMode':this['latencyMode'],'avc':{'format':this['format']}};console['log']('1videoEncode\\x20config\\x20width:'+this['encodeWidth']+',height:'+this['encodeHeight']+',bitrate:'+this['bitrate']+',framerate:'+this['frameRate']+',bitrateMode:'+this['bitrateMode']+',latencMode:'+this['latencyMode']),this['EncoderObj']['configure'](_0x4432ff);}},{'key':'inputData','value':function(_0x24ab5a,_0x23fafc){null==this['EncoderObj']||this['stopEncodflag']||('configured'==this['EncoderObj']['state']||this['FirstFrame'])&&this['EncodeProcess'](_0x24ab5a,_0x23fafc);}},{'key':'EncodeProcess','value':function(_0x22aae4,_0xfa21c0){if(0x4!=this['EncoderCurStatus']&&null!=this['EncoderObj']&&'configured'==this['EncoderObj']['state']&&this['EncoderObj']['encodeQueueSize']<0xa){var _0x264e87=this['frameCounter']%0x32==0x0;0x1==_0x264e87&&this['encodeFrameGlobalTime']['push'](_0xfa21c0),this['EncoderObj']['encode'](_0x22aae4,{'keyFrame':_0x264e87}),this['frameCounter']++;}}},{'key':'output','value':function(_0x58fcff,_0x232fbc){if('configured'==this['EncoderObj']['state']){_0x232fbc['decoderConfig'],_0x232fbc['svc'],_0x232fbc['alphaSideData'],_0x58fcff['type'];var _0x204128=_0x58fcff['timestamp'];_0x58fcff['byteLength'];if(!this['stopEncodflag']){var _0x5537cf=new Uint8Array(_0x58fcff['byteLength']);_0x58fcff['copyTo'](_0x5537cf);var _0x44a029={'dataType':0x1};if(_0x44a029['width']=this['encodeWidth'],_0x44a029['height']=this['encodeHeight'],_0x44a029['frameRate']=this['frameRate'],_0x44a029['timeStamp']=_0x204128/0x3e8,_0x44a029['frameNum']=this['frameNum'],_0x44a029['bitrate']=0x0,_0x44a029['globalTime']={},'key'==_0x58fcff['type']){var _0x36c27d=this['encodeFrameGlobalTime']['shift']();'year'in _0x36c27d?(_0x44a029['globalTime']['year']=_0x36c27d['year'],_0x44a029['globalTime']['month']=_0x36c27d['month'],_0x44a029['globalTime']['day']=_0x36c27d['day'],_0x44a029['globalTime']['hour']=_0x36c27d['hour'],_0x44a029['globalTime']['minute']=_0x36c27d['minute'],_0x44a029['globalTime']['second']=_0x36c27d['second'],_0x44a029['globalTime']['milliseconds']=_0x36c27d['milliseconds']):(_0x44a029['globalTime']['year']=0x7e8,_0x44a029['globalTime']['month']=0x0,_0x44a029['globalTime']['day']=0x0,_0x44a029['globalTime']['hour']=0x0,_0x44a029['globalTime']['minute']=0x0,_0x44a029['globalTime']['second']=0x0,_0x44a029['globalTime']['milliseconds']=0x0);}var _0xf21dd8=null,_0x3e6a4a=new Uint8Array(0x4);_0x3e6a4a[0x0]=0x0,_0x3e6a4a[0x1]=0x0,_0x3e6a4a[0x2]=0x0,_0x3e6a4a[0x3]=0x1;var _0x4b80ce=null,_0x13cf25=0x0,_0x4e5ce3=null,_0x17a8ce=0x0,_0x16d88f=null,_0xba1c85=null,_0x599168=0x0,_0x544b53=0x0,_0x2f5191=0x0;if('key'==_0x58fcff['type']){if('decoderConfig'in _0x232fbc&&'description'in _0x232fbc['decoderConfig']&&(_0xba1c85=new Uint8Array(_0x232fbc['decoderConfig']['description'])),0x2==this['userAgent']){for(null!=_0xba1c85&&(_0x13cf25=0x100*(_0x4b80ce=_0xba1c85['slice'](0x6,_0xba1c85['length']))[0x0]+_0x4b80ce[0x1],_0x4e5ce3=_0x4b80ce['slice'](0x2,0x2+_0x13cf25),_0x17a8ce=0x100*_0x4b80ce[0x3+_0x13cf25]+_0x4b80ce[0x4+_0x13cf25],_0x16d88f=_0x4b80ce['slice'](0x5+_0x13cf25,0x5+_0x13cf25+_0x17a8ce),_0x13cf25+=0x4,_0x17a8ce+=0x4);_0x544b53<_0x5537cf['length'];)_0x2f5191=0x100*_0x5537cf[_0x544b53]*0x100*0x100+0x100*_0x5537cf[_0x544b53+0x1]*0x100+0x100*_0x5537cf[_0x544b53+0x2]+_0x5537cf[_0x544b53+0x3],_0x5537cf[_0x544b53]=0x0,_0x5537cf[_0x544b53+0x1]=0x0,_0x5537cf[_0x544b53+0x2]=0x0,_0x5537cf[_0x544b53+0x3]=0x1,_0x544b53=_0x544b53+0x4+_0x2f5191;_0x599168=_0x13cf25+_0x17a8ce+_0x5537cf['length'],_0xf21dd8=new Uint8Array(_0x599168);var _0x7bbba3=0x0;null!=_0x4e5ce3&&(_0xf21dd8['set'](_0x3e6a4a,0x0),_0xf21dd8['set'](_0x4e5ce3,_0x3e6a4a['length']),_0x7bbba3=_0x3e6a4a['length']+_0x4e5ce3['length']),null!=_0x16d88f&&(_0xf21dd8['set'](_0x3e6a4a,_0x7bbba3),_0xf21dd8['set'](_0x16d88f,_0x7bbba3+_0x3e6a4a['length']),_0x7bbba3=_0x3e6a4a['length']+_0x4e5ce3['length']+_0x3e6a4a['length']+_0x16d88f['length']),_0xf21dd8['set'](_0x5537cf,_0x7bbba3),_0x44a029['rawData']=_0xf21dd8;}else{for(var _0x206941=_0x5537cf['slice'](0x6,_0x5537cf['length']),_0x44adab=0x0;_0x44adab<_0x206941['length']&&(0x0!=_0x206941[_0x44adab]||0x0!=_0x206941[_0x44adab+0x1]||0x1!=_0x206941[_0x44adab+0x2]||0x6e!=_0x206941[_0x44adab+0x3]);_0x44adab++);_0x4b80ce=_0x206941['slice'](0x0,_0x44adab);for(var _0x347cc9=_0x206941['slice'](_0x44adab,_0x206941['length']),_0x5e975f=0x0;_0x5e975f<_0x347cc9['length']&&(0x0!=_0x347cc9[_0x5e975f]||0x0!=_0x347cc9[_0x5e975f+0x1]||0x1!=_0x347cc9[_0x5e975f+0x2]||0x65!=_0x347cc9[_0x5e975f+0x3]);_0x5e975f++);var _0x5b1ebc=_0x347cc9['slice'](_0x5e975f-0x1,_0x347cc9['length']);_0x5b1ebc[0x0]=0x0,_0x599168=_0x4b80ce['length']+_0x5b1ebc['length'],(_0xf21dd8=new Uint8Array(_0x599168))['set'](_0x4b80ce,0x0),_0xf21dd8['set'](_0x5b1ebc,_0x4b80ce['length']),_0x206941=null,_0x347cc9=null,_0x5b1ebc=null;}_0x44a029['rawData']=_0xf21dd8,this['player']?this['rawDataCB']&&this['rawDataCB'](_0x44a029):postMessage({'function':'VideoRecoderInfo','videoInfo':_0x44a029},[_0x44a029['rawData']['buffer']]);}else{if(0x2==this['userAgent']){for(;_0x544b53<_0x5537cf['length'];)_0x2f5191=0x100*_0x5537cf[_0x544b53]*0x100*0x100+0x100*_0x5537cf[_0x544b53+0x1]*0x100+0x100*_0x5537cf[_0x544b53+0x2]+_0x5537cf[_0x544b53+0x3],_0x5537cf[_0x544b53]=0x0,_0x5537cf[_0x544b53+0x1]=0x0,_0x5537cf[_0x544b53+0x2]=0x0,_0x5537cf[_0x544b53+0x3]=0x1,_0x544b53=_0x544b53+0x4+_0x2f5191;_0x44a029['rawData']=_0x5537cf;}else _0x44a029['rawData']=_0x5537cf;this['player']?this['rawDataCB']&&this['rawDataCB'](_0x44a029):postMessage({'function':'VideoRecoderInfo','videoInfo':_0x44a029},[_0x44a029['rawData']['buffer']]);}_0x5537cf=null,_0xf21dd8=null,_0x3e6a4a=null,_0x4b80ce=null,_0x4e5ce3=null,_0x16d88f=null,_0xba1c85=null,this['frameNum']++;}}}},{'key':'_downloadFile','value':function(_0x445aea,_0x16f09a){var _0x5411de=_0x445aea;_0x445aea instanceof Blob||_0x445aea instanceof File||(_0x5411de=new Blob([_0x445aea]));var _0x608fd6=window['URL']['createObjectURL'](_0x5411de),_0x3e1b46=window['document']['createElement']('a');_0x3e1b46['href']=_0x608fd6,_0x3e1b46['download']=_0x16f09a;var _0x1bb718=document['createEvent']('MouseEvents');_0x1bb718['initEvent']('click',!0x0,!0x0),_0x3e1b46['dispatchEvent'](_0x1bb718);}},{'key':'downloadData','value':function(_0xef9db3){if(this['bWriteData']){for(var _0x2872a5=_0xef9db3,_0x5e5cfb=this['aTotalBuffer']['length'],_0x28cc83=0x0,_0x44976d=_0x2872a5['length'];_0x28cc83<_0x44976d;_0x28cc83++)this['aTotalBuffer'][_0x5e5cfb+_0x28cc83]=_0x2872a5[_0x28cc83];this['iFrameNum']++,_0x2872a5=null,console['log']('downloadEncodedata\\x20iFrameNum:'+this['iFrameNum']);}if(this['bWriteData']&&(this['iFrameNum']>=0x258||this['stopEncodflag'])){console['log']('download600encodeData');var _0x599f10=new Uint8Array(this['aTotalBuffer']);this['_downloadFile'](_0x599f10,'Encode600.data'),this['aTotalBuffer']['splice'](0x0,this['aTotalBuffer']['length']),this['bWriteData']=!0x1,this['iFrameNum']=0x0,_0x599f10=null;}}},{'key':'stopEncode','value':function(){if(this['EncoderCurStatus']=0x4,this['frameCounter']=0x0,this['frameNum']=0x0,this['stopEncodflag']=!0x0,this['destroyEncoder'](),this['bWriteData']&&this['stopEncodflag']){console['log']('download600encodeData');var _0x2af3b5=new Uint8Array(this['aTotalBuffer']);this['_downloadFile'](_0x2af3b5,'Encode600.data'),this['aTotalBuffer']['splice'](0x0,this['aTotalBuffer']['length']),this['bWriteData']=!0x1,this['iFrameNum']=0x0,_0x2af3b5=null;}}},{'key':'reportError','value':function(_0x214db8){console['log']('hardEncode\\x20reportError:'+_0x214db8['message']+',state:'+this['EncoderObj']['state']+',frameRate:'+this['frameRate']);}},{'key':'destroyEncoder','value':function(){var _0x236190=this;return new Promise(function(_0x3c0acd,_0x4778fc){_0x236190['clearEncoderObjBuffer']()['then'](function(){null!=_0x236190['EncoderObj']&&('closed'!=_0x236190['EncoderObj']['state']&&_0x236190['EncoderObj']['close'](),console['log']('>>>JS\\x2011\\x20destroy\\x20VideoEncoderObj'),_0x236190['EncoderObj']=null),_0x236190['EncoderCurStatus']=0x4,_0x236190['FirstFrame']=!0x0,_0x3c0acd();},function(){_0x4778fc();});});}},{'key':'resetEncoder','value':function(){var _0x3036fa=this;return new Promise(function(_0x13a19f,_0x42ed23){_0x3036fa['destroyEncoder']()['then'](function(){var _0x1c990b={'encodeWidth':_0x3036fa['encodeWidth'],'encodeHeight':_0x3036fa['encodeHeight'],'bitrate':_0x3036fa['bitrate'],'frameRate':_0x3036fa['frameRate'],'bitrateMode':_0x3036fa['bitrateMode'],'latencyMode':_0x3036fa['latencyMode']};_0x3036fa['initEncoder'](_0x3036fa['codecString'],_0x1c990b,_0x3036fa['rawDataCB']),console['log']('%c\\x20reset\\x20hard\\x20Encoder','color:red'),_0x13a19f();},function(){_0x42ed23();});});}},{'key':'clearEncoderObjBuffer','value':function(){var _0xb84273=this;return new Promise(function(_0xaf5e0c,_0x21e70e){null!=_0xb84273['EncoderObj']&&'configured'==_0xb84273['EncoderObj']['state']&&_0xb84273['EncoderObj']['reset'](),_0xaf5e0c();});}}]),_0x4286c2;}()),_0x469b0c=(function(){function _0x5b83e5(_0xc7197,_0x500c5e){_0x32f3fa(this,_0x5b83e5),this['AudioEncoderObj']=null,this['FirstFrame']=!0x0,this['EncoderCurStatus']=0x2,this['stopEncodflag']=!0x1,this['aTimeStamp']=0x0,this['oPlayCtrlHandle']=null,null!=_0xc7197&&(this['oPlayCtrlHandle']=_0xc7197),this['player']=null,null!=_0x500c5e&&(this['player']=_0x500c5e),this['output']=this['output']['bind'](this),this['reportError']=this['reportError']['bind'](this);}var _0x2ccd6c;return _0x551f25(_0x5b83e5,[{'key':'initEncoder','value':(_0x2ccd6c=_0x290ca7(_0x5cd95a()['mark'](function _0x3d97f0(_0x54ca54,_0x503ed3,_0x13a0f8){var _0x3c9e83,_0x1d030e;return _0x5cd95a()['wrap'](function(_0x4412ce){for(;;)switch(_0x4412ce['prev']=_0x4412ce['next']){case 0x0:this['codecString']=_0x54ca54,this['sampleRate']=_0x503ed3['sampleRate'],this['numberOfChannels']=_0x503ed3['numberOfChannels'],this['bitrate']=_0x503ed3['bitrate'],this['AudioDataCB']=_0x13a0f8,this['FirstFrame']=!0x0,this['EncoderCurStatus']=0x2,this['stopEncodflag']=!0x1,this['aTimeStamp']=0x0,null==this['AudioEncoderObj']&&(_0x3c9e83={'output':this['output'],'error':this['reportError']},this['AudioEncoderObj']=new AudioEncoder(_0x3c9e83)),this['format']='adts',_0x1d030e={'codec':_0x54ca54,'sampleRate':this['sampleRate'],'numberOfChannels':this['numberOfChannels'],'bitrate':this['bitrate'],'aac':{'format':this['format']}},console['log']('2audioEncode\\x20config\\x20sampleRate:'+this['sampleRate']+',numberOfChannels:'+this['numberOfChannels']+',bitrate:'+this['bitrate']),this['AudioEncoderObj']['configure'](_0x1d030e);case 0xe:case'end':return _0x4412ce['stop']();}},_0x3d97f0,this);})),function(_0x14770f,_0x57e7ef,_0x188fff){return _0x2ccd6c['apply'](this,arguments);})},{'key':'inputData','value':function(_0x14bb00){null!=this['AudioEncoderObj']&&('configured'==this['AudioEncoderObj']['state']||this['FirstFrame'])&&this['EncodeProcess'](_0x14bb00),this['FirstFrame']&&(0x1==this['oPlayCtrlHandle']['recoderBaseTimestampMode']?this['audioBaseTimeStamp']=_0x14bb00['timestamp']:0x0==this['oPlayCtrlHandle']['recoderBaseTimestampMode']&&(this['audioBaseTimeStamp']=0x0),this['FirstFrame']=!0x1);}},{'key':'EncodeProcess','value':function(_0x2938d7){0x4!=this['EncoderCurStatus']&&null!=this['AudioEncoderObj']&&'configured'==this['AudioEncoderObj']['state']&&this['AudioEncoderObj']['encode'](_0x2938d7);}},{'key':'output','value':function(_0x535f48,_0x1ef8ea){if('configured'==this['AudioEncoderObj']['state']){_0x535f48['type'],_0x535f48['timestamp'],_0x535f48['byteLength'];if(!this['stopEncodflag']){this['aTimeStamp']+=_0x535f48['duration']/0x3e8;var _0x38bbbc={'dataType':0x2,'width':0x1,'height':0x10,'frameRate':0xbb80};_0x38bbbc['timeStamp']=this['aTimeStamp']+this['audioBaseTimeStamp'],_0x38bbbc['frameNum']=0x0,_0x38bbbc['bitrate']=0x1f400,_0x38bbbc['globalTime']={};var _0x1e81c6=new Uint8Array(_0x535f48['byteLength']);_0x535f48['copyTo'](_0x1e81c6),_0x38bbbc['rawData']=_0x1e81c6,this['player']?null!=this['AudioDataCB']&&this['AudioDataCB'](_0x38bbbc):postMessage({'function':'AudioRecoderInfo','audioInfo':_0x38bbbc},[_0x38bbbc['rawData']['buffer']]),_0x1e81c6=null;}}}},{'key':'stopEncode','value':function(){this['stopEncodflag']=!0x0,this['destroyEncoder']();}},{'key':'reportError','value':function(_0x32d7c8){console['log']('hardEncode\\x20reportError:'+_0x32d7c8['message']+',state:'+this['AudioEncoderObj']['state']);}},{'key':'destroyEncoder','value':function(){var _0x45f964=this;return new Promise(function(_0x2dd91c,_0x302ae5){_0x45f964['clearEncoderObjBuffer']()['then'](function(){null!=_0x45f964['AudioEncoderObj']&&('closed'!=_0x45f964['AudioEncoderObj']['state']&&_0x45f964['AudioEncoderObj']['close'](),console['log']('>>>JS\\x2012\\x20destroy\\x20AudioEncoderObj'),_0x45f964['AudioEncoderObj']=null),_0x45f964['EncoderCurStatus']=0x4,_0x45f964['FirstFrame']=!0x0,_0x2dd91c();},function(){_0x302ae5();});});}},{'key':'resetEncoder','value':function(){var _0x440f17=this;return new Promise(function(_0x3ff096,_0x1a9a04){_0x440f17['destroyEncoder']()['then'](function(){var _0x4c08a3={'sampleRate':_0x440f17['sampleRate'],'numberOfChannels':_0x440f17['numberOfChannels'],'bitrate':_0x440f17['bitrate']};_0x440f17['initEncoder'](_0x440f17['codecString'],_0x4c08a3,_0x440f17['AudioDataCB']),console['log']('%c\\x20reset\\x20hard\\x20Encoder','color:red'),_0x3ff096();},function(){_0x1a9a04();});});}},{'key':'clearEncoderObjBuffer','value':function(){var _0x16cbb1=this;return new Promise(function(_0x2d642f,_0x424ffa){null!=_0x16cbb1['AudioEncoderObj']&&'configured'==_0x16cbb1['AudioEncoderObj']['state']&&_0x16cbb1['AudioEncoderObj']['reset'](),_0x2d642f();});}}]),_0x5b83e5;}());function _0x1486b7(_0x36e820,_0x529cbb){var _0x9a1a8c='undefined'!=typeof Symbol&&_0x36e820[Symbol['iterator']]||_0x36e820['@@iterator'];if(!_0x9a1a8c){if(Array['isArray'](_0x36e820)||(_0x9a1a8c=function(_0x45fcf2,_0xb330a7){if(!_0x45fcf2)return;if('string'==typeof _0x45fcf2)return _0x192c44(_0x45fcf2,_0xb330a7);var _0x58be74=Object['prototype']['toString']['call'](_0x45fcf2)['slice'](0x8,-0x1);'Object'===_0x58be74&&_0x45fcf2['constructor']&&(_0x58be74=_0x45fcf2['constructor']['name']);if('Map'===_0x58be74||'Set'===_0x58be74)return Array['from'](_0x45fcf2);if('Arguments'===_0x58be74||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/['test'](_0x58be74))return _0x192c44(_0x45fcf2,_0xb330a7);}(_0x36e820))||_0x529cbb&&_0x36e820&&'number'==typeof _0x36e820['length']){_0x9a1a8c&&(_0x36e820=_0x9a1a8c);var _0x1fc243=0x0,_0x31bbb6=function(){};return{'s':_0x31bbb6,'n':function(){return _0x1fc243>=_0x36e820['length']?{'done':!0x0}:{'done':!0x1,'value':_0x36e820[_0x1fc243++]};},'e':function(_0x495420){throw _0x495420;},'f':_0x31bbb6};}throw new TypeError('Invalid\\x20attempt\\x20to\\x20iterate\\x20non-iterable\\x20instance.\\x0aIn\\x20order\\x20to\\x20be\\x20iterable,\\x20non-array\\x20objects\\x20must\\x20have\\x20a\\x20[Symbol.iterator]()\\x20method.');}var _0x1c3581,_0x18f0cb=!0x0,_0x318539=!0x1;return{'s':function(){_0x9a1a8c=_0x9a1a8c['call'](_0x36e820);},'n':function(){var _0x18047b=_0x9a1a8c['next']();return _0x18f0cb=_0x18047b['done'],_0x18047b;},'e':function(_0x581c30){_0x318539=!0x0,_0x1c3581=_0x581c30;},'f':function(){try{_0x18f0cb||null==_0x9a1a8c['return']||_0x9a1a8c['return']();}finally{if(_0x318539)throw _0x1c3581;}}};}function _0x192c44(_0x5b3d7a,_0x1f1665){(null==_0x1f1665||_0x1f1665>_0x5b3d7a['length'])&&(_0x1f1665=_0x5b3d7a['length']);for(var _0x435a53=0x0,_0x392e2d=new Array(_0x1f1665);_0x435a53<_0x1f1665;_0x435a53++)_0x392e2d[_0x435a53]=_0x5b3d7a[_0x435a53];return _0x392e2d;}var _0x572984=(function(){function _0x35401(){var _0x5e910a=arguments['length']>0x0&&void 0x0!==arguments[0x0]?arguments[0x0]:null;_0x32f3fa(this,_0x35401),this['canvas']=null,this['streamOpenMode']=0x0,this['context']=null,this['oVideoDecoder']=null,this['frameBuffers']=[],this['initTimer']=!0x1,this['preTimeStamp']=0x0,this['baseTimeStamp']=0x0,this['resetTimer']=!0x0,this['RenderFrame']=this['RenderFrame']['bind'](this),this['renderCurStatus']=0x2,this['renderLastStatus']=0x2,this['playSpeed']=0x1,this['nplaySpeed']=0x1,this['displayBuf']=0xe,this['needForward']=!0x1,this['firstFrame']=!0x0,this['LatcyTime']=0x32,this['nFrameRate']=0x0,this['needSaveFrameInfo']=!0x1,this['displayFrameInfoCB']=null,this['displayFrameInfo']=[],this['curFrameInfo']={},this['curFrameInfo']['timeStamp']=0x0,this['bResetdisplayFrameInfoCB']=!0x0,this['sx']=0x0,this['sy']=0x0,this['sw']=0x0,this['sh']=0x0,this['displayRunning']=!0x1,this['oRenderTimer']=null,this['waitIFrameTimestamp']=0x0,this['curFrame']=null,this['player']=null,null!=_0x5e910a&&(this['player']=_0x5e910a),this['renderEngine']='webgl',this['oVideoRender']=null,this['FECCanvasID']='',this['oVideoRender']=new _0x8ee4c0(this),this['bSetStreamEnd']=!0x1,this['printfFlag']=0x0,this['oVideoEncoder']=null,this['oAudioEncoder']=null,this['startRecoderFlag']=!0x1,this['stopRecoderFlag']=!0x1,this['recoderFrameNum']=0x0,this['vBaseTimeStamp']=0x0,this['encodeVideoInfo']={'encodeVideoType':'avc','encodeWidth':0x500,'encodeHeight':0x2d0,'bitrate':0xf4240,'frameRate':0x19,'bitrateMode':0x0,'latencyMode':0x0},this['encodeAudioInfo']={'encodeAudioType':'aac','sampleRate':0xbb80,'numberOfChannels':0x1,'bitrate':0x1f400},this['recoderBaseTimestampMode']=0x0,this['recoderGetOriginData']=0x0,this['nstreamEndloopNum']=0x0,this['runtimeCBFun']=null,this['nTargetRelativePos']=0x0,this['ProcessPositionflag']=!0x1,this['nMPPlayMode']=0x0,this['nMPPosType']=0x0,this['VideoPrivateInfoMap']=new Map(),this['curPrivateInfo']={},this['curPrivateInfo']['linesInfo']=[],this['curPrivateInfo']['fontInfo']=[],this['curPrivateInfo']['imageInfo']=[],this['StretchPlayTime']=0x0,this['StretchPlayedTime']=0x0,this['StretchPlaySpeed']=0x1,this['StretchPlayFlag']=!0x1,this['Prevideowidth']=0x0,this['Prevideoheight']=0x0,this['PrecodecType']=0x0,this['PlayOrBackMode']=0x1,this['pstRuntimeInfo']={'nRunTimeModule':0x0,'nStrVersion':0x0,'nFrameTimeStamp':0x0,'nFrameNum':0x0,'nErrorCode':0x0,'nInputDataInterval':0x0,'nFrameNumInterval':0x0,'nAverageDecodeTime':0x0,'nSystemFormat':0x0,'nDetectRes':0x0,'nMp4FileTime':0x0,'nMp4TotalFrameNum':0x0,'AbsTimeYear':0x0,'AbsTimeMonth':0x0,'AbsTimeDay':0x0,'AbsTimeHour':0x0,'AbsTimeMinute':0x0,'AbsTimeSecond':0x0,'AbsTimeMilliseconds':0x0},this['firstRenderBegin']=!0x0,this['DecodeTypeFlagMap']=new Map(),this['RenderTypeFlagMap']=new Map();}var _0x394739,_0x3a0dd5;return _0x551f25(_0x35401,[{'key':'init','value':function(_0x1fdcbd,_0x400902,_0x5f3fb9,_0x144a1d,_0x30bee7){if(this['canvas']=_0x1fdcbd,this['streamOpenMode']=_0x400902,this['renderEngine']=_0x144a1d,this['printfFlag']=_0x30bee7,this['SetCurStatus'](0x2),null==this['oVideoDecoder']&&(this['oVideoDecoder']=new _0x5ae48a(_0x5f3fb9,this,this['player'],this['canvas']),null!==this['oVideoDecoder']&&this['oVideoDecoder']['initDecoder'](),null!=this['runtimeCBFun']&&this['oVideoDecoder']['SetRunTimeInfoCallBackFun'](0x2,this['runtimeCBFun']),this['DecodeTypeFlagMap']['size']>0x0)){var _0x3485c0,_0x27d4a2=_0x1486b7(this['DecodeTypeFlagMap']['keys']());try{for(_0x27d4a2['s']();!(_0x3485c0=_0x27d4a2['n']())['done'];){var _0x5a51b3=_0x3485c0['value'],_0x127ef5=this['DecodeTypeFlagMap']['get'](_0x5a51b3);0x1==_0x127ef5&&this['oVideoDecoder']['SetRunTimeInfoCallbackType'](0x2,_0x5a51b3,_0x127ef5);}}catch(_0x2ebd99){_0x27d4a2['e'](_0x2ebd99);}finally{_0x27d4a2['f']();}}''!=this['canvas']&&null!=this['canvas']&&(this['frameBuffers']=this['oVideoDecoder']['ready_frames'],null!=this['oVideoRender']&&this['oVideoRender']['InitDisplay'](this['canvas'],this['renderEngine'],0x100),null==this['oRenderTimer']&&(this['oRenderTimer']=new _0x5e0a45()));}},{'key':'HardDecodeError','value':function(){return this['player']['_switchHardToSoft'](),0x1;}},{'key':'inputData','value':function(_0x11ab36,_0x357296){if(this['curPrivateInfo']['linesInfo']['length']>0x0||this['curPrivateInfo']['fontInfo']['length']>0x0||this['curPrivateInfo']['imageInfo']['length']>0x0){var _0x122ebf=this['deepClone'](this['curPrivateInfo']);this['VideoPrivateInfoMap']['set'](_0x357296['timeStamp'],_0x122ebf),this['curPrivateInfo']['linesInfo']['splice'](0x0,this['curPrivateInfo']['linesInfo']['length']),this['curPrivateInfo']['fontInfo']['splice'](0x0,this['curPrivateInfo']['fontInfo']['length']),this['curPrivateInfo']['imageInfo']['splice'](0x0,this['curPrivateInfo']['imageInfo']['length']);}if(0x0!=this['PrecodecType']&&this['PrecodecType']!=_0x357296['codecType']&&(this['firstFrame']=!0x0,this['oVideoDecoder']['resetDecoderObj']()),this['needSaveFrameInfo']){var _0x515a49=new Object();_0x515a49['port']=_0x357296['port'],_0x515a49['codecType']=_0x357296['codecType'],_0x515a49['frameType']=_0x357296['frameType'],_0x515a49['frameSize']=_0x357296['frameSize'],_0x515a49['width']=_0x357296['width'],_0x515a49['height']=_0x357296['height'],_0x515a49['timeStamp']=_0x357296['timeStamp'],_0x515a49['frameRate']=_0x357296['frameRate'],_0x515a49['frameNum']=_0x357296['frameNum'],_0x515a49['interlace']=_0x357296['interlace'],_0x515a49['streamEnd']=_0x357296['streamEnd'],_0x515a49['cropLeft']=_0x357296['cropLeft'],_0x515a49['cropRight']=_0x357296['cropRight'],_0x515a49['cropTop']=_0x357296['cropTop'],_0x515a49['cropBottom']=_0x357296['cropBottom'],_0x515a49['year']=_0x357296['year'],_0x515a49['month']=_0x357296['month'],_0x515a49['week']=_0x357296['week'],_0x515a49['day']=_0x357296['day'],_0x515a49['hour']=_0x357296['hour'],_0x515a49['minute']=_0x357296['minute'],_0x515a49['second']=_0x357296['second'],_0x515a49['milliseconds']=_0x357296['milliseconds'],_0x515a49['isKeyFrame']=_0x357296['isKeyFrame'],this['nFrameRate']=_0x515a49['frameRate'],this['Prevideowidth']=_0x357296['width'],this['Prevideoheight']=_0x357296['height'],this['PrecodecType']=_0x357296['codecType'],this['displayFrameInfo']['push'](_0x515a49),_0x515a49=null;}else this['displayFrameInfo']['splice'](0x0,this['displayFrameInfo']['length']);null!=this['oVideoDecoder']&&this['oVideoDecoder']['inputData'](_0x11ab36,_0x357296);}},{'key':'_resetDecoder','value':function(){var _0x116d16=this;return new Promise(function(_0x4a93b4,_0x53f403){_0x116d16['oVideoDecoder']['resetDecoder']()['then'](function(){_0x116d16['displayFrameInfo']['splice'](0x0,_0x116d16['displayFrameInfo']['length']),_0x116d16['curFrameInfo']={},_0x116d16['oVideoRender']['DeInitPrivateParam'](),_0x116d16['VideoPrivateInfoMap']['clear'](),_0x116d16['curPrivateInfo']['linesInfo']['splice'](0x0,_0x116d16['curPrivateInfo']['linesInfo']['length']),_0x116d16['curPrivateInfo']['fontInfo']['splice'](0x0,_0x116d16['curPrivateInfo']['fontInfo']['length']),_0x116d16['curPrivateInfo']['imageInfo']['splice'](0x0,_0x116d16['curPrivateInfo']['imageInfo']['length']),_0x116d16['renderCurStatus']=0x2,_0x116d16['renderLastStatus']=0x2,_0x116d16['player']?_0x116d16['player']['JSPlayM4_ResetEnd']():postMessage({'function':'resetEnd'}),_0x4a93b4();},function(){_0x53f403();});});}},{'key':'_resetRenderTimer','value':function(){this['initTimer']=!0x1,this['preTimeStamp']=0x0,this['baseTimeStamp']=0x0,this['resetTimer']=!0x0,null!=this['oRenderTimer']&&this['oRenderTimer']['timerReset'](),this['RenderFrame']=this['RenderFrame']['bind'](this),this['renderCurStatus']=0x2,this['renderLastStatus']=0x2,this['curTimeStamp']=0x0,this['getImageJPEG']=!0x1,this['getImageBMP']=!0x1,this['getCropImageJPEG']=!0x1,this['getCropImageBMP']=!0x1,0x1==this['bResetdisplayFrameInfoCB']&&(this['displayFrameInfoCB']=null),this['displayFrameInfo']['splice'](0x0,this['displayFrameInfo']['length']),this['VideoPrivateInfoMap']['clear'](),this['curPrivateInfo']['linesInfo']['splice'](0x0,this['curPrivateInfo']['linesInfo']['length']),this['curPrivateInfo']['fontInfo']['splice'](0x0,this['curPrivateInfo']['fontInfo']['length']),this['curPrivateInfo']['imageInfo']['splice'](0x0,this['curPrivateInfo']['imageInfo']['length']),this['curFrameInfo']={},this['DecodeTypeFlagMap']['clear'](),this['RenderTypeFlagMap']['clear']();}},{'key':'_destroyPlayCtrl','value':function(){var _0xa7961e=this;this['oVideoDecoder']['destroyDecoder']()['then'](function(){_0xa7961e['oVideoDecoder']=null,null!=_0xa7961e['oVideoRender']&&(_0xa7961e['oVideoRender']['ReleaseDisplay'](),_0xa7961e['oVideoRender']=null),_0xa7961e['_resetRenderTimer'](),_0xa7961e['oRenderTimer']=null,_0xa7961e['displayRunning']=!0x1,_0xa7961e['runtimeCBFun']=null,_0xa7961e['printfFlag']>=0x0&&console['log']('>>>JS\\x2002\\x20destroy\\x20oVideoDecoder/oVideoRender'),null!=_0xa7961e['oVideoEncoder']&&(_0xa7961e['oVideoEncoder']['destroyEncoder'](),_0xa7961e['oVideoEncoder']=null),null!=_0xa7961e['oAudioEncoder']&&(_0xa7961e['oAudioEncoder']['destroyEncoder'](),_0xa7961e['oAudioEncoder']=null);},function(){_0xa7961e['printfFlag']>=0x0&&console['log']('stop\\x20failed\\x20');});}},{'key':'Sleep','value':(_0x3a0dd5=_0x290ca7(_0x5cd95a()['mark'](function _0x11d0fd(_0x2c4ae7){var _0xb3c6ff;return _0x5cd95a()['wrap'](function(_0x36787d){for(;;)switch(_0x36787d['prev']=_0x36787d['next']){case 0x0:return _0xb3c6ff=(_0xb3c6ff=_0x2c4ae7>0xea60?0xea60:_0x2c4ae7)<0x0?0x0:_0xb3c6ff,_0x36787d['abrupt']('return',new Promise(function(_0x326b34){setTimeout(_0x326b34,_0xb3c6ff);}));case 0x3:case'end':return _0x36787d['stop']();}},_0x11d0fd);})),function(_0x453746){return _0x3a0dd5['apply'](this,arguments);})},{'key':'RenderFrame','value':(_0x394739=_0x290ca7(_0x5cd95a()['mark'](function _0x3e1f34(){var _0x4987c6,_0x36d2fe=this;return _0x5cd95a()['wrap'](function(_0x43430a){for(;;)switch(_0x43430a['prev']=_0x43430a['next']){case 0x0:_0x4987c6=this['renderCurStatus'],null!=this['oVideoDecoder']&&null!=this['oVideoDecoder']['decoderObj']&&(this['player']?this['player']['JSPlayM4_GetDecodeBufferSize'](this['oVideoDecoder']['decoderObj']['decodeQueueSize'],this['oVideoDecoder']['ready_frames']['length']):postMessage({'function':'GetDecodeBufferSize','rawSize':this['oVideoDecoder']['decoderObj']['decodeQueueSize'],'frameSize':this['oVideoDecoder']['ready_frames']['length']}),this['oVideoDecoder']['decoderObj']['decodeQueueSize']<=0x3&&this['oVideoDecoder']['ready_frames']['length']<=0x3&&(this['player']?this['player']['JSPlayM4_GetRawData']():postMessage({'function':'GetRawData'})),this['printfFlag']>0x0&&console['log']('VideoPlayCtrl.js\\x20output1\\x20cb\\x20decodeQueueSize:'+this['oVideoDecoder']['decoderObj']['decodeQueueSize']+',length:'+this['oVideoDecoder']['ready_frames']['length'])),_0x43430a['t0']=_0x4987c6,_0x43430a['next']=0x0===_0x43430a['t0']?0x5:0x2===_0x43430a['t0']||0x6===_0x43430a['t0']?0x8:0x3===_0x43430a['t0']?0xa:0x5===_0x43430a['t0']?0xd:0x4===_0x43430a['t0']?0xf:0x11;break;case 0x5:return this['_resetRenderTimer'](),this['_resetDecoder']()['then'](function(){requestAnimationFrame(_0x36d2fe['RenderFrame']);},function(){}),_0x43430a['abrupt']('break',0x12);case 0x8:return this['displayRunning']?(this['printfFlag']>0x0&&console['log']('displayBuf:'+this['displayBuf']+',this.streamOpenMode:'+this['streamOpenMode']+',LatcyTime:'+this['LatcyTime']),this['chooseFrame']()['then'](function(_0x2c8382){if(_0x36d2fe['curFrame']=_0x2c8382,0x1==_0x36d2fe['ProcessPositionflag']){if(null!=_0x36d2fe['curFrame']){new Object();var _0xe6b9f7=0x0;if(0x1==_0x36d2fe['nMPPosType']&&(_0xe6b9f7=_0x36d2fe['findFramebyTime'](_0x36d2fe['curFrame']['timestamp'],0x0)['frameNum']),0x0==_0x36d2fe['nMPPosType']&&_0x36d2fe['curFrame']['timestamp']<_0x36d2fe['nTargetRelativePos']||0x1==_0x36d2fe['nMPPosType']&&_0xe6b9f7<_0x36d2fe['nTargetRelativePos'])requestAnimationFrame(_0x36d2fe['RenderFrame']);else{if(_0x36d2fe['ProcessPositionflag']=!0x1,_0x36d2fe['player']['needPlaySound']&&_0x36d2fe['player']['JSPlayM4_PlaySound'](),_0x36d2fe['paint'](_0x36d2fe['curFrame']),_0x36d2fe['curTimeStamp']=_0x36d2fe['curFrame']['timestamp'],null!=_0x36d2fe['player']){var _0x4ef549={'nRes':0x1};_0x4ef549['nRelativePos']=_0x36d2fe['nTargetRelativePos'],null!=_0x36d2fe['player']['SetPlayPosCBFun']?_0x36d2fe['player']['SetPlayPosCBFun'](_0x4ef549):postMessage({'function':'SetPlayPosCB','value':_0x36d2fe['nTargetRelativePos']});}0x1==_0x36d2fe['nMPPlayMode']&&_0x36d2fe['SetCurStatus'](0x3),_0x36d2fe['RenderFrame']();}}else requestAnimationFrame(_0x36d2fe['RenderFrame']);}else{if(-0x1==_0x36d2fe['displayBuf']||0x0==_0x36d2fe['streamOpenMode']&&0x0==_0x36d2fe['LatcyTime'])null!=_0x36d2fe['curFrame']&&(_0x36d2fe['curTimeStamp']=_0x36d2fe['curFrame']['timestamp'],_0x36d2fe['paint'](_0x36d2fe['curFrame'])),requestAnimationFrame(_0x36d2fe['RenderFrame']);else{if(null!=_0x36d2fe['curFrame']){_0x36d2fe['initTimer']&&!_0x36d2fe['resetTimer']||(_0x36d2fe['oRenderTimer']['Init'](),_0x36d2fe['initTimer']=!0x0,_0x36d2fe['resetTimer']=!0x1,_0x36d2fe['preTimeStamp']=_0x36d2fe['curFrame']['timestamp'],_0x36d2fe['baseTimeStamp']=_0x36d2fe['curFrame']['timestamp'],0x1==_0x36d2fe['streamOpenMode']&&(_0x36d2fe['LatcyTime']=0x0)),_0x36d2fe['curTimeStamp']=_0x36d2fe['curFrame']['timestamp'];var _0x20e28d=0x0,_0x7d112c=0x0;0x6==_0x4987c6?(_0x20e28d=_0x36d2fe['preTimeStamp']-_0x36d2fe['curTimeStamp'],_0x7d112c=_0x36d2fe['baseTimeStamp']-_0x36d2fe['curTimeStamp']):(_0x20e28d=_0x36d2fe['curTimeStamp']-_0x36d2fe['preTimeStamp'],_0x7d112c=_0x36d2fe['curTimeStamp']-_0x36d2fe['baseTimeStamp']);var _0x17876f=_0x36d2fe['oRenderTimer']['GetTimerWalk']();(_0x20e28d>0x1388||_0x20e28d<0x0||_0x7d112c<0x0||_0x17876f<=0x0)&&(_0x36d2fe['oRenderTimer']['Init'](),_0x36d2fe['preTimeStamp']=_0x36d2fe['curFrame']['timestamp'],_0x36d2fe['baseTimeStamp']=_0x36d2fe['curTimeStamp'],_0x7d112c=0x6==_0x4987c6?_0x36d2fe['baseTimeStamp']-_0x36d2fe['curTimeStamp']:_0x36d2fe['curTimeStamp']-_0x36d2fe['baseTimeStamp'],_0x17876f=_0x36d2fe['oRenderTimer']['GetTimerWalk']());var _0x4b593c=0x0;_0x4b593c=_0x36d2fe['StretchPlayFlag']?_0x36d2fe['StretchPlaySpeed']:_0x36d2fe['playSpeed'];var _0x5bb911=(_0x7d112c+_0x36d2fe['LatcyTime'])/_0x4b593c-_0x17876f;_0x36d2fe['printfFlag']>0x0&&console['log']('baseTimerWalk:'+_0x17876f+',lDeta:'+_0x5bb911+',Date\\x20:'+new Date()['getFullYear']()+'/'+(new Date()['getMonth']()+0x1)+'/'+new Date()['getDate']()+'\\x20'+new Date()['getHours']()+'-'+new Date()['getMinutes']()+'-'+new Date()['getSeconds']()+'-'+new Date()['getMilliseconds']()),_0x5bb911<0xf&&_0x5bb911>-0xf||_0x5bb911<0x0?(_0x36d2fe['StretchPlayFlag']&&_0x36d2fe['VideoStretchProcess'](_0x36d2fe['curTimeStamp']),_0x36d2fe['paint'](_0x36d2fe['curFrame']),_0x36d2fe['preTimeStamp']=_0x36d2fe['curTimeStamp'],_0x36d2fe['RenderFrame']()):_0x36d2fe['Sleep'](_0x5bb911-0x5)['then'](function(){0x2!=_0x36d2fe['renderCurStatus']&&0x6!=_0x36d2fe['renderCurStatus']||(_0x36d2fe['StretchPlayFlag']&&_0x36d2fe['VideoStretchProcess'](_0x36d2fe['curTimeStamp']),_0x36d2fe['paint'](_0x36d2fe['curFrame']),_0x36d2fe['preTimeStamp']=_0x36d2fe['curTimeStamp']),_0x36d2fe['RenderFrame']();});}else requestAnimationFrame(_0x36d2fe['RenderFrame']);}}})):requestAnimationFrame(this['RenderFrame']),_0x43430a['abrupt']('break',0x12);case 0xa:return this['_refresh'](),requestAnimationFrame(this['RenderFrame']),_0x43430a['abrupt']('break',0x12);case 0xd:return this['needForward']?this['chooseFrame']()['then'](function(_0x359d74){_0x36d2fe['curFrame']=_0x359d74,null!=_0x36d2fe['curFrame']&&(_0x36d2fe['curTimeStamp']=_0x36d2fe['curFrame']['timestamp'],_0x36d2fe['paint'](_0x36d2fe['curFrame']),_0x36d2fe['needForward']=!0x1),requestAnimationFrame(_0x36d2fe['RenderFrame']);}):(this['_refresh'](),requestAnimationFrame(this['RenderFrame'])),_0x43430a['abrupt']('break',0x12);case 0xf:return this['_destroyPlayCtrl'](),_0x43430a['abrupt']('return');case 0x11:return _0x43430a['abrupt']('return');case 0x12:case'end':return _0x43430a['stop']();}},_0x3e1f34,this);})),function(){return _0x394739['apply'](this,arguments);})},{'key':'paint','value':function(_0x50d3dd){var _0x3c851b=this,_0x1d85be=arguments['length']>0x1&&void 0x0!==arguments[0x1]&&arguments[0x1];return new Promise(function(_0x4696ac,_0x11cbef){if(0x4==_0x3c851b['renderCurStatus']||null==_0x50d3dd||null==_0x3c851b['oVideoRender']||0x1==_0x3c851b['ProcessPositionflag']||null==_0x50d3dd['timestamp'])_0x4696ac();else{_0x3c851b['waitIFrameTimestamp']===_0x50d3dd['timestamp']&&(_0x3c851b['resetTimer']=!0x0);var _0x26d64e={},_0x349d34=null;_0x349d34=null!=_0x50d3dd['image']&&null!=_0x50d3dd['image']?_0x50d3dd['image']:_0x50d3dd,_0x26d64e['nCropLeft']=0x0,_0x26d64e['nCropRight']=0x0,_0x26d64e['nCropTop']=0x0,_0x26d64e['nCropBottom']=0x0,_0x26d64e['nCodeWidth']=_0x50d3dd['displayWidth'],_0x26d64e['nCodeHeight']=_0x50d3dd['displayHeight'];var _0x4a7b37={'x':0x0,'y':0x0};if(_0x4a7b37['width']=_0x50d3dd['displayWidth'],_0x4a7b37['height']=_0x50d3dd['displayHeight'],_0x3c851b['RenderTypeFlagMap']['size']>0x0){var _0x1893b7,_0x25fcb4=_0x1486b7(_0x3c851b['RenderTypeFlagMap']['keys']());try{for(_0x25fcb4['s']();!(_0x1893b7=_0x25fcb4['n']())['done'];){var _0x5138fa=_0x1893b7['value'];if(_0x5138fa==_0x48ad0f){if(0x1==_0x3c851b['RenderTypeFlagMap']['get'](_0x5138fa)&&null!=_0x3c851b['runtimeCBFun']&&0x1==_0x3c851b['firstRenderBegin']){if(_0x3c851b['pstRuntimeInfo']['nRunTimeModule']=0x3,_0x3c851b['pstRuntimeInfo']['nStrVersion']=0x1,_0x3c851b['pstRuntimeInfo']['nFrameTimeStamp']=_0x50d3dd['timestamp'],_0x3c851b['pstRuntimeInfo']['nFrameNum']=0x0,_0x3c851b['pstRuntimeInfo']['nErrorCode']=_0x48ad0f,_0x3c851b['pstRuntimeInfo']['nInputDataInterval']=0x0,_0x3c851b['pstRuntimeInfo']['nFrameNumInterval']=0x0,_0x3c851b['pstRuntimeInfo']['nAverageDecodeTime']=0x0,0x1==_0x1d85be)_0x3c851b['pstRuntimeInfo']['AbsTimeYear']=_0x3c851b['curFrameInfo']['year'],_0x3c851b['pstRuntimeInfo']['AbsTimeMonth']=_0x3c851b['curFrameInfo']['month'],_0x3c851b['pstRuntimeInfo']['AbsTimeDay']=_0x3c851b['curFrameInfo']['day'],_0x3c851b['pstRuntimeInfo']['AbsTimeHour']=_0x3c851b['curFrameInfo']['hour'],_0x3c851b['pstRuntimeInfo']['AbsTimeMinute']=_0x3c851b['curFrameInfo']['minute'],_0x3c851b['pstRuntimeInfo']['AbsTimeSecond']=_0x3c851b['curFrameInfo']['second'],_0x3c851b['pstRuntimeInfo']['AbsTimeMilliseconds']=_0x3c851b['curFrameInfo']['milliseconds'];else{var _0x189582=new Object();_0x189582=_0x3c851b['findFramebyTime'](_0x50d3dd['timestamp'],0x0),_0x3c851b['pstRuntimeInfo']['AbsTimeYear']=_0x189582['year'],_0x3c851b['pstRuntimeInfo']['AbsTimeMonth']=_0x189582['month'],_0x3c851b['pstRuntimeInfo']['AbsTimeDay']=_0x189582['day'],_0x3c851b['pstRuntimeInfo']['AbsTimeHour']=_0x189582['hour'],_0x3c851b['pstRuntimeInfo']['AbsTimeMinute']=_0x189582['minute'],_0x3c851b['pstRuntimeInfo']['AbsTimeSecond']=_0x189582['second'],_0x3c851b['pstRuntimeInfo']['AbsTimeMilliseconds']=_0x189582['milliseconds'];}_0x3c851b['runtimeCBFun'](_0x3c851b['pstRuntimeInfo']),_0x3c851b['firstRenderBegin']=!0x1;}}}}catch(_0x25bdce){_0x25fcb4['e'](_0x25bdce);}finally{_0x25fcb4['f']();}}_0x3c851b['oVideoRender']['DisplayFrame'](_0x349d34,_0x50d3dd['displayWidth'],_0x50d3dd['displayHeight'],_0x50d3dd['timestamp'],_0x26d64e,null,_0x3c851b['nFrameRate'],_0x1d85be)['then'](function(_0x571f25){var _0x4120b1=_0x571f25['timestamp'],_0x533fac=_0x571f25['DrawRet'];if(_0x3c851b['RenderTypeFlagMap']['size']>0x0&&0x1!=_0x533fac){var _0x1ddc99,_0x4989db=_0x1486b7(_0x3c851b['RenderTypeFlagMap']['keys']());try{for(_0x4989db['s']();!(_0x1ddc99=_0x4989db['n']())['done'];){var _0x563a73=_0x1ddc99['value'];if(0x10==_0x563a73)0x1==_0x3c851b['RenderTypeFlagMap']['get'](_0x563a73)&&null!=_0x3c851b['runtimeCBFun']&&(_0x3c851b['pstRuntimeInfo']['nRunTimeModule']=0x3,_0x3c851b['pstRuntimeInfo']['nStrVersion']=0x1,_0x3c851b['pstRuntimeInfo']['nFrameTimeStamp']=_0x4120b1,_0x3c851b['pstRuntimeInfo']['nFrameNum']=0x0,_0x3c851b['pstRuntimeInfo']['nErrorCode']=0x10,_0x3c851b['runtimeCBFun'](_0x3c851b['pstRuntimeInfo']));}}catch(_0x4e6bc6){_0x4989db['e'](_0x4e6bc6);}finally{_0x4989db['f']();}}if(null!==_0x3c851b['displayFrameInfoCB']&&_0x3c851b['respondFrameInfoCB'](_0x4120b1),_0x3c851b['RenderTypeFlagMap']['size']>0x0){var _0x21a1fb,_0x4946e6=_0x1486b7(_0x3c851b['RenderTypeFlagMap']['keys']());try{for(_0x4946e6['s']();!(_0x21a1fb=_0x4946e6['n']())['done'];){var _0x4abb87=_0x21a1fb['value'];if(_0x4abb87==_0x694ebe)0x1==_0x3c851b['RenderTypeFlagMap']['get'](_0x4abb87)&&null!=_0x3c851b['runtimeCBFun']&&(_0x3c851b['pstRuntimeInfo']['nRunTimeModule']=0x3,_0x3c851b['pstRuntimeInfo']['nStrVersion']=0x1,_0x3c851b['pstRuntimeInfo']['nFrameTimeStamp']=_0x4120b1,_0x3c851b['pstRuntimeInfo']['nFrameNum']=0x0,_0x3c851b['pstRuntimeInfo']['nErrorCode']=_0x694ebe,_0x3c851b['pstRuntimeInfo']['nInputDataInterval']=0x0,_0x3c851b['pstRuntimeInfo']['nFrameNumInterval']=0x0,_0x3c851b['pstRuntimeInfo']['nAverageDecodeTime']=0x0,_0x3c851b['pstRuntimeInfo']['AbsTimeYear']=_0x3c851b['curFrameInfo']['year'],_0x3c851b['pstRuntimeInfo']['AbsTimeMonth']=_0x3c851b['curFrameInfo']['month'],_0x3c851b['pstRuntimeInfo']['AbsTimeDay']=_0x3c851b['curFrameInfo']['day'],_0x3c851b['pstRuntimeInfo']['AbsTimeHour']=_0x3c851b['curFrameInfo']['hour'],_0x3c851b['pstRuntimeInfo']['AbsTimeMinute']=_0x3c851b['curFrameInfo']['minute'],_0x3c851b['pstRuntimeInfo']['AbsTimeSecond']=_0x3c851b['curFrameInfo']['second'],_0x3c851b['pstRuntimeInfo']['AbsTimeMilliseconds']=_0x3c851b['curFrameInfo']['milliseconds'],_0x3c851b['runtimeCBFun'](_0x3c851b['pstRuntimeInfo']));}}catch(_0x3eb8b7){_0x4946e6['e'](_0x3eb8b7);}finally{_0x4946e6['f']();}}if(_0x3c851b['firstFrame']){_0x3c851b['firstFrame']=!0x1;var _0x3ffca1=_0x3c851b;_0x3c851b['oVideoRender']['GetCanvasData'](function(_0x4ffb4d,_0x34ce8f,_0x639e5e){if(null!=_0x4ffb4d){var _0xf5be80=_0x3ffca1['checkColorAnomaly'](_0x4ffb4d,_0x34ce8f,_0x639e5e);console['log']('checkColorAnomaly\\x20resC:'+_0xf5be80),_0xf5be80&&_0x3ffca1['HardDecodeError']();}}),null!=_0x3c851b['player']?null!=_0x3c851b['player']['FFCallBackFun']&&_0x3c851b['player']['FFCallBackFun']({'decodeEngine':0x1}):postMessage({'function':'firstFrameCB','value':!0x0});}_0x3c851b['startRecoderFlag']&&0x0==_0x3c851b['stopRecoderFlag']&&_0x3c851b['oVideoRender']['GetCanvasData'](function(_0x76227,_0x26694c,_0xd3e88a){if(null!=_0x76227){if(0x0==_0x3c851b['recoderBaseTimestampMode']){0x0==_0x3c851b['vBaseTimeStamp']&&(_0x3c851b['vBaseTimeStamp']=0x3c*new Date()['getHours']()*0x3c*0x3e8+0x3c*new Date()['getMinutes']()*0x3e8+0x3e8*new Date()['getSeconds']()+new Date()['getMilliseconds']());var _0x5dcd72=0x3c*new Date()['getHours']()*0x3c*0x3e8+0x3c*new Date()['getMinutes']()*0x3e8+0x3e8*new Date()['getSeconds']()+new Date()['getMilliseconds']();_0x3c851b['recoderFrameTimeStamp']=_0x5dcd72-_0x3c851b['vBaseTimeStamp'];}else 0x1==_0x3c851b['recoderBaseTimestampMode']||(_0x3c851b['recoderBaseTimestampMode']=0x1),_0x3c851b['recoderFrameTimeStamp']=_0x4120b1;var _0x509287={'timestamp':0x3e8*_0x3c851b['recoderFrameTimeStamp'],'codedWidth':_0x3c851b['encodeVideoInfo']['encodeWidth'],'codedHeight':_0x3c851b['encodeVideoInfo']['encodeHeight'],'format':'RGBA'},_0x5f514a=new VideoFrame(_0x76227,_0x509287),_0x3cebbd={};_0x3cebbd['year']=_0x3c851b['curFrameInfo']['year'],_0x3cebbd['month']=_0x3c851b['curFrameInfo']['month'],_0x3cebbd['day']=_0x3c851b['curFrameInfo']['day'],_0x3cebbd['hour']=_0x3c851b['curFrameInfo']['hour'],_0x3cebbd['minute']=_0x3c851b['curFrameInfo']['minute'],_0x3cebbd['second']=_0x3c851b['curFrameInfo']['second'],_0x3cebbd['milliseconds']=_0x3c851b['curFrameInfo']['milliseconds'],_0x3c851b['oVideoEncoder']['inputData'](_0x5f514a,_0x3cebbd),_0x5f514a['close'](),_0x76227=null,_0x3c851b['recoderFrameNum']++;}_0x4696ac();},_0x3c851b['encodeVideoInfo']['encodeWidth'],_0x3c851b['encodeVideoInfo']['encodeHeight'],_0x3c851b['recoderGetOriginData']);});}});}},{'key':'checkColorAnomaly','value':function(_0xceb9ac,_0x5b2f57,_0x5d17b1){for(var _0xbd80fd=0x0,_0x592fb1=_0x5b2f57*_0x5d17b1,_0x5d100b=0x0;_0x5d100b<_0xceb9ac['length'];_0x5d100b+=0x4){var _0xfda230=_0xceb9ac[_0x5d100b],_0x4b91ec=_0xceb9ac[_0x5d100b+0x1],_0x3f3712=_0xceb9ac[_0x5d100b+0x2];_0x4b91ec>1.5*_0xfda230&&_0x4b91ec>1.5*_0x3f3712&&_0xbd80fd++;}return _0xbd80fd/_0x592fb1>0.05;}},{'key':'respondFrameInfoCB','value':function(_0x372490){if(0x0!=this['displayFrameInfo']['length']&&(this['curFrameInfo']['timeStamp']!==_0x372490||0x0==_0x372490&&0x0==this['curFrameInfo']['timeStamp'])){var _0x5baf98=this['findFramebyTime'](_0x372490,0x1);this['curFrameInfo']['port']=_0x5baf98['port'],this['curFrameInfo']['codecType']=_0x5baf98['codecType'],this['curFrameInfo']['frameType']=_0x5baf98['frameType'],this['curFrameInfo']['frameSize']=_0x5baf98['frameSize'],this['curFrameInfo']['width']=_0x5baf98['width']-(0x2*_0x5baf98['cropLeft']+0x2*_0x5baf98['cropRight']),this['curFrameInfo']['height']=_0x5baf98['height']-(0x2*_0x5baf98['cropTop']+0x2*_0x5baf98['cropBottom']),this['curFrameInfo']['timeStamp']=_0x5baf98['timeStamp'],this['curFrameInfo']['frameRate']=_0x5baf98['frameRate'],this['curFrameInfo']['frameNum']=_0x5baf98['frameNum'],this['curFrameInfo']['interlace']=_0x5baf98['interlace'],this['curFrameInfo']['streamEnd']=_0x5baf98['streamEnd'],this['curFrameInfo']['cropLeft']=_0x5baf98['cropLeft'],this['curFrameInfo']['cropRight']=_0x5baf98['cropRight'],this['curFrameInfo']['cropTop']=_0x5baf98['cropTop'],this['curFrameInfo']['cropBottom']=_0x5baf98['cropBottom'],this['curFrameInfo']['year']=_0x5baf98['year'],this['curFrameInfo']['month']=_0x5baf98['month'],this['curFrameInfo']['week']=_0x5baf98['week'],this['curFrameInfo']['day']=_0x5baf98['day'],this['curFrameInfo']['hour']=_0x5baf98['hour'],this['curFrameInfo']['minute']=_0x5baf98['minute'],this['curFrameInfo']['second']=_0x5baf98['second'],this['curFrameInfo']['milliseconds']=_0x5baf98['milliseconds'],_0x5baf98=null,null!=this['displayFrameInfoCB']&&this['displayFrameInfoCB'](this['curFrameInfo']);}}},{'key':'findFramebyTime','value':function(_0x1d65cf,_0x2cd178){var _0x3f41f2=new Object();if(_0x3f41f2=this['displayFrameInfo']['find'](function(_0x2b90c1){return _0x2b90c1['timeStamp']==_0x1d65cf;}),0x1==_0x2cd178){var _0x570968=this['displayFrameInfo']['findIndex'](function(_0x20fb90){return _0x20fb90['timeStamp']==_0x1d65cf;});this['displayFrameInfo']['splice'](_0x570968,0x1);}return _0x3f41f2;}},{'key':'chooseFrame','value':function(){var _0x2c7212=this;return new Promise(function(_0x48a49b,_0x39eb23){if(null==_0x2c7212['oVideoRender']||null==_0x2c7212['oVideoDecoder'])_0x48a49b(null);else{if(_0x2c7212['oVideoDecoder']['decoderObjNeedReset'])_0x2c7212['oVideoDecoder']['resetDecoder']()['then'](function(){_0x2c7212['oVideoDecoder']['decoderObjNeedReset']=!0x1,_0x48a49b(null);},function(){_0x39eb23();});else{var _0x4fbc57=_0x2c7212['oVideoDecoder']['GetFrameBufferLength']();if(-0x1!=_0x2c7212['displayBuf']){if(_0x4fbc57<0x3){if(0x1==_0x2c7212['bSetStreamEnd']&&(_0x2c7212['nstreamEndloopNum']++,_0x2c7212['nstreamEndloopNum']>=0x32&&null!=_0x2c7212['player']&&null!=_0x2c7212['player']['runtimeCBFun'])){var _0x1a5d16={'nRunTimeModule':0x0,'nStrVersion':0x0,'nFrameTimeStamp':0x0,'nFrameNum':0x0,'nErrorCode':0x9};_0x2c7212['player']['runtimeCBFun'](_0x1a5d16),_0x2c7212['bSetStreamEnd']=!0x1,_0x2c7212['nstreamEndloopNum']=0x0;}_0x48a49b(null);}else 0x1==_0x2c7212['bSetStreamEnd']&&(_0x2c7212['nstreamEndloopNum']=0x0),_0x2c7212['oVideoDecoder']['GetFrame']()['then'](function(_0x24cd9d){_0x48a49b(_0x24cd9d);},function(){});}else{if(0x0==_0x4fbc57){if(0x1==_0x2c7212['bSetStreamEnd']&&(_0x2c7212['nstreamEndloopNum']++,_0x2c7212['nstreamEndloopNum']>=0x32&&null!=_0x2c7212['player']&&null!=_0x2c7212['player']['runtimeCBFun'])){var _0x58f8d8={'nRunTimeModule':0x0,'nStrVersion':0x0,'nFrameTimeStamp':0x0,'nFrameNum':0x0,'nErrorCode':0x9};_0x2c7212['player']['runtimeCBFun'](_0x58f8d8),_0x2c7212['bSetStreamEnd']=!0x1,_0x2c7212['nstreamEndloopNum']=0x0;}_0x48a49b(null);}else 0x1==_0x2c7212['bSetStreamEnd']&&(_0x2c7212['nstreamEndloopNum']=0x0),_0x2c7212['oVideoDecoder']['GetFrame']()['then'](function(_0x44fee2){_0x48a49b(_0x44fee2);},function(){});}}}});}},{'key':'SetDisplayRegion','value':function(_0xe54d8,_0x55a7e2,_0xe12ab1,_0x12d8a1){return null==this['oVideoRender']?0x0:(this['sx']=_0xe54d8,this['sy']=_0x55a7e2,this['sw']=_0xe12ab1,this['sh']=_0x12d8a1,this['oVideoRender']['SetDisplayRect'](_0xe54d8,_0x55a7e2,_0xe12ab1,_0x12d8a1));}},{'key':'SetCurStatus','value':function(_0x148324){var _0x4a7da8=!(arguments['length']>0x1&&void 0x0!==arguments[0x1])||arguments[0x1];return this['bResetdisplayFrameInfoCB']=_0x4a7da8,this['renderCurStatus']=_0x148324,0x1;}},{'key':'fast','value':function(){var _0x130b73=this['_GetFastSpeed'](this['nplaySpeed']);return this['_SetPlaySpeed'](_0x130b73);}},{'key':'slow','value':function(){var _0xaa1d4f=this['_GetSlowSpeed'](this['nplaySpeed']);return this['_SetPlaySpeed'](_0xaa1d4f);}},{'key':'Pause','value':function(_0x2312a9){if(_0x2312a9)0x2!=this['renderCurStatus']&&0x6!=this['renderCurStatus']||(this['renderLastStatus']=this['renderCurStatus']),this['SetCurStatus'](0x3);else{if(0x3!==this['renderCurStatus'])return 0x0;0x2===this['renderLastStatus']?this['SetCurStatus'](0x2):0x6===this['renderLastStatus']&&this['SetCurStatus'](0x6),this['resetTimer']=!0x0;}return 0x1;}},{'key':'NotifyBackPlay','value':function(_0x59e2cc){if(_0x59e2cc?this['SetCurStatus'](0x6):this['SetCurStatus'](0x2),null!=this['oVideoDecoder']){if(0x2==this['PlayOrBackMode'])this['oVideoDecoder']['NotifyBackPlay'](_0x59e2cc,this['preTimeStamp'],0x0);else{var _0x352314=0x1==_0x59e2cc?0x2:0x1;this['oVideoDecoder']['NotifyBackPlay'](_0x59e2cc,this['preTimeStamp'],_0x352314);}}return this['resetTimer']=!0x0,0x1;}},{'key':'SetPlayOrBackSwitchMode','value':function(_0x17bcbd){return this['PlayOrBackMode']=_0x17bcbd,0x1;}},{'key':'SetStretchPlay','value':function(_0x4f6403,_0x5f43e6){return 0x2!=this['renderCurStatus']||this['playSpeed']>1.1||this['playSpeed']<0.9?0x0:(this['StretchPlayTime']=_0x4f6403,this['StretchPlayedTime']=0x0,this['StretchPlaySpeed']=_0x5f43e6,this['StretchPlayFlag']=!0x0,this['resetTimer']=!0x0,0x1);}},{'key':'VideoStretchProcess','value':function(_0x271001){return this['StretchPlayFlag']&&(this['printfFlag']>0x0&&console['log']('StretchPlayedTime:'+this['StretchPlayedTime']+',StretchPlayTime:'+this['StretchPlayTime']),this['StretchPlayedTime']<this['StretchPlayTime']?this['StretchPlayedTime']+=_0x271001-this['preTimeStamp']:(this['StretchPlayedTime']=0x0,this['StretchPlayFlag']=!0x1,this['resetTimer']=!0x0)),0x1;}},{'key':'_refresh','value':function(){0x0!=this['frameBuffers']['length']&&this['paint'](this['frameBuffers'][0x0],!0x0);}},{'key':'OneByOne','value':function(_0x105581){if(_0x105581)0x2!=this['renderCurStatus']&&0x6!=this['renderCurStatus']||(this['renderLastStatus']=this['renderCurStatus']),this['SetCurStatus'](0x5),this['needForward']=!0x0;else{if(0x5!==this['renderCurStatus'])return-0x1;0x2===this['renderLastStatus']?this['SetCurStatus'](0x2):0x6===this['renderLastStatus']&&this['SetCurStatus'](0x6),this['resetTimer']=!0x0,this['needForward']=!0x1,this['_SetPlaySpeed'](0x1);}return 0x1;}},{'key':'SetCanvasSize','value':function(_0x6e9ac6,_0x56ed6e,_0x652798){return null!=this['oVideoRender']?this['oVideoRender']['SetCanvasSize'](_0x6e9ac6,_0x56ed6e,_0x652798):0x0;}},{'key':'GetCanvasSize','value':function(){return null!=this['oVideoRender']?this['oVideoRender']['GetCanvasSize']():0x0;}},{'key':'GetPlayedTime','value':function(){return this['curTimeStamp'];}},{'key':'SetTargetRelativePos','value':function(_0x468c94,_0x388e56,_0x23c989){this['nTargetRelativePos']=_0x468c94,this['nMPPlayMode']=_0x23c989,this['nMPPosType']=_0x388e56,this['ProcessPositionflag']=!0x0;}},{'key':'_SetPlaySpeed','value':function(_0x9973f5){switch(_0x9973f5){case-0x10:case-0x8:case-0x4:case-0x2:case 0x1:case 0x2:case 0x4:case 0x8:case 0x10:case 0x20:case 0x40:break;default:return-0x1;}return _0x9973f5===this['nplaySpeed']||(this['nplaySpeed']=_0x9973f5,this['playSpeed']=_0x9973f5>0x0?_0x9973f5:-0x1/_0x9973f5,console['log']('playSpeed:'+this['playSpeed']),this['resetTimer']=!0x0,this['needForward']=!0x1,0x2!=this['renderCurStatus']&&0x6!=this['renderCurStatus']&&(0x2===this['renderLastStatus']?this['SetCurStatus'](0x2):0x6===this['renderLastStatus']&&this['SetCurStatus'](0x6))),0x1;}},{'key':'_GetFastSpeed','value':function(_0x56c969){var _0x3ca2ea=0x0;switch(_0x56c969){case-0x10:_0x3ca2ea=-0x8;break;case-0x8:_0x3ca2ea=-0x4;break;case-0x4:_0x3ca2ea=-0x2;break;case-0x2:_0x3ca2ea=0x1;break;case 0x1:_0x3ca2ea=0x2;break;case 0x2:_0x3ca2ea=0x4;break;case 0x4:_0x3ca2ea=0x8;break;case 0x8:_0x3ca2ea=0x10;break;case 0x10:_0x3ca2ea=0x20;break;case 0x20:_0x3ca2ea=0x40;break;default:_0x3ca2ea=0x0;}return _0x3ca2ea;}},{'key':'_GetSlowSpeed','value':function(_0x4fbe8e){var _0x3f5f1d=0x0;switch(_0x4fbe8e){case-0x8:_0x3f5f1d=-0x10;break;case-0x4:_0x3f5f1d=-0x8;break;case-0x2:_0x3f5f1d=-0x4;break;case 0x1:_0x3f5f1d=-0x2;break;case 0x2:_0x3f5f1d=0x1;break;case 0x4:_0x3f5f1d=0x2;break;case 0x8:_0x3f5f1d=0x4;break;case 0x10:_0x3f5f1d=0x8;break;case 0x20:_0x3f5f1d=0x10;break;case 0x40:_0x3f5f1d=0x20;break;default:_0x3f5f1d=0x0;}return _0x3f5f1d;}},{'key':'SetDisplayBuf','value':function(_0x5a176b){return this['displayBuf']=_0x5a176b,this['LatcyTime']=0x1==_0x5a176b?0x0:0xf==_0x5a176b?0x2bc:0x2d==_0x5a176b?0x76c:_0x5a176b>0x6&&_0x5a176b<0x2d?0x28*_0x5a176b+0x64:-0x1==_0x5a176b?0x0:0x32,0x1;}},{'key':'GetJPEG','value':function(){var _0xd5cb72=this;null!=this['oVideoDecoder']&&this['oVideoDecoder']['GetImageYUV']('jpeg',0x0,0x0,0x0,0x0)['then'](function(_0x58202f){var _0x1cbf97=_0x58202f['yuvFrameBuffer'],_0x40db71=_0x58202f['yuvLength'],_0x3bd936=_0x58202f['displayWidth'],_0x397bb5=_0x58202f['displayHeight'],_0x315c61=_0x58202f['yuvType'];-0x1!=_0x1cbf97&&(_0xd5cb72['player']?_0xd5cb72['player']['_GetImage2'](_0x1cbf97,_0x40db71,_0x3bd936,_0x397bb5,'jpeg',_0x315c61,0x0,0x0,0x0,0x0):postMessage({'function':'imageYUV','value':_0x1cbf97['buffer'],'size':_0x40db71,'width':_0x3bd936,'height':_0x397bb5,'type':'jpeg','yuvType':_0x315c61,'sx':0x0,'sy':0x0,'sw':0x0,'sh':0x0},[_0x1cbf97['buffer']]));},function(){});}},{'key':'GetBMP','value':function(){var _0x2ba826=this;null!=this['oVideoDecoder']&&this['oVideoDecoder']['GetImageYUV']('bmp',0x0,0x0,0x0,0x0)['then'](function(_0x1de22d){var _0x44e4c4=_0x1de22d['yuvFrameBuffer'],_0x1f4b93=_0x1de22d['yuvLength'],_0x16a98e=_0x1de22d['displayWidth'],_0x3c1c4f=_0x1de22d['displayHeight'],_0x21cc3e=_0x1de22d['yuvType'];-0x1!=_0x44e4c4&&(_0x2ba826['player']?_0x2ba826['player']['_GetImage2'](_0x44e4c4,_0x1f4b93,_0x16a98e,_0x3c1c4f,'bmp',_0x21cc3e,0x0,0x0,0x0,0x0):postMessage({'function':'imageYUV','value':_0x44e4c4['buffer'],'size':_0x1f4b93,'width':_0x16a98e,'height':_0x3c1c4f,'type':'bmp','yuvType':_0x21cc3e,'sx':0x0,'sy':0x0,'sw':0x0,'sh':0x0},[_0x44e4c4['buffer']]));},function(){});}},{'key':'GetCropJPEG','value':function(){var _0x7e0464=this;null!=this['oVideoDecoder']&&this['oVideoDecoder']['GetImageYUV']('jpeg',this['sx'],this['sy'],this['sw'],this['sh'])['then'](function(_0x459067){var _0x54923d=_0x459067['yuvFrameBuffer'],_0x3b1dbb=_0x459067['yuvLength'],_0x74c1da=_0x459067['displayWidth'],_0x34f72b=_0x459067['displayHeight'],_0x4a8540=_0x459067['yuvType'];-0x1!=_0x54923d&&(_0x7e0464['player']?_0x7e0464['player']['_GetImage2'](_0x54923d,_0x3b1dbb,_0x74c1da,_0x34f72b,'jpeg',_0x4a8540,_0x7e0464['sx'],_0x7e0464['sy'],_0x7e0464['sw'],_0x7e0464['sh']):postMessage({'function':'imageYUV','value':_0x54923d['buffer'],'size':_0x3b1dbb,'width':_0x74c1da,'height':_0x34f72b,'type':'jpeg','yuvType':_0x4a8540,'sx':_0x7e0464['sx'],'sy':_0x7e0464['sy'],'sw':_0x7e0464['sw'],'sh':_0x7e0464['sh']},[_0x54923d['buffer']]));},function(){});}},{'key':'GetCropBMP','value':function(){var _0x442380=this;null!=this['oVideoDecoder']&&this['oVideoDecoder']['GetImageYUV']('bmp',this['sx'],this['sy'],this['sw'],this['sh'])['then'](function(_0x530c75){var _0x2c9cab=_0x530c75['yuvFrameBuffer'],_0x2bbfcc=_0x530c75['yuvLength'],_0x2410a9=_0x530c75['displayWidth'],_0x3d6ee2=_0x530c75['displayHeight'],_0x25544c=_0x530c75['yuvType'];-0x1!=_0x2c9cab&&(_0x442380['player']?_0x442380['player']['_GetImage2'](_0x2c9cab,_0x2bbfcc,_0x2410a9,_0x3d6ee2,'bmp',_0x25544c,_0x442380['sx'],_0x442380['sy'],_0x442380['sw'],_0x442380['sh']):postMessage({'function':'imageYUV','value':_0x2c9cab['buffer'],'size':_0x2bbfcc,'width':_0x2410a9,'height':_0x3d6ee2,'type':'bmp','yuvType':_0x25544c,'sx':_0x442380['sx'],'sy':_0x442380['sy'],'sw':_0x442380['sw'],'sh':_0x442380['sh']},[_0x2c9cab['buffer']]));},function(){});}},{'key':'GetCanvasCapture','value':function(_0x3060f5,_0xbf70ba,_0x19971d){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20GetCanvasCapture','color:red'),0x0):(this['oVideoRender']['GetCanvasData'](_0x3060f5,_0xbf70ba,_0x19971d),0x1);}},{'key':'SetDecodeFrameType','value':function(_0x540d1c){return this['waitIFrameTimestamp']=_0x540d1c,0x1;}},{'key':'SetStreamEnd','value':function(_0x49f2c2){return this['bSetStreamEnd']=_0x49f2c2,this['oVideoDecoder']['SetStreamEnd'](),0x1;}},{'key':'SetAntialias','value':function(_0x5a8be8){return null!=this['oVideoRender']?this['oVideoRender']['SetAntialias'](_0x5a8be8):0x0;}},{'key':'SetFrameInfoCallBack','value':function(_0x4769ba,_0x36982a){return _0x36982a?(this['needSaveFrameInfo']=!0x0,this['displayFrameInfoCB']=_0x4769ba):(this['needSaveFrameInfo']=!0x1,this['displayFrameInfoCB']=null),0x1;}},{'key':'FEC_SetCanvasID','value':function(_0xd447c4){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20FEC\\x20correct','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['FEC_SetCanvasID'](_0xd447c4):(this['FECCanvasID']=_0xd447c4,0x0);}},{'key':'FEC_ResetCorrectType','value':function(_0x18a703,_0x5afbc6,_0x1a76d1){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20FEC\\x20correct','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['FEC_ResetCorrectType'](_0x18a703,_0x5afbc6,_0x1a76d1):0x0;}},{'key':'FEC_GetPort','value':function(_0x11aca2,_0x3f2171){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20FEC\\x20correct','color:red'),-0x1):null!=this['oVideoRender']?this['oVideoRender']['FEC_GetPort'](_0x11aca2,_0x3f2171):-0x1;}},{'key':'FEC_Enable','value':function(_0x23f844){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20FEC\\x20correct','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['FEC_Enable'](_0x23f844):0x0;}},{'key':'FEC_SetParam','value':function(_0x16d7f9,_0x476f14){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20FEC\\x20correct','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['FEC_SetParam'](_0x16d7f9,_0x476f14):0x0;}},{'key':'FEC_GetParam','value':function(_0x56e91d,_0x5c7796){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20FEC\\x20correct','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['FEC_GetParam'](_0x56e91d,_0x5c7796):0x0;}},{'key':'FEC_SetViewParam','value':function(_0x2f1ef5,_0x5cddf2,_0x30b85d){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20FEC\\x20correct','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['FEC_SetViewParam'](_0x2f1ef5,_0x5cddf2,_0x30b85d):0x0;}},{'key':'FEC_GetViewParam','value':function(_0x1f6bc9,_0x17a126,_0xebf466){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20FEC\\x20correct','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['FEC_GetViewParam'](_0x1f6bc9,_0x17a126,_0xebf466):0x0;}},{'key':'FEC_SetWnd','value':function(_0x48e19a,_0x34849b){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20FEC\\x20correct','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['FEC_SetWnd'](_0x48e19a,_0x34849b):0x0;}},{'key':'FEC_Disable','value':function(_0x4b3c59,_0x1317b2,_0x38caa5){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20FEC\\x20correct','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['FEC_Disable'](_0x4b3c59,_0x1317b2,_0x38caa5):0x0;}},{'key':'FEC_DelPort','value':function(_0x335eef){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20FEC\\x20correct','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['FEC_DelPort'](_0x335eef):0x0;}},{'key':'FEC_SetDisplayRegion','value':function(_0x126d3f,_0x1bef81,_0x44632d,_0x186d95,_0x150fdd,_0x479dcd,_0x5c5e09){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20FEC\\x20correct','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['FEC_SetDisplayRegion'](_0x126d3f,_0x1bef81,_0x44632d,_0x186d95,_0x150fdd,_0x479dcd,_0x5c5e09):0x0;}},{'key':'FEC_SetBackCilling','value':function(_0x1101ec,_0xdfcf72){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20FEC\\x20correct','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['FEC_SetBackCilling'](_0x1101ec,_0xdfcf72):0x0;}},{'key':'FEC_GetPTZPort','value':function(_0x204ad8,_0x222d46,_0x896c9d){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20FEC\\x20correct','color:red'),-0x1):null!=this['oVideoRender']?this['oVideoRender']['FEC_GetPTZPort'](_0x204ad8,_0x222d46,_0x896c9d):-0x1;}},{'key':'FEC_SetPTZDisplayMode','value':function(_0x10b23d){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20FEC\\x20correct','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['FEC_SetPTZDisplayMode'](_0x10b23d):0x0;}},{'key':'FEC_Capture','value':function(_0x3dea20,_0x45c406){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20FEC_Capture','color:red'),0x0):this['oVideoRender']['FEC_Capture'](_0x3dea20,_0x45c406);}},{'key':'InputPrivateInfo','value':function(_0x143e89,_0x1f2d5c,_0x15ba80){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20PrivateInfo','color:red'),0x0):((null!=_0x143e89&&_0x143e89['linesNum']>0x0||null!=_0x1f2d5c&&_0x1f2d5c['nFontsNum']>0x0)&&0x0==this['firstFrame']&&(this['LatcyTime']=0x64),this['curPrivateInfo']['linesInfo']['push'](_0x143e89),this['curPrivateInfo']['fontInfo']['push'](_0x1f2d5c),this['curPrivateInfo']['imageInfo']['push'](_0x15ba80),0x1);}},{'key':'deepClone','value':function(_0x1c75ed){if(null===_0x1c75ed||'object'!==_0x1113ff(_0x1c75ed))return _0x1c75ed;if(Array['isArray'](_0x1c75ed)){for(var _0x53332f=[],_0x1ba067=0x0;_0x1ba067<_0x1c75ed['length'];_0x1ba067++)_0x53332f[_0x1ba067]=this['deepClone'](_0x1c75ed[_0x1ba067]);return _0x53332f;}if(ArrayBuffer['isView'](_0x1c75ed)){var _0x193ad6=new Uint8Array(_0x1c75ed['length']);return _0x193ad6['set'](_0x1c75ed),_0x193ad6;}var _0x21340c={};for(var _0x32f138 in _0x1c75ed)_0x1c75ed['hasOwnProperty'](_0x32f138)&&(_0x21340c[_0x32f138]=this['deepClone'](_0x1c75ed[_0x32f138]));return _0x21340c;}},{'key':'RenderPrivateData','value':function(_0x2126e5,_0x1ee4ec){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20PrivateInfo','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['RenderPrivateData'](_0x2126e5,_0x1ee4ec):0x0;}},{'key':'RenderPrivateDataEx','value':function(_0x1c3b1c,_0x250214,_0x33e0f0){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20PrivateInfo','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['RenderPrivateDataEx'](_0x1c3b1c,_0x250214,_0x33e0f0):0x0;}},{'key':'SetWaterMarkFont','value':function(_0x2ad436){return'2d'===this['renderEngine']||'2D'===this['renderEngine']||null==this['oVideoRender']?(console['log']('%c\\x20param\\x20error\\x20this.renderEngine:%d,this.oVideoRender:%d','color:red',this['renderEngine'],this['oVideoRender']),0x0):null!=this['oVideoRender']?this['oVideoRender']['SetWaterMarkFont'](_0x2ad436):0x0;}},{'key':'SetWaterMarkImage','value':function(_0x5dbda3){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20SetWaterMarkImage','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['SetWaterMarkImage'](_0x5dbda3):0x0;}},{'key':'SetMosaicType','value':function(_0x217dfa){return'2d'===this['renderEngine']||'2D'===this['renderEngine']||null==this['oVideoRender']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20SetMosaicType','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['SetMosaicType'](_0x217dfa):0x0;}},{'key':'SelectIntelInfoFeatureToDraw','value':function(_0x2e5295){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20SelectIntelInfoFeatureToDraw','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['SelectIntelInfoFeatureToDraw'](_0x2e5295):0x0;}},{'key':'SetD3DPostProcess','value':function(_0x10b7aa,_0x4023aa){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20SetD3DPostProcess','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['SetD3DPostProcess'](_0x10b7aa,_0x4023aa):0x0;}},{'key':'SetTextCanvas','value':function(_0x442df3){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20SetD3DPostProcess','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['SetTextCanvas'](_0x442df3):0x0;}},{'key':'SetPrintLogFlag','value':function(_0x4f8a85){return this['printfFlag']=_0x4f8a85,null!=this['oVideoDecoder']&&this['oVideoDecoder']['SetPrintLogFlag'](_0x4f8a85),null!=this['oVideoRender']&&this['oVideoRender']['SetPrintLogFlag'](_0x4f8a85),0x1;}},{'key':'SetRotateAngle','value':function(_0x471e5b){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20SetRotateAngle','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['SetRotateAngle'](_0x471e5b):0x0;}},{'key':'InitEncoder','value':function(_0x5c868a,_0x40ec10){return _0x5c868a['encodeWidth']>0x0||_0x5c868a['encodeHeight']>0x0?(this['encodeVideoInfo']['encodeWidth']=_0x5c868a['encodeWidth'],this['encodeVideoInfo']['encodeHeight']=_0x5c868a['encodeHeight']):null!=this['curFrameInfo']['width']&&this['curFrameInfo']['width']>0x0&&this['curFrameInfo']['width']<=0x578&&null!=this['curFrameInfo']['height']&&this['curFrameInfo']['height']>0x0&&this['curFrameInfo']['height']<=0x320?(this['encodeVideoInfo']['encodeWidth']=this['curFrameInfo']['width'],this['encodeVideoInfo']['encodeHeight']=this['curFrameInfo']['height']):(this['encodeVideoInfo']['encodeWidth']=0x500,this['encodeVideoInfo']['encodeHeight']=0x2d0),_0x5c868a['bitrate']>0x0?this['encodeVideoInfo']['bitrate']=_0x5c868a['bitrate']:this['encodeVideoInfo']['encodeWidth']>0x62c?this['encodeVideoInfo']['bitrate']=0x3d0900:this['encodeVideoInfo']['encodeWidth']>0x320?this['encodeVideoInfo']['bitrate']=0x1e8480:this['encodeVideoInfo']['bitrate']=0xf4240,_0x5c868a['frameRate']>0x0?this['encodeVideoInfo']['frameRate']=_0x5c868a['frameRate']:'frameRate'in this['curFrameInfo']&&(this['encodeVideoInfo']['frameRate']=this['curFrameInfo']['frameRate']),_0x5c868a['bitrateMode']>0x0?this['encodeVideoInfo']['bitrateMode']=_0x5c868a['bitrateMode']:this['encodeVideoInfo']['bitrateMode']=0x0,_0x5c868a['latencyMode']>0x0?this['encodeVideoInfo']['latencyMode']=_0x5c868a['latencyMode']:this['encodeVideoInfo']['latencyMode']=0x0,0x0==_0x5c868a['encodeType']&&(this['encodeVideoInfo']['encodeVideoType']='avc'),this['recoderBaseTimestampMode']=_0x5c868a['baseTimeStampMode'],this['recoderGetOriginData']=_0x5c868a['getOriginData'],null==this['oVideoEncoder']&&(this['oVideoEncoder']=new _0x130022(this,this['player'])),_0x40ec10['sampleRate']>0x0?this['encodeAudioInfo']['sampleRate']=_0x40ec10['sampleRate']:this['encodeAudioInfo']['sampleRate']=0xbb80,_0x40ec10['numberOfChannels']>0x0?this['encodeAudioInfo']['numberOfChannels']=_0x40ec10['numberOfChannels']:this['encodeAudioInfo']['numberOfChannels']=0x1,_0x40ec10['bitrate']>0x0?this['encodeAudioInfo']['bitrate']=_0x40ec10['bitrate']:this['encodeAudioInfo']['bitrate']=0x1f400,0x0==_0x40ec10['encodeType']&&(this['encodeAudioInfo']['encodeAudioType']='aac'),null==this['oAudioEncoder']&&(this['oAudioEncoder']=new _0x469b0c(this,this['player'])),0x1;}},{'key':'StartVideoEncode','value':function(_0x51a7f5){return null!=this['oVideoEncoder']&&(this['oVideoEncoder']['initEncoder']('avc1.4d4032',this['encodeVideoInfo'],_0x51a7f5),this['startRecoderFlag']=!0x0,this['stopRecoderFlag']=!0x1),0x1;}},{'key':'StartAudioEncode','value':function(_0x59a974){return null!=this['oAudioEncoder']&&this['oAudioEncoder']['initEncoder']('mp4a.40.2',this['encodeAudioInfo'],_0x59a974),0x1;}},{'key':'InputPCMToEncode','value':function(_0x462616,_0x5317f5){if(null!=this['oAudioEncoder']&&0x0==this['stopRecoderFlag']){var _0x207f0d={'format':'s16','sampleRate':this['encodeAudioInfo']['sampleRate'],'numberOfFrames':_0x462616['length']/0x2,'numberOfChannels':0x1,'timestamp':_0x5317f5,'data':_0x462616},_0x1ab6bc=new AudioData(_0x207f0d);this['oAudioEncoder']['inputData'](_0x1ab6bc),_0x1ab6bc['close']();}return 0x1;}},{'key':'StopEncode','value':function(){return this['startRecoderFlag']=!0x1,this['stopRecoderFlag']=!0x0,this['recoderFrameNum']=0x0,null!=this['oAudioEncoder']&&(this['oAudioEncoder']['stopEncode'](),this['oAudioEncoder']=null),null!=this['oVideoEncoder']&&(this['oVideoEncoder']['stopEncode'](),this['oVideoEncoder']=null),this['recoderBaseTimestampMode']=0x0,this['recoderGetOriginData']=0x0,0x1;}},{'key':'SetRunTimeInfoCallBack','value':function(_0x47a893,_0xcf10af){return this['runtimeCBFun']=_0xcf10af,null!=this['oVideoDecoder']&&this['oVideoDecoder']['SetRunTimeInfoCallBackFun'](_0x47a893,_0xcf10af),0x1;}},{'key':'SetRunTimeInfoCallbackType','value':function(_0xa54656,_0x8b9cc0,_0x3283a8){return 0x2==_0xa54656?_0x3283a8?this['DecodeTypeFlagMap']['set'](_0x8b9cc0,0x1):this['DecodeTypeFlagMap']['delete'](_0x8b9cc0):0x3==_0xa54656&&(_0x3283a8?this['RenderTypeFlagMap']['set'](_0x8b9cc0,0x1):this['RenderTypeFlagMap']['delete'](_0x8b9cc0)),null!=this['oVideoDecoder']&&0x2==_0xa54656&&this['oVideoDecoder']['SetRunTimeInfoCallbackType'](_0xa54656,_0x8b9cc0,_0x3283a8),0x1;}},{'key':'IsVisible','value':function(_0x588f20){return null!=this['oVideoDecoder']&&this['oVideoDecoder']['IsVisible'](_0x588f20),0x1;}},{'key':'SetPanoramaDisplayEffect','value':function(_0x42902b){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20SetPanoramaDisplayEffect','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['SetPanoramaDisplayEffect'](_0x42902b):0x0;}},{'key':'SetPanoramaSphereViewParam','value':function(_0x191fe8,_0x4f9754){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20SetPanoramaSphereViewParam','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['SetPanoramaSphereViewParam'](_0x191fe8,_0x4f9754):0x0;}},{'key':'GetPanoramaSphereViewParam','value':function(_0x4b7ce8,_0x15a33e){return'2d'===this['renderEngine']||'2D'===this['renderEngine']?(console['log']('%c\\x202D\\x20render\\x20not\\x20support\\x20GetPanoramaSphereViewParam','color:red'),0x0):null!=this['oVideoRender']?this['oVideoRender']['GetPanoramaSphereViewParam'](_0x4b7ce8,_0x15a33e):0x0;}},{'key':'ResetBuffer','value':function(){return this['resetTimer']=!0x0,this['oVideoDecoder']['clearDecoderObjBuffer'](),0x1;}}]),_0x35401;}());!function(_0xa634db){let _0x37a5ad=new _0x572984(),_0x1803b9=0x0;self['onmessage']=function(_0x24e44d){let _0x2f7aa5=_0x24e44d['data'];switch(_0x2f7aa5['command']){case'init':_0x1803b9=_0x2f7aa5['printfLog'],_0x37a5ad['init'](_0x2f7aa5['canvas'],_0x2f7aa5['streamOpenMode'],_0x2f7aa5['sab'],_0x2f7aa5['renderEngine'],_0x2f7aa5['printfLog']);break;case'inputData':let _0x1fe220=new Uint8Array(_0x2f7aa5['rawData']),_0x4b450e=_0x2f7aa5['rawDataFrameInfo'];_0x37a5ad['inputData'](_0x1fe220,_0x4b450e),_0x1fe220=null;break;case'SetDisplayRegion':null===_0x37a5ad&&self['postMessage']({'function':'OrderError'}),_0x37a5ad['SetDisplayRegion'](_0x2f7aa5['sx'],_0x2f7aa5['sy'],_0x2f7aa5['sw'],_0x2f7aa5['sh']);break;case'stop':null===_0x37a5ad&&self['postMessage']({'function':'OrderError'}),_0x37a5ad['SetCurStatus'](0x4);let _0x12f621=setInterval(()=>{_0x37a5ad['displayRunning']||(_0x37a5ad=null,self['postMessage']({'function':'stop'}),clearInterval(_0x12f621),_0x12f621=null,self['close'](),_0x1803b9>=0x0&&console['log']('>>>JS\\x2003\\x20destroy\\x20oVideoPlayCtrl\\x20and\\x20worker'));},0x2);break;case'fast':null===_0x37a5ad&&self['postMessage']({'function':'OrderError'}),0x1!==_0x37a5ad['fast']()&&self['postMessage']({'function':'paraError'});break;case'slow':null===_0x37a5ad&&self['postMessage']({'function':'OrderError'}),0x1!==_0x37a5ad['slow']()&&self['postMessage']({'function':'paraError'});break;case'SetDisplayBuf':null===_0x37a5ad&&self['postMessage']({'function':'OrderError'}),0x1!==_0x37a5ad['SetDisplayBuf'](_0x2f7aa5['value'])&&self['postMessage']({'function':'paraError'});break;case'Pause':null===_0x37a5ad&&self['postMessage']({'function':'OrderError'}),0x1!==_0x37a5ad['Pause'](_0x2f7aa5['value'])&&self['postMessage']({'function':'paraError'});break;case'OneByOne':null===_0x37a5ad&&self['postMessage']({'function':'OrderError'}),0x1!==_0x37a5ad['OneByOne'](_0x2f7aa5['value'])&&self['postMessage']({'function':'paraError'});break;case'NotifyBackPlay':null===_0x37a5ad&&self['postMessage']({'function':'OrderError'}),0x1!==_0x37a5ad['NotifyBackPlay'](_0x2f7aa5['flag'])&&self['postMessage']({'function':'paraError'});break;case'SetPlayOrBackSwitchMode':null===_0x37a5ad&&self['postMessage']({'function':'OrderError'}),0x1!==_0x37a5ad['SetPlayOrBackSwitchMode'](_0x2f7aa5['PlayOrBackMode'])&&self['postMessage']({'function':'paraError'});break;case'SetStretchPlay':null===_0x37a5ad&&self['postMessage']({'function':'OrderError'}),0x1!==_0x37a5ad['SetStretchPlay'](_0x2f7aa5['Stretchtime'],_0x2f7aa5['Stretchspeed'])&&self['postMessage']({'function':'paraError'});break;case'SetCanvasSize':null===_0x37a5ad&&self['postMessage']({'function':'OrderError'}),0x1!==_0x37a5ad['SetCanvasSize'](_0x2f7aa5['width'],_0x2f7aa5['height'],_0x2f7aa5['FECSubPort'])&&self['postMessage']({'function':'paraError'});break;case'GetCanvasSize':null===_0x37a5ad&&self['postMessage']({'function':'OrderError'}),0x1!==_0x37a5ad['GetCanvasSize']()&&self['postMessage']({'function':'paraError'});break;case'GetPlayedTime':null===_0x37a5ad&&self['postMessage']({'function':'OrderError'});let _0x5fc792=_0x37a5ad['GetPlayedTime']();0x0!==_0x5fc792&&self['postMessage']({'function':'GetPlayedTime','value':_0x5fc792});break;case'needReset':_0x37a5ad['SetCurStatus'](0x0,_0x2f7aa5['bTrue']);break;case'GetJPEG':_0x37a5ad['GetJPEG']();break;case'GetBMP':_0x37a5ad['GetBMP']();break;case'GetCropJPEG':_0x37a5ad['GetCropJPEG']();break;case'GetCropBMP':_0x37a5ad['GetCropBMP']();break;case'SetDecodeFrameType':_0x37a5ad['SetDecodeFrameType'](_0x2f7aa5['timestamp']);break;case'SetStreamEnd':_0x37a5ad['SetStreamEnd'](_0x2f7aa5['bTrue']);break;case'SetAntialias':_0x37a5ad['SetAntialias'](_0x2f7aa5['value']);break;case'SetFrameInfoCallBack':_0x37a5ad['SetFrameInfoCallBack'](_0x10db80=>{self['postMessage']({'function':'SetFrameInfoCallBack','curFrameInfo':_0x10db80});},_0x2f7aa5['value']);break;case'SetTargetRelativePos':_0x37a5ad['SetTargetRelativePos'](_0x2f7aa5['nRelativePos'],_0x2f7aa5['nPosType'],_0x2f7aa5['nPlayMode']);break;case'ResetBuffer':_0x37a5ad['ResetBuffer']();break;case'FEC_SetCanvasID':_0x37a5ad['FEC_SetCanvasID'](_0x2f7aa5['canvasID']);break;case'FECResetCorrectType':_0x37a5ad['FEC_ResetCorrectType'](_0x2f7aa5['fishSubPort'],_0x2f7aa5['placeType'],_0x2f7aa5['correctType']);break;case'FECGetPort':let _0x169f58=_0x37a5ad['FEC_GetPort'](_0x2f7aa5['placeType'],_0x2f7aa5['correctType']);(_0x169f58<0x1||_0x169f58>0x1f||null==_0x169f58)&&(_0x169f58=-0x1),self['postMessage']({'function':'FECGetPort','fishSubPort':_0x169f58});break;case'FECEnable':_0x37a5ad['FEC_Enable'](_0x2f7aa5['fishSubPort']);break;case'FECSetParam':_0x37a5ad['FEC_SetParam'](_0x2f7aa5['fishSubPort'],_0x2f7aa5['param2d']);break;case'FECGetParam':let _0x2b3b93={};_0x37a5ad['FEC_GetParam'](_0x2f7aa5['fishSubPort'],_0x2b3b93),self['postMessage']({'function':'FECGetParam','param2d':_0x2b3b93});break;case'FECSetViewParam':_0x37a5ad['FEC_SetViewParam'](_0x2f7aa5['fishSubPort'],_0x2f7aa5['upDateType'],_0x2f7aa5['fValue']);break;case'FECGetViewParam':let _0x348d7c={};_0x37a5ad['FEC_GetViewParam'](_0x2f7aa5['fishSubPort'],_0x2f7aa5['upDateType'],_0x348d7c),self['postMessage']({'function':'FECGetViewParam','Param3D':_0x348d7c});break;case'FECSetWnd':_0x37a5ad['FEC_SetWnd'](_0x2f7aa5['fishSubPort'],_0x2f7aa5['offscrrenCnv']);break;case'FECDisable':_0x37a5ad['FEC_Disable'](_0x2f7aa5['fishSubPort'],_0x2f7aa5['clearFECCanvas'],_0x2f7aa5['clearContext']);break;case'FECDelPort':_0x37a5ad['FEC_DelPort'](_0x2f7aa5['fishSubPort']);break;case'FECSetDisplayRegion':_0x37a5ad['FEC_SetDisplayRegion'](_0x2f7aa5['fishSubPort'],_0x2f7aa5['type'],_0x2f7aa5['regionNum'],_0x2f7aa5['sx'],_0x2f7aa5['sy'],_0x2f7aa5['sw'],_0x2f7aa5['sh']);break;case'FECSetBackCilling':_0x37a5ad['FEC_SetBackCilling'](_0x2f7aa5['fishSubPort'],_0x2f7aa5['bValue']);break;case'FECGetPTZPort':let _0x267f53=_0x37a5ad['FEC_GetPTZPort'](_0x2f7aa5['subport'],_0x2f7aa5['fPositionX'],_0x2f7aa5['fPositionY']);(_0x267f53<0x1||_0x267f53>0x1f||null==_0x267f53)&&(_0x267f53=-0x1,console['info']('%c\\x20hardDecoderWorker\\x20FECGetPTZPort\\x20error\\x20','color:\\x20red')),self['postMessage']({'function':'FECGetPTZPort','fishSubPort':_0x267f53});break;case'FECCapture':_0x37a5ad['FEC_Capture'](_0x2f7aa5['subport'],(_0x4f15d3,_0x541959,_0x572859,_0x4715a4)=>{self['postMessage']({'function':'FECCapture','frameData':_0x4f15d3['buffer'],'width':_0x541959,'height':_0x572859,'fishSubPort':_0x4715a4},[_0x4f15d3['buffer']]);});break;case'FECSetPTZDisplayMode':_0x37a5ad['FEC_SetPTZDisplayMode'](_0x2f7aa5['ptzMode']);break;case'RenderPrivateData':_0x37a5ad['RenderPrivateData'](_0x2f7aa5['intelType'],_0x2f7aa5['bTrue']);break;case'RenderPrivateDataEx':_0x37a5ad['RenderPrivateDataEx'](_0x2f7aa5['intelType'],_0x2f7aa5['subType'],_0x2f7aa5['bTrue']);break;case'InputPrivateInfo':_0x37a5ad['InputPrivateInfo'](_0x2f7aa5['linesInfo'],_0x2f7aa5['fontInfo'],_0x2f7aa5['ImageInfo']);break;case'GetCanvasCapture':_0x37a5ad['GetCanvasCapture']((_0x4720c4,_0xca5f0b,_0x5840b4)=>{self['postMessage']({'function':'GetCanvasCapture','frameData':_0x4720c4['buffer'],'width':_0xca5f0b,'height':_0x5840b4},[_0x4720c4['buffer']]);},_0x2f7aa5['capWidth'],_0x2f7aa5['capHeight']);break;case'SetWaterMarkFont':_0x37a5ad['SetWaterMarkFont'](_0x2f7aa5['fontParam']);break;case'SetMosaicType':_0x37a5ad['SetWaterMarkFont'](_0x2f7aa5['MosaicParam']);break;case'SetWaterMarkImage':let _0x35ce3e=new Uint8Array(_0x2f7aa5['pImageData']),_0x2743d4={};_0x2743d4['pImageData']=_0x35ce3e,_0x2743d4['pImageType']=_0x2f7aa5['pImageType'],_0x2743d4['pstRectPos']=_0x2f7aa5['pstRectPos'],_0x2743d4['fAlpha']=_0x2f7aa5['fAlpha'],_0x37a5ad['SetWaterMarkImage'](_0x2743d4),_0x35ce3e=null;break;case'SelectIntelInfoFeatureToDraw':_0x37a5ad['SelectIntelInfoFeatureToDraw'](_0x2f7aa5['IntelInfoParam']);break;case'SetD3DPostProcess':_0x37a5ad['SetD3DPostProcess'](_0x2f7aa5['ProcessType'],_0x2f7aa5['ProcessValue']);break;case'SetTextCanvas':_0x37a5ad['SetTextCanvas'](_0x2f7aa5['textoffscreenCanvas']);break;case'SetPrintLogFlag':_0x37a5ad['SetPrintLogFlag'](_0x2f7aa5['printfFlag']);break;case'SetPanoramaDisplayEffect':_0x37a5ad['SetPanoramaDisplayEffect'](_0x2f7aa5['DisplayEffect']);break;case'SetPanoramaSphereViewParam':_0x37a5ad['SetPanoramaSphereViewParam'](_0x2f7aa5['ViewParamType'],_0x2f7aa5['fValue']);break;case'GetPanoramaSphereViewParam':let _0x53ec6e={};_0x37a5ad['GetPanoramaSphereViewParam'](_0x2f7aa5['ViewParamType'],_0x53ec6e),self['postMessage']({'function':'GetPanoramaSphereViewParam','ParamVR':_0x53ec6e});break;case'SetRotateAngle':_0x37a5ad['SetRotateAngle'](_0x2f7aa5['rotateValue']);break;case'InitEncoder':_0x37a5ad['InitEncoder'](_0x2f7aa5['videoInfo'],_0x2f7aa5['audioInfo']);break;case'StartVideoEncode':_0x37a5ad['StartVideoEncode'](null);break;case'StartAudioEncode':_0x37a5ad['StartAudioEncode'](null);break;case'InputPCMToEncode':let _0x58a326=new Uint8Array(_0x2f7aa5['PCMData']);_0x37a5ad['InputPCMToEncode'](_0x58a326,_0x2f7aa5['timeStamp']);break;case'StopEncode':_0x37a5ad['StopEncode']();break;case'SetRunTimeInfoCallBack':_0x37a5ad['SetRunTimeInfoCallBack'](_0x2f7aa5['module'],_0x3f9ea7=>{self['postMessage']({'function':'runtimeInfo','pstRuntimeInfo':_0x3f9ea7});});break;case'SetRunTimeInfoCallbackType':_0x37a5ad['SetRunTimeInfoCallbackType'](_0x2f7aa5['module'],_0x2f7aa5['type'],_0x2f7aa5['flag']);break;case'IsVisible':_0x37a5ad['IsVisible'](_0x2f7aa5['visibility']);}};}();})());})());","Worker",void 0,void 0)},_=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r},h=function(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return c(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?c(t,e):void 0}}(t))||e){a&&(t=a);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,x=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return s=t.done,t},e:function(t){x=!0,n=t},f:function(){try{s||null==a.return||a.return()}finally{if(x)throw n}}}},c=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r},u=function(t,e){if(!i(t,e))throw new TypeError("Cannot call a class as a function")},d=function(t,e,a){return e&&function(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t},p=function(){var t=new Tt(16);return Tt!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},m=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},S=function(t,e,a){var r=e[0],i=e[1],n=e[2],s=e[3],x=e[4],o=e[5],f=e[6],l=e[7],_=e[8],h=e[9],c=e[10],u=e[11],d=e[12],p=e[13],m=e[14],S=e[15],R=a[0],P=a[1],y=a[2],b=a[3];return t[0]=R*r+P*x+y*_+b*d,t[1]=R*i+P*o+y*h+b*p,t[2]=R*n+P*f+y*c+b*m,t[3]=R*s+P*l+y*u+b*S,R=a[4],P=a[5],y=a[6],b=a[7],t[4]=R*r+P*x+y*_+b*d,t[5]=R*i+P*o+y*h+b*p,t[6]=R*n+P*f+y*c+b*m,t[7]=R*s+P*l+y*u+b*S,R=a[8],P=a[9],y=a[10],b=a[11],t[8]=R*r+P*x+y*_+b*d,t[9]=R*i+P*o+y*h+b*p,t[10]=R*n+P*f+y*c+b*m,t[11]=R*s+P*l+y*u+b*S,R=a[12],P=a[13],y=a[14],b=a[15],t[12]=R*r+P*x+y*_+b*d,t[13]=R*i+P*o+y*h+b*p,t[14]=R*n+P*f+y*c+b*m,t[15]=R*s+P*l+y*u+b*S,t},R=function(t,e,a,r){var i,n,s,x,o,f,l,_,h,c,u,d,p,m,S,R,P,y,b,E,g,F,C,v,T=r[0],D=r[1],A=r[2],I=Math.hypot(T,D,A);return I<vt?null:(T*=I=1/I,D*=I,A*=I,i=Math.sin(a),s=1-(n=Math.cos(a)),x=e[0],o=e[1],f=e[2],l=e[3],_=e[4],h=e[5],c=e[6],u=e[7],d=e[8],p=e[9],m=e[10],S=e[11],R=T*T*s+n,P=D*T*s+A*i,y=A*T*s-D*i,b=T*D*s-A*i,E=D*D*s+n,g=A*D*s+T*i,F=T*A*s+D*i,C=D*A*s-T*i,v=A*A*s+n,t[0]=x*R+_*P+d*y,t[1]=o*R+h*P+p*y,t[2]=f*R+c*P+m*y,t[3]=l*R+u*P+S*y,t[4]=x*b+_*E+d*g,t[5]=o*b+h*E+p*g,t[6]=f*b+c*E+m*g,t[7]=l*b+u*E+S*g,t[8]=x*F+_*C+d*v,t[9]=o*F+h*C+p*v,t[10]=f*F+c*C+m*v,t[11]=l*F+u*C+S*v,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},P=function(t,e,a,r){var i,n,s,x,o,f,l,_,h,c,u=e[0],d=e[1],p=e[2],S=r[0],R=r[1],P=r[2],y=a[0],b=a[1],E=a[2];return Math.abs(u-y)<vt&&Math.abs(d-b)<vt&&Math.abs(p-E)<vt?m(t):(l=u-y,_=d-b,h=p-E,i=R*(h*=c=1/Math.hypot(l,_,h))-P*(_*=c),n=P*(l*=c)-S*h,s=S*_-R*l,(c=Math.hypot(i,n,s))?(i*=c=1/c,n*=c,s*=c):(i=0,n=0,s=0),x=_*s-h*n,o=h*i-l*s,f=l*n-_*i,(c=Math.hypot(x,o,f))?(x*=c=1/c,o*=c,f*=c):(x=0,o=0,f=0),t[0]=i,t[1]=x,t[2]=l,t[3]=0,t[4]=n,t[5]=o,t[6]=_,t[7]=0,t[8]=s,t[9]=f,t[10]=h,t[11]=0,t[12]=-(i*u+n*d+s*p),t[13]=-(x*u+o*d+f*p),t[14]=-(l*u+_*d+h*p),t[15]=1,t)},y=function(){var t=new Tt(3);return Tt!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t},b=function(t,e,a){var r=new Tt(3);return r[0]=t,r[1]=e,r[2]=a,r},E=function(){var t=new Tt(4);return Tt!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t},g=function(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a},F=function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?g(Object(a),!0).forEach((function(e){var r,i,n;r=t,i=e,n=a[e],i in r?Object.defineProperty(r,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[i]=n})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t},C=function(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return v(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?v(t,e):void 0}}(t))||e){a&&(t=a);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,x=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return s=t.done,t},e:function(t){x=!0,n=t},f:function(){try{s||null==a.return||a.return()}finally{if(x)throw n}}}},v=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r},T=function(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return D(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?D(t,e):void 0}}(t))||e){a&&(t=a);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,x=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return s=t.done,t},e:function(t){x=!0,n=t},f:function(){try{s||null==a.return||a.return()}finally{if(x)throw n}}}},D=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r},A=function(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return I(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?I(t,e):void 0}}(t))||e){a&&(t=a);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,x=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return s=t.done,t},e:function(t){x=!0,n=t},f:function(){try{s||null==a.return||a.return()}finally{if(x)throw n}}}},I=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r},M=function(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return L(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?L(t,e):void 0}}(t))||e){a&&(t=a);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,x=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return s=t.done,t},e:function(t){x=!0,n=t},f:function(){try{s||null==a.return||a.return()}finally{if(x)throw n}}}},L=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r};a.r(x),a.d(x,{JSPlayCtrl:function(){return Fe}});var w=16,O=1281,B=1282,k=1285,N=1287,V=1288,U=1289,H=1298,W=1302,Y=256,G=512,X=768,J=1024,Z=1280,j=1536,z=1792,K=2048,q=2304,Q=2560,$=262144,tt=352321537,et=520093697,at=528482304,rt=16,it=a(687),nt=a.n(it),st=a(477),xt=a.n(st);function ot(t){return(ot="function"==typeof Symbol&&"symbol"==n(Symbol.iterator)?function(t){return void 0===t?"undefined":n(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":n(t)})(t)}var ft=function(){function a(){t(this,a),this.startTime=0,this.curTime=0,this.timeWalk=0,this.preTimerStamp=0}return e(a,[{key:"Init",value:function(){this.startTime=this.GetCurTime()}},{key:"GetCurTime",value:function(){return this.curTime=24*(new Date).getDate()*60*60*1e3+60*(new Date).getHours()*60*1e3+60*(new Date).getMinutes()*1e3+1e3*(new Date).getSeconds()+(new Date).getMilliseconds(),this.curTime}},{key:"GetTimerWalk",value:function(){return this.timeWalk=this.GetCurTime()-this.startTime,this.timeWalk<0&&(this.timeWalk=0),this.timeWalk}},{key:"timerReset",value:function(){this.startTime=0,this.curTime=0,this.timeWalk=0,this.preTimerStamp=0}}]),a}(),lt=function(){function a(e,r,i,n){t(this,a),this.width=0,this.height=0,this.decoderObj=null,this.FirstFrame=!0,this.ready_frames=[],this.underflow=!0,this.sab=e,this.frameRate=30,this.needSetPreSoft=!1,this.decoderCurStatus=2,this.decoderOutSuccess=!1,this.decoderObjNeedReset=!1,this.oVideoRenderHandle=r,this.output=this.output.bind(this),this.reportError=this.reportError.bind(this),this.player=null,null!=i&&(this.player=i),this.curFrame=null,this.printfFlag=this.oVideoRenderHandle.printfFlag,this.nGetTotalFrameNum=0,this.nAverageDecodeTime=0,this.oDecodeTimer=null,this.runtimeInfoCBFun=null,this.pstRuntimeInfo={nRunTimeModule:0,nStrVersion:0,nFrameTimeStamp:0,nFrameNum:0,nErrorCode:0,nInputDataInterval:0,nFrameNumInterval:0,nAverageDecodeTime:0,nSystemFormat:0,nDetectRes:0,nMp4FileTime:0,nMp4TotalFrameNum:0,AbsTimeYear:0,AbsTimeMonth:0,AbsTimeDay:0,AbsTimeHour:0,AbsTimeMinute:0,AbsTimeSecond:0,AbsTimeMilliseconds:0},this.HardDecFrameCount=0,this.canvas=n,this.bSetStreamEnd=!1,this.bVisibility=!0,this.back_ready_frames=[],this.StartFrameTime=0,this.WaitForFrameFlag=0}return e(a,[{key:"initDecoder",value:function(){if(null==this.decoderObj)try{var t={output:this.output,error:this.reportError};this.decoderObj=new VideoDecoder(t)}catch(t){0==this.oVideoRenderHandle.firstFrame?this.decoderObjNeedReset=!0:(this.oVideoRenderHandle.HardDecodeError(),console.log("%cswitch hardVideoDecoder to softVideoDecoder","color: red"))}""!=this.canvas&&null!=this.canvas&&(this.underflow&&(this.underflow=!1,this.oVideoRenderHandle.RenderFrame().then((function(){}))),this.oVideoRenderHandle.displayRunning=!0),this.decoderCurStatus=2,this.FirstFrame=!0}},{key:"inputData",value:function(t,e){null!=this.decoderObj&&(this.printfFlag>0&&console.log("VideoDecoder.js inputData videoInfo.timeStamp:"+e.timeStamp+",decodeQueueSize:"+this.decoderObj.decodeQueueSize+",frameLength:"+this.ready_frames.length),("configured"==this.decoderObj.state||this.FirstFrame)&&this.decodeProcess(t,e),(this.ready_frames.length>100||this.decoderObj.decodeQueueSize>100)&&(this.player?this.player.JSPlayM4_GetDecodeBufferSize(this.decoderObj.decodeQueueSize,this.ready_frames.length):postMessage({function:"GetDecodeBufferSize",rawSize:this.decoderObj.decodeQueueSize,frameSize:this.ready_frames.length})),e.nStreamEnd&&this.SetStreamEnd())}},{key:"concatenate",value:function(t){for(var e=0,a=arguments.length,r=new Array(a>1?a-1:0),i=1;i<a;i++)r[i-1]=arguments[i];for(var n=0,s=r;n<s.length;n++){e+=s[n].length}for(var x=new t(e),o=0,f=0,l=r;f<l.length;f++){var _=l[f];x.set(_,o),o+=_.length}return x}},{key:"processData",value:function(t){for(var e=null,a=null,r=null,i=!1,n=!1,s=0,x=0;x<t.length-4;x++){if(0!=t[x]||0!=t[x+1]||0!=t[x+2]||1!=t[x+3]||103!=t[x+4]&&39!=t[x+4]||(0!=x?(n=!0,e=t.slice(x),s=x):e=t),0==t[x]&&0==t[x+1]&&0==t[x+2]&&1==t[x+3]&&(9==t[x+4]||6==t[x+4])){if(null==e)continue;null==a&&(a=t.slice(s,x),i=!0)}if(0==t[x]&&0==t[x+1]&&0==t[x+2]&&1==t[x+3]&&(101==t[x+4]||37==t[x+4])){i&&(r=t.slice(x));break}}return i?this.concatenate(Uint8Array,a,r):n?e:t}},{key:"processData1",value:function(t){return 0!=t[0]||0!=t[1]||0!=t[2]||1!=t[3]||9!=t[4]&&6!=t[4]?t:t.slice(5)}},{key:"formatVideoDecoderConfigure",value:function(t,e,a,r){var i="";5==e?(i="hvc1.1.6.L123.00",this.printfFlag>=0&&console.log("265 hard decoder")):256==e?(i="avc1.42001f",this.printfFlag>=0&&console.log("264 hard decoder")):console.log("Support Error: hard decoder only support 264 and 265 !!!");var n={codec:i,hardwareAcceleration:"prefer-hardware",optimizeForLatency:1};return 5!=e&&this.needSetPreSoft&&(n.hardwareAcceleration="prefer-software"),n}},{key:"decodeProcess",value:function(t,e){this.frameRate!=e.frameRate&&(this.frameRate=e.frameRate),this.width!=e.width&&(this.width=e.width),this.height!=e.height&&(this.height=e.height),e.needSetPreSoft&&(this.needSetPreSoft=e.needSetPreSoft);var a=t;if(4!=this.decoderCurStatus&&null!=this.decoderObj)if(this.printfFlag>0&&console.log("VideoDecoder.js Decoder this.decoderObj.state:"+this.decoderObj.state),"configured"==this.decoderObj.state){var r=new EncodedVideoChunk({data:a,timestamp:e.timeStamp,type:e.isKeyFrame?"key":"delta"});try{this.decoderObj.decode(r)}catch(t){0==this.oVideoRenderHandle.firstFrame?this.decoderObjNeedReset=!0:(this.oVideoRenderHandle.HardDecodeError(),console.log("%cswitch hardVideoDecoder to softVideoDecoder","color: red"))}a=null,t=null,r=null,e.frameType}else if(e.isKeyFrame&&"unconfigured"==this.decoderObj.state){var i=this.formatVideoDecoderConfigure(t,e.codecType,e.width,e.height);if(""==i.codec)return-1;if(null!==this.decoderObj){try{this.decoderObj.configure(i)}catch(t){0==this.oVideoRenderHandle.firstFrame?this.decoderObjNeedReset=!0:(this.oVideoRenderHandle.HardDecodeError(),console.log("%cswitch hardVideoDecoder to softVideoDecoder","color: red"))}a=this.processData(t),this.FirstFrame=!1;var n=new EncodedVideoChunk({data:a,timestamp:e.timeStamp,type:e.isKeyFrame?"key":"delta"});try{this.decoderObj.decode(n)}catch(t){0==this.oVideoRenderHandle.firstFrame?this.decoderObjNeedReset=!0:(this.oVideoRenderHandle.HardDecodeError(),console.log("%cswitch hardVideoDecoder to softVideoDecoder","color: red"))}i=null,a=null,t=null}}}},{key:"checkY",value:function(t,e,a){Uint8Array.prototype.compare=function(t,e,a){for(var r=0;r<a;r++)if(this[t+r]!==this[e+r])return-1;return 0};for(var r=0,i=new Uint8Array(t),n=(a-8)*e,s=0;s<8;s++)for(var x=n+s*e,o=0;o<e-16;o+=24){var f=i.compare(x+o,x+o+8,8),l=i.compare(x+o+8,x+o+16,8);0===f&&0===l&&(i[x+o]>122&&i[x+o]<=128||0===i[x+o])&&r++}return!(r>100)}},{key:"output",value:function(t){var e,a=this;if(this.printfFlag>0&&console.log("VideoDecoder.js output frame:"+t+",frame.timestamp:"+t.timestamp),null!==this.decoderObj)if("configured"==this.decoderObj.state&&this.bVisibility){var r=t.timestamp;if(this.oVideoRenderHandle.VideoPrivateInfoMap.size>0){var i=this.oVideoRenderHandle.VideoPrivateInfoMap.get(r);if(null!=i){for(;i.linesInfo.length>0||i.fontInfo.length>0||i.imageInfo.length>0;)this.oVideoRenderHandle.oVideoRender.InputPrivateInfo(i.linesInfo.shift(),i.fontInfo.shift(),i.imageInfo.shift());this.oVideoRenderHandle.VideoPrivateInfoMap.delete(r)}}if(this.printfFlag>0&&console.log("output1 cb decodeQueueSize:"+this.decoderObj.decodeQueueSize+",length:"+this.ready_frames.length+",timestamp:"+r+",systime:"+(new Date).getHours()+":"+(new Date).getMinutes()+":"+(new Date).getSeconds()+"."+(new Date).getMilliseconds()),this.oVideoRenderHandle.DecodeTypeFlagMap.size>0){var n,s=h(this.oVideoRenderHandle.DecodeTypeFlagMap.keys());try{for(s.s();!(n=s.n()).done;){var x=n.value;if(x==tt&&1==this.oVideoRenderHandle.DecodeTypeFlagMap.get(x)&&null!=this.runtimeInfoCBFun&&null!=this.oDecodeTimer){var o=this.oDecodeTimer.GetTimerWalk();o<=0||o>1e7||this.nGetTotalFrameNum>1e5?(this.nGetTotalFrameNum=0,this.oDecodeTimer.Init()):(this.nGetTotalFrameNum++,this.nAverageDecodeTime=o/this.nGetTotalFrameNum,null!=this.runtimeInfoCBFun&&(this.pstRuntimeInfo.nRunTimeModule=2,this.pstRuntimeInfo.nStrVersion=1,this.pstRuntimeInfo.nFrameTimeStamp=r,this.pstRuntimeInfo.nFrameNum=0,this.pstRuntimeInfo.nErrorCode=tt,this.pstRuntimeInfo.nInputDataInterval=0,this.pstRuntimeInfo.nFrameNumInterval=0,this.pstRuntimeInfo.nAverageDecodeTime=this.nAverageDecodeTime,this.runtimeInfoCBFun(this.pstRuntimeInfo)))}}}catch(t){s.e(t)}finally{s.f()}}if(null!=this.player&&null!=this.player.HardDecToJpegCBFun){++this.HardDecFrameCount;var f=t.displayWidth,l=t.displayHeight;(this.HardDecFrameCount-1)%this.player.HardDecToJpegInterval==0&&createImageBitmap(t).then((function(e){a.player?a.player._GetImage(e,"jpeg",0,0,f,l,a.HardDecFrameCount):postMessage({function:"bitmap",value:e,type:"jpeg",sx:0,sy:0,sw:t.displayWidth,sh:t.displayHeight,framenum:a.HardDecFrameCount})}))}if(""!=this.canvas&&null!=this.canvas){if(this.printfFlag>0&&console.log("VideoDecoder.js WaitForFrameFlag:"+this.WaitForFrameFlag+",frame.timestamp:"+t.timestamp+",StartFrameTime:"+this.StartFrameTime),2==this.WaitForFrameFlag&&t.timestamp>this.StartFrameTime&&0!=this.StartFrameTime)return t.close(),1;if(1==this.WaitForFrameFlag&&t.timestamp<this.StartFrameTime&&0!=this.StartFrameTime)return t.close(),1;var c;if(6==this.decoderCurStatus)if(this.back_ready_frames.length>200)t.close();else this.oVideoRenderHandle.findFramebyTime(t.timestamp,0).isKeyFrame?(this.back_ready_frames.reverse(),(c=this.ready_frames).push.apply(c,function(t){if(Array.isArray(t))return _(t)}(e=this.back_ready_frames)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return _(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),this.back_ready_frames.splice(0,this.back_ready_frames.length),createImageBitmap(t).then((function(e){a.back_ready_frames.push({image:e,timestamp:t.timestamp,displayWidth:t.displayWidth,displayHeight:t.displayHeight}),t.close()}))):(createImageBitmap(t).then((function(e){a.back_ready_frames.push({image:e,timestamp:t.timestamp,displayWidth:t.displayWidth,displayHeight:t.displayHeight}),t.close()})),this.decoderOutSuccess||(this.decoderOutSuccess=!0),this.decoderObj.decodeQueueSize<=1&&this.back_ready_frames.length<=1&&(this.player?this.player.JSPlayM4_GetRawData():postMessage({function:"GetRawData"})));else this.ready_frames.length>100?t.close():(this.ready_frames.push(t),this.decoderOutSuccess||(this.decoderOutSuccess=!0),this.decoderObj.decodeQueueSize<=1&&this.ready_frames.length<=1&&(this.player?this.player.JSPlayM4_GetRawData():postMessage({function:"GetRawData"})))}else if(t.close(),null!=this.player&&null!=this.player.runtimeCBFun&&1==this.GetStreamEnd()&&1==this.bSetStreamEnd){this.player.runtimeCBFun({nRunTimeModule:0,nStrVersion:0,nFrameTimeStamp:0,nFrameNum:0,nErrorCode:9}),this.bSetStreamEnd=!1}}else t.close()}},{key:"output2",value:function(t){var e=this;t.timestamp,createImageBitmap(t).then((function(a){t.close(),e.ready_frames.push(a)}))}},{key:"reportError",value:function(t){if(this.oVideoRenderHandle.DecodeTypeFlagMap.size>0){var e,a=h(this.oVideoRenderHandle.DecodeTypeFlagMap.keys());try{for(a.s();!(e=a.n()).done;){var r=e.value;128==r&&1==this.oVideoRenderHandle.DecodeTypeFlagMap.get(r)&&null!=this.runtimeInfoCBFun&&(this.pstRuntimeInfo.nRunTimeModule=2,this.pstRuntimeInfo.nStrVersion=1,this.pstRuntimeInfo.nFrameTimeStamp=timestamp,this.pstRuntimeInfo.nFrameNum=0,this.pstRuntimeInfo.nErrorCode=128,this.runtimeInfoCBFun(this.pstRuntimeInfo))}}catch(t){a.e(t)}finally{a.f()}}console.log("hardDecode reportError:"+t.message+",state:"+this.decoderObj.state+",frameRate:"+this.frameRate+"this.ready_frames.length:"+this.ready_frames.length),0==this.oVideoRenderHandle.firstFrame?this.decoderObjNeedReset=!0:(this.oVideoRenderHandle.HardDecodeError(),console.log("%cswitch hardVideoDecoder to softVideoDecoder","color: red"))}},{key:"destroyDecoder",value:function(){var t=this;return new Promise((function(e,a){t.clearDecoderObjBuffer(),null!=t.decoderObj&&("closed"!=t.decoderObj.state&&t.decoderObj.close(),t.printfFlag>=0&&console.log(">>>JS 01 destroy decoderObj"),t.decoderObj=null),t.decoderCurStatus=4,t.decoderOutSuccess=!1,t.FirstFrame=!0,t.needSetPreSoft=!1,t.decoderObjNeedReset=!1,t.curFrame=null,null!==t.oDecodeTimer&&(t.oDecodeTimer.timerReset(),t.oDecodeTimer=null),e()}))}},{key:"resetDecoder",value:function(){var t=this;return new Promise((function(e,a){t.destroyDecoder().then((function(){t.initDecoder(),console.log("%c reset hard decoder","color:red"),e()}),(function(){a()}))}))}},{key:"clearDecoderObjBuffer",value:function(){if(6==this.decoderCurStatus){for(var t=this.ready_frames.length,e=0;e<t;e++){var a=this.ready_frames.shift();null!=a.image&&null!=a.image&&a.image.close()}this.ready_frames.splice(0,this.ready_frames.length);for(var r=this.back_ready_frames.length,i=0;i<r;i++){var n=this.back_ready_frames.shift();null!=n.image&&null!=n.image&&n.image.close()}this.back_ready_frames.splice(0,this.back_ready_frames.length)}else{for(var s=this.ready_frames.length,x=0;x<s;x++)this.ready_frames.shift().close();this.ready_frames.splice(0,this.ready_frames.length)}this.resetDecoderObj()}},{key:"resetDecoderObj",value:function(){null!=this.decoderObj&&"configured"==this.decoderObj.state&&(this.decoderObj.reset(),this.FirstFrame=!0)}},{key:"SetStreamEnd",value:function(){return null!=this.decoderObj&&0==this.decoderObj.decodeQueueSize&&0==this.ready_frames.length&&(this.decoderObj.flush(),console.log("flush")),this.bSetStreamEnd=!0,1}},{key:"GetStreamEnd",value:function(){return null!=this.decoderObj&&(0==this.decoderObj.decodeQueueSize&&0==this.ready_frames.length||void 0)}},{key:"NotifyBackPlay",value:function(t,e,a){var r=this;return 0!=e?this.resetDecoder().then((function(){r.decoderCurStatus=t?6:2,r.StartFrameTime=e,r.WaitForFrameFlag=a})):(this.decoderCurStatus=t?6:2,this.StartFrameTime=e,this.WaitForFrameFlag=a),1}},{key:"GetFrame",value:function(){var t=this;return new Promise((function(e,a){if(null!=t.curFrame){var r=t.ready_frames.shift();6==t.decoderCurStatus?null!=r.image&&null!=r.image&&r.image.close():r.close(),r=null,t.curFrame=null}0!=t.ready_frames.length?(t.curFrame=t.ready_frames[0],e(t.curFrame)):(t.curFrame=null,e(null))}))}},{key:"GetFrameBufferLength",value:function(){return this.ready_frames.length}},{key:"GetImageYUV",value:function(t,e,a,r,i){var n=this;return new Promise((function(s,x){var o=null;if(null!=n.curFrame?o=n.curFrame:0!=n.ready_frames.length&&(o=n.ready_frames[0]),null!=o){var f=o.displayWidth,l=o.displayHeight;o.format,0==e&&0==a&&0==r&&0==i&&(r=f,i=l),createImageBitmap(o).then((function(s){n.player?n.player._GetImage(s,t,e,a,r,i,0):postMessage({function:"bitmap",value:s,type:t,sx:e,sy:a,sw:r,sh:i,framenum:0})})),x()}else s({yuvFrameBuffer:-1,yuvLength:-1,displayWidth:-1,displayHeight:-1,yuvType:-1})}))}},{key:"SetPrintLogFlag",value:function(t){return this.printfFlag=t,1}},{key:"SetRunTimeInfoCallBackFun",value:function(t,e){return this.runtimeInfoCBFun=e,1}},{key:"SetRunTimeInfoCallbackType",value:function(t,e,a){return e==tt&&(this.nGetTotalFrameNum=0,a?null==this.oDecodeTimer&&(this.oDecodeTimer=new ft,this.oDecodeTimer.Init()):null!==this.oDecodeTimer&&(this.oDecodeTimer.timerReset(),this.oDecodeTimer=null)),1}},{key:"IsVisible",value:function(t){return this.bVisibility=t,1}}]),a}(),_t={d:function(t,e){for(var a in e)_t.o(e,a)&&!_t.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r:function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},ht={};_t.d(ht,{Dv:function(){return Wt},CF:function(){return Ht},bC:function(){return ct}});var ct={};_t.r(ct),_t.d(ct,{ERRCODE:function(){return pt},SRCALLBACKTYPE:function(){return Et},SRDISPLAYEFFECT:function(){return St},SRFISHPARAMTYPE:function(){return Pt},SRIMAGEROTATEANGLE:function(){return Ct},SRPIXELFORMAT:function(){return Rt},SRPOSTPROCTYPE:function(){return Ft},SRPTZDISPLAYMODE:function(){return yt},SRRENDERSTATETYPE:function(){return gt},SRSETRECTTYPE:function(){return mt},SRVIEWTYPE:function(){return bt}});var ut=3.1415926,dt=.78539815,pt={SR_OK:1,SR_ERR_NOT_SUPPORT:2147483649,SR_ERR_SUBPORT:2147483650,SR_ERR_ALLOC_MEMORY:2147483651,SR_ERR_CALL_ORDER:2147483652,SR_ERR_PARAM:2147483653,SR_ERR_CAPTURE:2147483654,SR_ERR_SUBPORT_FULL:2147483655,SR_ERR_SHADER:2147483656,SR_ERR_3D_MODEL:2147483657,SR_ERR_FONT:2147483658,SR_ERR_MEMORY_LIMIT:2147483659,SR_ERR_WEBGPU_RESOURCE:2147483660,SR_ERR_WEBGL_RESOURCE:2147483661,SR_ERR_CANVAS:2147483662},mt={SR_SRT_NULL:0,SR_SRT_SRC:1,SR_SRT_DST:2},St={SR_DE_NULL:0,SR_DE_FISH_ORIGINAL:1,SR_DE_FISH_PTZ_CEILING:2,SR_DE_FISH_PTZ_FLOOR:3,SR_DE_FISH_PTZ_WALL:4,SR_DE_FISH_PANORAMA_CEILING_360:5,SR_DE_FISH_PANORAMA_CEILING_180:6,SR_DE_FISH_PANORAMA_FLOOR_360:7,SR_DE_FISH_PANORAMA_FLOOR_180:8,SR_DE_FISH_PANORAMA_WALL:9,SR_DE_FISH_SEMISPHERE:10,SR_DE_EAGLEEYE_SEMISPHERE:11,SR_DE_EAGLEEYE_PLANE:12,SR_DE_FISH_CYLINDER_CEILING:13,SR_DE_FISH_CYLINDER_FLOOR:14,SR_DE_FISH_CYLINDER_SPLIT_CEILING:15,SR_DE_FISH_CYLINDER_SPLIT_FLOOR:16,SR_DE_FISH_PLANET:17,SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL:18,SR_DE_FISH_ARCSPHERE_VERTICAL_WALL:19,SR_DE_FISH_ANIMATION_SWITCH_CEILING:20,SR_DE_FISH_ANIMATION_SWITCH_FLOOR:21,SR_DE_PANORAMA_SPHERE:22,SR_DE_PANORAMA_PLANET:23},Rt={SR_PF_NULL:0,SR_PF_YV12:1,SR_PF_NV12:2,SR_PF_I420:3,SR_PF_RGB565:4,SR_PF_RGBA32:5,SR_PF_NV21:6,SR_PF_SURFACE:256},Pt={SR_FPT_NULL:0,SR_FPT_CENTER:1,SR_FPT_ANGLE:2,SR_FPT_ZOOM:3,SR_FPT_PTZ:4},yt={SR_DM_NULL:0,SR_DM_RECT:1,SR_DM_RANGE:2},bt={SR_VT_NULL:0,SR_VT_ROTATION_X:1,SR_VT_ROTATION_Y:2,SR_VT_SCALE:3},Et={SR_CBT_NULL:0,SR_CBT_OUT:1},gt={SR_RST_NULL:0,SR_RST_VERTICALFLIP:1,SR_RST_BACK_CULL:2,SR_RST_IMAGE_ROTATE:3},Ft={SR_PPT_NULL:0,SR_PPT_BRIGHTNESS:1,SR_PPT_HUE:2,SR_PPT_SATURATION:3,SR_PPT_CONTRAST:4,SR_PPT_SHARPNESS:5},Ct={SR_IRA_0:1,SR_IRA_90:2,SR_IRA_180:3,SR_IRA_270:4},vt=1e-6,Tt="undefined"!=typeof Float32Array?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Dt,At,It,Mt=function(t,e,a,r,i){var n=1/Math.tan(e/2);if(t[0]=n/a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0){var s=1/(r-i);t[10]=(i+r)*s,t[14]=2*i*r*s}else t[10]=-1,t[14]=-2*r;return t};y(),Dt=new Tt(4),Tt!=Float32Array&&(Dt[0]=0,Dt[1]=0,Dt[2]=0,Dt[3]=0),y(),b(1,0,0),b(0,1,0),E(),E(),At=new Tt(9),Tt!=Float32Array&&(At[1]=0,At[2]=0,At[3]=0,At[5]=0,At[6]=0,At[7]=0),At[0]=1,At[4]=1,At[8]=1,It=new Tt(2),Tt!=Float32Array&&(It[0]=0,It[1]=0);var Lt="\nattribute vec4 position; \nattribute vec4 texCoord; \nvarying vec4 pp; \nuniform int bCapture; \n\nvoid main(void) {\n  if(bCapture == 1)\n  {\n    gl_Position = position;\n    gl_Position.y = -position.y;\n  }\n  else\n  {\n    gl_Position = position;\n  }\n  pp = texCoord;\n}\n",wt="\nprecision mediump float;\nvarying vec4 pp;\nuniform sampler2D Ytexture;\nuniform sampler2D Utexture;\nuniform sampler2D Vtexture;\nuniform int bDataFormat;\nuniform float fAlpha;\nuniform int bDrawImage;\n\nvoid main(void)\n{\n    float r,g,b,y,u,v;\n    if(bDataFormat == 0)\n    {\n        y = texture2D(Ytexture, pp.st).r;\n        u = texture2D(Utexture, pp.st).r;\n        v = texture2D(Vtexture, pp.st).r;\n        \n        y=1.1643*(y-0.0625);\n        u=u-0.5; \n        v=v-0.5; \n\n        r=y+1.5958*v; \n        g=y-0.39173*u-0.81290*v; \n        b=y+2.017*u; \n\n        gl_FragColor=vec4(r, g, b, 1.0);\n    }\n    else if(bDataFormat == 1)\n    {\n        gl_FragColor = texture2D(Ytexture, pp.st);\n    }\n    \n    if(bDrawImage == 1)\n    {\n        gl_FragColor.a *= fAlpha; \n    }\n}\n",Ot="\n    varying  mediump float pp;\n    varying  lowp vec4  colorOut;\n    void main()\n    {\n        gl_FragColor = colorOut;\n        mediump float fx = abs(pp);\n        if (fx > 0.2)\n        { \n            gl_FragColor.a = colorOut.a*(1.25 - 1.25*fx);\n        } \n    } \n",Bt="\n    attribute vec4 position; \n    attribute vec4 texCoord; \n    uniform   mat4   matRotate; \n    varying vec4 pp; \n    uniform int bCapture;\n\n    void main() \n    { \n        gl_Position = position * matRotate; \n        if(bCapture == 1)\n        {\n           gl_Position.y =  -gl_Position.y;\n        }\n        pp = texCoord; \n    } \n",kt="\n    precision mediump float; \n    uniform sampler2D texture;\n    varying lowp vec4 pp; \n    uniform float fAlpha;\n    void main(void) \n    { \n        gl_FragColor = texture2D(texture, pp.st); \n        gl_FragColor.a *= fAlpha; \n    } \n",Nt=function(){function t(){u(this,t),this.fFov=1.57,this.fAspect=1,this.fNear=.1,this.fFar=1e3,this.fTheta=0,this.fAlpha=0,this.fBeta=0,this.fScale=1,this.bOrtho=!1,this.matView=p(),this.matProj=p(),this.vecEye=b(0,0,0),this.vecCenter=b(0,0,100),this.vecUp=b(0,1,0)}return d(t,[{key:"SetYaw",value:function(t){this.fTheta=t}},{key:"GetYaw",value:function(){return this.fTheta}},{key:"SetPitch",value:function(t){this.fAlpha=t}},{key:"GetPitch",value:function(){return this.fAlpha}},{key:"SetRoll",value:function(t){this.fBeta=t}},{key:"GetRoll",value:function(){return this.fBeta}},{key:"SetScale",value:function(t){this.fScale=t}},{key:"GetScale",value:function(){return this.fScale}},{key:"SetFov",value:function(t){this.fFov=t}},{key:"SetAspect",value:function(t){this.fAspect=t}},{key:"SetNear",value:function(t){this.fNear=t}},{key:"SetFar",value:function(t){this.fFar=t}},{key:"SetOrtho",value:function(t){this.bOrtho=t}},{key:"UpdateCamera",value:function(t,e){if(!(t<=0||e<=0)){1==this.bOrtho?(l=this.matProj,_=(2-1.5*this.fAlpha)*(t/e),h=2-1.5*this.fAlpha,c=this.fNear,u=this.fFar,d=1/(0-_),m=1/(0-h),y=1/(c-u),l[0]=-2*d,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*m,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*y,l[11]=0,l[12]=(0+_)*d,l[13]=(h+0)*m,l[14]=(u+c)*y,l[15]=1,this.matProj[12]=0,this.matProj[13]=0):Mt(this.matProj,this.fFov,t/e,this.fNear,this.fFar),this.vecEye=b(0,0,this.fScale),this.vecCenter=b(0,0,-100),this.vecUp=b(0,1,0);var a=b(1,0,0),r=b(0,1,0),i=b(0,0,1),n=p();P(n,this.vecEye,this.vecCenter,this.vecUp);var s=p(),x=p(),o=p(),f=p();R(x,s,-this.fAlpha,a),R(o,x,-this.fTheta,r),R(f,o,-this.fBeta,i),S(this.matView,n,f)}var l,_,h,c,u,d,m,y}},{key:"GetView",value:function(){return this.matView}},{key:"GetProj",value:function(){return this.matProj}}]),t}(),Vt=function(){function t(){u(this,t),this.fFov=1.57,this.fAspect=1,this.fNear=.1,this.fFar=1e3,this.fAlpha=0,this.fTheta=0,this.fScale=1,this.bPano=!1,this.matView=p(),this.matProj=p(),this.vecEye=b(0,0,.99),this.vecCenter=b(0,0,-100),this.vecUp=b(0,1,0)}return d(t,[{key:"SetPitch",value:function(t){this.fAlpha=t}},{key:"GetPitch",value:function(){return this.fAlpha}},{key:"SetYaw",value:function(t){this.fTheta=t}},{key:"GetYaw",value:function(){return this.fTheta}},{key:"SetScale",value:function(t){this.fScale=t}},{key:"GetScale",value:function(){return this.fScale}},{key:"SetFov",value:function(t){this.fFov=t}},{key:"SetAspect",value:function(t){this.fAspect=t}},{key:"SetNear",value:function(t){this.fNear=t}},{key:"SetPano",value:function(t){this.bPano=t}},{key:"SetFar",value:function(t){this.fFar=t}},{key:"UpdateCamera",value:function(t,e){if(!(t<=0||e<=0)){var a=t/e;1==this.bPano?(Mt(this.matProj,this.fScale,a,this.fNear,this.fFar),this.matProj[0]=-1*this.matProj[0],this.matProj[5]*=-1):(Mt(this.matProj,this.fFov+this.fScale-1,a,this.fNear,this.fFar),this.matProj[0]=this.matProj[0]*((this.fAlpha- -1.57)/ut*.5-1),this.matProj[5]=this.matProj[0]*a);var r=b(1,0,0),i=b(0,1,0),n=p();P(n,this.vecEye,this.vecCenter,this.vecUp);var s=p(),x=p(),o=p();R(x,s,-this.fAlpha,r),R(o,x,-this.fTheta,i),S(this.matView,n,o)}}},{key:"GetView",value:function(){return this.matView}},{key:"GetProj",value:function(){return this.matProj}}]),t}(),Ut=function(){function t(){u(this,t),this.onlySupportedWebGL1=!1,this.videoShaderProgram=0,this.vertexPosBuffer=0,this.texturePosBuffer=0,this.indicesPosBuffer=0,this.ctx=null,this.enPixelFormat=Rt.SR_PF_NULL,this.nTextureNum=0,this.nSurfaceTexture=[],this.nSurfaceTexture[0]=0,this.nSurfaceTexture[1]=0,this.nSurfaceTexture[2]=0,this.frameDisplayWidth=0,this.frameDisplayHeight=0,this.bSrcRect=!1,this.fSrcUseLeft=0,this.fSrcUseRight=1,this.fSrcUseTop=0,this.fSrcUseBottom=1,this.fDstUseLeft=0,this.fDstUseRight=1,this.fDstUseTop=0,this.fDstUseBottom=1,this.nPostProc=0,this.fBrightness=0,this.fHue=0,this.fSaturation=0,this.fContrast=0,this.fSharpness=0,this.nWndWidth=0,this.nWndHeight=0,this.bCullBack=!1,this.nImageRotateAngle=Ct.SR_IRA_0,this.matRotate=p(),this.bIsCapturing=!1,this.nCaptureWidth=0,this.nCaptureHeight=0,this.nCaptureRTTex=0,this.nCaptureFBO=0,this.nCaptureFBOWidth=0,this.nCaptureFBOHeight=0,this.nCaptureDepthbuffer=0,this.bCaptureResInit=!1,this.pFishParamManager=null,this.nFECPort=-1,this.pstFishParam=[],this.fRX1=0,this.fRX2=1,this.fRY1=0,this.fRY2=1,this.b3DPort=!1,this.pCamera=null,this.fRotateX=0,this.fRotateY=0,this.fScale=0,this.fRotateLimitX=0,this.fRotateLimitY=0,this.pSemiSpherePos=null,this.pSemiSphereTex=null,this.nSemiSpherePosNum=0,this.nSemiSpherePosSize=0,this.nSemiSphereTexSize=0,this.pSpherePos=null,this.pSphereTex=null,this.pSphereInd=null,this.nSpherePosNum=0,this.nSpherePosSize=0,this.nSphereTexSize=0,this.pCylinderPos=null,this.pCylinderTex=null,this.nCylinderPosNum=0,this.nCylinderPosSize=0,this.nCylinderTexSize=0,this.fCylinderHeight=0,this.fCylinderRadius=0,this.pArcSpherePos=null,this.pArcSphereTex=null,this.nArcSpherePosNum=0,this.nArcSpherePosSize=0,this.nArcSphereTexSize=0,this.fImageWidth=1,this.fImageHeight=1,this.fTexCenterX=.5,this.fTexCenterY=.5,this.fTexRadius=.5,this.pfuncCBIn=null,this.pUserIn=null,this.pfuncCBOut=null,this.pUserOut=null,this.nMosaicShaderProgram=0,this.nLineShaderProgram=0,this.nMaxPointNum=0,this.pLinePosVertices=null,this.pLineClrVertices=null,this.glLinePosBuffer=0,this.glLineClrBuffer=0,this.nLineTriangleNum=0,this.pFillBlockPosVertices=null,this.pFillBlockClrVertices=null,this.nMaxFillBlockTriNum=0,this.glBlockPosBuffer=0,this.glBlockClrBuffer=0,this.nBlockShaderProgram=0,this.textCanvas=null,this.textCanvasCtx=null,this.nDrawFontWidth=0,this.nDrawFontHeight=0,this.nFontColorTexture=0,this.pFontColorBuffer=0,this.nFontShaderProgram=0,this.nFontBGNum=0,this.pstFontBGLines=[],this.pFontPosVertices=null,this.glFontVertexPosBuffer=0,this.glFontTexturePosBuffer=0,this.nImageShaderProgram=0,this.pImagePosVertices=null,this.pImageClrVertices=null,this.glImagePosBuffer=0,this.glImageClrBuffer=0,this.nImageColorTexture=null,this.nDrawImageWidth=0,this.nDrawImageHeight=0,this.nImageColorTextures=[],this.nImageColorTextures[0]=0,this.nImageColorTextures[1]=0,this.nImageColorTextures[2]=0,this.bFirstDrawImage=!0,this.bAntialias=!1,this.bRenderToTex=!1,this.msaaFrameBuffer=0,this.renderBuffer=0,this.stOriginalDisplayRect={},this.bCaptureOriginal=!1}return d(t,[{key:"SetCanvasSize",value:function(t,e){return t<=0||e<=0?pt.SR_ERR_PARAM:(this.nWndWidth=t,this.nWndHeight=e,pt.SR_OK)}},{key:"Init",value:function(t,e,a,r){if(null==t)return pt.SR_ERR_PARAM;if(null==this.ctx&&(this.ctx=t),e==Rt.SR_PF_NULL)return pt.SR_ERR_NOT_SUPPORT;var i=pt.SR_OK;return a!=St.SR_DE_FISH_SEMISPHERE&&a!=St.SR_DE_PANORAMA_SPHERE&&a!=St.SR_DE_PANORAMA_PLANET&&a!=St.SR_DE_FISH_CYLINDER_CEILING&&a!=St.SR_DE_FISH_CYLINDER_FLOOR&&a!=St.SR_DE_FISH_PLANET&&a!=St.SR_DE_FISH_CYLINDER_SPLIT_CEILING&&a!=St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR&&a!=St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL&&a!=St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL||(this.b3DPort=!0,this.ctx.enable(this.ctx.DEPTH_TEST),this.ctx.depthFunc(this.ctx.LESS),this.ctx.depthMask(!0)),i=this._InitVideoVertex(e,a,r),pt.SR_OK!=i?i:(i=this._InitVideoShader(e,a),pt.SR_OK!=i?i:(i=this._InitCamera(a),pt.SR_OK!=i?i:(this.enPixelFormat=e,this.enDisplayEffect=a,a!=St.SR_DE_FISH_SEMISPHERE&&a!=St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL&&a!=St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL||this.ctx.enable(this.ctx.CULL_FACE),pt.SR_OK)))}},{key:"DeInit",value:function(){}},{key:"SetTextureNum",value:function(t){return this.nTextureNum=t,pt.SR_OK}},{key:"SetTextures",value:function(t,e){return this.nSurfaceTexture[t]=e,pt.SR_OK}},{key:"SetWndResolution",value:function(t,e){return t<=0||e<=0?pt.SR_ERR_PARAM:(this.nWndWidth=t,this.nWndHeight=e,pt.SR_OK)}},{key:"GetWndResolution",value:function(t){return t.nWndWidth=this.nWndWidth,t.nWndHeight=this.nWndHeight,pt.SR_OK}},{key:"SetDisplayRect",value:function(t,e,a,r,i){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;if(this.b3DPort)return pt.SR_ERR_NOT_SUPPORT;var n=t,s=e,x=t+a,o=e+r,f=null,l=null;switch(i){case mt.SR_SRT_SRC:if(this.frameDisplayWidth>0&&this.frameDisplayHeight>0){if(this.fSrcUseLeft=n/this.frameDisplayWidth,this.fSrcUseLeft<0?this.fSrcUseLeft=0:this.fSrcUseLeft>1&&(this.fSrcUseLeft=1),this.fSrcUseTop=s/this.frameDisplayHeight,this.fSrcUseTop<0?this.fSrcUseTop=0:this.fSrcUseTop>1&&(this.fSrcUseTop=1),this.fSrcUseRight=x/this.frameDisplayWidth,this.fSrcUseRight<0?this.fSrcUseRight=0:this.fSrcUseRight>1&&(this.fSrcUseRight=1),this.fSrcUseBottom=o/this.frameDisplayHeight,this.fSrcUseBottom<0?this.fSrcUseBottom=0:this.fSrcUseBottom>1&&(this.fSrcUseBottom=1),this.fSrcUseLeft>=this.fSrcUseRight||this.fSrcUseTop>=this.fSrcUseBottom)return pt.SR_ERR_PARAM;if(Ct.SR_IRA_0==this.nImageRotateAngle)f=new Float32Array([this.fSrcUseLeft,this.fSrcUseTop,this.fSrcUseLeft,this.fSrcUseBottom,this.fSrcUseRight,this.fSrcUseTop,this.fSrcUseRight,this.fSrcUseTop,this.fSrcUseLeft,this.fSrcUseBottom,this.fSrcUseRight,this.fSrcUseBottom]);else if(Ct.SR_IRA_90==this.nImageRotateAngle){var _=this.fSrcUseTop,h=this.fSrcUseBottom,c=1-this.fSrcUseRight,u=1-this.fSrcUseLeft;this.fSrcUseLeft=_,this.fSrcUseRight=h,this.fSrcUseTop=c,this.fSrcUseBottom=u,f=new Float32Array([this.fSrcUseLeft,this.fSrcUseBottom,this.fSrcUseRight,this.fSrcUseBottom,this.fSrcUseLeft,this.fSrcUseTop,this.fSrcUseLeft,this.fSrcUseTop,this.fSrcUseRight,this.fSrcUseBottom,this.fSrcUseRight,this.fSrcUseTop])}else if(Ct.SR_IRA_180==this.nImageRotateAngle){var d=1-this.fSrcUseRight,p=1-this.fSrcUseLeft,m=1-this.fSrcUseBottom,S=1-this.fSrcUseTop;this.fSrcUseLeft=d,this.fSrcUseRight=p,this.fSrcUseTop=m,this.fSrcUseBottom=S,f=new Float32Array([this.fSrcUseRight,this.fSrcUseBottom,this.fSrcUseRight,this.fSrcUseTop,this.fSrcUseLeft,this.fSrcUseBottom,this.fSrcUseLeft,this.fSrcUseBottom,this.fSrcUseRight,this.fSrcUseTop,this.fSrcUseLeft,this.fSrcUseTop])}else if(Ct.SR_IRA_270==this.nImageRotateAngle){var R=1-this.fSrcUseBottom,P=1-this.fSrcUseTop,y=this.fSrcUseLeft,b=this.fSrcUseRight;this.fSrcUseLeft=R,this.fSrcUseRight=P,this.fSrcUseTop=y,this.fSrcUseBottom=b,f=new Float32Array([this.fSrcUseRight,this.fSrcUseTop,this.fSrcUseLeft,this.fSrcUseTop,this.fSrcUseRight,this.fSrcUseBottom,this.fSrcUseRight,this.fSrcUseBottom,this.fSrcUseLeft,this.fSrcUseTop,this.fSrcUseLeft,this.fSrcUseBottom])}this.bSrcRect=!0}else f=new Float32Array([this.fSrcUseLeft,this.fSrcUseTop,this.fSrcUseLeft,this.fSrcUseBottom,this.fSrcUseRight,this.fSrcUseTop,this.fSrcUseRight,this.fSrcUseTop,this.fSrcUseLeft,this.fSrcUseBottom,this.fSrcUseRight,this.fSrcUseBottom]),this.bSrcRect=!1;this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.texturePosBuffer),this.ctx.bufferSubData(this.ctx.ARRAY_BUFFER,0,f),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,null),f=null;break;case mt.SR_SRT_DST:if(this.frameDisplayWidth>0&&this.frameDisplayHeight>0){if(this.fDstUseLeft=n/this.frameDisplayWidth,this.fDstUseLeft<0?this.fDstUseLeft=0:this.fDstUseLeft>1&&(this.fDstUseLeft=1),this.fDstUseTop=s/this.frameDisplayHeight,this.fDstUseTop<0?this.fDstUseTop=0:this.fDstUseTop>1&&(this.fDstUseTop=1),this.fDstUseRight=x/this.frameDisplayWidth,this.fDstUseRight<0?this.fDstUseRight=0:this.fDstUseRight>1&&(this.fDstUseRight=1),this.fDstUseBottom=o/this.frameDisplayHeight,this.fDstUseBottom<0?this.fDstUseBottom=0:this.fDstUseBottom>1&&(this.fDstUseBottom=1),this.fDstUseLeft>=this.fDstUseRight||this.fDstUseTop>=this.fDstUseBottom)return pt.SR_ERR_PARAM;(l=new Float32Array(12))[0]=2*this.fDstUseLeft-1,l[1]=1-2*this.fDstUseTop,l[2]=2*this.fDstUseLeft-1,l[3]=1-2*this.fDstUseBottom,l[4]=2*this.fDstUseRight-1,l[5]=1-2*this.fDstUseTop,l[6]=2*this.fDstUseRight-1,l[7]=1-2*this.fDstUseTop,l[8]=2*this.fDstUseLeft-1,l[9]=1-2*this.fDstUseBottom,l[10]=2*this.fDstUseRight-1,l[11]=1-2*this.fDstUseBottom,this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.vertexPosBuffer),this.ctx.bufferSubData(this.ctx.ARRAY_BUFFER,0,l),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,null),l=null}break;default:return pt.SR_ERR_NOT_SUPPORT}return pt.SR_OK}},{key:"SetImagePostProcess",value:function(t,e){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;if(Ft.SR_PPT_SHARPNESS==t||Ft.SR_PPT_HUE==t){if(0-e>1e-6||e-1>1e-6)return pt.SR_ERR_PARAM}else if((Ft.SR_PPT_BRIGHTNESS==t||Ft.SR_PPT_SATURATION==t||Ft.SR_PPT_CONTRAST==t)&&(-1-e>1e-6||e-1>1e-6))return pt.SR_ERR_PARAM;switch(t){case Ft.SR_PPT_BRIGHTNESS:this.fBrightness=e;break;case Ft.SR_PPT_HUE:this.fHue=e;break;case Ft.SR_PPT_SATURATION:this.fSaturation=e;break;case Ft.SR_PPT_CONTRAST:this.fContrast=e;break;case Ft.SR_PPT_SHARPNESS:this.fSharpness=e;break;default:return pt.SR_ERR_NOT_SUPPORT}return Math.abs(this.fBrightness-0)<1e-6&&Math.abs(this.fHue-0)<1e-6&&Math.abs(this.fSaturation-0)<1e-6&&Math.abs(this.fContrast-0)<1e-6&&Math.abs(this.fSharpness-0)<1e-6?this.nPostProc=0:this.nPostProc=1,pt.SR_OK}},{key:"SetRenderState",value:function(t,e){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;switch(t){case gt.SR_RST_VERTICALFLIP:if(this.b3DPort)return pt.SR_ERR_NOT_SUPPORT;break;case gt.SR_RST_BACK_CULL:if(!this.b3DPort)return pt.SR_ERR_NOT_SUPPORT;Math.abs(e-0)<1e-6?this.bCullBack=!1:this.bCullBack=!0;break;case gt.SR_RST_IMAGE_ROTATE:if(this.b3DPort)return pt.SR_ERR_NOT_SUPPORT;var a=null,r=Ct.SR_IRA_0,i=b(0,0,1),n=p();if(Math.abs(e-0)<1e-6){if(this.nImageRotateAngle==r)break;a=this.bSrcRect?new Float32Array([this.fSrcUseLeft,this.fSrcUseTop,this.fSrcUseLeft,this.fSrcUseBottom,this.fSrcUseRight,this.fSrcUseTop,this.fSrcUseRight,this.fSrcUseTop,this.fSrcUseLeft,this.fSrcUseBottom,this.fSrcUseRight,this.fSrcUseBottom]):new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]),m(this.matRotate)}else if(Math.abs(e-90)<1e-6){if(r=Ct.SR_IRA_90,this.nImageRotateAngle==r)break;a=this.bSrcRect?new Float32Array([this.fSrcUseLeft,this.fSrcUseBottom,this.fSrcUseRight,this.fSrcUseBottom,this.fSrcUseLeft,this.fSrcUseTop,this.fSrcUseLeft,this.fSrcUseTop,this.fSrcUseRight,this.fSrcUseBottom,this.fSrcUseRight,this.fSrcUseTop]):new Float32Array([0,1,1,1,0,0,0,0,1,1,1,0]),R(this.matRotate,n,1.5707963,i)}else if(Math.abs(e-180)<1e-6){if(r=Ct.SR_IRA_180,this.nImageRotateAngle==r)break;a=this.bSrcRect?new Float32Array([this.fSrcUseRight,this.fSrcUseBottom,this.fSrcUseRight,this.fSrcUseTop,this.fSrcUseLeft,this.fSrcUseBottom,this.fSrcUseLeft,this.fSrcUseBottom,this.fSrcUseRight,this.fSrcUseTop,this.fSrcUseLeft,this.fSrcUseTop]):new Float32Array([1,1,1,0,0,1,0,1,1,0,0,0]),R(this.matRotate,n,ut,i)}else{if(!(Math.abs(e-270)<1e-6))return pt.SR_ERR_PARAM;if(r=Ct.SR_IRA_270,this.nImageRotateAngle==r)break;a=this.bSrcRect?new Float32Array([this.fSrcUseRight,this.fSrcUseTop,this.fSrcUseLeft,this.fSrcUseTop,this.fSrcUseRight,this.fSrcUseBottom,this.fSrcUseRight,this.fSrcUseBottom,this.fSrcUseLeft,this.fSrcUseTop,this.fSrcUseLeft,this.fSrcUseBottom]):new Float32Array([1,0,0,0,1,1,1,1,0,0,0,1]),R(this.matRotate,n,3*ut/2,i)}if(null==a)return pt.SR_ERR_NOT_SUPPORT;var s=this.ctx.createBuffer();this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,s),this.ctx.bufferData(this.ctx.ARRAY_BUFFER,a,this.ctx.STATIC_DRAW),this.texturePosBuffer=s,this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,null),this.nImageRotateAngle=r;break;default:return pt.SR_ERR_NOT_SUPPORT}return pt.SR_OK}},{key:"SetVideoResolution",value:function(t,e){return null==this.ctx||t<=0||e<=0?pt.SR_ERR_CALL_ORDER:(this.frameDisplayWidth=t,this.frameDisplayHeight=e,pt.SR_OK)}},{key:"GetCaptureSize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;if(null==t.nWidth||null==t.nWidth||null==t.nHeight||null==t.nHeight)return pt.SR_ERR_PARAM;if(1==e&&this.b3DPort)return pt.SR_ERR_NOT_SUPPORT;var a=0,r=0;if(0==t.nWidth&&0==t.nHeight)switch(this.enDisplayEffect){case St.SR_DE_FISH_PTZ_WALL:case St.SR_DE_FISH_PTZ_CEILING:case St.SR_DE_FISH_PTZ_FLOOR:a=Math.round(5*this.frameDisplayHeight/8),r=Math.round(3*a/4);break;case St.SR_DE_NULL:e?(a=Math.round(this.frameDisplayWidth),r=Math.round(this.frameDisplayHeight)):(a=Math.round((this.fSrcUseRight-this.fSrcUseLeft)*this.frameDisplayWidth),r=Math.round((this.fSrcUseBottom-this.fSrcUseTop)*this.frameDisplayHeight));break;case St.SR_DE_FISH_ORIGINAL:case St.SR_DE_FISH_SEMISPHERE:case St.SR_DE_PANORAMA_SPHERE:case St.SR_DE_PANORAMA_PLANET:case St.SR_DE_FISH_CYLINDER_CEILING:case St.SR_DE_FISH_CYLINDER_FLOOR:case St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL:case St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL:case St.SR_DE_FISH_PLANET:case St.SR_DE_FISH_CYLINDER_SPLIT_CEILING:case St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR:a=Math.round(this.frameDisplayWidth),r=Math.round(this.frameDisplayHeight);break;case St.SR_DE_FISH_PANORAMA_FLOOR_360:case St.SR_DE_FISH_PANORAMA_CEILING_360:this.frameDisplayHeight>=2048?(a=6144,r=864):this.frameDisplayHeight>=1536&&2048>this.frameDisplayHeight?(a=4096,r=576):(a=Math.round(3.14*this.frameDisplayHeight/1.6),r=Math.round(9*this.frameDisplayWidth/16),a=Math.round(2*a),r=Math.round(r/2));break;case St.SR_DE_FISH_PANORAMA_FLOOR_180:case St.SR_DE_FISH_PANORAMA_CEILING_180:this.frameDisplayHeight>=3072?(a=4096,r=2304):this.frameDisplayHeight>=2048&&3072>this.frameDisplayHeight?(a=3072,r=1728):this.frameDisplayHeight>=1536&&2048>this.frameDisplayHeight?(a=2048,r=1152):(a=Math.round(3.14*this.frameDisplayHeight/1.6),r=Math.round(9*a/16));break;case St.SR_DE_FISH_PANORAMA_WALL:a=Math.round(this.frameDisplayHeight),r=Math.round(9*a/16);break;default:return pt.SR_ERR_PARAM}else a=Math.round(t.nWidth),r=Math.round(t.nHeight);return a<16||r<16?pt.SR_ERR_PARAM:(this.nCaptureWidth=4*Math.round(a/4),this.nCaptureHeight=Math.round(r),t.nWidth=this.nCaptureWidth,t.nHeight=this.nCaptureHeight,t.nBufferLen=this.nCaptureWidth*this.nCaptureHeight*4,this.bCaptureOriginal=e,pt.SR_OK)}},{key:"CaptureScreen",value:function(t,e){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;var a=pt.SR_OK;if(a=this._BeginCapture(),pt.SR_OK!=a)return this.bIsCapturing=!1,a;if(1==this.bCaptureOriginal&&(this.stOriginalDisplayRect.fLeft=this.fSrcUseLeft*this.frameDisplayWidth,this.stOriginalDisplayRect.fTop=this.fSrcUseTop*this.frameDisplayHeight,this.stOriginalDisplayRect.fWidth=(this.fSrcUseRight-this.fSrcUseLeft)*this.frameDisplayWidth,this.stOriginalDisplayRect.fHeight=(this.fSrcUseBottom-this.fSrcUseTop)*this.frameDisplayHeight,a=this.SetDisplayRect(0,0,this.frameDisplayWidth,this.frameDisplayHeight,mt.SR_SRT_SRC),pt.SR_OK!=a))return this.bIsCapturing=!1,a;if(0==this.videoShaderProgram||0==this.vertexPosBuffer||0==this.texturePosBuffer)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_CALL_ORDER;this.ctx.useProgram(this.videoShaderProgram),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.vertexPosBuffer);var r=this.ctx.getAttribLocation(this.videoShaderProgram,"position");if(r<0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.b3DPort?this.ctx.vertexAttribPointer(r,3,this.ctx.FLOAT,!1,0,0):this.ctx.vertexAttribPointer(r,2,this.ctx.FLOAT,!1,0,0),this.ctx.enableVertexAttribArray(r),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.texturePosBuffer);var i=this.ctx.getAttribLocation(this.videoShaderProgram,"texCoord");if(i<0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.vertexAttribPointer(i,2,this.ctx.FLOAT,!1,0,0),this.ctx.enableVertexAttribArray(i),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,null);var n=this.enDisplayEffect,s=this.ctx.getUniformLocation(this.videoShaderProgram,"bCapture");if(s<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1i(s,1);var x=this.ctx.getUniformLocation(this.videoShaderProgram,"bDataFormat");if(x<=0)return pt.SR_ERR_WEBGL_RESOURCE;switch(this.enPixelFormat){case Rt.SR_PF_YV12:case Rt.SR_PF_I420:this.ctx.uniform1i(x,0);break;case Rt.SR_PF_NV12:break;case Rt.SR_PF_RGBA32:case Rt.SR_PF_SURFACE:this.ctx.uniform1i(x,1);break;default:return pt.SR_ERR_NOT_SUPPORT}var o=this.ctx.getUniformLocation(this.videoShaderProgram,"bDrawImage");this.ctx.uniform1i(o,0);var f=this.ctx.getUniformLocation(this.videoShaderProgram,"fAlpha");switch(this.ctx.uniform1f(f,0),n){case St.SR_DE_NULL:break;case St.SR_DE_FISH_ORIGINAL:case St.SR_DE_FISH_PTZ_CEILING:case St.SR_DE_FISH_PTZ_FLOOR:case St.SR_DE_FISH_PTZ_WALL:case St.SR_DE_FISH_PANORAMA_CEILING_360:case St.SR_DE_FISH_PANORAMA_CEILING_180:case St.SR_DE_FISH_PANORAMA_FLOOR_360:case St.SR_DE_FISH_PANORAMA_FLOOR_180:case St.SR_DE_FISH_PANORAMA_WALL:if(null==this.pFishParamManager)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_CALL_ORDER;var l={},_=pt.SR_OK;if(_=this.pFishParamManager.GetRenderParam(this.nFECPort,l),pt.SR_OK!=_)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),_;if(St.SR_DE_FISH_ORIGINAL==n){var h=this.ctx.getUniformLocation(this.videoShaderProgram,"bBlack");if(h<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1i(h,l.bBlack);var c=this.ctx.getUniformLocation(this.videoShaderProgram,"bCut");if(c<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1i(c,l.bCut)}if(St.SR_DE_FISH_PTZ_CEILING==n||St.SR_DE_FISH_PTZ_FLOOR==n||St.SR_DE_FISH_PTZ_WALL==n){var u=this.ctx.getUniformLocation(this.videoShaderProgram,"fHAngleCos");if(u<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(u,l.fCosH);var d=this.ctx.getUniformLocation(this.videoShaderProgram,"fHAngleSin");if(d<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(d,l.fSinH);var p=this.ctx.getUniformLocation(this.videoShaderProgram,"fVAngleCos");if(p<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(p,l.fCosV);var m=this.ctx.getUniformLocation(this.videoShaderProgram,"fVAngleSin");if(m<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(m,l.fSinV);var S=this.ctx.getUniformLocation(this.videoShaderProgram,"fZoom");if(S<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(S,l.fZoom)}if(St.SR_DE_FISH_PANORAMA_CEILING_360==n||St.SR_DE_FISH_PANORAMA_CEILING_180==n||St.SR_DE_FISH_PANORAMA_FLOOR_360==n||St.SR_DE_FISH_PANORAMA_FLOOR_180==n){var R=this.ctx.getUniformLocation(this.videoShaderProgram,"fAngle");if(R<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(R,l.fAngle)}var P=this.ctx.getUniformLocation(this.videoShaderProgram,"fRX1");if(P<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(P,l.fRXLeft);var y=this.ctx.getUniformLocation(this.videoShaderProgram,"fRX2");if(y<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(y,l.fRXRight);var b=this.ctx.getUniformLocation(this.videoShaderProgram,"fRY1");if(b<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(b,l.fRYTop);var E=this.ctx.getUniformLocation(this.videoShaderProgram,"fRY2");if(E<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(E,l.fRYBottom);break;case St.SR_DE_FISH_SEMISPHERE:this.pCamera.SetScale(this.fScale),this.pCamera.SetPitch(3.14-this.fRotateX),this.pCamera.SetYaw(-this.fRotateY),this.pCamera.UpdateCamera(this.nWndWidth,this.nWndHeight);var g=this.pCamera.GetView(),F=this.pCamera.GetProj(),C=this.ctx.getUniformLocation(this.videoShaderProgram,"matView");if(C<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(C,!1,g);var v=this.ctx.getUniformLocation(this.videoShaderProgram,"matProj");if(v<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(v,!1,F);break;case St.SR_DE_PANORAMA_SPHERE:this.pCamera.SetScale(this.fScale),this.pCamera.SetPitch(3.14-this.fRotateX),this.pCamera.SetYaw(this.fRotateY),this.pCamera.UpdateCamera(this.nWndWidth,this.nWndHeight);var T=this.pCamera.GetView(),D=this.pCamera.GetProj(),A=this.ctx.getUniformLocation(this.videoShaderProgram,"matView");if(A<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(A,!1,T);var I=this.ctx.getUniformLocation(this.videoShaderProgram,"matProj");if(I<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(I,!1,D);break;case St.SR_DE_FISH_CYLINDER_CEILING:case St.SR_DE_FISH_CYLINDER_FLOOR:case St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL:case St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL:this.pCamera.SetScale(this.fScale),this.pCamera.SetPitch(-this.fRotateX),this.pCamera.SetYaw(-this.fRotateY),this.pCamera.UpdateCamera(this.nWndWidth,this.nWndHeight);var M=this.pCamera.GetView(),L=this.pCamera.GetProj(),w=this.ctx.getUniformLocation(this.videoShaderProgram,"matView");if(w<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(w,!1,M);var O=this.ctx.getUniformLocation(this.videoShaderProgram,"matProj");if(O<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(O,!1,L);break;case St.SR_DE_FISH_PLANET:case St.SR_DE_PANORAMA_PLANET:this.pCamera.SetScale(this.fScale),this.pCamera.SetPitch(this.fRotateX),this.pCamera.SetYaw(3.14+this.fRotateY),this.pCamera.UpdateCamera(this.nWndWidth,this.nWndHeight);var B=this.pCamera.GetView(),k=this.pCamera.GetProj(),N=this.ctx.getUniformLocation(this.videoShaderProgram,"matView");if(N<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(N,!1,B);var V=this.ctx.getUniformLocation(this.videoShaderProgram,"matProj");if(V<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(V,!1,k);break;case St.SR_DE_FISH_CYLINDER_SPLIT_CEILING:case St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR:if(null==this.pFishParamManager)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_CALL_ORDER;var U={},H=pt.SR_OK;if(H=this.pFishParamManager.GetRenderParam(this.nFECPort,U),pt.SR_OK!=H)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),H;this.pCamera.SetScale(this.fScale),this.pCamera.SetPitch(-this.fRotateX),this.pCamera.UpdateCamera(this.nWndWidth,this.nWndHeight);var W=this.pCamera.GetView(),Y=this.pCamera.GetProj(),G=this.ctx.getUniformLocation(this.videoShaderProgram,"matView");if(G<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(G,!1,W);var X,J=this.ctx.getUniformLocation(this.videoShaderProgram,"matProj");if(J<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(J,!1,Y),X=Math.abs(.785-this.fRotateX)<.0025?.785:this.fRotateX;var Z=new Float32Array([0,1,0,2*-X]),j=this.ctx.getUniformLocation(this.videoShaderProgram,"vecCylinderParam");if(j<=0)return pt.SR_ERR_WEBGL_RESOURCE;if(this.ctx.uniform4f(j,Z[0],Z[1],Z[2],Z[3]),St.SR_DE_FISH_CYLINDER_SPLIT_CEILING==this.enDisplayEffect){var z=this.ctx.getUniformLocation(this.videoShaderProgram,"fTextureOffset");if(z<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(z,this.fRotateY)}else{var K=this.ctx.getUniformLocation(this.videoShaderProgram,"fTextureOffset");if(K<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(K,-this.fRotateY)}var q=this.ctx.getUniformLocation(this.videoShaderProgram,"fRX1");if(q<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(q,U.fRXLeft);var Q=this.ctx.getUniformLocation(this.videoShaderProgram,"fRX2");if(Q<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(Q,U.fRXRight);var $=this.ctx.getUniformLocation(this.videoShaderProgram,"fRY1");if($<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f($,U.fRYTop);var tt=this.ctx.getUniformLocation(this.videoShaderProgram,"fRY2");if(tt<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(tt,U.fRYBottom);break;default:return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_NOT_SUPPORT}if(this.nCaptureWidth<=0||this.nCaptureHeight<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_CANVAS;if(this.ctx.viewport(0,0,this.nCaptureWidth,this.nCaptureHeight),this.ctx.clearColor(0,0,0,1),this.ctx.clear(this.ctx.COLOR_BUFFER_BIT|this.ctx.DEPTH_BUFFER_BIT),this.b3DPort&&(this.ctx.enable(this.ctx.DEPTH_TEST),this.ctx.depthFunc(this.ctx.LESS),this.ctx.depthMask(!0),1==this.bCullBack?this.ctx.enable(this.ctx.CULL_FACE):this.ctx.disable(this.ctx.CULL_FACE)),this.enPixelFormat==Rt.SR_PF_RGBA32||this.enPixelFormat==Rt.SR_PF_SURFACE){this.ctx.activeTexture(this.ctx.TEXTURE0),this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nSurfaceTexture[0]),!this.onlySupportedWebGL1&&this.bAntialias&&this.ctx.generateMipmap(this.ctx.TEXTURE_2D);var et=this.ctx.getUniformLocation(this.videoShaderProgram,"Ytexture");this.ctx.uniform1i(et,0)}else{if(this.enPixelFormat!=Rt.SR_PF_YV12&&this.enPixelFormat!=Rt.SR_PF_I420)return pt.SR_ERR_NOT_SUPPORT;this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nSurfaceTexture[0]),!this.onlySupportedWebGL1&&this.bAntialias&&this.ctx.generateMipmap(this.ctx.TEXTURE_2D);var at=this.ctx.getUniformLocation(this.videoShaderProgram,"Ytexture");this.ctx.uniform1i(at,0),this.ctx.activeTexture(this.ctx.TEXTURE1),this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nSurfaceTexture[1]),!this.onlySupportedWebGL1&&this.bAntialias&&this.ctx.generateMipmap(this.ctx.TEXTURE_2D);var rt=this.ctx.getUniformLocation(this.videoShaderProgram,"Utexture");this.ctx.uniform1i(rt,1),this.ctx.activeTexture(this.ctx.TEXTURE2),this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nSurfaceTexture[2]),!this.onlySupportedWebGL1&&this.bAntialias&&this.ctx.generateMipmap(this.ctx.TEXTURE_2D);var it=this.ctx.getUniformLocation(this.videoShaderProgram,"Vtexture");this.ctx.uniform1i(it,2)}if(this.onlySupportedWebGL1||this.ctx.clearBufferfi(this.ctx.DEPTH_STENCIL,0,1,0),0==this.b3DPort)this.ctx.drawArrays(this.ctx.TRIANGLES,0,6);else if(this.enDisplayEffect==St.SR_DE_FISH_SEMISPHERE||this.enDisplayEffect==St.SR_DE_FISH_PLANET){if(this.nSemiSpherePosNum<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_CALL_ORDER;this.ctx.drawArrays(this.ctx.TRIANGLES,0,this.nSemiSpherePosNum)}else if(this.enDisplayEffect==St.SR_DE_PANORAMA_SPHERE||this.enDisplayEffect==St.SR_DE_PANORAMA_PLANET){if(this.nSpherePosNum<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_CALL_ORDER;this.ctx.bindBuffer(this.ctx.ELEMENT_ARRAY_BUFFER,this.indicesPosBuffer),this.ctx.drawElements(this.ctx.TRIANGLES,6*this.nSpherePosNum,this.ctx.UNSIGNED_SHORT,0),this.ctx.bindBuffer(this.ctx.ELEMENT_ARRAY_BUFFER,null)}else if(this.enDisplayEffect==St.SR_DE_FISH_CYLINDER_CEILING||this.enDisplayEffect==St.SR_DE_FISH_CYLINDER_FLOOR||this.enDisplayEffect==St.SR_DE_FISH_CYLINDER_SPLIT_CEILING||this.enDisplayEffect==St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR){if(this.nCylinderPosNum<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_CALL_ORDER;this.ctx.drawArrays(this.ctx.TRIANGLES,0,this.nCylinderPosNum)}else if(this.enDisplayEffect==St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL||this.enDisplayEffect==St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL){if(this.nArcSpherePosNum<=0)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_CALL_ORDER;this.ctx.drawArrays(this.ctx.TRIANGLES,0,this.nArcSpherePosNum)}if(this.ctx.useProgram(null),e||this.DoCallBack(),1==this.bCaptureOriginal){var nt=this.nImageRotateAngle;if(this.bSrcRect=!1,a=this.SetRenderState(gt.SR_RST_IMAGE_ROTATE,0),pt.SR_OK!=a)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),a;if(a=this.SetDisplayRect(this.stOriginalDisplayRect.fLeft,this.stOriginalDisplayRect.fTop,this.stOriginalDisplayRect.fWidth,this.stOriginalDisplayRect.fHeight,mt.SR_SRT_SRC),pt.SR_OK!=a)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),a;switch(this.bSrcRect=!0,nt){case Ct.SR_IRA_0:a=this.SetRenderState(gt.SR_RST_IMAGE_ROTATE,0);break;case Ct.SR_IRA_90:a=this.SetRenderState(gt.SR_RST_IMAGE_ROTATE,90);break;case Ct.SR_IRA_180:a=this.SetRenderState(gt.SR_RST_IMAGE_ROTATE,180);break;case Ct.SR_IRA_270:a=this.SetRenderState(gt.SR_RST_IMAGE_ROTATE,270);break;default:return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_NOT_SUPPORT}if(pt.SR_OK!=a)return this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),a}return a=this._EndCapture(t),pt.SR_OK!=a?a:pt.SR_OK}},{key:"SetWebGL2Support",value:function(t){return this.onlySupportedWebGL1=t,pt.SR_OK}},{key:"SetFishParamManager",value:function(t){return this.pFishParamManager=t,pt.SR_OK}},{key:"SetFECPort",value:function(t){return this.nFECPort=t,pt.SR_OK}},{key:"Render",value:function(t){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;switch(this.ctx.useProgram(this.videoShaderProgram),this.enPixelFormat){case Rt.SR_PF_YV12:case Rt.SR_PF_I420:this.ctx.activeTexture(this.ctx.TEXTURE0),this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nSurfaceTexture[0]),!this.onlySupportedWebGL1&&this.bAntialias&&this.ctx.generateMipmap(this.ctx.TEXTURE_2D);var e=this.ctx.getUniformLocation(this.videoShaderProgram,"Ytexture");this.ctx.uniform1i(e,0),this.ctx.activeTexture(this.ctx.TEXTURE1),this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nSurfaceTexture[1]),!this.onlySupportedWebGL1&&this.bAntialias&&this.ctx.generateMipmap(this.ctx.TEXTURE_2D);var a=this.ctx.getUniformLocation(this.videoShaderProgram,"Utexture");this.ctx.uniform1i(a,1),this.ctx.activeTexture(this.ctx.TEXTURE2),this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nSurfaceTexture[2]),!this.onlySupportedWebGL1&&this.bAntialias&&this.ctx.generateMipmap(this.ctx.TEXTURE_2D);var r=this.ctx.getUniformLocation(this.videoShaderProgram,"Vtexture");this.ctx.uniform1i(r,2);break;case Rt.SR_PF_SURFACE:this.ctx.activeTexture(this.ctx.TEXTURE0),this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nSurfaceTexture[0]),!this.onlySupportedWebGL1&&this.bAntialias&&this.ctx.generateMipmap(this.ctx.TEXTURE_2D);var i=this.ctx.getUniformLocation(this.videoShaderProgram,"Ytexture");this.ctx.uniform1i(i,0);break;default:return pt.SR_ERR_NOT_SUPPORT}var n=this.ctx.getUniformLocation(this.videoShaderProgram,"bCapture");if(n<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1i(n,0);var s=this.ctx.getUniformLocation(this.videoShaderProgram,"bDataFormat");if(s<=0)return pt.SR_ERR_WEBGL_RESOURCE;switch(this.enPixelFormat){case Rt.SR_PF_YV12:case Rt.SR_PF_I420:this.ctx.uniform1i(s,0);break;case Rt.SR_PF_NV12:break;case Rt.SR_PF_RGBA32:case Rt.SR_PF_SURFACE:this.ctx.uniform1i(s,1)}switch(this.enDisplayEffect){case St.SR_DE_NULL:if(this.nPostProc){var x=this.ctx.getUniformLocation(this.videoShaderProgram,"fBrightness");if(x<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(x,this.fBrightness);var o=this.ctx.getUniformLocation(this.videoShaderProgram,"fHue");if(o<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(o,this.fHue);var f=this.ctx.getUniformLocation(this.videoShaderProgram,"fSaturation");if(f<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(f,this.fSaturation);var l=this.ctx.getUniformLocation(this.videoShaderProgram,"fContrast");if(l<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(l,this.fContrast);var _=this.ctx.getUniformLocation(this.videoShaderProgram,"fSharpness");if(_<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(_,this.fSharpness);var h=this.ctx.getUniformLocation(this.videoShaderProgram,"fWndWidth");if(h<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(h,this.nWndWidth);var c=this.ctx.getUniformLocation(this.videoShaderProgram,"fWndHeight");if(c<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(c,this.nWndHeight)}var u=this.ctx.getUniformLocation(this.videoShaderProgram,"nPostProc");this.ctx.uniform1i(u,this.nPostProc);break;case St.SR_DE_FISH_ORIGINAL:case St.SR_DE_FISH_PTZ_CEILING:case St.SR_DE_FISH_PTZ_FLOOR:case St.SR_DE_FISH_PTZ_WALL:case St.SR_DE_FISH_PANORAMA_CEILING_360:case St.SR_DE_FISH_PANORAMA_CEILING_180:case St.SR_DE_FISH_PANORAMA_FLOOR_360:case St.SR_DE_FISH_PANORAMA_FLOOR_180:case St.SR_DE_FISH_PANORAMA_WALL:if(St.SR_DE_FISH_ORIGINAL==this.enDisplayEffect){var d=this.ctx.getUniformLocation(this.videoShaderProgram,"bBlack");if(d<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1i(d,this.pstFishParam.bBlack);var p=this.ctx.getUniformLocation(this.videoShaderProgram,"bCut");if(p<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1i(p,this.pstFishParam.bCut)}if(St.SR_DE_FISH_PTZ_CEILING==this.enDisplayEffect||St.SR_DE_FISH_PTZ_FLOOR==this.enDisplayEffect||St.SR_DE_FISH_PTZ_WALL==this.enDisplayEffect){var m=this.ctx.getUniformLocation(this.videoShaderProgram,"fHAngleCos");if(m<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(m,this.pstFishParam.fCosH);var S=this.ctx.getUniformLocation(this.videoShaderProgram,"fHAngleSin");if(S<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(S,this.pstFishParam.fSinH);var R=this.ctx.getUniformLocation(this.videoShaderProgram,"fVAngleCos");if(R<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(R,this.pstFishParam.fCosV);var P=this.ctx.getUniformLocation(this.videoShaderProgram,"fVAngleSin");if(P<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(P,this.pstFishParam.fSinV);var y=this.ctx.getUniformLocation(this.videoShaderProgram,"fZoom");if(y<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(y,this.pstFishParam.fZoom)}if(St.SR_DE_FISH_PANORAMA_CEILING_360==this.enDisplayEffect||St.SR_DE_FISH_PANORAMA_CEILING_180==this.enDisplayEffect||St.SR_DE_FISH_PANORAMA_FLOOR_360==this.enDisplayEffect||St.SR_DE_FISH_PANORAMA_FLOOR_180==this.enDisplayEffect){var b=this.ctx.getUniformLocation(this.videoShaderProgram,"fAngle");if(b<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(b,this.pstFishParam.fAngle)}var E=this.ctx.getUniformLocation(this.videoShaderProgram,"fRX1");if(E<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(E,this.pstFishParam.fRXLeft);var g=this.ctx.getUniformLocation(this.videoShaderProgram,"fRX2");if(g<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(g,this.pstFishParam.fRXRight);var F=this.ctx.getUniformLocation(this.videoShaderProgram,"fRY1");if(F<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(F,this.pstFishParam.fRYTop);var C=this.ctx.getUniformLocation(this.videoShaderProgram,"fRY2");if(C<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(C,this.pstFishParam.fRYBottom);break;case St.SR_DE_FISH_SEMISPHERE:this.pCamera.SetScale(this.fScale),this.pCamera.SetPitch(3.14-this.fRotateX),this.pCamera.SetYaw(-this.fRotateY),this.pCamera.UpdateCamera(this.nWndWidth,this.nWndHeight);var v=this.pCamera.GetView(),T=this.pCamera.GetProj(),D=this.ctx.getUniformLocation(this.videoShaderProgram,"matView");if(D<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(D,!1,v);var A=this.ctx.getUniformLocation(this.videoShaderProgram,"matProj");if(A<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(A,!1,T);break;case St.SR_DE_PANORAMA_SPHERE:this.pCamera.SetScale(this.fScale),this.pCamera.SetPitch(3.14-this.fRotateX),this.pCamera.SetYaw(this.fRotateY),this.pCamera.UpdateCamera(this.nWndWidth,this.nWndHeight);var I=this.pCamera.GetView(),M=this.pCamera.GetProj(),L=this.ctx.getUniformLocation(this.videoShaderProgram,"matView");if(L<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(L,!1,I);var w=this.ctx.getUniformLocation(this.videoShaderProgram,"matProj");if(w<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(w,!1,M);break;case St.SR_DE_FISH_CYLINDER_CEILING:case St.SR_DE_FISH_CYLINDER_FLOOR:case St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL:case St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL:this.pCamera.SetScale(this.fScale),this.pCamera.SetPitch(-this.fRotateX),this.pCamera.SetYaw(-this.fRotateY),this.pCamera.UpdateCamera(this.nWndWidth,this.nWndHeight);var O=this.pCamera.GetView(),B=this.pCamera.GetProj(),k=this.ctx.getUniformLocation(this.videoShaderProgram,"matView");if(k<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(k,!1,O);var N=this.ctx.getUniformLocation(this.videoShaderProgram,"matProj");if(N<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(N,!1,B);break;case St.SR_DE_FISH_PLANET:case St.SR_DE_PANORAMA_PLANET:this.pCamera.SetScale(this.fScale),this.pCamera.SetPitch(this.fRotateX),this.pCamera.SetYaw(3.14+this.fRotateY),this.pCamera.UpdateCamera(this.nWndWidth,this.nWndHeight);var V=this.pCamera.GetView(),U=this.pCamera.GetProj(),H=this.ctx.getUniformLocation(this.videoShaderProgram,"matView");if(H<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(H,!1,V);var W=this.ctx.getUniformLocation(this.videoShaderProgram,"matProj");if(W<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(W,!1,U);var Y=this.ctx.getUniformLocation(this.videoShaderProgram,"bDrawImage");if(Y<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1i(Y,0);var G=this.ctx.getUniformLocation(this.videoShaderProgram,"fAlpha");if(G<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(G,0);break;case St.SR_DE_FISH_CYLINDER_SPLIT_CEILING:case St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR:if(null==this.pFishParamManager)return pt.SR_ERR_CALL_ORDER;this.pCamera.SetScale(this.fScale),this.pCamera.SetPitch(-this.fRotateX),this.pCamera.UpdateCamera(this.nWndWidth,this.nWndHeight);var X=this.pCamera.GetView(),J=this.pCamera.GetProj(),Z=this.ctx.getUniformLocation(this.videoShaderProgram,"matView");if(Z<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(Z,!1,X);var j,z=this.ctx.getUniformLocation(this.videoShaderProgram,"matProj");if(z<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(z,!1,J),j=Math.abs(.785-this.fRotateX)<.0025?.785:this.fRotateX;var K=new Float32Array([0,1,0,2*-j]),q=this.ctx.getUniformLocation(this.videoShaderProgram,"vecCylinderParam");if(q<=0)return pt.SR_ERR_WEBGL_RESOURCE;if(this.ctx.uniform4f(q,K[0],K[1],K[2],K[3]),St.SR_DE_FISH_CYLINDER_SPLIT_CEILING==this.enDisplayEffect){var Q=this.ctx.getUniformLocation(this.videoShaderProgram,"fTextureOffset");if(Q<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(Q,this.fRotateY)}else{var $=this.ctx.getUniformLocation(this.videoShaderProgram,"fTextureOffset");if($<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f($,-this.fRotateY)}var tt={},et=pt.SR_OK;if(et=this.pFishParamManager.GetRenderParam(this.nFECPort,tt),pt.SR_OK!=et)return et;var at=this.ctx.getUniformLocation(this.videoShaderProgram,"fRX1");if(at<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(at,tt.fRXLeft);var rt=this.ctx.getUniformLocation(this.videoShaderProgram,"fRX2");if(rt<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(rt,tt.fRXRight);var it=this.ctx.getUniformLocation(this.videoShaderProgram,"fRY1");if(it<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(it,tt.fRYTop);var nt=this.ctx.getUniformLocation(this.videoShaderProgram,"fRY2");if(nt<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(nt,tt.fRYBottom);var st=this.ctx.getUniformLocation(this.videoShaderProgram,"bDrawImage");if(st<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1i(st,0);var xt=this.ctx.getUniformLocation(this.videoShaderProgram,"fAlpha");if(xt<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(xt,0);break;default:return pt.SR_ERR_NOT_SUPPORT}this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.vertexPosBuffer);var ot=this.ctx.getAttribLocation(this.videoShaderProgram,"position");if(ot<0)return pt.SR_ERR_WEBGL_RESOURCE;this.b3DPort?this.ctx.vertexAttribPointer(ot,3,this.ctx.FLOAT,!1,0,0):this.ctx.vertexAttribPointer(ot,2,this.ctx.FLOAT,!1,0,0),this.ctx.enableVertexAttribArray(ot),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.texturePosBuffer);var ft=this.ctx.getAttribLocation(this.videoShaderProgram,"texCoord");if(ft<0)return pt.SR_ERR_WEBGL_RESOURCE;if(this.ctx.vertexAttribPointer(ft,2,this.ctx.FLOAT,!1,0,0),this.ctx.enableVertexAttribArray(ft),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,null),this.ctx.viewport(0,0,this.nWndWidth,this.nWndHeight),this.onlySupportedWebGL1||this.ctx.clearBufferfi(this.ctx.DEPTH_STENCIL,0,1,0),this.ctx.clearColor(0,0,0,1),this.ctx.clear(this.ctx.COLOR_BUFFER_BIT|this.ctx.DEPTH_BUFFER_BIT),this.b3DPort&&(this.ctx.enable(this.ctx.DEPTH_TEST),this.ctx.depthFunc(this.ctx.LESS),this.ctx.depthMask(!0),1==this.bCullBack?this.ctx.enable(this.ctx.CULL_FACE):this.ctx.disable(this.ctx.CULL_FACE)),0==this.b3DPort)this.ctx.drawArrays(this.ctx.TRIANGLES,0,6);else if(this.enDisplayEffect==St.SR_DE_FISH_SEMISPHERE||this.enDisplayEffect==St.SR_DE_FISH_PLANET){if(this.nSemiSpherePosNum<=0)return pt.SR_ERR_CALL_ORDER;this.ctx.drawArrays(this.ctx.TRIANGLES,0,this.nSemiSpherePosNum)}else if(this.enDisplayEffect==St.SR_DE_PANORAMA_SPHERE||this.enDisplayEffect==St.SR_DE_PANORAMA_PLANET){if(this.nSpherePosNum<=0)return pt.SR_ERR_CALL_ORDER;this.ctx.bindBuffer(this.ctx.ELEMENT_ARRAY_BUFFER,this.indicesPosBuffer),this.ctx.drawElements(this.ctx.TRIANGLES,6*this.nSpherePosNum,this.ctx.UNSIGNED_SHORT,0),this.ctx.bindBuffer(this.ctx.ELEMENT_ARRAY_BUFFER,null)}else if(this.enDisplayEffect==St.SR_DE_FISH_CYLINDER_CEILING||this.enDisplayEffect==St.SR_DE_FISH_CYLINDER_FLOOR||this.enDisplayEffect==St.SR_DE_FISH_CYLINDER_SPLIT_CEILING||this.enDisplayEffect==St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR){if(this.nCylinderPosNum<=0)return pt.SR_ERR_CALL_ORDER;this.ctx.drawArrays(this.ctx.TRIANGLES,0,this.nCylinderPosNum)}else if(this.enDisplayEffect==St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL||this.enDisplayEffect==St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL){if(this.nArcSpherePosNum<=0)return pt.SR_ERR_CALL_ORDER;this.ctx.drawArrays(this.ctx.TRIANGLES,0,this.nArcSpherePosNum)}return this.ctx.useProgram(null),pt.SR_OK}},{key:"SetAntialias",value:function(t){return null==this.ctx?pt.SR_ERR_CALL_ORDER:(this.bAntialias=t,pt.SR_OK)}},{key:"DelSubPort",value:function(){return null==this.ctx?pt.SR_ERR_CALL_ORDER:(0!=this.videoShaderProgram&&null!=this.ctx&&(this.ctx.deleteProgram(this.videoShaderProgram),this.videoShaderProgram=0),0!=this.vertexPosBuffer&&null!=this.ctx&&(this.ctx.deleteBuffer(this.vertexPosBuffer),this.vertexPosBuffer=0),0!=this.texturePosBuffer&&null!=this.ctx&&(this.ctx.deleteBuffer(this.texturePosBuffer),this.texturePosBuffer=0),0!=this.indicesPosBuffer&&null!=this.ctx&&(this.ctx.deleteBuffer(this.indicesPosBuffer),this.indicesPosBuffer=0),this.nMaxPointNum=0,this.pLinePosVertices=null,this.pLineClrVertices=null,0!=this.glLinePosBuffer&&null!=this.ctx&&(this.ctx.deleteBuffer(this.glLinePosBuffer),this.glLinePosBuffer=0),this.nLineTriangleNum=0,0!=this.nLineShaderProgram&&null!=this.ctx&&(this.ctx.deleteProgram(this.nLineShaderProgram),this.nLineShaderProgram=0),this.pFillBlockPosVertices=null,this.pFillBlockClrVertices=null,this.nMaxFillBlockTriNum=0,0!=this.glBlockPosBuffer&&null!=this.ctx&&(this.ctx.deleteBuffer(this.glBlockPosBuffer),this.glBlockPosBuffer=0),0!=this.glBlockClrBuffer&&null!=this.ctx&&(this.ctx.deleteBuffer(this.glBlockClrBuffer),this.glBlockClrBuffer=0),0!=this.nBlockShaderProgram&&null!=this.ctx&&(this.ctx.deleteProgram(this.nBlockShaderProgram),this.nBlockShaderProgram=0),this.nDrawFontWidth=0,this.nDrawFontHeight=0,0!=this.nFontColorTexture&&null!=this.ctx&&(this.ctx.deleteTexture(this.nFontColorTexture),this.nFontColorTexture=0),this.pFontColorBuffer=0,0!=this.nFontShaderProgram&&null!=this.ctx&&(this.ctx.deleteProgram(this.nFontShaderProgram),this.nFontShaderProgram=0),this.pFontPosVertices=null,0!=this.glFontTexturePosBuffer&&null!=this.ctx&&(this.ctx.deleteBuffer(this.glFontTexturePosBuffer),this.glFontTexturePosBuffer=0),0!=this.glFontVertexPosBuffer&&null!=this.ctx&&(this.ctx.deleteBuffer(this.glFontVertexPosBuffer),this.glFontVertexPosBuffer=0),0!=this.nCaptureRTTex&&(this.ctx.deleteTexture(this.nCaptureRTTex),this.nCaptureRTTex=0),0!=this.nCaptureFBO&&(this.ctx.deleteFramebuffer(this.nCaptureFBO),this.nCaptureFBO=0),0!=this.nCaptureDepthbuffer&&(this.ctx.deleteRenderbuffer(this.nCaptureDepthbuffer),this.nCaptureDepthbuffer=0),this.bCaptureResInit=!1,this.pSemiSpherePos=null,this.pSemiSphereTex=null,this.nSemiSpherePosNum=0,this.nSemiSpherePosSize=0,this.nSemiSphereTexSize=0,this.pSpherePos=null,this.pSphereTex=null,this.pSphereInd=null,this.nSpherePosNum=0,this.nSpherePosSize=0,this.nSphereTexSize=0,this.pCylinderPos=null,this.pCylinderTex=null,this.nCylinderPosNum=0,this.nCylinderPosSize=0,this.nCylinderTexSize=0,this.fCylinderHeight=0,this.fCylinderRadius=0,this.pArcSpherePos=null,this.pArcSphereTex=null,this.nArcSpherePosNum=0,this.nArcSpherePosSize=0,this.nArcSphereTexSize=0,this.b3DPort=!1,this.pCamera=null,this.fRotateX=0,this.fRotateY=0,this.fScale=0,this.pfuncCBIn=null,this.pfuncCBOut=null,this.pUserIn=null,this.pUserOut=null,this.ctx.disable(this.ctx.CULL_FACE),this.ctx.disable(this.ctx.DEPTH_TEST),pt.SR_OK)}},{key:"SetFishParam",value:function(t){return null==t?pt.SR_ERR_PARAM:(this.pstFishParam=t,pt.SR_OK)}},{key:"DrawLines",value:function(t,e,a,r,i,n){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;var s=[],x={};return x.pstPoints=t,x.nPointNum=e,x.bLoop=a,x.pstColor=r,x.nLineWidth=i,s.push(x),this.DrawLinesEx(s,1,e,n)}},{key:"DrawLinesEx",value:function(t,e,a,r){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;if(null==t||e<1||a<2)return pt.SR_ERR_PARAM;if(0==this.nLineShaderProgram){var i=this.CompileProgram("\n    attribute vec3 position;\n    attribute vec4   color;\n    varying   float  pp;\n    varying   vec4  colorOut;\n    uniform int bCapture; \n    uniform   mat4   matRotate;\n\n    void main()\n    {\n        if(bCapture == 1)\n        {\n            gl_Position = vec4(position.x, position.y, 0.0, 1.0) * matRotate;\n            gl_Position.y = -gl_Position.y;\n        }\n        else\n        {\n            gl_Position = vec4(position.x, position.y, 0.0, 1.0) * matRotate;\n        }\n        pp = position.z;\n        colorOut = color;\n    }\n",Ot);if(i<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.nLineShaderProgram=i}if(1==r)return this.DrawFillBlock(t,e,a);for(var n=0,s=0;s<e;++s){if(null==t[s].pstPoints||t[s].nPointNum<=1||t[s].nPointNum>=1024||t[s].nLineWidth<=0||null==t[s].pstColor)return pt.SR_ERR_PARAM;n+=t[s].nPointNum}if(n!=a)return pt.SR_ERR_PARAM;if((n+=e)>this.nMaxPointNum&&(this.nMaxPointNum=n,this.pLinePosVertices=null,this.pLineClrVertices=null),null==this.pLinePosVertices&&(this.pLinePosVertices=new Float32Array(6*this.nMaxPointNum*3),null==this.pLinePosVertices))return pt.SR_ERR_ALLOC_MEMORY;if(this.pLinePosVertices.fill(0),null==this.pLineClrVertices&&(this.pLineClrVertices=new Float32Array(6*this.nMaxPointNum*4),null==this.pLineClrVertices))return pt.SR_ERR_ALLOC_MEMORY;if(this.pLineClrVertices.fill(0),0==this.glLinePosBuffer&&(this.glLinePosBuffer=this.ctx.createBuffer(),0==this.glLinePosBuffer))return pt.SR_ERR_WEBGL_RESOURCE;if(0==this.glLineClrBuffer&&(this.glLineClrBuffer=this.ctx.createBuffer(),0==this.glLineClrBuffer))return pt.SR_ERR_WEBGL_RESOURCE;var x=this.ComputeLinePoint(t,e);if(pt.SR_OK!=x)return x;this.ctx.enable(this.ctx.BLEND),this.ctx.blendFuncSeparate(this.ctx.SRC_ALPHA,this.ctx.ONE_MINUS_SRC_ALPHA,this.ctx.ONE,this.ctx.ONE_MINUS_SRC_ALPHA);var o=this.nLineShaderProgram;this.ctx.useProgram(o);var f=this.ctx.getUniformLocation(this.nLineShaderProgram,"bCapture");if(f<=0)return pt.SR_ERR_WEBGL_RESOURCE;1==this.bIsCapturing?this.ctx.uniform1i(f,1):this.ctx.uniform1i(f,0);var l=this.glLinePosBuffer,_=this.glLineClrBuffer,h=this.nLineTriangleNum,c=this.pLinePosVertices,u=this.pLineClrVertices;this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,l),this.ctx.bufferData(this.ctx.ARRAY_BUFFER,c,this.ctx.STATIC_DRAW);var d=this.ctx.getAttribLocation(o,"position");this.ctx.enableVertexAttribArray(d),this.ctx.vertexAttribPointer(d,3,this.ctx.FLOAT,!1,0,0),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,_),this.ctx.bufferData(this.ctx.ARRAY_BUFFER,u,this.ctx.STATIC_DRAW);var p=this.ctx.getAttribLocation(o,"color");this.ctx.enableVertexAttribArray(p),this.ctx.vertexAttribPointer(p,4,this.ctx.FLOAT,!1,0,0),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,null);var m=this.ctx.getUniformLocation(o,"matRotate");return m<=0?pt.SR_ERR_WEBGL_RESOURCE:(this.ctx.uniformMatrix4fv(m,!1,this.matRotate),1==this.bIsCapturing?this.ctx.viewport(0,0,this.nCaptureWidth,this.nCaptureHeight):this.ctx.viewport(0,0,this.nWndWidth,this.nWndHeight),this.ctx.disable(this.ctx.DEPTH_TEST),this.ctx.drawArrays(this.ctx.TRIANGLES,0,3*h),this.ctx.useProgram(null),this.ctx.disable(this.ctx.BLEND),this.b3DPort&&(this.ctx.enable(this.ctx.DEPTH_TEST),this.ctx.depthFunc(this.ctx.LESS),this.ctx.depthMask(!0),1==this.bCullBack?this.ctx.enable(this.ctx.CULL_FACE):this.ctx.disable(this.ctx.CULL_FACE)),pt.SR_OK)}},{key:"DrawFillBlock",value:function(t,e,a){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;if(null==t||e<1||a<2)return pt.SR_ERR_PARAM;for(var r=0,i=0;i<e;++i){if(null==t[i].pstPoints||t[i].nPointNum<3||1!=t[i].bLoop||null==t[i].pstColor)return pt.SR_ERR_PARAM;r+=t[i].nPointNum}if(r!==a)return pt.SR_ERR_PARAM;var n=a-2*e;if(n>this.nMaxFillBlockTriNum&&(this.pFillBlockPosVertices=null,this.pFillBlockClrVertices=null,this.nMaxFillBlockTriNum=n),0==this.glBlockPosBuffer&&(this.glBlockPosBuffer=this.ctx.createBuffer(),0==this.glBlockPosBuffer))return pt.SR_ERR_WEBGL_RESOURCE;if(0==this.glBlockClrBuffer&&(this.glBlockClrBuffer=this.ctx.createBuffer(),0==this.glBlockClrBuffer))return pt.SR_ERR_WEBGL_RESOURCE;if(null==this.pFillBlockPosVertices){var s=this.nMaxFillBlockTriNum;if(this.pFillBlockPosVertices=new Float32Array(3*s*3),null==this.pFillBlockPosVertices)return pt.SR_ERR_ALLOC_MEMORY}if(this.pFillBlockPosVertices.fill(0),null==this.pFillBlockClrVertices){var x=this.nMaxFillBlockTriNum;if(this.pFillBlockClrVertices=new Float32Array(4*x*3),null==this.pFillBlockClrVertices)return pt.SR_ERR_ALLOC_MEMORY}this.pFillBlockClrVertices.fill(0);for(var o=0,f=0,l=0,_=null,h=null,c={},u={},d={},p=0;p<e;++p){l=t[p].nPointNum,_=t[p].pstPoints,h=t[p].pstColor,c.fX=(_[0].fX-this.fSrcUseLeft)/(this.fSrcUseRight-this.fSrcUseLeft),c.fX=this.fDstUseLeft+c.fX*(this.fDstUseRight-this.fDstUseLeft),c.fX=2*c.fX-1,c.fY=(_[0].fY-this.fSrcUseTop)/(this.fSrcUseBottom-this.fSrcUseTop),c.fY=this.fDstUseTop+c.fY*(this.fDstUseBottom-this.fDstUseTop),c.fY=1-2*c.fY;for(var m=1;m<l-1;m++)u.fX=(_[m].fX-this.fSrcUseLeft)/(this.fSrcUseRight-this.fSrcUseLeft),u.fX=this.fDstUseLeft+u.fX*(this.fDstUseRight-this.fDstUseLeft),u.fX=2*u.fX-1,u.fY=(_[m].fY-this.fSrcUseTop)/(this.fSrcUseBottom-this.fSrcUseTop),u.fY=this.fDstUseTop+u.fY*(this.fDstUseBottom-this.fDstUseTop),u.fY=1-2*u.fY,d.fX=(_[m+1].fX-this.fSrcUseLeft)/(this.fSrcUseRight-this.fSrcUseLeft),d.fX=this.fDstUseLeft+d.fX*(this.fDstUseRight-this.fDstUseLeft),d.fX=2*d.fX-1,d.fY=(_[m+1].fY-this.fSrcUseTop)/(this.fSrcUseBottom-this.fSrcUseTop),d.fY=this.fDstUseTop+d.fY*(this.fDstUseBottom-this.fDstUseTop),d.fY=1-2*d.fY,this.pFillBlockPosVertices[o++]=c.fX,this.pFillBlockPosVertices[o++]=c.fY,this.pFillBlockPosVertices[o++]=0,this.pFillBlockClrVertices[f++]=h.fR,this.pFillBlockClrVertices[f++]=h.fG,this.pFillBlockClrVertices[f++]=h.fB,this.pFillBlockClrVertices[f++]=h.fA,this.pFillBlockPosVertices[o++]=u.fX,this.pFillBlockPosVertices[o++]=u.fY,this.pFillBlockPosVertices[o++]=0,this.pFillBlockClrVertices[f++]=h.fR,this.pFillBlockClrVertices[f++]=h.fG,this.pFillBlockClrVertices[f++]=h.fB,this.pFillBlockClrVertices[f++]=h.fA,this.pFillBlockPosVertices[o++]=d.fX,this.pFillBlockPosVertices[o++]=d.fY,this.pFillBlockPosVertices[o++]=0,this.pFillBlockClrVertices[f++]=h.fR,this.pFillBlockClrVertices[f++]=h.fG,this.pFillBlockClrVertices[f++]=h.fB,this.pFillBlockClrVertices[f++]=h.fA}if(0==this.nBlockShaderProgram&&(this.nBlockShaderProgram=this.CompileProgram("\n    attribute vec3 position;\n    attribute vec4   color;\n    varying   float  pp;\n    varying   vec4  colorOut;\n    uniform int bCapture; \n\n    void main()\n    {\n        if(bCapture == 1)\n        {\n            gl_Position = vec4(position.x, position.y, 0.0, 1.0);\n            gl_Position.y = -gl_Position.y;\n        }\n        else\n        {\n            gl_Position = vec4(position.x, position.y, 0.0, 1.0);\n        }\n        pp = position.z;\n        colorOut = color;\n    }\n",Ot),this.nBlockShaderProgram<=0))return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.enable(this.ctx.BLEND),this.ctx.blendFuncSeparate(this.ctx.SRC_ALPHA,this.ctx.ONE_MINUS_SRC_ALPHA,this.ctx.ONE,this.ctx.ONE_MINUS_SRC_ALPHA),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.glBlockPosBuffer),this.ctx.bufferData(this.ctx.ARRAY_BUFFER,this.pFillBlockPosVertices,this.ctx.STATIC_DRAW),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,null),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.glBlockClrBuffer),this.ctx.bufferData(this.ctx.ARRAY_BUFFER,this.pFillBlockClrVertices,this.ctx.STATIC_DRAW),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,null),this.ctx.useProgram(this.nBlockShaderProgram);var S=this.ctx.getUniformLocation(this.nBlockShaderProgram,"bCapture");if(S<=0)return pt.SR_ERR_WEBGL_RESOURCE;1==this.bIsCapturing?this.ctx.uniform1i(S,1):this.ctx.uniform1i(S,0),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.glBlockPosBuffer);var R=this.ctx.getAttribLocation(this.nBlockShaderProgram,"position");this.ctx.enableVertexAttribArray(R),this.ctx.vertexAttribPointer(R,3,this.ctx.FLOAT,!1,0,0),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,null),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.glBlockClrBuffer);var P=this.ctx.getAttribLocation(this.nBlockShaderProgram,"color");return this.ctx.enableVertexAttribArray(P),this.ctx.vertexAttribPointer(P,4,this.ctx.FLOAT,!1,0,0),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,null),this.ctx.drawArrays(this.ctx.TRIANGLES,0,3*n),this.ctx.useProgram(null),this.ctx.disable(this.ctx.BLEND),pt.SR_OK}},{key:"ComputeLinePoint",value:function(t,e){if(null==t||e<1)return pt.SR_ERR_PARAM;if(null==this.pLinePosVertices||null==this.pLineClrVertices)return pt.SR_ERR_CALL_ORDER;var a=0,r=0;1==this.bIsCapturing?(a=(this.fDstUseRight-this.fDstUseLeft)*this.nCaptureWidth,r=(this.fDstUseBottom-this.fDstUseTop)*this.nCaptureHeight):(a=(this.fDstUseRight-this.fDstUseLeft)*this.nWndWidth,r=(this.fDstUseBottom-this.fDstUseTop)*this.nWndHeight);for(var i=0,n=0,s=0,x=0,o=0,f=0,l=0,_=0,h=0,c=0,u=0,d=0;d<e;++d){var p=[];if(!((u=t[d].nPointNum)<=0)){for(var m=0;m<u;++m){var S={};S.fX=(t[d].pstPoints[m].fX-this.fSrcUseLeft)/(this.fSrcUseRight-this.fSrcUseLeft),S.fX=this.fDstUseLeft+S.fX*(this.fDstUseRight-this.fDstUseLeft),S.fX=2*S.fX-1,S.fY=(t[d].pstPoints[m].fY-this.fSrcUseTop)/(this.fSrcUseBottom-this.fSrcUseTop),S.fY=this.fDstUseTop+S.fY*(this.fDstUseBottom-this.fDstUseTop),S.fY=1-2*S.fY,p.push(S)}if(this.nWndWidth<=0||this.nWndHeight<=0)return pt.SR_ERR_CANVAS;if(f=3.5*t[d].nLineWidth/a,l=3.5*t[d].nLineWidth/r,f<=0||l<=0)return pt.SR_ERR_PARAM;var R=t[d].pstColor;if(null==R||null==R)return pt.SR_ERR_PARAM;for(var P=0;P<u-1;++P)n=p[P+1].fX-p[P].fX,s=p[P+1].fY-p[P].fY,i=Math.sqrt(n*n+s*s),Math.abs(i-0)<1e-6||(x=-f*s/i/2,o=l*n/i/2,this.pLinePosVertices[h++]=p[P].fX+x,this.pLinePosVertices[h++]=p[P].fY+o,this.pLinePosVertices[h++]=-1,this.pLineClrVertices[c++]=R.fR,this.pLineClrVertices[c++]=R.fG,this.pLineClrVertices[c++]=R.fB,this.pLineClrVertices[c++]=R.fA,this.pLinePosVertices[h++]=p[P+1].fX-x,this.pLinePosVertices[h++]=p[P+1].fY-o,this.pLinePosVertices[h++]=1,this.pLineClrVertices[c++]=R.fR,this.pLineClrVertices[c++]=R.fG,this.pLineClrVertices[c++]=R.fB,this.pLineClrVertices[c++]=R.fA,this.pLinePosVertices[h++]=p[P].fX-x,this.pLinePosVertices[h++]=p[P].fY-o,this.pLinePosVertices[h++]=1,this.pLineClrVertices[c++]=R.fR,this.pLineClrVertices[c++]=R.fG,this.pLineClrVertices[c++]=R.fB,this.pLineClrVertices[c++]=R.fA,this.pLinePosVertices[h++]=p[P].fX+x,this.pLinePosVertices[h++]=p[P].fY+o,this.pLinePosVertices[h++]=-1,this.pLineClrVertices[c++]=R.fR,this.pLineClrVertices[c++]=R.fG,this.pLineClrVertices[c++]=R.fB,this.pLineClrVertices[c++]=R.fA,this.pLinePosVertices[h++]=p[P+1].fX+x,this.pLinePosVertices[h++]=p[P+1].fY+o,this.pLinePosVertices[h++]=-1,this.pLineClrVertices[c++]=R.fR,this.pLineClrVertices[c++]=R.fG,this.pLineClrVertices[c++]=R.fB,this.pLineClrVertices[c++]=R.fA,this.pLinePosVertices[h++]=p[P+1].fX-x,this.pLinePosVertices[h++]=p[P+1].fY-o,this.pLinePosVertices[h++]=1,this.pLineClrVertices[c++]=R.fR,this.pLineClrVertices[c++]=R.fG,this.pLineClrVertices[c++]=R.fB,this.pLineClrVertices[c++]=R.fA,_+=2);1==t[d].bLoop&&2<u&&(n=p[u-1].fX-p[0].fX,s=p[u-1].fY-p[0].fY,i=Math.sqrt(n*n+s*s),Math.abs(i-0)>1e-6&&(x=-f*s/i/2,o=l*n/i/2,this.pLinePosVertices[h++]=p[0].fX+x,this.pLinePosVertices[h++]=p[0].fY+o,this.pLinePosVertices[h++]=-1,this.pLineClrVertices[c++]=R.fR,this.pLineClrVertices[c++]=R.fG,this.pLineClrVertices[c++]=R.fB,this.pLineClrVertices[c++]=R.fA,this.pLinePosVertices[h++]=p[u-1].fX-x,this.pLinePosVertices[h++]=p[u-1].fY-o,this.pLinePosVertices[h++]=1,this.pLineClrVertices[c++]=R.fR,this.pLineClrVertices[c++]=R.fG,this.pLineClrVertices[c++]=R.fB,this.pLineClrVertices[c++]=R.fA,this.pLinePosVertices[h++]=p[0].fX-x,this.pLinePosVertices[h++]=p[0].fY-o,this.pLinePosVertices[h++]=1,this.pLineClrVertices[c++]=R.fR,this.pLineClrVertices[c++]=R.fG,this.pLineClrVertices[c++]=R.fB,this.pLineClrVertices[c++]=R.fA,this.pLinePosVertices[h++]=p[0].fX+x,this.pLinePosVertices[h++]=p[0].fY+o,this.pLinePosVertices[h++]=-1,this.pLineClrVertices[c++]=R.fR,this.pLineClrVertices[c++]=R.fG,this.pLineClrVertices[c++]=R.fB,this.pLineClrVertices[c++]=R.fA,this.pLinePosVertices[h++]=p[u-1].fX+x,this.pLinePosVertices[h++]=p[u-1].fY+o,this.pLinePosVertices[h++]=-1,this.pLineClrVertices[c++]=R.fR,this.pLineClrVertices[c++]=R.fG,this.pLineClrVertices[c++]=R.fB,this.pLineClrVertices[c++]=R.fA,this.pLinePosVertices[h++]=p[u-1].fX-x,this.pLinePosVertices[h++]=p[u-1].fY-o,this.pLinePosVertices[h++]=1,this.pLineClrVertices[c++]=R.fR,this.pLineClrVertices[c++]=R.fG,this.pLineClrVertices[c++]=R.fB,this.pLineClrVertices[c++]=R.fA,_+=2))}}return 0==_?pt.SR_ERR_PARAM:(this.nLineTriangleNum=_,pt.SR_OK)}},{key:"DrawFont",value:function(t,e,a,r,i,n,s,x,o,f,l){return pt.SR_ERR_NOT_SUPPORT}},{key:"DrawFontEx",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;if(0>e||null==t)return pt.SR_ERR_PARAM;var i,n,s=0,x=0;if(1==this.bIsCapturing){if(0==this.nCaptureWidth||0==this.nCaptureHeight)return pt.SR_ERR_CALL_ORDER;s=Math.round((this.fDstUseRight-this.fDstUseLeft)*this.nCaptureWidth),x=Math.round((this.fDstUseBottom-this.fDstUseTop)*this.nCaptureHeight)}else s=Math.round((this.fDstUseRight-this.fDstUseLeft)*this.nWndWidth),x=Math.round((this.fDstUseBottom-this.fDstUseTop)*this.nWndHeight);if(this.nDrawFontWidth==s&&this.nDrawFontHeight==x||(this.pFontColorBuffer=null,this.nFontColorTexture=0,this.nDrawFontWidth=s,this.nDrawFontHeight=x),0==this.nFontColorTexture){if(this.nFontColorTexture=this.ctx.createTexture(),0==this.nFontColorTexture)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nFontColorTexture),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MAG_FILTER,this.ctx.LINEAR),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_S,this.ctx.CLAMP_TO_EDGE),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_T,this.ctx.CLAMP_TO_EDGE)}if(null==this.textCanvas){if(this.textCanvas=r,null==this.textCanvas)return pt.SR_ERR_FONT;if(this.textCanvasCtx=this.textCanvas.getContext("2d"),null==this.textCanvasCtx)return pt.SR_ERR_FONT}this.textCanvasCtx.canvas.width=this.nDrawFontWidth,this.textCanvasCtx.canvas.height=this.nDrawFontHeight,this.textCanvasCtx.clearRect(0,0,this.nDrawFontWidth,this.nDrawFontHeight);for(var o=0;o<e;++o){var f=t[o].nFontWidth,l=t[o].nFontHeight;1==this.bIsCapturing&&(f=Math.round(this.nCaptureWidth/this.nWndWidth*f),l=Math.round(this.nCaptureHeight/this.nWndHeight*l));var _=f<l?f:l;this.textCanvasCtx.font="".concat(_,"px ").concat(t[o].pFontFamily),this.textCanvasCtx.textAlign=t[o].textAlign||"left",this.textCanvasCtx.textBaseline=t[o].textBaseline||"top",this.textCanvasCtx.save();var h=t[o].pstStartPos.fX*this.nDrawFontWidth,c=t[o].pstStartPos.fY*this.nDrawFontHeight;if(this.textCanvasCtx.translate(h,c),this.textCanvasCtx.rotate(t[o].fRotateAngle*Math.PI/180),t[o].bBackGround){var u=t[o].pstStartPos.fX,d=t[o].pstStartPos.fY,m=this.textCanvasCtx.measureText(t[o].pString).width,R=_;switch(this.textCanvasCtx.textAlign){case"center":u-=m/2;break;case"right":case"end":u-=m}switch(this.textCanvasCtx.textBaseline){case"top":case"hanging":break;case"middle":d-=R/2;break;default:d-=R}var P=t[o].pstBGColor;this.textCanvasCtx.fillStyle="rgb(".concat(255*P.fR,", ").concat(255*P.fG,", ").concat(255*P.fB,")"),this.textCanvasCtx.globalAlpha=P.fA,this.textCanvasCtx.fillRect(u,d,m,R)}var y=t[o].pstFontColor;this.textCanvasCtx.fillStyle="rgb(".concat(255*y.fR,", ").concat(255*y.fG,", ").concat(255*y.fB,")"),this.textCanvasCtx.globalAlpha=t[o].pstFontColor.fA,this.textCanvasCtx.fillText(t[o].pString,0,0),this.textCanvasCtx.restore()}if(this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nFontColorTexture),this.ctx.texImage2D(this.ctx.TEXTURE_2D,0,this.ctx.RGBA,this.ctx.RGBA,this.ctx.UNSIGNED_BYTE,this.textCanvasCtx.canvas),0==this.nFontShaderProgram&&(this.nFontShaderProgram=this.CompileProgram("\n    attribute vec4  position;\n    attribute vec4  texCoord;\n    varying vec4  pp; \n    uniform int bCapture;\n    uniform   mat4   matRotate;\n\n    void main()\n    { \n        gl_Position.x  = position.x;\n        gl_Position.y  = position.y;\n        if(bCapture == 1)\n        {\n            gl_Position.y = -position.y;\n        }\n        gl_Position.z  = 0.1;\n        gl_Position.w  = 1.0;\n        pp = matRotate * texCoord; \n    }\n","\n    varying lowp vec4 pp;\n    uniform sampler2D texture;\n\n    void main(void)\n    {\n        gl_FragColor = texture2D(texture, pp.st);\n    }\n"),this.nFontShaderProgram<=0))return pt.SR_ERR_WEBGL_RESOURCE;if(1==this.bIsCapturing?(i=this.nCaptureWidth,n=this.nCaptureHeight):(i=this.nWndWidth,n=this.nWndHeight),1==a){if(0==this.glFontVertexPosBuffer){var b=new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0]),E=this.ctx.createBuffer();this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,E),this.ctx.bufferData(this.ctx.ARRAY_BUFFER,b,this.ctx.STATIC_DRAW),this.glFontVertexPosBuffer=E,b=0}if(0==this.glFontTexturePosBuffer){var g=new Float32Array([0,1,1,1,1,0,0,0]),F=this.ctx.createBuffer();this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,F),this.ctx.bufferData(this.ctx.ARRAY_BUFFER,g,this.ctx.STATIC_DRAW),this.glFontTexturePosBuffer=F,g=0}}this.ctx.viewport(0,0,i,n),this.ctx.enable(this.ctx.BLEND),this.ctx.blendFuncSeparate(this.ctx.SRC_ALPHA,this.ctx.ONE_MINUS_SRC_ALPHA,this.ctx.ONE,this.ctx.ONE_MINUS_SRC_ALPHA),this.ctx.useProgram(this.nFontShaderProgram);var C=this.ctx.getUniformLocation(this.nFontShaderProgram,"bCapture");if(C<=0)return pt.SR_ERR_WEBGL_RESOURCE;1==this.bIsCapturing?this.ctx.uniform1i(C,1):this.ctx.uniform1i(C,0),this.ctx.activeTexture(this.ctx.TEXTURE0),this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nFontColorTexture);var v=this.ctx.getUniformLocation(this.nFontShaderProgram,"texture");this.ctx.uniform1i(v,0);var T=p(),D=p(),A=p();S(A,T,D);var I=this.ctx.getUniformLocation(this.nFontShaderProgram,"matRotate");if(I<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(I,!1,A),1==a?this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.glFontVertexPosBuffer):this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.vertexPosBuffer);var M=this.ctx.getAttribLocation(this.nFontShaderProgram,"position");this.ctx.enableVertexAttribArray(M),1==a?this.ctx.vertexAttribPointer(M,3,this.ctx.FLOAT,!1,0,0):this.ctx.vertexAttribPointer(M,2,this.ctx.FLOAT,!1,0,0),1==a?this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.glFontTexturePosBuffer):this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.texturePosBuffer);var L=this.ctx.getAttribLocation(this.nFontShaderProgram,"texCoord");return this.ctx.enableVertexAttribArray(L),this.ctx.vertexAttribPointer(L,2,this.ctx.FLOAT,!1,0,0),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,null),this.ctx.disable(this.ctx.DEPTH_TEST),1==a?this.ctx.drawArrays(this.ctx.TRIANGLE_FAN,0,4):this.ctx.drawArrays(this.ctx.TRIANGLES,0,6),this.ctx.bindTexture(this.ctx.TEXTURE_2D,null),this.ctx.useProgram(null),this.ctx.disable(this.ctx.BLEND),this.b3DPort&&(this.ctx.enable(this.ctx.DEPTH_TEST),this.ctx.depthFunc(this.ctx.LESS),this.ctx.depthMask(!0),1==this.bCullBack?this.ctx.enable(this.ctx.CULL_FACE):this.ctx.disable(this.ctx.CULL_FACE)),pt.SR_OK}},{key:"DrawImage",value:function(t,e,a,r,i,n){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;if(null==t||e<=0||a<=0||null==r||n<0||n>1)return pt.SR_ERR_PARAM;if(this.nDrawImageWidth=e,this.nDrawImageHeight=a,0==this.glImagePosBuffer&&(this.glImagePosBuffer=this.ctx.createBuffer(),0==this.glImagePosBuffer))return pt.SR_ERR_WEBGL_RESOURCE;if(0==this.glImageClrBuffer&&(this.glImageClrBuffer=this.ctx.createBuffer(),0==this.glImageClrBuffer))return pt.SR_ERR_WEBGL_RESOURCE;if(null==this.pImageClrVertices){if(this.pImageClrVertices=new Float32Array(12),null==this.pImageClrVertices)return pt.SR_ERR_ALLOC_MEMORY;this.pImageClrVertices[0]=0,this.pImageClrVertices[1]=0,this.pImageClrVertices[2]=0,this.pImageClrVertices[3]=1,this.pImageClrVertices[4]=1,this.pImageClrVertices[5]=0,this.pImageClrVertices[6]=1,this.pImageClrVertices[7]=0,this.pImageClrVertices[8]=0,this.pImageClrVertices[9]=1,this.pImageClrVertices[10]=1,this.pImageClrVertices[11]=1}var s={},x={};if(s.fLeft=(r.fLeft-this.fSrcUseLeft)/(this.fSrcUseRight-this.fSrcUseLeft),s.fRight=(r.fRight-this.fSrcUseLeft)/(this.fSrcUseRight-this.fSrcUseLeft),s.fTop=(r.fTop-this.fSrcUseTop)/(this.fSrcUseBottom-this.fSrcUseTop),s.fBottom=(r.fBottom-this.fSrcUseTop)/(this.fSrcUseBottom-this.fSrcUseTop),x.fLeft=this.fDstUseLeft+s.fLeft*(this.fDstUseRight-this.fDstUseLeft),x.fRight=this.fDstUseLeft+s.fRight*(this.fDstUseRight-this.fDstUseLeft),x.fTop=this.fDstUseTop+s.fTop*(this.fDstUseBottom-this.fDstUseTop),x.fBottom=this.fDstUseTop+s.fBottom*(this.fDstUseBottom-this.fDstUseTop),null==this.pImagePosVertices&&(this.pImagePosVertices=new Float32Array(12),null==this.pImagePosVertices))return pt.SR_ERR_ALLOC_MEMORY;switch(this.pImagePosVertices.fill(0),this.pImagePosVertices[0]=2*x.fLeft-1,this.pImagePosVertices[1]=1-2*x.fTop,this.pImagePosVertices[2]=2*x.fLeft-1,this.pImagePosVertices[3]=1-2*x.fBottom,this.pImagePosVertices[4]=2*x.fRight-1,this.pImagePosVertices[5]=1-2*x.fTop,this.pImagePosVertices[6]=2*x.fRight-1,this.pImagePosVertices[7]=1-2*x.fTop,this.pImagePosVertices[8]=2*x.fLeft-1,this.pImagePosVertices[9]=1-2*x.fBottom,this.pImagePosVertices[10]=2*x.fRight-1,this.pImagePosVertices[11]=1-2*x.fBottom,1==this.bIsCapturing?this.ctx.viewport(0,0,this.nCaptureWidth,this.nCaptureHeight):this.ctx.viewport(0,0,this.nWndWidth,this.nWndHeight),this.ctx.enable(this.ctx.BLEND),this.ctx.blendFuncSeparate(this.ctx.SRC_ALPHA,this.ctx.ONE_MINUS_SRC_ALPHA,this.ctx.ONE,this.ctx.ONE_MINUS_SRC_ALPHA),i){case Rt.SR_PF_SURFACE:if(null==this.nImageColorTexture){if(this.nImageColorTexture=this.ctx.createTexture(),0==this.nImageColorTexture)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nImageColorTexture),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MAG_FILTER,this.ctx.LINEAR),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_S,this.ctx.CLAMP_TO_EDGE),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_T,this.ctx.CLAMP_TO_EDGE)}this.ctx.useProgram(this.videoShaderProgram),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.vertexPosBuffer);var o=this.ctx.getAttribLocation(this.videoShaderProgram,"position");if(o<0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.vertexAttribPointer(o,3,this.ctx.FLOAT,!1,0,0),this.ctx.enableVertexAttribArray(o),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.texturePosBuffer);var f=this.ctx.getAttribLocation(this.videoShaderProgram,"texCoord");if(f<0)return pt.SR_ERR_WEBGL_RESOURCE;if(this.ctx.vertexAttribPointer(f,2,this.ctx.FLOAT,!1,0,0),this.ctx.enableVertexAttribArray(f),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,null),this.ctx.useProgram(null),this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nImageColorTexture),this.ctx.texImage2D(this.ctx.TEXTURE_2D,0,this.ctx.RGBA,this.nDrawImageWidth,this.nDrawImageHeight,0,this.ctx.RGBA,this.ctx.UNSIGNED_BYTE,t),0==this.nImageShaderProgram){var l=this.CompileProgram(Bt,kt);if(l<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.nImageShaderProgram=l}break;case Rt.SR_PF_RGBA32:if(null==this.nImageColorTexture){if(this.nImageColorTexture=this.ctx.createTexture(),0==this.nImageColorTexture)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nImageColorTexture),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MAG_FILTER,this.ctx.LINEAR),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_S,this.ctx.CLAMP_TO_EDGE),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_T,this.ctx.CLAMP_TO_EDGE)}if(this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nImageColorTexture),this.ctx.texImage2D(this.ctx.TEXTURE_2D,0,this.ctx.RGBA,this.nDrawImageWidth,this.nDrawImageHeight,0,this.ctx.RGBA,this.ctx.UNSIGNED_BYTE,t),0==this.nImageShaderProgram){var _=this.CompileProgram(Bt,kt);if(_<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.nImageShaderProgram=_}break;case Rt.SR_PF_RGB565:if(null==this.nImageColorTexture){if(this.nImageColorTexture=this.ctx.createTexture(),0==this.nImageColorTexture)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nImageColorTexture),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MAG_FILTER,this.ctx.LINEAR),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_S,this.ctx.CLAMP_TO_EDGE),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_T,this.ctx.CLAMP_TO_EDGE)}if(this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nImageColorTexture),this.ctx.texImage2D(this.ctx.TEXTURE_2D,0,this.ctx.RGB,this.nDrawImageWidth,this.nDrawImageHeight,0,this.ctx.RGB,this.ctx.UNSIGNED_SHORT_5_6_5,t),0==this.nImageShaderProgram){var h=this.CompileProgram(Bt,"\n    precision mediump float; \n    uniform sampler2D texture; \n    varying lowp vec4 pp;\n    uniform float fAlpha;\n    void main(void) \n    { \n        gl_FragColor = texture2D(texture, pp.st); \n        gl_FragColor.a *= fAlpha; \n    } \n");if(h<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.nImageShaderProgram=h}break;default:return pt.SR_ERR_NOT_SUPPORT}var c=this.nImageShaderProgram;this.ctx.useProgram(c);var u=this.ctx.getUniformLocation(this.nImageShaderProgram,"bCapture");if(u<=0)return pt.SR_ERR_WEBGL_RESOURCE;1==this.bIsCapturing?this.ctx.uniform1i(u,1):this.ctx.uniform1i(u,0),this.ctx.activeTexture(this.ctx.TEXTURE0),this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nImageColorTexture);var d=this.ctx.getUniformLocation(this.nImageShaderProgram,"texture");this.ctx.uniform1i(d,0),d=this.ctx.getUniformLocation(this.nImageShaderProgram,"fAlpha"),this.ctx.uniform1f(d,n);var p=this.ctx.getUniformLocation(this.nImageShaderProgram,"matRotate");if(p<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniformMatrix4fv(p,!1,this.matRotate),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.glImagePosBuffer),this.ctx.bufferData(this.ctx.ARRAY_BUFFER,this.pImagePosVertices,this.ctx.STATIC_DRAW);var m=this.ctx.getAttribLocation(this.nImageShaderProgram,"position");this.ctx.enableVertexAttribArray(m),this.ctx.vertexAttribPointer(m,2,this.ctx.FLOAT,!1,0,0),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.glImageClrBuffer),this.ctx.bufferData(this.ctx.ARRAY_BUFFER,this.pImageClrVertices,this.ctx.STATIC_DRAW);var S=this.ctx.getAttribLocation(this.nImageShaderProgram,"texCoord");return this.ctx.enableVertexAttribArray(S),this.ctx.vertexAttribPointer(S,2,this.ctx.FLOAT,!1,0,0),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,null),this.ctx.disable(this.ctx.DEPTH_TEST),this.ctx.drawArrays(this.ctx.TRIANGLES,0,6),this.ctx.useProgram(null),this.ctx.disable(this.ctx.BLEND),this.b3DPort&&(this.ctx.enable(this.ctx.DEPTH_TEST),this.ctx.depthFunc(this.ctx.LESS),this.ctx.depthMask(!0),1==this.bCullBack?this.ctx.enable(this.ctx.CULL_FACE):this.ctx.disable(this.ctx.CULL_FACE)),pt.SR_OK}},{key:"DrawMosaic",value:function(t,e,a,r,i){if(t<0||e<0||a<0||r<0||t>1||e>1||a>1||r>1||i<=0)return pt.SR_ERR_PARAM;if(0==this.nMosaicShaderProgram){var n=this.CompileProgram("\n    attribute vec4  position; \n    attribute vec4  texCoord; \n    varying vec4  out_texCoord; \n    uniform int bCapture;\n    \n    void main() \n    { \n        gl_Position  = position; \n        if(bCapture == 1)\n        {\n           gl_Position.y =  -gl_Position.y;\n        }\n        out_texCoord = texCoord; \n    } \n","\n    varying lowp vec4 out_texCoord; \n    uniform sampler2D texture; \n    uniform mediump float videoWidth; \n    uniform mediump float videoHeight; \n    uniform mediump float mosaicSize; \n    uniform mediump float left; \n    uniform mediump float right; \n    uniform mediump float top; \n    uniform mediump float bottom; \n\n    void main(void) \n    { \n        lowp vec2 uv; \n        uv.x = floor(out_texCoord.x * videoWidth / mosaicSize) * mosaicSize / videoWidth; \n        uv.y = floor(out_texCoord.y * videoHeight / mosaicSize) * mosaicSize / videoHeight; \n        gl_FragColor = texture2D(texture, uv); \n        if(out_texCoord.x < left || out_texCoord.x > right || out_texCoord.y < top || out_texCoord.y > bottom) \n        { \n            gl_FragColor.a = 0.0; \n        } \n        else \n        { \n            gl_FragColor.a = 1.0;  \n        } \n    } \n");if(n<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.nMosaicShaderProgram=n}this.ctx.viewport(0,0,this.nWndWidth,this.nWndHeight),this.ctx.enable(this.ctx.BLEND),this.ctx.blendFuncSeparate(this.ctx.SRC_ALPHA,this.ctx.ONE_MINUS_SRC_ALPHA,this.ctx.ONE,this.ctx.ONE_MINUS_SRC_ALPHA);var s=this.nMosaicShaderProgram;this.ctx.useProgram(s);var x=this.ctx.getUniformLocation(s,"bCapture");if(x<=0)return pt.SR_ERR_WEBGL_RESOURCE;1==this.bIsCapturing?this.ctx.uniform1i(x,1):this.ctx.uniform1i(x,0),this.ctx.activeTexture(this.ctx.TEXTURE0),this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nSurfaceTexture[0]);var o=this.ctx.getUniformLocation(s,"texture");this.ctx.uniform1i(o,0);var f=this.ctx.getUniformLocation(s,"videoWidth");if(f<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(f,this.frameDisplayWidth);var l=this.ctx.getUniformLocation(s,"videoHeight");if(l<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(l,this.frameDisplayHeight);var _=this.ctx.getUniformLocation(s,"mosaicSize");if(_<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(_,i);var h=this.ctx.getUniformLocation(s,"left");if(h<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(h,t);var c=this.ctx.getUniformLocation(s,"right");if(c<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(c,e);var u=this.ctx.getUniformLocation(s,"top");if(u<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(u,a);var d=this.ctx.getUniformLocation(s,"bottom");if(d<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.uniform1f(d,r);var p=this.ctx.getAttribLocation(s,"position");this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.vertexPosBuffer),this.ctx.vertexAttribPointer(p,2,this.ctx.FLOAT,!1,0,0),this.ctx.enableVertexAttribArray(p);var m=this.ctx.getAttribLocation(s,"texCoord");return this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,this.texturePosBuffer),this.ctx.vertexAttribPointer(m,2,this.ctx.FLOAT,!1,0,0),this.ctx.enableVertexAttribArray(m),this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,null),this.ctx.drawArrays(this.ctx.TRIANGLES,0,6),this.ctx.useProgram(null),this.ctx.disable(this.ctx.BLEND),pt.SR_OK}},{key:"SetCallBack",value:function(t,e,a){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;switch(a){case Et.SR_CBT_NULL:this.pfuncCBIn=t,this.pUserIn=e;break;case Et.SR_CBT_OUT:this.pfuncCBOut=t,this.pUserOut=e;break;default:return pt.SR_ERR_NOT_SUPPORT}return pt.SR_OK}},{key:"DoCallBack",value:function(){return null==this.ctx?pt.SR_ERR_CALL_ORDER:(null!=this.pfuncCBIn&&this.pfuncCBIn(this.pUserIn),null!=this.pfuncCBOut&&this.pfuncCBOut(this.pUserOut),pt.SR_OK)}},{key:"SetViewParam",value:function(t,e){if(!this.b3DPort)return pt.SR_ERR_NOT_SUPPORT;switch(t){case bt.SR_VT_ROTATION_X:if((this.enDisplayEffect==St.SR_DE_FISH_PLANET||this.enDisplayEffect==St.SR_DE_PANORAMA_PLANET)&&(e>1.57||e<-1.57))return pt.SR_ERR_PARAM;if((this.enDisplayEffect==St.SR_DE_FISH_CYLINDER_SPLIT_CEILING||this.enDisplayEffect==St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR)&&(e>.78539815||e<0))return pt.SR_ERR_PARAM;if((this.enDisplayEffect==St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL||this.enDisplayEffect==St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL)&&(e>this.fRotateLimitX||e<-this.fRotateLimitX))return pt.SR_ERR_PARAM;this.fRotateX=e;break;case bt.SR_VT_ROTATION_Y:if((this.enDisplayEffect==St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL||this.enDisplayEffect==St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL)&&(e>this.fRotateLimitY||e<-this.fRotateLimitY))return pt.SR_ERR_PARAM;this.fRotateY=e;break;case bt.SR_VT_SCALE:if(this.enDisplayEffect==St.SR_DE_FISH_PLANET&&(e>1.2||e<-.3))return pt.SR_ERR_PARAM;if(this.enDisplayEffect==St.SR_DE_FISH_SEMISPHERE){if(e<-.8||e>900)return pt.SR_ERR_PARAM}else if(this.enDisplayEffect==St.SR_DE_PANORAMA_SPHERE){if(e<-.95||e>.95)return pt.SR_ERR_PARAM}else if(this.enDisplayEffect==St.SR_DE_PANORAMA_PLANET){if(e<.1||e>2.6)return pt.SR_ERR_PARAM}else if(this.enDisplayEffect==St.SR_DE_FISH_CYLINDER_FLOOR||this.enDisplayEffect==St.SR_DE_FISH_CYLINDER_CEILING){if(e<0||e>900)return pt.SR_ERR_PARAM}else if(this.enDisplayEffect==St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL||this.enDisplayEffect==St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL){if(e<-.3||e>5)return pt.SR_ERR_PARAM;this._ComputeRotateLimits()}else if(this.enDisplayEffect==St.SR_DE_FISH_CYLINDER_SPLIT_CEILING||this.enDisplayEffect==St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR)return pt.SR_ERR_NOT_SUPPORT;this.fScale=e;break;default:return pt.SR_ERR_NOT_SUPPORT}return pt.SR_OK}},{key:"GetViewParam",value:function(t,e){if(!this.b3DPort)return pt.SR_ERR_CALL_ORDER;var a=0;switch(t){case bt.SR_VT_ROTATION_X:a=this.fRotateX;break;case bt.SR_VT_ROTATION_Y:a=this.fRotateY;break;case bt.SR_VT_SCALE:a=this.fScale;break;default:return pt.SR_ERR_NOT_SUPPORT}return e.fValue=a,pt.SR_OK}},{key:"SetRenderMode",value:function(t){return this.bRenderToTex=t,pt.SR_OK}},{key:"_InitVideoShader",value:function(t,e){var a,r;switch(e){case St.SR_DE_NULL:a=Lt,r="\nprecision mediump float;\nvarying highp vec4 pp;\nuniform sampler2D Ytexture;\nuniform sampler2D Utexture;\nuniform sampler2D Vtexture;\nuniform float fWndWidth;\nuniform float fWndHeight;\nuniform float fBrightness;\nuniform float fHue;\nuniform float fSaturation;\nuniform float fContrast;\nuniform float fSharpness;\nuniform int nPostProc;\nuniform int bDataFormat;\n\nvec3 rgb;\nvec3 yuv2rgb(float y, float u, float v)\n{\n    float r,g,b; \n    y = 1.1643 * (y - 0.0625); \n    u = u - 0.5; \n    v = v - 0.5; \n    r = y + 1.5958 * v; \n    g = y - 0.39173 * u - 0.81290 * v; \n    b = y + 2.017 * u; \n    return vec3(r, g, b);\n}\nvec3 rgb2hsv(vec3 c) \n{ \n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0); \n    vec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy); \n    vec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx); \n\n    float d = q.x - min(q.w, q.y); \n    float e = 1.0e-10; \n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x); \n} \n\nvec3 hsv2rgb(vec3 c) \n{ \n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0); \n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www); \n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y); \n} \n\nvec3 sharpen(vec3 c) \n{ \n    vec3 sharpenColor; \n\n    if(bDataFormat == 0)\n    {\n        float sharpenColorY;\n        float sharpenColorU;\n        float sharpenColorV;\n        float offWidth  = 1.0 / fWndWidth; \n        float offHeight = 1.0 / fWndHeight; \n        float tempSharpness = fSharpness * 100.0; \n\n        sharpenColor = (1.0 + 4.0 * tempSharpness) * c;\n\n        vec2 uv       = pp.st + vec2(offWidth, 0); \n        sharpenColorY = texture2D(Ytexture, uv).r; \n        sharpenColorU = texture2D(Utexture, uv).r; \n        sharpenColorV = texture2D(Vtexture, uv).r; \n        sharpenColor -= tempSharpness * yuv2rgb(sharpenColorY, sharpenColorU, sharpenColorV);\n\n        uv            = pp.st + vec2(-offWidth, 0); \n        sharpenColorY = texture2D(Ytexture, uv).r;\n        sharpenColorU = texture2D(Utexture, uv).r; \n        sharpenColorV = texture2D(Vtexture, uv).r; \n        sharpenColor -= tempSharpness * yuv2rgb(sharpenColorY, sharpenColorU, sharpenColorV);\n\n        uv            = pp.st + vec2(0, offHeight);\n        sharpenColorY = texture2D(Ytexture, uv).r; \n        sharpenColorU = texture2D(Utexture, uv).r; \n        sharpenColorV = texture2D(Vtexture, uv).r; \n        sharpenColor -= tempSharpness * yuv2rgb(sharpenColorY, sharpenColorU, sharpenColorV);\n\n        uv            = pp.st + vec2(0, -offHeight); \n        sharpenColorY = texture2D(Ytexture, uv).r; \n        sharpenColorU = texture2D(Utexture, uv).r; \n        sharpenColorV = texture2D(Vtexture, uv).r; \n        sharpenColor -= tempSharpness * yuv2rgb(sharpenColorY, sharpenColorU, sharpenColorV);\n    }\n    else if(bDataFormat == 1)\n    {\n        vec3 sharpenColorY;\n        float offWidth  = 1.0 / fWndWidth; \n        float offHeight = 1.0 / fWndHeight; \n        float tempSharpness = fSharpness * 100.0;\n        vec2 uv = pp.st;\n        sharpenColorY = (1.0 + 4.0 * tempSharpness) * texture2D(Ytexture, uv).rgb;\n\n        uv       = pp.st + vec2(offWidth, 0); \n        sharpenColorY -= tempSharpness * texture2D(Ytexture, uv).rgb;\n\n        uv            = pp.st + vec2(-offWidth, 0); \n        sharpenColorY -= tempSharpness * texture2D(Ytexture, uv).rgb;\n\n        uv            = pp.st + vec2(0, offHeight);\n        sharpenColorY -= tempSharpness * texture2D(Ytexture, uv).rgb;\n\n        uv            = pp.st + vec2(0, -offHeight); \n        sharpenColorY -= tempSharpness * texture2D(Ytexture, uv).rgb;\n\n        sharpenColor = sharpenColorY;\n    }\n\n    return sharpenColor; \n} \nvoid main(void)\n{\n    float r, g, b, y, u, v;\n    if(bDataFormat == 1)\n    {\n        r = texture2D(Ytexture, pp.st).r; \n        g = texture2D(Ytexture, pp.st).g; \n        b = texture2D(Ytexture, pp.st).b; \n        rgb = vec3(r, g, b);\n    }\n    else if(bDataFormat == 0)\n    {\n        y = texture2D(Ytexture, pp.st).r;\n        u = texture2D(Utexture, pp.st).r;\n        v = texture2D(Vtexture, pp.st).r;\n        rgb = yuv2rgb(y, u, v);\n    }\n\n    if(1 == nPostProc)\n    {\n        vec3 fragRGB = sharpen(rgb);                    //sharpen 锐度\n        vec3 fragHSV = rgb2hsv(fragRGB); \n        fragHSV.x = fragHSV.x + fHue;                   //hue 色度\n        fragHSV.y = fragHSV.y * (fSaturation + 1.0);    //saturation 饱和度\n        fragRGB = hsv2rgb(fragHSV); \n        if (fBrightness > 0.0)                        //brightness 亮度\n        { \n            fragRGB = fragRGB + (1.0 - fragRGB) * fBrightness; \n        } \n        else \n        { \n            fragRGB = fragRGB + fragRGB * fBrightness; \n        } \n\n        float tempContrast = fContrast > 0.0 ? fContrast * 10.0 : fContrast; \n        fragRGB = ((fragRGB - 0.5) * max(tempContrast + 1.0, 0.0)) + 0.5;      //contrast 对比度\n        gl_FragColor = vec4(fragRGB, 1.0); \n    }\n    else\n    {\n        gl_FragColor = vec4(rgb, 1.0);\n    }\n}\n";break;case St.SR_DE_FISH_ORIGINAL:a=Lt,r="\nprecision mediump float;\nvarying vec4 pp;\nuniform sampler2D Ytexture;\nuniform sampler2D Utexture;\nuniform sampler2D Vtexture;\nuniform float fRX1;\nuniform float fRX2;\nuniform float fRY1;\nuniform float fRY2;\nuniform int bBlack; \nuniform int bCut;\nuniform int bDataFormat;\n\nvoid main()\n{ \n\tfloat r,g,b,y,u,v;\n\tvec4 origin;\n\n\tfloat  w;\n\tfloat  h;\n\tfloat  fCenterX;\n\tfloat  fCenterY;\n\tfloat  fRadius;\n\tw = 1.0;\n\th = (fRX2 - fRX1) / (fRY2 - fRY1);\n\tfCenterX = (fRX1 + fRX2) / 2.0 * w;    ///<圆心实际坐标\n\tfCenterY = (fRY1 + fRY2) / 2.0 * h;\n\tfRadius = (fRX2 - fRX1) / 2.0 * w;     ///<半径实际长度\n\tfloat  leftCut = 0.0;\n\tfloat  rightCut = 1.0;\n\tfloat  topCut = 0.0;\n\tfloat  bottomCut = 1.0;\n\tif(bCut == 1)\n\t{\n\t\tif(fRX1 > 0.0)\n\t\t{\n\t\t\tleftCut = fRX1;\n\t\t}\n\t\tif(fRX2 < 1.0)\n\t\t{\n\t\t\trightCut = fRX2;\n\t\t}\n\t\tif(fRY1 > 0.0)\n\t\t{\n\t\t\ttopCut = fRY1;\n\t\t}\n\t\tif(fRY2 < 1.0)\n\t\t{\n\t\t\tbottomCut = fRY2;\n\t\t}\n\t}\n\torigin.s = pp.s * (rightCut-leftCut) + leftCut;\n\torigin.t = pp.t * (bottomCut-topCut) + topCut;\n\n    if(bDataFormat == 1)\n    {\n        r = texture2D(Ytexture, origin.st).r; \n        g = texture2D(Ytexture, origin.st).g; \n        b = texture2D(Ytexture, origin.st).b; \n    }\n    else if(bDataFormat == 0)\n    {\n        y = texture2D(Ytexture, origin.st).r;\n        u = texture2D(Utexture, origin.st).r;\n        v = texture2D(Vtexture, origin.st).r;\n        \n        y=1.1643*(y-0.0625);\n        u=u-0.5; \n        v=v-0.5; \n\n        r=y+1.5958*v; \n        g=y-0.39173*u-0.81290*v; \n        b=y+2.017*u; \n    }\n\n\tif(bBlack == 1)\n\t{\n\t\tfloat tmpX, tmpY;\n\t\ttmpX = origin.s * w; \n\t\ttmpY = origin.t * h; \n\t\tfloat d2 = (tmpX-fCenterX)*(tmpX-fCenterX) + (tmpY-fCenterY)*(tmpY-fCenterY);\n\t\tif(d2 > fRadius*fRadius)\n\t\t{\n\t\t\tr = 0.0; \n\t\t\tg = 0.0; \n\t\t\tb = 0.0; \n\t\t}\n\t}\n\n\tgl_FragColor = vec4(r ,g ,b , 1.0);\n}\n";break;case St.SR_DE_FISH_PTZ_CEILING:a=Lt,r="\nprecision mediump float;\nvarying vec4 pp; \nuniform sampler2D Ytexture;\nuniform sampler2D Utexture;\nuniform sampler2D Vtexture;\nuniform float fHAngleCos;\nuniform float fHAngleSin;\nuniform float fVAngleCos;\nuniform float fVAngleSin;\nuniform float fZoom;\nuniform float fRX1; \nuniform float fRX2; \nuniform float fRY1; \nuniform float fRY2; \nuniform int bDataFormat;\n\nvoid main()\n{\n\tfloat r,g,b,y,u,v;\n\n    vec4 origin1;\n    vec4 origin2;\n    vec4 result;\n    float  z1;\n    float  z2;\n    float  dnew;\n\n    float  w;\n    float  h;\n    float  fCenterX;\n    float  fCenterY;\n    float  fRadius;\n    w = 1.0;\n    h = (fRX2 - fRX1) / (fRY2 - fRY1);\n    fCenterX = (fRX1 + fRX2) / 2.0 * w;    \n    fCenterY = (fRY1 + fRY2) / 2.0 * h;\n    fRadius = (fRX2 - fRX1) / 2.0 * w; \n\n    origin1.s = pp.s - 0.5;\n    origin1.t = 0.5 - pp.t;\n    z1 = fZoom ;\n\n    origin2.s = origin1.s ;\n    origin2.t = (origin1.t*fVAngleCos + z1*fVAngleSin);\n    z2 = z1*fVAngleCos - origin1.t*fVAngleSin;\n\n    dnew = sqrt(origin2.s*origin2.s + origin2.t*origin2.t) ;\n    float d = sqrt(origin2.s*origin2.s + origin2.t*origin2.t + z2*z2);\n    float theta = asin(dnew/d);\n    float tmp = theta / 1.5707963 * 0.5;\n    origin2.s = tmp*origin2.s / dnew ;\n    origin2.t = tmp*origin2.t / dnew ;\n\n    result.s = ((origin2.s*fHAngleCos - origin2.t*fHAngleSin)*fRadius*2.0+fCenterX)/w;\n    result.t = (-(origin2.s*fHAngleSin + origin2.t*fHAngleCos)*fRadius*2.0+fCenterY)/h;\n\n    if(bDataFormat == 1)\n    {\n        r = texture2D(Ytexture, result.st).r; \n        g = texture2D(Ytexture, result.st).g; \n        b = texture2D(Ytexture, result.st).b; \n    }\n    else if(bDataFormat == 0)\n    {\n        y = texture2D(Ytexture, result.st).r;\n        u = texture2D(Utexture, result.st).r;\n        v = texture2D(Vtexture, result.st).r;\n        \n        y=1.1643*(y-0.0625);\n        u=u-0.5; \n        v=v-0.5; \n\n        r=y+1.5958*v; \n        g=y-0.39173*u-0.81290*v; \n        b=y+2.017*u; \n    }\n\n    if(result.s > 1.0 || result.t > 1.0 || result.s < 0.0 || result.t < 0.0)\n    {\n        r = 0.0; \n        g = 0.0; \n        b = 0.0; \n    }\n    gl_FragColor = vec4(r ,g ,b , 1.0);\n} \n";break;case St.SR_DE_FISH_PTZ_FLOOR:a=Lt,r="\nprecision mediump float;\nvarying vec4 pp; \nuniform sampler2D Ytexture;\nuniform sampler2D Utexture;\nuniform sampler2D Vtexture;\nuniform float fHAngleCos;  \nuniform float fHAngleSin; \nuniform float fVAngleCos;  \nuniform float fVAngleSin;  \nuniform float fZoom;\nuniform float fRX1; \nuniform float fRX2; \nuniform float fRY1; \nuniform float fRY2; \nuniform int bDataFormat;\n\nvoid main()\n{\n\tfloat r,g,b,y,u,v;\n\n    vec4 origin1;\n    vec4 origin2;\n    vec4 result;\n    float  z1;\n    float  z2;\n    float  dnew;\n\n    float  w;\n    float  h;\n    float  fCenterX;\n    float  fCenterY;\n    float  fRadius;\n    w = 1.0;\n    h = (fRX2 - fRX1) / (fRY2 - fRY1);\n    fCenterX = (fRX1 + fRX2) / 2.0 * w;\n    fCenterY = (fRY1 + fRY2) / 2.0 * h;\n    fRadius = (fRX2 - fRX1) / 2.0 * w;\n    origin1.s = pp.s - 0.5;\n    origin1.t = pp.t - 0.5;\n    z1 = fZoom ;\n\n    origin2.s = origin1.s ;\n    origin2.t = (origin1.t*fVAngleCos + z1*fVAngleSin);\n    z2 = z1*fVAngleCos - origin1.t*fVAngleSin;\n\n    dnew = sqrt(origin2.s*origin2.s + origin2.t*origin2.t) ;\n    float d = sqrt(origin2.s*origin2.s + origin2.t*origin2.t + z2*z2);\n    float theta = asin(dnew/d);\n    float tmp = theta / 1.5707963 * 0.5;\n    origin2.s = tmp*origin2.s / dnew ;\n    origin2.t = tmp*origin2.t / dnew ;\n\n    result.s = ((origin2.s*fHAngleCos - origin2.t*fHAngleSin)*fRadius*2.0+fCenterX)/w;\n    result.t = ((origin2.s*fHAngleSin + origin2.t*fHAngleCos)*fRadius*2.0+fCenterY)/h;\n\n    if(bDataFormat == 1)\n    {\n        r = texture2D(Ytexture, result.st).r; \n        g = texture2D(Ytexture, result.st).g; \n        b = texture2D(Ytexture, result.st).b; \n    }\n    else if(bDataFormat == 0)\n    {\n        y = texture2D(Ytexture, result.st).r;\n        u = texture2D(Utexture, result.st).r;\n        v = texture2D(Vtexture, result.st).r;\n        \n        y=1.1643*(y-0.0625);\n        u=u-0.5; \n        v=v-0.5; \n\n        r=y+1.5958*v; \n        g=y-0.39173*u-0.81290*v; \n        b=y+2.017*u; \n    }\n\n    if(result.s > 1.0 || result.t > 1.0 || result.s < 0.0 || result.t < 0.0)\n    {\n        r = 0.0;\n        g = 0.0; \n        b = 0.0; \n    }\n    gl_FragColor = vec4(r ,g ,b , 1.0);\n} \n";break;case St.SR_DE_FISH_PTZ_WALL:a=Lt,r="\nprecision mediump float;\nvarying vec4 pp; \nuniform sampler2D Ytexture;\nuniform sampler2D Utexture;\nuniform sampler2D Vtexture;\nuniform float fHAngleCos;\nuniform float fHAngleSin;  \nuniform float fVAngleCos;  \nuniform float fVAngleSin;  \nuniform float fZoom;\nuniform float fRX1; \nuniform float fRX2; \nuniform float fRY1; \nuniform float fRY2; \nuniform int bDataFormat;\n\nvoid main()\n{\n\tfloat r,g,b,y,u,v;\n\n    vec4 origin1;\n    vec4 origin2;\n    vec4 origin3;\n    vec4 result;\n    float  z1;\n    float  z2;\n    float  z3;\n    float  dnew;\n\n    float  w;\n    float  h;\n    float  fCenterX;\n    float  fCenterY;\n    float  fRadius;\n    w = 1.0;\n    h = (fRX2 - fRX1) / (fRY2 - fRY1);\n    fCenterX = (fRX1 + fRX2) / 2.0 * w;\n    fCenterY = (fRY1 + fRY2) / 2.0 * h;\n    fRadius = (fRX2 - fRX1) / 2.0 * w;\n\n    origin1.s = pp.s - 0.5;\n    origin1.t = pp.t - 0.5;\n    z1 = fZoom ;\n\n    origin2.s = origin1.s ;\n    origin2.t = (origin1.t*fVAngleCos + z1*fVAngleSin);\n    z2 = z1*fVAngleCos - origin1.t*fVAngleSin;\n\n    origin3.s = origin2.s*fHAngleCos + z2*fHAngleSin ;\n    origin3.t = origin2.y;\n    z3 = z2*fHAngleCos - origin2.x*fHAngleSin;\n\n    dnew = sqrt(origin3.s*origin3.s + origin3.t*origin3.t) ;\n    float d = sqrt(origin3.s*origin3.s + origin3.t*origin3.t + z3*z3);\n    float theta = asin(dnew/d);\n    float tmp = theta / 1.5707963 * 0.5;\n    result.s = (tmp*origin3.s / dnew * fRadius * 2.0 + fCenterX)/w;\n    result.t = (tmp*origin3.t / dnew * fRadius * 2.0 + fCenterY)/h;\n\n    if(bDataFormat == 1)\n    {\n        r = texture2D(Ytexture, result.st).r; \n        g = texture2D(Ytexture, result.st).g; \n        b = texture2D(Ytexture, result.st).b; \n    }\n    else if(bDataFormat == 0)\n    {\n        y = texture2D(Ytexture, result.st).r;\n        u = texture2D(Utexture, result.st).r;\n        v = texture2D(Vtexture, result.st).r;\n        \n        y=1.1643*(y-0.0625);\n        u=u-0.5; \n        v=v-0.5; \n\n        r=y+1.5958*v; \n        g=y-0.39173*u-0.81290*v; \n        b=y+2.017*u; \n    }\n\n    if(result.s > 1.0 || result.t > 1.0 || result.s < 0.0 || result.t < 0.0)\n    {\n        r = 0.0; \n        g = 0.0; \n        b = 0.0; \n    }\n    gl_FragColor = vec4(r ,g ,b , 1.0);\n} \n";break;case St.SR_DE_FISH_PANORAMA_CEILING_360:a=Lt,r="\n    precision highp float;\n    varying vec4 pp; \n    uniform sampler2D Ytexture;\n    uniform sampler2D Utexture;\n    uniform sampler2D Vtexture;\n    uniform float fAngle;\n    uniform float fRX1;\n    uniform float fRX2;\n    uniform float fRY1;\n    uniform float fRY2;\n    uniform int bDataFormat;\n    \n    void main()\n    {\n    \n        float r,g,b,y,u,v;\n    \n        vec4 origin;\n        vec4 result;\n        float  thetabase;\n        float  d;\n    \n        float  w;\n        float  h;\n        float  fCenterX;\n        float  fCenterY;\n        float  fRadius;\n        w = 1.0;\n        h = (fRX2 - fRX1) / (fRY2 - fRY1);\n        fCenterX = (fRX1 + fRX2) / 2.0 * w;    ///<圆心实际坐标\n        fCenterY = (fRY1 + fRY2) / 2.0 * h;\n        fRadius = (fRX2 - fRX1) / 2.0 * w;    ///<半径实际长度\n        float fMax = 0.0;\n        if(fRX2 > 1.0 || fRY2 > 1.0 || fRX1 < 0.0 || fRY1 < 0.0) ///<如果不是一个完整的圆\n        {\n            float tmp;\n            if(fRX1 < 0.0)\n            {\n                tmp = -fRX1 * w; ///<左边超出图像部分最大实际长度\n                if(tmp > fMax)\n                    fMax = tmp;\n            }\n            if(fRX2 > 1.0)\n            {\n                tmp = (fRX2 - 1.0) * w; ///<右边超出图像部分最大实际长度\n                if(tmp > fMax)\n                    fMax = tmp;\n            }\n            if(fRY1 < 0.0)\n            {\n                tmp = -fRY1 * h; ///<上边超出图像部分最大实际长度\n                if(tmp > fMax)\n                    fMax = tmp;\n            }\n            if(fRY2 > 1.0)\n            {\n                tmp = (fRY2 - 1.0) * h; ///<下边超出图像部分最大实际长度\n                if(tmp > fMax)\n                    fMax = tmp;\n            }\n        }\n        float topCut = fMax / fRadius;  ///<如果不是一个完整的圆,最终矫正图需要切掉上面无图像部分,否则无需切\n        float bottomCut = 0.8;           ///<为矫正效果,最终矫正图固定切掉下面一部分\n        origin.s = pp.s;\n        origin.t = (bottomCut - topCut) * pp.t + topCut;\n        thetabase = 6.2831853 * origin.s + fAngle;\n        d = fRadius * (1.0 - origin.t);\n        result.s = (fCenterX - d*sin(thetabase)) / w;\n        result.t = (fCenterY + d*cos(thetabase)) / h;\n    \n        if(bDataFormat == 1)\n        {\n            r = texture2D(Ytexture, result.st).r; \n            g = texture2D(Ytexture, result.st).g; \n            b = texture2D(Ytexture, result.st).b; \n        }\n        else if(bDataFormat == 0)\n        {\n            y = texture2D(Ytexture, result.st).r;\n            u = texture2D(Utexture, result.st).r;\n            v = texture2D(Vtexture, result.st).r;\n            \n            y=1.1643*(y-0.0625);\n            u=u-0.5; \n            v=v-0.5; \n\n            r=y+1.5958*v; \n            g=y-0.39173*u-0.81290*v; \n            b=y+2.017*u; \n        }\n\n        if(result.s > 1.0 || result.t > 1.0 || result.s < 0.0 || result.t < 0.0)\n        {\n            r = 0.0; \n            g = 0.0; \n            b = 0.0;\n        }\n        gl_FragColor = vec4(r, g, b, 1.0);\n    }\n";break;case St.SR_DE_FISH_PANORAMA_CEILING_180:a=Lt,r="\n    precision highp float;\n    varying vec4 pp; \n    uniform sampler2D Ytexture;\n    uniform sampler2D Utexture;\n    uniform sampler2D Vtexture;\n    uniform float fAngle;\n    uniform float fRX1; \n    uniform float fRX2; \n    uniform float fRY1; \n    uniform float fRY2; \n    uniform int bDataFormat;\n    \n    void main()\n    {\n        float r,g,b,y,u,v;\n    \n        vec4 origin;\n        vec4 result;\n        float  thetabase;\n        float  d;\n    \n        vec4 newpp;  ///<180矫正pp纹理坐标的点对应360矫正newpp纹理坐标对应的点\n        if (pp.t  <= 0.5)\n        {\n            newpp.s =  pp.s / 2.0 + 0.5;\n            newpp.t =  pp.t * 2.0;\n        }\n        else\n        {\n            newpp.s =  pp.s / 2.0;\n            newpp.t =  (pp.t - 0.5) * 2.0;\n        }\n        float  w;\n        float  h;\n        float  fCenterX;\n        float  fCenterY;\n        float  fRadius;\n        w = 1.0;\n        h = (fRX2 - fRX1) / (fRY2 - fRY1);\n        fCenterX = (fRX1 + fRX2) / 2.0 * w;     ///<圆心实际坐标\n        fCenterY = (fRY1 + fRY2) / 2.0 * h;\n        fRadius = (fRX2 - fRX1) / 2.0 * w;     ///<半径实际长度\n        float fMax = 0.0;\n        if(fRX2 > 1.0 || fRY2 > 1.0 || fRX1 < 0.0 || fRY1 < 0.0) ///<如果不是一个完整的圆\n        {\n            float tmp;\n            if(fRX1 < 0.0)\n            {\n                tmp = -fRX1 * w; ///<左边超出图像部分最大实际长度\n                if(tmp > fMax)\n                    fMax = tmp;\n            }\n            if(fRX2 > 1.0)\n            {\n                tmp = (fRX2 - 1.0) * w; ///<右边超出图像部分最大实际长度\n                if(tmp > fMax)\n                    fMax = tmp;\n            }\n            if(fRY1 < 0.0)\n            {\n                tmp = -fRY1 * h; ///<上边超出图像部分最大实际长度\n                if(tmp > fMax)\n                    fMax = tmp;\n            }\n            if(fRY2 > 1.0)\n            {\n                tmp = (fRY2 - 1.0) * h; ///<下边超出图像部分最大实际长度\n                if(tmp > fMax)\n                    fMax = tmp;\n            }\n        }\n        float topCut = fMax / fRadius;   ///<如果不是一个完整的圆,最终矫正图需要切掉上面无图像部分,否则无需切\n        float bottomCut = 0.8;           ///<为矫正效果,最终矫正图固定切掉下面一部分\n        origin.s = newpp.s;\n        origin.t = (bottomCut - topCut) * newpp.t + topCut;\n        thetabase = 6.2831853 * origin.s + fAngle;\n        d = fRadius * (1.0 - origin.t);\n        result.s = (fCenterX - d*sin(thetabase)) / w;\n        result.t = (fCenterY + d*cos(thetabase)) / h;\n    \n        if(bDataFormat == 1)\n        {\n            r = texture2D(Ytexture, result.st).r; \n            g = texture2D(Ytexture, result.st).g; \n            b = texture2D(Ytexture, result.st).b; \n        }\n        else if(bDataFormat == 0)\n        {\n            y = texture2D(Ytexture, result.st).r;\n            u = texture2D(Utexture, result.st).r;\n            v = texture2D(Vtexture, result.st).r;\n            \n            y=1.1643*(y-0.0625);\n            u=u-0.5; \n            v=v-0.5; \n\n            r=y+1.5958*v; \n            g=y-0.39173*u-0.81290*v; \n            b=y+2.017*u; \n        }\n\n        if(result.s > 1.0 || result.t > 1.0 || result.s < 0.0 || result.t < 0.0)\n        {\n            r = 0.0;\n            g = 0.0;\n            b = 0.0;\n        }\n        gl_FragColor = vec4(r ,g ,b , 1.0);\n    }\n";break;case St.SR_DE_FISH_PANORAMA_FLOOR_360:a=Lt,r="\n    precision highp float;\n    varying vec4 pp; \n    uniform sampler2D Ytexture;\n    uniform sampler2D Utexture;\n    uniform sampler2D Vtexture;\n    uniform float fAngle;\n    uniform float fRX1;\n    uniform float fRX2;\n    uniform float fRY1;\n    uniform float fRY2;\n    uniform int bDataFormat;\n\n    void main()\n    {\n        float r,g,b,y,u,v;\n    \n        vec4 origin;\n        vec4 result;\n        float  thetabase;\n        float  d;\n    \n        float  w;\n        float  h;\n        float  fCenterX;\n        float  fCenterY;\n        float  fRadius;\n        w = 1.0;\n        h = (fRX2 - fRX1) / (fRY2 - fRY1);\n        fCenterX = (fRX1 + fRX2) / 2.0 * w;    ///<圆心实际坐标\n        fCenterY = (fRY1 + fRY2) / 2.0 * h;\n        fRadius = (fRX2 - fRX1) / 2.0 * w;    ///<半径实际长度\n        float fMax = 0.0;\n        if(fRX2 > 1.0 || fRY2 > 1.0 || fRX1 < 0.0 || fRY1 < 0.0) ///<如果不是一个完整的圆\n        {\n            float tmp;\n            if(fRX1 < 0.0)\n            {\n                tmp = -fRX1 * w; ///<左边超出图像部分最大实际长度\n                if(tmp > fMax)\n                   fMax = tmp;\n            }\n            if(fRX2 > 1.0)\n            {\n                tmp = (fRX2 - 1.0) * w; ///<右边超出图像部分最大实际长度\n                if(tmp > fMax)\n                    fMax = tmp;\n            }\n            if(fRY1 < 0.0)\n            {\n                tmp = -fRY1 * h; ///<上边超出图像部分最大实际长度\n                if(tmp > fMax)\n                    fMax = tmp;\n            }\n            if(fRY2 > 1.0)\n            {\n                tmp = (fRY2 - 1.0) * h; ///<下边超出图像部分最大实际长度\n                if(tmp > fMax)\n                    fMax = tmp;\n            }\n        }\n        float topCut = fMax / fRadius;   ///<如果不是一个完整的圆,最终矫正图需要切掉上面无图像部分,否则无需切\n        float bottomCut = 0.8;           ///<为矫正效果,最终矫正图固定切掉下面一部分\n        origin.s = 1.0 - pp.s;\n        origin.t = (bottomCut - topCut) * (1.0 - pp.t) + topCut;\n        thetabase = 6.2831853 * origin.s + fAngle;\n        d = fRadius * (1.0 - origin.t);\n        result.s = (fCenterX - d*sin(thetabase)) / w;\n        result.t = (fCenterY + d*cos(thetabase)) / h;\n    \n        if(bDataFormat == 1)\n        {\n            r = texture2D(Ytexture, result.st).r; \n            g = texture2D(Ytexture, result.st).g; \n            b = texture2D(Ytexture, result.st).b; \n        }\n        else if(bDataFormat == 0)\n        {\n            y = texture2D(Ytexture, result.st).r;\n            u = texture2D(Utexture, result.st).r;\n            v = texture2D(Vtexture, result.st).r;\n            \n            y=1.1643*(y-0.0625);\n            u=u-0.5; \n            v=v-0.5; \n\n            r=y+1.5958*v; \n            g=y-0.39173*u-0.81290*v; \n            b=y+2.017*u; \n        }\n\n        if(result.s > 1.0 || result.t > 1.0 || result.s < 0.0 || result.t < 0.0)\n        {\n            r = 0.0; \n            g = 0.0; \n            b = 0.0; \n        }\n        gl_FragColor = vec4(r ,g ,b , 1.0);\n    }\n";break;case St.SR_DE_FISH_PANORAMA_FLOOR_180:a=Lt,r="\n    precision highp float;\n    varying vec4 pp; \n    uniform sampler2D Ytexture;\n    uniform sampler2D Utexture;\n    uniform sampler2D Vtexture;\n    uniform float fAngle;\n    uniform float fRX1;\n    uniform float fRX2;\n    uniform float fRY1;\n    uniform float fRY2;\n    uniform int bDataFormat;\n\n    void main()\n    {\n        float r,g,b,y,u,v;\n\n        vec4 origin;\n        vec4 result;\n        float  thetabase;\n        float  d;\n    \n        vec4 newpp;  ///<180矫正pp纹理坐标的点对应360矫正newpp纹理坐标对应的点\n        if (pp.t  <= 0.5) \n        {\n            newpp.s =  pp.s / 2.0;\n            newpp.t =  pp.t * 2.0;\n        }\n        else\n        {\n            newpp.s =  pp.s / 2.0 + 0.5;\n            newpp.t =  (pp.t - 0.5) * 2.0;\n        }\n        float  w;\n        float  h;\n        float  fCenterX;\n        float  fCenterY;\n        float  fRadius;\n        w = 1.0;\n        h = (fRX2 - fRX1) / (fRY2 - fRY1);\n        fCenterX = (fRX1 + fRX2) / 2.0 * w;    ///<圆心实际坐标\n        fCenterY = (fRY1 + fRY2) / 2.0 * h;\n        fRadius = (fRX2 - fRX1) / 2.0 * w;     ///<半径实际长度\n        float fMax = 0.0;\n        if(fRX2 > 1.0 || fRY2 > 1.0 || fRX1 < 0.0 || fRY1 < 0.0) ///<如果不是一个完整的圆\n        {\n             float tmp;\n            if(fRX1 < 0.0)\n            {\n                tmp = -fRX1 * w; ///<左边超出图像部分最大实际长度\n                if(tmp > fMax)\n                    fMax = tmp;\n            }\n            if(fRX2 > 1.0)\n            {\n                tmp = (fRX2 - 1.0) * w; ///<右边超出图像部分最大实际长度\n                if(tmp > fMax)\n                    fMax = tmp;\n            }\n            if(fRY1 < 0.0)\n            {\n                tmp = -fRY1 * h; ///<上边超出图像部分最大实际长度\n                if(tmp > fMax)\n                    fMax = tmp;\n            }\n            if(fRY2 > 1.0)\n            {\n                tmp = (fRY2 - 1.0) * h; ///<下边超出图像部分最大实际长度\n                if(tmp > fMax)\n                    fMax = tmp;\n            }\n        }\n        float topCut = fMax / fRadius;   ///<如果不是一个完整的圆,最终矫正图需要切掉上面无图像部分,否则无需切\n        float bottomCut = 0.8;           ///<为矫正效果,最终矫正图固定切掉下面一部分\n        origin.s = 1.0 - newpp.s;\n        origin.t = (bottomCut - topCut) * (1.0 - newpp.t) + topCut;\n        thetabase = 6.2831853 * origin.s + fAngle;\n        d = fRadius * (1.0 - origin.t);\n        result.s = (fCenterX - d*sin(thetabase)) / w;\n        result.t = (fCenterY + d*cos(thetabase)) / h;\n    \n        if(bDataFormat == 1)\n        {\n            r = texture2D(Ytexture, result.st).r; \n            g = texture2D(Ytexture, result.st).g; \n            b = texture2D(Ytexture, result.st).b; \n        }\n        else if(bDataFormat == 0)\n        {\n            y = texture2D(Ytexture, result.st).r;\n            u = texture2D(Utexture, result.st).r;\n            v = texture2D(Vtexture, result.st).r;\n            \n            y=1.1643*(y-0.0625);\n            u=u-0.5; \n            v=v-0.5; \n\n            r=y+1.5958*v; \n            g=y-0.39173*u-0.81290*v; \n            b=y+2.017*u; \n        }\n\n        if(result.s > 1.0 || result.t > 1.0 || result.s < 0.0 || result.t < 0.0)\n        {\n            r = 0.0; \n            g = 0.0; \n            b = 0.0; \n        }\n        gl_FragColor = vec4(r ,g ,b , 1.0);\n    } \n";break;case St.SR_DE_FISH_PANORAMA_WALL:a=Lt,r="\n    precision highp float;\n    varying vec4 pp; \n    uniform sampler2D Ytexture;\n    uniform sampler2D Utexture;\n    uniform sampler2D Vtexture;\n    uniform float fRX1;\n    uniform float fRX2;\n    uniform float fRY1; \n    uniform float fRY2; \n    uniform int bDataFormat;\n\n    void main()\n    {\n        float r,g,b,y,u,v;\n    \n        vec4 origin;\n        vec4 result;\n        float  d;\n        float  w;\n        float  h;\n        float  fCenterX;\n        float  fCenterY;\n        float  fRadius;\n        w = 1.0;\n        h = (fRX2 - fRX1) / (fRY2 - fRY1);\n        fCenterX = (fRX1 + fRX2) / 2.0 * w;     ///<圆心实际坐标\n        fCenterY = (fRY1 + fRY2) / 2.0 * h;\n        fRadius = (fRX2 - fRX1) / 2.0 * w;     ///<半径实际长度\n        float  defaultTopCut = 0.1;\n        float  defaultBottomCut = 0.9;\n        float  leftCut = 0.0;    ///<当图像中圆不完整时需要切掉无图像部分,即使图像完整,为了效果,也要切掉上下固定的一部分\n        float  rightCut = 1.0;\n        float  topCut = defaultTopCut;\n        float  bottomCut = defaultBottomCut;\n        if(fRX1 < 0.0)\n        {\n            float tmp;\n            tmp = -fRX1 * w; ///<左边超出图像部分最大实际长度\n            tmp = tmp / (2.0*fRadius);\n            leftCut = tmp;\n        }\n        if(fRX2 > 1.0)\n        {\n            float tmp;\n            tmp = (fRX2 - 1.0) * w; ///<右边超出图像部分最大实际长度\n            tmp = tmp / (2.0*fRadius);\n            rightCut = 1.0 - tmp;\n        }\n        if(fRY1 < 0.0)\n        {\n            float tmp;\n            tmp = -fRY1 * h; ///<上边超出图像部分最大实际长度\n            tmp = tmp / (2.0*fRadius);\n            if(tmp > defaultTopCut)\n                topCut = tmp;\n            else\n                topCut = defaultTopCut;\n        }\n        if(fRY2 > 1.0)\n        {\n            float tmp;\n            tmp = (fRY2 - 1.0) * h; ///<下边超出图像部分最大实际长度\n            tmp = tmp / (2.0*fRadius);\n            if(tmp > 1.0 - defaultBottomCut)\n                bottomCut = 1.0 - tmp;\n            else\n                bottomCut = defaultBottomCut;\n        }\n        origin.s = pp.s * (rightCut-leftCut) + leftCut;\n        origin.t = pp.t * (bottomCut-topCut) + topCut;\n        float tmpx = origin.s * 2.0 * fRadius + fCenterX - fRadius; ///<纹理坐标转化为原图上的实际坐标\n        float tmpy = origin.t * 2.0 * fRadius + fCenterY - fRadius;\n        d = sqrt(fRadius*fRadius - (tmpy-fCenterY)*(tmpy-fCenterY));\n        result.s = ((tmpx-fCenterX) * d / fRadius + fCenterX) / w;\n        result.t = tmpy / h;\n    \n        if(bDataFormat == 1)\n        {\n            r = texture2D(Ytexture, result.st).r; \n            g = texture2D(Ytexture, result.st).g; \n            b = texture2D(Ytexture, result.st).b; \n        }\n        else if(bDataFormat == 0)\n        {\n            y = texture2D(Ytexture, result.st).r;\n            u = texture2D(Utexture, result.st).r;\n            v = texture2D(Vtexture, result.st).r;\n            \n            y=1.1643*(y-0.0625);\n            u=u-0.5; \n            v=v-0.5; \n\n            r=y+1.5958*v; \n            g=y-0.39173*u-0.81290*v; \n            b=y+2.017*u; \n        }\n\n        if(result.s > 1.0 || result.t > 1.0 || result.s < 0.0 || result.t < 0.0)\n        {\n            r = 0.0; \n            g = 0.0; \n            b = 0.0; \n        }\n        gl_FragColor = vec4(r ,g ,b , 1.0);\n    }\n";break;case St.SR_DE_FISH_SEMISPHERE:case St.SR_DE_PANORAMA_SPHERE:case St.SR_DE_PANORAMA_PLANET:case St.SR_DE_FISH_CYLINDER_CEILING:case St.SR_DE_FISH_CYLINDER_FLOOR:case St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL:case St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL:case St.SR_DE_FISH_PLANET:a="\n    precision lowp  float;\n    attribute vec4  position;\n    attribute vec4  texCoord;\n    varying vec4    pp; \n    uniform int bCapture;\n\n    uniform mat4 matProj;\n    uniform mat4 matView;\n    void main(void) {\n        gl_Position = matProj * matView * position;\n        pp = texCoord;\n        if(bCapture == 1)\n        {\n          gl_Position.y = - gl_Position.y;\n        }\n    }\n",r=wt;break;case St.SR_DE_FISH_CYLINDER_SPLIT_CEILING:case St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR:a="\n    attribute vec4  position;\n    attribute vec4  texCoord;\n    varying vec4    pp; \n    uniform int bCapture;\n\n    uniform mat4 matProj;\n    uniform mat4 matView;\n    uniform highp vec4    vecCylinderParam;\n    uniform highp float   fTextureOffset;\n    uniform mediump float fRX1;\n    uniform mediump float fRX2;\n    uniform mediump float fRY1;\n    uniform mediump float fRY2;\n    void main(void) {\n        highp float  w;\n        highp float  h;\n        highp float  fCenterX;\n        highp float  fCenterY;\n        w = 1.0;\n        h = (fRX2 - fRX1) / (fRY2 - fRY1);\n        fCenterX = (fRX1 + fRX2) / 2.0 * w;\n        fCenterY = (fRY1 + fRY2) / 2.0 * h;\n\n        highp float dx     = position.x - vecCylinderParam.x;\n        highp float dz     = position.z - (vecCylinderParam.z + vecCylinderParam.y); \n        highp float theta  = atan(abs(dx/dz));\n        highp float fDis   = (3.1415926 - 2.0 * theta) * 1.0;\n        highp float fdx    = 0.0;\n        if (dx > 0.0)\n        {\n            fdx = 1.0;\n        }\n        else\n        {\n            fdx = -1.0;\n        }\n        fDis               = fdx * fDis; \n        highp float lx     = fDis; \n        highp float lz     = vecCylinderParam.z + vecCylinderParam.y; \n        highp float fRate  = (3.1415926 / 2.0 + vecCylinderParam.w) / 3.1415926 * 2.0; \n        highp vec4 newPos  = position; \n        newPos.x     = fRate * (lx - newPos.x) + newPos.x; \n        newPos.z     = fRate * (lz - newPos.z) + newPos.z; \n        gl_Position  = matProj * matView * newPos; \n        if(bCapture == 1)\n        {\n          gl_Position.y = - gl_Position.y;\n        }\n\n        highp float s = texCoord.s * w - fCenterX; \n        highp float t = fCenterY - texCoord.t * h; \n        pp.s = (s*cos(fTextureOffset) - t*sin(fTextureOffset) + fCenterX) / w; \n        pp.t = (fCenterY - (s*sin(fTextureOffset) + t*cos(fTextureOffset))) / h;\n    }\n",r=wt;break;default:return pt.SR_ERR_NOT_SUPPORT}var i=this.CompileProgram(a,r);return i<=0?pt.SR_ERR_WEBGL_RESOURCE:(this.videoShaderProgram=i,pt.SR_OK)}},{key:"_InitVideoVertex",value:function(t,e,a){var r=null,i=null,n=null,s=pt.SR_OK;if(0==this.b3DPort)r=new Float32Array([-1,1,-1,-1,1,1,1,1,-1,-1,1,-1]),i=new Float32Array([0,0,0,1,1,0,1,0,0,1,1,1]);else{if(this.fRX1=a.fRXLeft,this.fRX2=a.fRXRight,this.fRY1=a.fRYTop,this.fRY2=a.fRYBottom,e==St.SR_DE_FISH_SEMISPHERE||e==St.SR_DE_FISH_PLANET)s=this._CreateSemiSphere(this.fRX1,this.fRX2,this.fRY1,this.fRY2),r=this.pSemiSpherePos,i=this.pSemiSphereTex;else if(e==St.SR_DE_PANORAMA_SPHERE||e==St.SR_DE_PANORAMA_PLANET)s=this._CreateSphere(this.fRX1,this.fRX2,this.fRY1,this.fRY2),r=this.pSpherePos,i=this.pSphereTex,n=this.pSphereInd;else if(e==St.SR_DE_FISH_CYLINDER_CEILING||e==St.SR_DE_FISH_CYLINDER_FLOOR||e==St.SR_DE_FISH_CYLINDER_SPLIT_CEILING||e==St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR)s=this._CreateCylinder(e,this.fRX1,this.fRX2,this.fRY1,this.fRY2,0,0),r=this.pCylinderPos,i=this.pCylinderTex;else{if(e!=St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL&&e!=St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL)return pt.SR_ERR_NOT_SUPPORT;s=e==St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL?this._CreateArcSphere(e,.05,.95,-.3,1.3):this._CreateArcSphere(e,-.16,1.16,.005,.995),r=this.pArcSpherePos,i=this.pArcSphereTex}if(s!=pt.SR_OK)return s}if(null==r||null==i)return pt.SR_ERR_NOT_SUPPORT;var x=this.ctx.createBuffer();if(this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,x),this.ctx.bufferData(this.ctx.ARRAY_BUFFER,r,this.ctx.STATIC_DRAW),this.vertexPosBuffer=x,e==St.SR_DE_PANORAMA_SPHERE||e==St.SR_DE_PANORAMA_PLANET){var o=this.ctx.createBuffer();this.ctx.bindBuffer(this.ctx.ELEMENT_ARRAY_BUFFER,o),this.ctx.bufferData(this.ctx.ELEMENT_ARRAY_BUFFER,n,this.ctx.STATIC_DRAW),this.indicesPosBuffer=o}var f=this.ctx.createBuffer();return this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,f),this.ctx.bufferData(this.ctx.ARRAY_BUFFER,i,this.ctx.STATIC_DRAW),this.texturePosBuffer=f,this.ctx.bindBuffer(this.ctx.ARRAY_BUFFER,null),r=null,i=null,pt.SR_OK}},{key:"_InitCamera",value:function(t){if(null!=this.pCamera)return pt.SR_ERR_CALL_ORDER;switch(t){case St.SR_DE_NULL:case St.SR_DE_FISH_ORIGINAL:case St.SR_DE_FISH_PTZ_CEILING:case St.SR_DE_FISH_PTZ_FLOOR:case St.SR_DE_FISH_PTZ_WALL:case St.SR_DE_FISH_PANORAMA_CEILING_360:case St.SR_DE_FISH_PANORAMA_CEILING_180:case St.SR_DE_FISH_PANORAMA_FLOOR_360:case St.SR_DE_FISH_PANORAMA_FLOOR_180:case St.SR_DE_FISH_PANORAMA_WALL:return pt.SR_OK;case St.SR_DE_FISH_SEMISPHERE:if(this.pCamera=new Nt,null==this.pCamera)return pt.SR_ERR_ALLOC_MEMORY;this.pCamera.SetFov(dt),this.pCamera.SetNear(.02),this.pCamera.SetFar(1e3),this.fRotateX=4.71,this.pCamera.SetPitch(3.14-this.fRotateX),this.fScale=3,this.pCamera.SetScale(this.fScale);break;case St.SR_DE_PANORAMA_SPHERE:if(this.pCamera=new Nt,null==this.pCamera)return pt.SR_ERR_ALLOC_MEMORY;this.pCamera.SetFov(dt),this.pCamera.SetNear(.02),this.pCamera.SetFar(1e3),this.fRotateX=0,this.pCamera.SetPitch(3.14-this.fRotateX),this.fScale=0,this.pCamera.SetScale(this.fScale);break;case St.SR_DE_FISH_CYLINDER_CEILING:case St.SR_DE_FISH_CYLINDER_FLOOR:if(this.pCamera=new Nt,null==this.pCamera)return pt.SR_ERR_ALLOC_MEMORY;this.pCamera.SetFov(dt),this.pCamera.SetNear(.02),this.pCamera.SetFar(1e3),this.fRotateX=.785,this.pCamera.SetPitch(-this.fRotateX),this.fScale=6,this.pCamera.SetScale(this.fScale);break;case St.SR_DE_FISH_CYLINDER_SPLIT_CEILING:case St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR:if(this.pCamera=new Nt,null==this.pCamera)return pt.SR_ERR_ALLOC_MEMORY;this.pCamera.SetOrtho(!0),this.pCamera.SetNear(.02),this.pCamera.SetFar(1e3),this.fScale=3,this.pCamera.SetScale(this.fScale);break;case St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL:case St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL:if(this.pCamera=new Nt,null==this.pCamera)return pt.SR_ERR_ALLOC_MEMORY;this.pCamera.SetFov(1.25663704),this.pCamera.SetNear(.02),this.pCamera.SetFar(1e3),this.fScale=2,this.pCamera.SetScale(this.fScale),St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL==t?(this.fRotateLimitX=.17453292222222222,this.fRotateLimitY=1.0471975333333334):(this.fRotateLimitX=.5235987666666667,this.fRotateLimitY=.34906584444444444);break;case St.SR_DE_FISH_PLANET:if(this.pCamera=new Vt,null==this.pCamera)return pt.SR_ERR_ALLOC_MEMORY;this.pCamera.SetFov(2.16),this.pCamera.SetNear(.02),this.pCamera.SetFar(1e3),this.fRotateX=1.57,this.pCamera.SetPitch(this.fRotateX),this.pCamera.SetYaw(ut+this.fRotateY),this.fScale=1,this.pCamera.SetScale(this.fScale);break;case St.SR_DE_PANORAMA_PLANET:if(this.pCamera=new Vt,null==this.pCamera)return pt.SR_ERR_ALLOC_MEMORY;this.pCamera.SetPano(!0),this.pCamera.SetNear(.02),this.pCamera.SetFar(1e3),this.fRotateX=1.57,this.pCamera.SetPitch(this.fRotateX),this.fRotateY=-1.57,this.pCamera.SetYaw(ut+this.fRotateY),this.fScale=2.6,this.pCamera.SetScale(this.fScale);break;default:return pt.SR_ERR_NOT_SUPPORT}return pt.SR_OK}},{key:"CompileProgram",value:function(t,e){var a=this.ctx;if(null==a||null==t||null==e)return-1;var r=a.createShader(a.VERTEX_SHADER);if(a.shaderSource(r,t),a.compileShader(r),!a.getShaderParameter(r,a.COMPILE_STATUS))return-1;var i=a.createShader(a.FRAGMENT_SHADER);if(a.shaderSource(i,e),a.compileShader(i),!a.getShaderParameter(i,a.COMPILE_STATUS))return-1;var n=a.createProgram();return a.attachShader(n,r),a.attachShader(n,i),a.linkProgram(n),a.getProgramParameter(n,a.LINK_STATUS)?(a.deleteShader(r),a.deleteShader(i),n):-1}},{key:"_CreateSemiSphere",value:function(t,e,a,r){if(null!=this.pSemiSpherePos||null!=this.pSemiSphereTex)return pt.SR_ERR_CALL_ORDER;this.pSemiSpherePos=new Float32Array(43200),this.pSemiSphereTex=new Float32Array(28800);for(var i=(e-t)/(r-a),n=(e-t)/2*1,s=6.2831852/60,x=.0392699075,o=0,f=0,l=0,_=0;_<60;++_)for(var h=0;h<40;++h){var c=_*s;0==_&&(o=c);var u=59==_?o:(_+1)*s,d=-h*x,p=-(h+1)*x,m=void 0,S=void 0;this.pSemiSpherePos[f]=-1*Math.cos(d)*Math.cos(c),this.pSemiSpherePos[f+1]=1*Math.sin(d),this.pSemiSpherePos[f+2]=-1*Math.cos(d)*Math.sin(c),S=.5-.5*(1+d/1.5707963)*Math.sin(c),m=.5-.5*(1+d/1.5707963)*Math.cos(c),this.pSemiSphereTex[l++]=(2*m*n+1*t)/1,this.pSemiSphereTex[l++]=(2*S*n+a*i)/i,f+=3,this.pSemiSpherePos[f]=-1*Math.cos(p)*Math.cos(c),this.pSemiSpherePos[f+1]=1*Math.sin(p),this.pSemiSpherePos[f+2]=-1*Math.cos(p)*Math.sin(c),S=.5-.5*(1+p/1.5707963)*Math.sin(c),m=.5-.5*(1+p/1.5707963)*Math.cos(c),this.pSemiSphereTex[l++]=(2*m*n+1*t)/1,this.pSemiSphereTex[l++]=(2*S*n+a*i)/i,f+=3,this.pSemiSpherePos[f]=-1*Math.cos(d)*Math.cos(u),this.pSemiSpherePos[f+1]=1*Math.sin(d),this.pSemiSpherePos[f+2]=-1*Math.cos(d)*Math.sin(u),S=.5-.5*(1+d/1.5707963)*Math.sin(u),m=.5-.5*(1+d/1.5707963)*Math.cos(u),this.pSemiSphereTex[l++]=(2*m*n+1*t)/1,this.pSemiSphereTex[l++]=(2*S*n+a*i)/i,f+=3,this.pSemiSpherePos[f]=-1*Math.cos(d)*Math.cos(u),this.pSemiSpherePos[f+1]=1*Math.sin(d),this.pSemiSpherePos[f+2]=-1*Math.cos(d)*Math.sin(u),S=.5-.5*(1+d/1.5707963)*Math.sin(u),m=.5-.5*(1+d/1.5707963)*Math.cos(u),this.pSemiSphereTex[l++]=(2*m*n+1*t)/1,this.pSemiSphereTex[l++]=(2*S*n+a*i)/i,f+=3,this.pSemiSpherePos[f]=-1*Math.cos(p)*Math.cos(c),this.pSemiSpherePos[f+1]=1*Math.sin(p),this.pSemiSpherePos[f+2]=-1*Math.cos(p)*Math.sin(c),S=.5-.5*(1+p/1.5707963)*Math.sin(c),m=.5-.5*(1+p/1.5707963)*Math.cos(c),this.pSemiSphereTex[l++]=(2*m*n+1*t)/1,this.pSemiSphereTex[l++]=(2*S*n+a*i)/i,f+=3,this.pSemiSpherePos[f]=-1*Math.cos(p)*Math.cos(u),this.pSemiSpherePos[f+1]=1*Math.sin(p),this.pSemiSpherePos[f+2]=-1*Math.cos(p)*Math.sin(u),S=.5-.5*(1+p/1.5707963)*Math.sin(u),m=.5-.5*(1+p/1.5707963)*Math.cos(u),this.pSemiSphereTex[l++]=(2*m*n+1*t)/1,this.pSemiSphereTex[l++]=(2*S*n+a*i)/i,f+=3}return this.nSemiSpherePosNum=f/3,this.nSemiSpherePosSize=3,this.nSemiSphereTexSize=2,pt.SR_OK}},{key:"_CreateSphere",value:function(){if(null!=this.pSpherePos||null!=this.pSphereTex)return pt.SR_ERR_CALL_ORDER;this.pSpherePos=new Float32Array(7803),this.pSphereTex=new Float32Array(5202),this.pSphereInd=new Uint16Array(15e3);for(var t=0,e=0,a=0;a<=50;++a)for(var r=a*ut/50-1.5707963,i=Math.sin(r),n=Math.cos(r),s=0;s<=50;++s){var x=2*s*ut/50-ut,o=Math.sin(x),f=1*n*Math.cos(x),l=1*i,_=1*n*o;this.pSpherePos[t]=-f,this.pSpherePos[t+1]=l,this.pSpherePos[t+2]=_;var h=s/50,c=a/50;this.pSphereTex[e++]=h,this.pSphereTex[e++]=c,t+=3}for(var u=0,d=0;d<50;++d)for(var p=0;p<50;++p){var m=51*d+p,S=m+50+1;this.pSphereInd[u+0]=m,this.pSphereInd[u+1]=S,this.pSphereInd[u+2]=m+1,this.pSphereInd[u+3]=S,this.pSphereInd[u+4]=S+1,this.pSphereInd[u+5]=m+1,u+=6}return this.nSpherePosNum=2500,this.nSpherePosSize=3,this.nSphereTexSize=2,pt.SR_OK}},{key:"_CreateCylinder",value:function(t,e,a,r,i,n,s){if(null!=this.pCylinderPos||null!=this.pCylinderTex)return pt.SR_ERR_CALL_ORDER;if(Math.abs(n-0)<1e-6)this.fCylinderHeight=2;else{if(n<.5||n>6)return pt.SR_ERR_PARAM;this.fCylinderHeight=n}if(Math.abs(s-0)<1e-6)t==St.SR_DE_FISH_CYLINDER_FLOOR||t==St.SR_DE_FISH_CYLINDER_CEILING?this.fCylinderRadius=2:this.fCylinderRadius=1;else{if(s<.5||s>4)return pt.SR_ERR_PARAM;this.fCylinderRadius=s}if(this.pCylinderPos=new Float32Array(43200),this.pCylinderTex=new Float32Array(28800),null==this.pCylinderPos||null==this.pCylinderTex)return this.pCylinderPos=null,this.pCylinderTex=null,pt.SR_ERR_ALLOC_MEMORY;for(var x=(a-e)/(i-r),o=(a-e)/2*1,f=6.2831852/60,l=this.fCylinderHeight/40,_=0,h=0,c=0;c<60;++c)for(var u=0;u<40;++u){var d=c*f,p=(c+1)*f,m=void 0,S=void 0;this.pCylinderPos[_]=-this.fCylinderRadius*Math.sin(d),this.pCylinderPos[_+1]=this.fCylinderHeight/2-u*l,this.pCylinderPos[_+2]=-this.fCylinderRadius*Math.cos(d),St.SR_DE_FISH_CYLINDER_FLOOR==t||St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR==t?(m=.5+(.1+.01*u)*Math.sin(d),S=.5+(.1+.01*u)*Math.cos(d)):(m=.5-(.5-.01*u)*Math.sin(d),S=.5+(.5-.01*u)*Math.cos(d)),this.pCylinderTex[h++]=(2*m*o+1*e)/1,this.pCylinderTex[h++]=(2*S*o+r*x)/x,_+=3,this.pCylinderPos[_]=-this.fCylinderRadius*Math.sin(d),this.pCylinderPos[_+1]=this.fCylinderHeight/2-(u+1)*l,this.pCylinderPos[_+2]=-this.fCylinderRadius*Math.cos(d),St.SR_DE_FISH_CYLINDER_FLOOR==t||St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR==t?(m=.5+(.1+.01*(u+1))*Math.sin(d),S=.5+(.1+.01*(u+1))*Math.cos(d)):(m=.5-(.5-.01*(u+1))*Math.sin(d),S=.5+(.5-.01*(u+1))*Math.cos(d)),this.pCylinderTex[h++]=(2*m*o+1*e)/1,this.pCylinderTex[h++]=(2*S*o+r*x)/x,_+=3,this.pCylinderPos[_]=-this.fCylinderRadius*Math.sin(p),this.pCylinderPos[_+1]=this.fCylinderHeight/2-u*l,this.pCylinderPos[_+2]=-this.fCylinderRadius*Math.cos(p),St.SR_DE_FISH_CYLINDER_FLOOR==t||St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR==t?(m=.5+(.1+.01*u)*Math.sin(p),S=.5+(.1+.01*u)*Math.cos(p)):(m=.5-(.5-.01*u)*Math.sin(p),S=.5+(.5-.01*u)*Math.cos(p)),this.pCylinderTex[h++]=(2*m*o+1*e)/1,this.pCylinderTex[h++]=(2*S*o+r*x)/x,_+=3,this.pCylinderPos[_]=-this.fCylinderRadius*Math.sin(p),this.pCylinderPos[_+1]=this.fCylinderHeight/2-u*l,this.pCylinderPos[_+2]=-this.fCylinderRadius*Math.cos(p),St.SR_DE_FISH_CYLINDER_FLOOR==t||St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR==t?(m=.5+(.1+.01*u)*Math.sin(p),S=.5+(.1+.01*u)*Math.cos(p)):(m=.5-(.5-.01*u)*Math.sin(p),S=.5+(.5-.01*u)*Math.cos(p)),this.pCylinderTex[h++]=(2*m*o+1*e)/1,this.pCylinderTex[h++]=(2*S*o+r*x)/x,_+=3,this.pCylinderPos[_]=-this.fCylinderRadius*Math.sin(d),this.pCylinderPos[_+1]=this.fCylinderHeight/2-(u+1)*l,this.pCylinderPos[_+2]=-this.fCylinderRadius*Math.cos(d),St.SR_DE_FISH_CYLINDER_FLOOR==t||St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR==t?(m=.5+(.1+.01*(u+1))*Math.sin(d),S=.5+(.1+.01*(u+1))*Math.cos(d)):(m=.5-(.5-.01*(u+1))*Math.sin(d),S=.5+(.5-.01*(u+1))*Math.cos(d)),this.pCylinderTex[h++]=(2*m*o+1*e)/1,this.pCylinderTex[h++]=(2*S*o+r*x)/x,_+=3,this.pCylinderPos[_]=-this.fCylinderRadius*Math.sin(p),this.pCylinderPos[_+1]=this.fCylinderHeight/2-(u+1)*l,this.pCylinderPos[_+2]=-this.fCylinderRadius*Math.cos(p),St.SR_DE_FISH_CYLINDER_FLOOR==t||St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR==t?(m=.5+(.1+.01*(u+1))*Math.sin(p),S=.5+(.1+.01*(u+1))*Math.cos(p)):(m=.5-(.5-.01*(u+1))*Math.sin(p),S=.5+(.5-.01*(u+1))*Math.cos(p)),this.pCylinderTex[h++]=(2*m*o+1*e)/1,this.pCylinderTex[h++]=(2*S*o+r*x)/x,_+=3}return this.nCylinderPosNum=_/3,this.nCylinderPosSize=3,this.nCylinderTexSize=2,pt.SR_OK}},{key:"_CreateArcSphere",value:function(t,e,a,r,i){if(null!=this.pArcSpherePos||null!=this.pArcSphereTex)return pt.SR_ERR_CALL_ORDER;if(t==St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL){if(r>0||i<1)return pt.SR_ERR_PARAM}else{if(t!=St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL)return pt.SR_ERR_NOT_SUPPORT;if(e>0||a<1)return pt.SR_ERR_PARAM}if(this.fImageWidth=1,this.fImageHeight=(a-e)/(i-r),this.fTexCenterX=(e+a)/2*this.fImageWidth,this.fTexCenterY=(r+i)/2*this.fImageHeight,this.fTexRadius=(a-e)/2*this.fImageWidth,null==this.pArcSphereTex&&(this.pArcSphereTex=new Float32Array(14688),null==this.pArcSphereTex))return pt.SR_ERR_ALLOC_MEMORY;if(null==this.pArcSpherePos&&(this.pArcSpherePos=new Float32Array(22032),null==this.pArcSpherePos))return pt.SR_ERR_ALLOC_MEMORY;var n=new Float32Array(64);if(null==n)return pt.SR_ERR_ALLOC_MEMORY;var s=pt.SR_OK;if(t==St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL?s=this._ComputeLatitudeHorizontal(n,25,40,1):t==St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL&&(s=this._ComputeLatitudeVertical(n,25,40,1)),pt.SR_OK!=s)return this.pArcSpherePos=null,this.pArcSphereTex=null,s;this.fFirstLatitude=n[12],this.fLastLatitude=n[51];var x=0,o=0,f=new Float32Array(5);if(null==f)return this.pArcSpherePos=null,this.pArcSphereTex=null,pt.SR_ERR_ALLOC_MEMORY;for(var l=ut/24,_=-12;_<12;++_)for(var h=_<0?-_:_,c=_<0?h:h+1,u=_<0?64-2*(h-1)-2:64-2*h-2,d=0;d<u;++d,++c)t==St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL?this._ComputeVertexAndTexturePosHorizontal(1,1.5707963-l*_,n[c],f):t==St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL&&this._ComputeVertexAndTexturePosVertical(1,1.5707963-l*_,n[c],f),this.pArcSpherePos[x]=f[0],this.pArcSpherePos[x+1]=f[1],this.pArcSpherePos[x+2]=f[2],this.pArcSphereTex[o++]=f[3],this.pArcSphereTex[o++]=f[4],x+=3,t==St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL?this._ComputeVertexAndTexturePosHorizontal(1,1.5707963-l*(_+1),n[c],f):t==St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL&&this._ComputeVertexAndTexturePosVertical(1,1.5707963-l*(_+1),n[c],f),this.pArcSpherePos[x]=f[0],this.pArcSpherePos[x+1]=f[1],this.pArcSpherePos[x+2]=f[2],this.pArcSphereTex[o++]=f[3],this.pArcSphereTex[o++]=f[4],x+=3,_>=0&&0==d?t==St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL?this._ComputeVertexAndTexturePosHorizontal(1,1.5707963-l*_,n[c-1],f):t==St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL&&this._ComputeVertexAndTexturePosVertical(1,1.5707963-l*_,n[c-1],f):t==St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL?this._ComputeVertexAndTexturePosHorizontal(1,1.5707963-l*(_+1),n[c-1],f):t==St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL&&this._ComputeVertexAndTexturePosVertical(1,1.5707963-l*(_+1),n[c-1],f),this.pArcSpherePos[x]=f[0],this.pArcSpherePos[x+1]=f[1],this.pArcSpherePos[x+2]=f[2],this.pArcSphereTex[o++]=f[3],this.pArcSphereTex[o++]=f[4],x+=3,t==St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL?this._ComputeVertexAndTexturePosHorizontal(1,1.5707963-l*(_+1),n[c],f):t==St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL&&this._ComputeVertexAndTexturePosVertical(1,1.5707963-l*(_+1),n[c],f),this.pArcSpherePos[x]=f[0],this.pArcSpherePos[x+1]=f[1],this.pArcSpherePos[x+2]=f[2],this.pArcSphereTex[o++]=f[3],this.pArcSphereTex[o++]=f[4],x+=3,t==St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL?this._ComputeVertexAndTexturePosHorizontal(1,1.5707963-l*_,n[c],f):t==St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL&&this._ComputeVertexAndTexturePosVertical(1,1.5707963-l*_,n[c],f),this.pArcSpherePos[x]=f[0],this.pArcSpherePos[x+1]=f[1],this.pArcSpherePos[x+2]=f[2],this.pArcSphereTex[o++]=f[3],this.pArcSphereTex[o++]=f[4],x+=3,_<0&&d==u-1?t==St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL?this._ComputeVertexAndTexturePosHorizontal(1,1.5707963-l*(_+1),n[c+1],f):t==St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL&&this._ComputeVertexAndTexturePosVertical(1,1.5707963-l*(_+1),n[c+1],f):t==St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL?this._ComputeVertexAndTexturePosHorizontal(1,1.5707963-l*_,n[c+1],f):t==St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL&&this._ComputeVertexAndTexturePosVertical(1,1.5707963-l*_,n[c+1],f),this.pArcSpherePos[x]=f[0],this.pArcSpherePos[x+1]=f[1],this.pArcSpherePos[x+2]=f[2],this.pArcSphereTex[o++]=f[3],this.pArcSphereTex[o++]=f[4],x+=3;return this.nArcSpherePosNum=x/3,this.nArcSpherePosSize=3,this.nArcSphereTexSize=2,n=null,f=null,pt.SR_OK}},{key:"_ComputeIntersectionOfPlaneAndLongtitude",value:function(t,e,a){if(null==t)return pt.SR_ERR_PARAM;var r,i=t[1]*a,n=t[2]*a*Math.sin(e),s=-t[3],x=0;if(t[1]>0){var o=i*i*s*s-(i*i+n*n)*(s*s-n*n);x=(-i*s-Math.sqrt(o))/(i*i+n*n),o=n*n*s*s-(i*i+n*n)*(s*s-i*i)}if(t[1]<0){var f=i*i*s*s-(i*i+n*n)*(s*s-n*n);x=(-i*s+Math.sqrt(f))/(i*i+n*n),f=n*n*s*s-(i*i+n*n)*(s*s-i*i)}return r=-a*x,Math.asin(r/a)}},{key:"_ComputeLatitudeHorizontal",value:function(t,e,a,r){if(null==t)return pt.SR_ERR_PARAM;var i=0,n=(this.fTexCenterY,ut/(e-1)),s=ut*this.fTexCenterY/(2*this.fTexRadius),x=Math.asin(this.fTexCenterY/this.fTexRadius),o=Math.atan(Math.cos(s)/(Math.sin(s)-Math.sin(x))),f=new Float32Array(4);f[0]=0,f[1]=Math.sin(o),f[2]=Math.cos(o),f[3]=-r*Math.sin(o)*Math.sin(x),t[i++]=s;for(var l=1;l<=(e-3)/2;++l){var _=this._ComputeIntersectionOfPlaneAndLongtitude(f,1.5707963-n*l,r);t[i++]=_}for(var h=-Math.asin((this.fImageHeight-this.fTexCenterY)/this.fTexRadius),c=x,u=(c-h)/(a-1),d=0;d<a;++d)t[i++]=c-d*u;var p=h,m=ut*(this.fTexCenterY-this.fImageHeight)/(2*this.fTexRadius);o=Math.atan(Math.cos(m)/(Math.sin(p)-Math.sin(m)));var S=new Float32Array(4);S[0]=0,S[1]=-Math.sin(o),S[2]=Math.cos(o),S[3]=r*Math.sin(o)*Math.sin(p);for(var R=1;R<=(e-3)/2;++R){var P=this._ComputeIntersectionOfPlaneAndLongtitude(S,n*R,r);t[i++]=P}return t[i++]=m,f=null,S=null,pt.SR_OK}},{key:"_ComputeVertexAndTexturePosHorizontal",value:function(t,e,a,r){if(null==r)return pt.SR_ERR_PARAM;r[2]=-t*Math.cos(a)*Math.sin(e),r[0]=t*Math.cos(a)*Math.cos(e),r[1]=t*Math.sin(a);var i,n=-Math.asin(-r[2]/t)/ut;i=a>=0?Math.acos(r[0]/Math.sqrt(r[0]*r[0]+r[1]*r[1])):6.2831852-Math.acos(r[0]/Math.sqrt(r[0]*r[0]+r[1]*r[1]));var s=this.fTexCenterX-this.fTexRadius,x=this.fTexRadius-this.fTexCenterY;return r[3]=(Math.cos(i)*this.fTexRadius*(1+2*n)+this.fTexRadius+s)/this.fImageWidth,r[4]=(Math.sin(i)*this.fTexRadius*(-1-2*n)+this.fTexRadius-x)/this.fImageHeight,pt.SR_OK}},{key:"_ComputeLatitudeVertical",value:function(t,e,a,r){if(null==t)return pt.SR_ERR_PARAM;var i=0,n=ut/(e-1),s=ut*this.fTexCenterX/(2*this.fTexRadius),x=Math.asin(this.fTexCenterX/this.fTexRadius),o=Math.atan(Math.cos(s)/(Math.sin(s)-Math.sin(x))),f=new Float32Array(4);f[0]=0,f[1]=Math.sin(o),f[2]=Math.cos(o),f[3]=-r*Math.sin(o)*Math.sin(x),t[i++]=s;for(var l=1;l<=(e-3)/2;++l){var _=this._ComputeIntersectionOfPlaneAndLongtitude(f,1.5707963-n*l,r);t[i++]=_}for(var h=-Math.asin((this.fImageWidth-this.fTexCenterX)/this.fTexRadius),c=x,u=(c-h)/(a-1),d=0;d<a;++d)t[i++]=c-d*u;var p=h,m=ut*(this.fTexCenterX-this.fImageWidth)/(2*this.fTexRadius);o=Math.atan(Math.cos(m)/(Math.sin(p)-Math.sin(m)));var S=new Float32Array(4);S[0]=0,S[1]=-Math.sin(o),S[2]=Math.cos(o),S[3]=r*Math.sin(o)*Math.sin(p);for(var R=1;R<=(e-3)/2;++R){var P=this._ComputeIntersectionOfPlaneAndLongtitude(S,n*R,r);t[i++]=P}return t[i++]=m,f=null,S=null,pt.SR_OK}},{key:"_ComputeVertexAndTexturePosVertical",value:function(t,e,a,r){if(null==r)return pt.SR_ERR_PARAM;r[2]=-t*Math.cos(a)*Math.sin(e),r[1]=t*Math.cos(a)*Math.cos(e),r[0]=-t*Math.sin(a);var i,n=-Math.asin(-r[2]/t)/ut;i=e<=1.5707963?Math.acos(r[0]/Math.sqrt(r[0]*r[0]+r[1]*r[1])):6.2831852-Math.acos(r[0]/Math.sqrt(r[0]*r[0]+r[1]*r[1]));var s=this.fTexCenterX-this.fTexRadius,x=this.fTexRadius-this.fTexCenterY;return r[3]=(Math.cos(i)*this.fTexRadius*(1+2*n)+this.fTexRadius+s)/this.fImageWidth,r[4]=(Math.sin(i)*this.fTexRadius*(-1-2*n)+this.fTexRadius-x)/this.fImageHeight,pt.SR_OK}},{key:"_BeginCapture",value:function(){var t=pt.SR_OK;return 0==this.bCaptureResInit&&(t=this._InitRenderTarget(this.nWndWidth,this.nWndHeight,!1,!0),pt.SR_OK!=t)?t:(t=this._Resize(this.nWndWidth,this.nWndHeight,!1,!0),pt.SR_OK!=t?t:(this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,this.nCaptureFBO),this.bIsCapturing=!0,pt.SR_OK))}},{key:"_InitRenderTarget",value:function(t,e,a,r){if(0!=this.nCaptureRTTex||0!=this.nCaptureFBO)return pt.SR_ERR_CALL_ORDER;if(t<=0||e<=0)return pt.SR_ERR_PARAM;if(this.nCaptureRTTex=this.ctx.createTexture(),this.nCaptureRTTex<=0)return pt.SR_ERR_WEBGL_RESOURCE;if(this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nCaptureRTTex),this.bAntialias?this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR_MINMAP_LINEAR):this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MAG_FILTER,this.ctx.LINEAR),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_S,this.ctx.CLAMP_TO_EDGE),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_T,this.ctx.CLAMP_TO_EDGE),this.ctx.texImage2D(this.ctx.TEXTURE_2D,0,this.ctx.RGBA,t,e,0,this.ctx.RGBA,this.ctx.UNSIGNED_BYTE,null),0==this.nCaptureFBO&&(this.nCaptureFBO=this.ctx.createFramebuffer(),this.nCaptureFBO<=0))return pt.SR_ERR_WEBGL_RESOURCE;if(this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,this.nCaptureFBO),this.ctx.framebufferTexture2D(this.ctx.FRAMEBUFFER,this.ctx.COLOR_ATTACHMENT0,this.ctx.TEXTURE_2D,this.nCaptureRTTex,0),1==r&&0==this.nCaptureDepthbuffer){if(this.nCaptureDepthbuffer=this.ctx.createRenderbuffer(),this.nCaptureDepthbuffer<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.bindRenderbuffer(this.ctx.RENDERBUFFER,this.nCaptureDepthbuffer),this.ctx.renderbufferStorage(this.ctx.RENDERBUFFER,this.ctx.DEPTH_COMPONENT16,t,e),this.ctx.framebufferRenderbuffer(this.ctx.FRAMEBUFFER,this.ctx.DEPTH_ATTACHMENT,this.ctx.RENDERBUFFER,this.nCaptureDepthbuffer)}return this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),this.nCaptureFBOWidth=t,this.nCaptureFBOHeight=e,this.bCaptureResInit=!0,pt.SR_OK}},{key:"_Resize",value:function(t,e,a,r){if(this.nCaptureFBOWidth!=t||this.nCaptureFBOHeight!=e){if(this.nCaptureFBOWidth=t,this.nCaptureFBOHeight=e,0!=this.nCaptureRTTex&&(this.ctx.deleteTexture(this.nCaptureRTTex),this.nCaptureRTTex=0),0!=this.nCaptureDepthbuffer&&(this.ctx.deleteRenderbuffer(this.nCaptureDepthbuffer),this.nCaptureDepthbuffer=0),0==this.nCaptureRTTex&&(this.nCaptureRTTex=this.ctx.createTexture(),this.nCaptureRTTex<=0))return pt.SR_ERR_WEBGL_RESOURCE;if(this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nCaptureRTTex),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MAG_FILTER,this.ctx.LINEAR),this.bAntialias?this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR_MINMAP_LINEAR):this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_S,this.ctx.CLAMP_TO_EDGE),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_T,this.ctx.CLAMP_TO_EDGE),this.ctx.texImage2D(this.ctx.TEXTURE_2D,0,this.ctx.RGBA,this.nCaptureFBOWidth,this.nCaptureFBOHeight,0,this.ctx.RGBA,this.ctx.UNSIGNED_BYTE,null),this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,this.nCaptureFBO),this.ctx.framebufferTexture2D(this.ctx.FRAMEBUFFER,this.ctx.COLOR_ATTACHMENT0,this.ctx.TEXTURE_2D,this.nCaptureRTTex,0),1==r&&0==this.nCaptureDepthbuffer){if(this.nCaptureDepthbuffer=this.ctx.createRenderbuffer(),this.nCaptureDepthbuffer<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.bindRenderbuffer(this.ctx.RENDERBUFFER,this.nCaptureDepthbuffer),this.ctx.renderbufferStorage(this.ctx.RENDERBUFFER,this.ctx.DEPTH_COMPONENT16,t,e),this.ctx.framebufferRenderbuffer(this.ctx.FRAMEBUFFER,this.ctx.DEPTH_ATTACHMENT,this.ctx.RENDERBUFFER,this.nCaptureDepthbuffer)}this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null)}return pt.SR_OK}},{key:"_EndCapture",value:function(t){return null==this.ctx?(this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_CALL_ORDER):null==t.pBuffer||null==t.pBuffer?(this.bIsCapturing=!1,this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),pt.SR_ERR_PARAM):(this.ctx.readPixels(0,0,this.nCaptureWidth,this.nCaptureHeight,this.ctx.RGBA,this.ctx.UNSIGNED_BYTE,t.pBuffer),this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null),this.bIsCapturing=!1,pt.SR_OK)}},{key:"_ComputeRotateLimits",value:function(){if(this.enDisplayEffect==St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL||this.enDisplayEffect==St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL){var t,e;if(this.enDisplayEffect==St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL?(t=.17453292222222222,e=1.0471975333333334):(t=.5235987666666667,e=.34906584444444444),0==this.nWndWidth||0==this.nWndHeight)this.fRotateLimitX=t,this.fRotateLimitY=e;else{var a=Math.tan(2.748893525);if(Math.abs(a*this.fScale)<1){var r=a*a+1,i=-2*a*a*this.fScale,n=a*a*this.fScale*this.fScale-1,s=(-i-Math.sqrt(i*i-4*r*n))/(2*r),x=a*(s-this.fScale);this.fRotateLimitX=Math.acos(x/Math.sqrt(s*s+x*x)),this.fRotateLimitX<t&&(this.fRotateLimitX=t)}else this.fRotateLimitX=t;var o=Math.atan(this.nWndWidth/this.nWndHeight*Math.tan(.392699075));if(a=Math.tan(ut-o),Math.abs(a*this.fScale)<1){var f=a*a+1,l=-2*a*a*this.fScale,_=a*a*this.fScale*this.fScale-1,h=(-l-Math.sqrt(l*l-4*f*_))/(2*f),c=a*(h-this.fScale);this.fRotateLimitY=Math.acos(c/Math.sqrt(h*h+c*c)),this.fRotateLimitY<e&&(this.fRotateLimitY=e)}else this.fRotateLimitY=e}this.fRotateX>this.fRotateLimitX&&(this.fRotateX=this.fRotateLimitX),this.fRotateX<-this.fRotateLimitX&&(this.fRotateX=-this.fRotateLimitX),this.fRotateY>this.fRotateLimitY&&(this.fRotateY=this.fRotateLimitX),this.fRotateY<-this.fRotateLimitX&&(this.fRotateY=-this.fRotateLimitX)}return pt.SR_OK}},{key:"SetMSAACache",value:function(t,e){return this.msaaFrameBuffer=t,this.renderBuffer=e,pt.SR_OK}}]),t}(),Ht=function(){function t(){u(this,t),this.canvas=null,this.ctx=null,this.pFrameData=null,this.frameDisplayWidth=0,this.frameDisplayHeight=0,this.onlySupportedWebGL1=!1,this.bAntialias=!1,this.bAntialiasStateNeedChange=!1,this.bRecreateTex=!0,this.nSurfaceTexture=[],this.nSurfaceTexture[0]=0,this.nSurfaceTexture[1]=0,this.nSurfaceTexture[2]=0,this.bOpenMsaa=!1,this.nMsaaFBO=0,this.nResolveFBO=0,this.nMsaaColorBuffer=0,this.nResolveTexture=0,this.nMsaaSample=0,this.pFishParamManager=null,this.enDisplayEffect=St.SR_DE_NULL,this.nFECPort=-1,this.enPixelFormat=Rt.SR_PF_NULL,this.nTextureNum=0,this.nCaptureWidth=0,this.nCaptureHeight=0,this.pSubDisplay=null,this.nRTWidth=0,this.nRTHeight=0,this.pRenderToTex=null,this.bRenderToTex=!1,this.b3DPort=!1,this.preDisplayRectnX=0,this.preDisplayRectnY=0,this.preDisplayRectnW=0,this.preDisplayRectnH=0,this.preImageRotateValue=0}return d(t,[{key:"SR_Init",value:function(t,e){if(null==t)return pt.SR_ERR_PARAM;if(this.canvas=t,this.ctx=this.canvas.getContext("webgl2"),!this.ctx){if(this.ctx=this.canvas.getContext("webgl")||this.canvas.getContext("experimental-webgl"),!this.ctx)return pt.SR_ERR_CANVAS;this.onlySupportedWebGL1=!0}if(e==Rt.SR_PF_NV12||e==Rt.SR_PF_NV21)return pt.SR_ERR_NOT_SUPPORT;switch(e){case Rt.SR_PF_YV12:case Rt.SR_PF_I420:this.nTextureNum=3;break;case Rt.SR_PF_SURFACE:this.nTextureNum=1;break;default:return pt.SR_ERR_NOT_SUPPORT}return this.enPixelFormat=e,pt.SR_OK}},{key:"SR_AddSubPort",value:function(t){var e=-1;if(null==this.ctx)return e;if(null!=this.pFishParamManager?(e=this.pFishParamManager.GetFECPort(t),this.b3DPort=!0):t==St.SR_DE_NULL&&(e=0),-1==e)return-1;this.nFECPort=e;var a=pt.SR_OK;if(null==this.pSubDisplay&&(this.pSubDisplay=new Ut,null==this.pSubDisplay))return pt.SR_ERR_ALLOC_MEMORY;if((a=this.pSubDisplay.SetCanvasSize(this.canvas.width,this.canvas.height))!=pt.SR_OK)return a;if((a=this.pSubDisplay.SetWebGL2Support(this.onlySupportedWebGL1))!=pt.SR_OK)return a;var r={};if(null!=this.pFishParamManager){this.pSubDisplay.SetFishParamManager(this.pFishParamManager),this.pSubDisplay.SetFECPort(this.nFECPort);for(var i=0;i<32&&pt.SR_OK!=this.pFishParamManager.GetRenderParam(i,r);++i);}if((a=this.pSubDisplay.Init(this.ctx,this.enPixelFormat,t,r))!=pt.SR_OK)return a;if(St.SR_DE_NULL!=t){a=this.pFishParamManager.SetPTZDisplayMode(yt.SR_DM_NULL);var n={};if((a=this.pFishParamManager.GetFishParam(this.nFECPort,n))!=pt.SR_OK)return a;if(St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL==t){if(n.nFishParamType=Pt.SR_FPT_CENTER,n.fRXLeft=.05,n.fRXRight=.95,n.fRYTop=-.3,n.fRYBottom=1.3,(a=this.pFishParamManager.SetFishParam(this.nFECPort,n))!=pt.SR_OK)return a}else if(St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL==t&&(n.nFishParamType=Pt.SR_FPT_CENTER,n.fRXLeft=-.16,n.fRXRight=1.16,n.fRYTop=.005,n.fRYBottom=.995,(a=this.pFishParamManager.SetFishParam(this.nFECPort,n))!=pt.SR_OK))return a}return null!=this.pFishParamManager&&this.pFishParamManager.ComputePTZPoints(),this.enDisplayEffect=t,this.nFECPort}},{key:"SR_UpdateFrameData",value:function(t,e,a,r,i){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;if(null==t||e<=0||a<=0)return pt.SR_ERR_PARAM;this.frameDisplayWidth==e&&this.frameDisplayHeight==a||(this.bRecreateTex=!0);var n=pt.SR_OK;if(Rt.SR_PF_SURFACE==this.enPixelFormat)this.frameDisplayWidth=e,this.frameDisplayHeight=a;else if(n=this._ResizeFrameData(t,e,a,r),pt.SR_OK!=n)return n;if(1==this.bRecreateTex){if(this.enPixelFormat==Rt.SR_PF_SURFACE){if(0!=this.nSurfaceTexture[0]){var s=this.nSurfaceTexture[0];this.ctx.deleteTexture(s),this.nSurfaceTexture[0]=0}var x=this.ctx.createTexture();if(x<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.bindTexture(this.ctx.TEXTURE_2D,x),this.onlySupportedWebGL1||1!=this.bAntialias?this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR):this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR_MIPMAP_NEAREST),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MAG_FILTER,this.ctx.LINEAR),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_S,this.ctx.CLAMP_TO_EDGE),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_T,this.ctx.CLAMP_TO_EDGE),this.ctx.bindTexture(this.ctx.TEXTURE_2D,null),this.nSurfaceTexture[0]=x}else if(this.enPixelFormat==Rt.SR_PF_YV12||this.enPixelFormat==Rt.SR_PF_I420)for(var o=0;o<this.nTextureNum;o++){if(0!=this.nSurfaceTexture[o]){var f=this.nSurfaceTexture[o];this.ctx.deleteTexture(f),this.nSurfaceTexture[o]=0}var l=this.ctx.createTexture();if(l<=0)return pt.SR_ERR_WEBGL_RESOURCE;this.ctx.bindTexture(this.ctx.TEXTURE_2D,l),this.onlySupportedWebGL1||1!=this.bAntialias?this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR):this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR_MIPMAP_NEAREST),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MAG_FILTER,this.ctx.LINEAR),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_S,this.ctx.CLAMP_TO_EDGE),this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_WRAP_T,this.ctx.CLAMP_TO_EDGE),this.nSurfaceTexture[o]=l,this.ctx.bindTexture(this.ctx.TEXTURE_2D,null)}this.bRecreateTex=!1}if(Rt.SR_PF_YV12==this.enPixelFormat){var _=this.pFrameData.subarray(0,e*a);this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nSurfaceTexture[0]),this.ctx.texImage2D(this.ctx.TEXTURE_2D,0,this.ctx.LUMINANCE,e,a,0,this.ctx.LUMINANCE,this.ctx.UNSIGNED_BYTE,_),this.bAntialiasStateNeedChange&&(this.onlySupportedWebGL1||1!=this.bAntialias?this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR):(this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR_MIPMAP_NEAREST),this.ctx.generateMipmap(this.ctx.TEXTURE_2D)));var h=this.pFrameData.subarray(e*a+e/2*a/2,e*a+e/2*a/2+e/2*a/2);this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nSurfaceTexture[1]),this.ctx.texImage2D(this.ctx.TEXTURE_2D,0,this.ctx.LUMINANCE,e/2,a/2,0,this.ctx.LUMINANCE,this.ctx.UNSIGNED_BYTE,h),this.bAntialiasStateNeedChange&&(this.onlySupportedWebGL1||1!=this.bAntialias?this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR):(this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR_MIPMAP_NEAREST),this.ctx.generateMipmap(this.ctx.TEXTURE_2D)));var c=this.pFrameData.subarray(e*a,e*a+e/2*a/2);this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nSurfaceTexture[2]),this.ctx.texImage2D(this.ctx.TEXTURE_2D,0,this.ctx.LUMINANCE,e/2,a/2,0,this.ctx.LUMINANCE,this.ctx.UNSIGNED_BYTE,c),this.bAntialiasStateNeedChange&&(this.onlySupportedWebGL1||1!=this.bAntialias?this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR):(this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR_MIPMAP_NEAREST),this.ctx.generateMipmap(this.ctx.TEXTURE_2D)),this.bAntialiasStateNeedChange=!1),_=null,h=null,c=null}else if(Rt.SR_PF_I420==this.enPixelFormat){var u=this.pFrameData.subarray(0,e*a);this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nSurfaceTexture[0]),this.ctx.texImage2D(this.ctx.TEXTURE_2D,0,this.ctx.LUMINANCE,e,a,0,this.ctx.LUMINANCE,this.ctx.UNSIGNED_BYTE,u),this.bAntialiasStateNeedChange&&(this.onlySupportedWebGL1||1!=this.bAntialias?this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR):(this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR_MIPMAP_NEAREST),this.ctx.generateMipmap(this.ctx.TEXTURE_2D)));var d=this.pFrameData.subarray(e*a,e*a+e/2*a/2);this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nSurfaceTexture[1]),this.ctx.texImage2D(this.ctx.TEXTURE_2D,0,this.ctx.LUMINANCE,e/2,a/2,0,this.ctx.LUMINANCE,this.ctx.UNSIGNED_BYTE,d),this.bAntialiasStateNeedChange&&(this.onlySupportedWebGL1||1!=this.bAntialias?this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR):(this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR_MIPMAP_NEAREST),this.ctx.generateMipmap(this.ctx.TEXTURE_2D)));var p=this.pFrameData.subarray(e*a+e/2*a/2,e*a+e/2*a/2+e/2*a/2);this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nSurfaceTexture[2]),this.ctx.texImage2D(this.ctx.TEXTURE_2D,0,this.ctx.LUMINANCE,e/2,a/2,0,this.ctx.LUMINANCE,this.ctx.UNSIGNED_BYTE,p),this.bAntialiasStateNeedChange&&(this.onlySupportedWebGL1||1!=this.bAntialias?this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR):(this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR_MIPMAP_NEAREST),this.ctx.generateMipmap(this.ctx.TEXTURE_2D)),this.bAntialiasStateNeedChange=!1),u=null,d=null,p=null}else Rt.SR_PF_SURFACE==this.enPixelFormat&&(this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.nSurfaceTexture[0]),this.ctx.texImage2D(this.ctx.TEXTURE_2D,0,this.ctx.RGBA,e,a,0,this.ctx.RGBA,this.ctx.UNSIGNED_BYTE,t),this.bAntialiasStateNeedChange&&(this.onlySupportedWebGL1||1!=this.bAntialias?this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR):(this.ctx.texParameteri(this.ctx.TEXTURE_2D,this.ctx.TEXTURE_MIN_FILTER,this.ctx.LINEAR_MIPMAP_NEAREST),this.ctx.generateMipmap(this.ctx.TEXTURE_2D)),this.bAntialiasStateNeedChange=!1));return pt.SR_OK}},{key:"SR_Display",value:function(t){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;if(null==this.pSubDisplay)return pt.SR_ERR_CALL_ORDER;this.pSubDisplay.SetTextureNum(this.nTextureNum);for(var e=0;e<this.nTextureNum;e++)this.pSubDisplay.SetTextures(e,this.nSurfaceTexture[e]);if(null!=this.pFishParamManager){var a={};this.pFishParamManager.GetRenderParam(this.nFECPort,a),this.pSubDisplay.SetFishParam(a)}var r=this.pSubDisplay.Render(!1);if(pt.SR_OK!=r)return r;if(null!=this.pFishParamManager){var i=this.pFishParamManager.GetWndPort();-1!=i&&i==this.nFECPort&&this.DrawPTZLines()}return this.pSubDisplay.SetVideoResolution(this.frameDisplayWidth,this.frameDisplayHeight),t||this.pSubDisplay.DoCallBack(),pt.SR_OK}},{key:"SR_SetDisplayRect",value:function(t,e,a,r,i){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;if(null==this.pSubDisplay)return pt.SR_ERR_CALL_ORDER;var n=pt.SR_OK;return(n=this.pSubDisplay.SetDisplayRect(t,e,a,r,i))!=pt.SR_OK?n:(this.preDisplayRectnX=t,this.preDisplayRectnY=e,this.preDisplayRectnW=a,this.preDisplayRectnH=r,pt.SR_OK)}},{key:"SR_SetImagePostProcess",value:function(t,e){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;if(null==this.pSubDisplay&&(this.pSubDisplay=new Ut,null==this.pSubDisplay))return pt.SR_ERR_ALLOC_MEMORY;var a=pt.SR_OK;return(a=this.pSubDisplay.SetImagePostProcess(t,e))!=pt.SR_OK?a:pt.SR_OK}},{key:"SR_SetRenderState",value:function(t,e){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;if(null==this.pSubDisplay)return pt.SR_ERR_CALL_ORDER;var a=pt.SR_OK;return(a=this.pSubDisplay.SetRenderState(t,e))!=pt.SR_OK?a:(t==gt.SR_RST_IMAGE_ROTATE&&(this.preImageRotateValue=e),pt.SR_OK)}},{key:"SR_GetCaptureSize",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null==t)return pt.SR_ERR_PARAM;if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;if(null==this.pSubDisplay)return pt.SR_ERR_CALL_ORDER;var a=pt.SR_OK;return(a=this.pSubDisplay.GetCaptureSize(t,e))!=pt.SR_OK?a:(this.nCaptureWidth=t.nWidth,this.nCaptureHeight=t.nHeight,pt.SR_OK)}},{key:"SR_CaptureScreen",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(0==this.nSurfaceTexture[0])return pt.SR_ERR_CALL_ORDER;if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;if(null==this.pSubDisplay)return pt.SR_ERR_CALL_ORDER;var a={nWndWidth:0,nWndHeight:0};this.pSubDisplay.GetWndResolution(a),this.pSubDisplay.SetWndResolution(this.nCaptureWidth,this.nCaptureHeight);var r=pt.SR_OK;return(r=this.pSubDisplay.CaptureScreen(t,e))!=pt.SR_OK?r:(this.pSubDisplay.SetWndResolution(a.nWndWidth,a.nWndHeight),pt.SR_OK)}},{key:"SR_DrawMosaic",value:function(t,e,a,r,i){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;if(null==this.pSubDisplay)return pt.SR_ERR_CALL_ORDER;var n=pt.SR_OK;return(n=this.pSubDisplay.DrawMosaic(t,e,a,r,i))!=pt.SR_OK?n:pt.SR_OK}},{key:"DrawPTZLines",value:function(){if(null==this.pFishParamManager)return pt.SR_ERR_CALL_ORDER;var t=this.pFishParamManager.GetPTZDisplayMode();if(t==yt.SR_DM_RANGE||t==yt.SR_DM_RECT)for(var e=0,a={fR:0,fG:0,fB:0,fA:0},r=pt.SR_OK,i=0;i<32;++i)if(0!=this.pFishParamManager.IsPortAllocated(i)&&(e=2,r=this.pFishParamManager.GetPTZColor(i,a),pt.SR_OK==r)){1==this.pFishParamManager.IsPTZSelected(i)&&(e+=1);var n=this.pFishParamManager.GetWndPort();if(i!=n&&yt.SR_DM_RANGE==t)if(St.SR_DE_FISH_ORIGINAL==this.pFishParamManager.GetDisplayEffect(n)){var s={};if(r=this.pFishParamManager.GetPTZPoints(i,s,yt.SR_DM_RANGE),pt.SR_OK!=r)continue;if(null!=s.pstPoints&&0!=s.nPointNum&&(r=this.SR_DrawLines(s.pstPoints,s.nPointNum,!0,a,e,!1),pt.SR_OK!=r))continue}else{var x;if((x=this.pFishParamManager.GetPTZFragmentNum(i))<=0)continue;for(var o=0;o<x;o++){var f={};this.pFishParamManager.GetPTZFragmentPoints(i,f,o),null!=f.pstPoints&&0!=f.nPointNum&&this.SR_DrawLines(f.pstPoints,f.nPointNum,!1,a,e,!1)}}else if(i!=n&&yt.SR_DM_RECT==t){var l={};if(r=this.pFishParamManager.GetPTZPoints(i,l,yt.SR_DM_RECT),pt.SR_OK!=r)continue;if(null!=l.pstPoints&&0!=l.nPointNum&&(r=this.SR_DrawLines(l.pstPoints,l.nPointNum,!0,a,e,!1),pt.SR_OK!=r))continue}}return pt.SR_OK}},{key:"SR_DrawLines",value:function(t,e,a,r,i,n){return null==this.ctx||null==this.pSubDisplay?pt.SR_ERR_CALL_ORDER:this.pSubDisplay.DrawLines(t,e,a,r,i,n)}},{key:"SR_DrawLinesEx",value:function(t,e,a,r){return null==this.ctx||null==this.pSubDisplay?pt.SR_ERR_CALL_ORDER:this.pSubDisplay.DrawLinesEx(t,e,a,r)}},{key:"SR_DrawFont",value:function(t,e,a,r,i,n,s,x,o,f,l){return pt.SR_ERR_NOT_SUPPORT}},{key:"SR_DrawFontEx",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;return null==this.ctx||null==this.pSubDisplay?pt.SR_ERR_CALL_ORDER:this.pSubDisplay.DrawFontEx(t,e,a,r)}},{key:"SR_DrawImage",value:function(t,e,a,r,i,n){return null==this.ctx||null==this.pSubDisplay?pt.SR_ERR_CALL_ORDER:this.pSubDisplay.DrawImage(t,e,a,r,i,n)}},{key:"SR_DelSubPort",value:function(t){return null==this.ctx||null==this.pSubDisplay?pt.SR_ERR_CALL_ORDER:(this.pSubDisplay.DelSubPort(),null!=this.pFishParamManager&&this.nFECPort==t&&this.pFishParamManager.FreeFECPort(this.nFECPort),this.enDisplayEffect=St.SR_DE_NULL,this.pSubDisplay=null,pt.SR_OK)}},{key:"SR_GetFishParam",value:function(t){return null==t?pt.SR_ERR_PARAM:null==this.pFishParamManager?pt.SR_ERR_CALL_ORDER:this.pFishParamManager.GetFishParam(this.nFECPort,t)}},{key:"SR_SetFishParam",value:function(t){return null==t?pt.SR_ERR_PARAM:null==this.pFishParamManager?pt.SR_ERR_CALL_ORDER:this.pFishParamManager.SetFishParam(this.nFECPort,t)}},{key:"SR_Destroy",value:function(){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;this.frameDisplayWidth=0,this.frameDisplayHeight=0,this.pFrameData=null;for(var t=0;t<this.nTextureNum;t++)0!=this.nSurfaceTexture[t]&&null!=this.ctx&&(this.ctx.deleteTexture(this.nSurfaceTexture[t]),this.nSurfaceTexture[t]=0);return this.SR_DelSubPort(this.nFECPort),this.ctx=null,this.onlySupportedWebGL1=!1,this.bAntialias=!1,this.bAntialiasStateNeedChange=!1,this.bOpenMsaa=!1,this.bRecreateTex=!0,this.pFishParamManager=null,pt.SR_OK}},{key:"SR_SetCanvasSize",value:function(t,e){if(!this.pSubDisplay||!this.canvas)return pt.SR_ERR_CALL_ORDER;this.canvas.width=t,this.canvas.height=e;var a=this.pSubDisplay.SetCanvasSize(t,e);return a!=pt.SR_OK?a:pt.SR_OK}},{key:"SR_GetCanvasSize",value:function(){return this.canvas?pt.SR_OK:pt.SR_ERR_CALL_ORDER}},{key:"SR_SetAntialias",value:function(t){if(null==this.pSubDisplay)return pt.SR_ERR_CALL_ORDER;if(1==this.onlySupportedWebGL1)return pt.SR_ERR_NOT_SUPPORT;this.bAntialias!=t&&(this.bAntialias=t,this.bAntialiasStateNeedChange=!0);var e=this.pSubDisplay.SetAntialias(this.bAntialias);return e!=pt.SR_OK?e:pt.SR_OK}},{key:"SR_SetRenderMode",value:function(t){return pt.SR_ERR_NOT_SUPPORT}},{key:"SR_SetPTZDisplayMode",value:function(t){return null==this.pFishParamManager?pt.SR_ERR_CALL_ORDER:this.pFishParamManager.SetPTZDisplayMode(t)}},{key:"SR_SetFishParamManager",value:function(t){return null!=this.pFishParamManager?pt.SR_ERR_NOT_SUPPORT:(this.pFishParamManager=t,pt.SR_OK)}},{key:"SR_SetViewParam",value:function(t,e){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;if(null==this.pSubDisplay)return pt.SR_ERR_CALL_ORDER;var a=this.pSubDisplay.SetViewParam(t,e);return a!=pt.SR_OK?a:pt.SR_OK}},{key:"SR_GetViewParam",value:function(t,e){if(null==this.ctx)return pt.SR_ERR_CALL_ORDER;if(null==this.pSubDisplay)return pt.SR_ERR_CALL_ORDER;var a=this.pSubDisplay.GetViewParam(t,e);return a!=pt.SR_OK?a:pt.SR_OK}},{key:"SR_SetCallBack",value:function(t,e,a){if(null==this.pSubDisplay)return pt.SR_ERR_CALL_ORDER;var r=pt.SR_OK;return(r=this.pSubDisplay.SetCallBack(t,e,a))!=pt.SR_OK?r:pt.SR_OK}},{key:"SR_SetPTZColor",value:function(t,e){return null==this.pFishParamManager?pt.SR_ERR_CALL_ORDER:this.pFishParamManager.SetPTZColor(t,e)}},{key:"SR_GetPTZColor",value:function(t,e){return null==this.pFishParamManager?pt.SR_ERR_CALL_ORDER:this.pFishParamManager.GetPTZColor(t,e)}},{key:"SR_SetPTZPort",value:function(t){return null==this.pFishParamManager?pt.SR_ERR_CALL_ORDER:this.pFishParamManager.SetPTZPort(t)}},{key:"SR_GetPTZPort",value:function(t,e,a){return null==this.pFishParamManager?pt.SR_ERR_CALL_ORDER:null==a?pt.SR_ERR_PARAM:this.pFishParamManager.GetPTZPort(t,e,a)}},{key:"SR_GetDllVersion",value:function(){return"V1.1.0.3_build20250820_svn96751"}},{key:"_ResizeFrameData",value:function(t,e,a,r){if(0==e%8&&null==r)return this.frameDisplayWidth=Math.round(e),this.frameDisplayHeight=Math.round(a),this.pFrameData=t,pt.SR_OK;if(null!=r&&0==r.nCropBottom&&0==r.nCropLeft&&0==r.nCropRight&&0==r.nCropTop&&0==e%8)return this.frameDisplayWidth=Math.round(e),this.frameDisplayHeight=Math.round(a),this.pFrameData=t,pt.SR_OK;if((null==this.pFrameData||this.frameDisplayWidth!=e/8*8||this.frameDisplayHeight!=a)&&(this.frameDisplayWidth=8*Math.round(e/8),this.frameDisplayHeight=Math.round(a),this.pFrameData=null,this.pFrameData=new Uint8Array(this.frameDisplayWidth*this.frameDisplayHeight*3/2),null==this.pFrameData))return pt.SR_ERR_ALLOC_MEMORY;var i=0,n=0,s=Math.round(r.nCodeWidth),x=Math.round(r.nCodeHeight),o=0;if(Rt.SR_PF_YV12==this.enPixelFormat||Rt.SR_PF_I420==this.enPixelFormat){var f,l,_;null!=r?(i=Math.round(r.nCropLeft),n=Math.round(r.nCropTop),f=t.subarray(i*s+n,s*x),l=t.subarray(s*x+n*s/4+i/2,s*x*5/4),_=t.subarray(s*x*5/4+n*s/4+i/2,s*x*3/2),o=s):(f=t.subarray(0,e*a),l=t.subarray(e*a,e*a*5/4),_=t.subarray(e*a*5/4,e*a*3/2),o=this.frameDisplayWidth);for(var h=null,c=0;c<this.frameDisplayHeight;++c){var u=Math.round(c*o),d=Math.round(c*o+this.frameDisplayWidth);h=f.slice(u,d);var p=Math.round(c*this.frameDisplayWidth);this.pFrameData.set(h,p)}for(var m=0;m<this.frameDisplayHeight/2;++m){var S=Math.round(m*o/2),R=Math.round(m*o/2+this.frameDisplayWidth/2);h=l.slice(S,R);var P=Math.round(this.frameDisplayWidth*this.frameDisplayHeight+m*this.frameDisplayWidth/2);this.pFrameData.set(h,P)}for(var y=0;y<this.frameDisplayHeight/2;++y){var b=Math.round(y*o/2),E=Math.round(y*o/2+this.frameDisplayWidth/2);h=_.slice(b,E);var g=Math.round(this.frameDisplayWidth*this.frameDisplayHeight*5/4+y*this.frameDisplayWidth/2);this.pFrameData.set(h,g)}f=null,l=null,_=null,h=null}else if(Rt.SR_PF_NV12==this.enPixelFormat){var F,C,v;null!=r?(i=Math.round(r.nCropLeft),n=Math.round(r.nCropTop),F=t.subarray(n*s+i,s*x),C=t.subarray(s*x+n*s/4+i/2,s*x*3/2),o=Math.round(r.nCodeWidth)):(F=t.subarray(0,s*x),C=t.subarray(s*x,s*x*3/2),o=this.frameDisplayWidth);for(var T=0;T<this.frameDisplayHeight;++T){var D=Math.round(T*o),A=Math.round(T*o+this.frameDisplayWidth);v=F.slice(D,A);var I=Math.round(T*this.frameDisplayWidth);this.pFrameData.set(v,I)}for(var M=0;M<this.frameDisplayHeight/2;++M){var L=Math.round(M*o),w=Math.round(M*o+this.frameDisplayWidth);v=C.slice(L,w);var O=Math.round(this.frameDisplayWidth*this.frameDisplayHeight+M*this.frameDisplayWidth);this.pFrameData.set(v,O)}F=null,C=null,v=null}return pt.SR_OK}},{key:"_RenderToTarget",value:function(t){return pt.SR_ERR_NOT_SUPPORT}},{key:"_SetRenderMode",value:function(t){if(null==this.pSubDisplay)return pt.SR_ERR_CALL_ORDER;var e=pt.SR_OK;if(t==this.bRenderToTex)return pt.SR_OK;this.bRenderToTex=t;var a={};if(null!=this.pFishParamManager){this.pSubDisplay.SetFishParamManager(this.pFishParamManager),this.pSubDisplay.SetFECPort(this.nFECPort);for(var r=0;r<32&&pt.SR_OK!=this.pFishParamManager.GetRenderParam(r,a);++r);}return(e=this.bRenderToTex?this.pSubDisplay.Init(this.ctx,Rt.SR_PF_RGBA32,this.enDisplayEffect,a):this.pSubDisplay.Init(this.ctx,this.enPixelFormat,this.enDisplayEffect,a))!=pt.SR_OK?e:0==this.preDisplayRectnX&&0==this.preDisplayRectnY&&0==this.preDisplayRectnW&&0==this.preDisplayRectnH||(e=this.pSubDisplay.SetDisplayRect(this.preDisplayRectnX,this.preDisplayRectnY,this.preDisplayRectnW,this.preDisplayRectnH,mt.SR_SRT_SRC))==pt.SR_OK?(this.pSubDisplay.nImageRotateAngle=Ct.SR_IRA_0,(e=this.pSubDisplay.SetRenderState(gt.SR_RST_IMAGE_ROTATE,this.preImageRotateValue))!=pt.SR_OK?e:pt.SR_OK):e}}]),t}(),Wt=function(){function t(){u(this,t),this.bPortAllocated=[],this.pRenderParam=[],this.pFishParam=[],this.stPTZColor=[],this.pPTZSetColor=[];for(var e=0;e<32;++e)this.pPTZSetColor[e]={},this.pPTZSetColor[e].fR=0,this.pPTZSetColor[e].fG=0,this.pPTZSetColor[e].fB=0,this.pPTZSetColor[e].fA=1,this.pPTZSetColor[e].bSetColor=!1;this.nBasePTZPointNum=[],this.nOriPTZPointNum=[],this.nPanoPTZPointNum=[],this.nPTZFragmentNum=[],this.pBasePTZPoints=[],this.pPanoPTZPoints=[],this.pRectPoints=[],this.nPTZRectNum=[],this.nPTZDisplayMode=yt.SR_DM_NULL,this.fRX1=0,this.fRX2=1,this.fRY1=0,this.fRY2=1,this.bBlack=!1,this.pOriPTZPoints=[],this.nWndPort=-1,this.nPlaceType=0,this.nPTZFragmentNode=[],this.bPTZSelected=[],this.nPTZDisplayMode=yt.SR_DM_RANGE;for(var a=0;a<32;++a){this.bPortAllocated[a]=!1,this.bPTZSelected[a]=!1,this.pRenderParam[a]=null,this.pFishParam[a]=null,this.stPTZColor[a]={},this.stPTZColor[a].fR=0,this.stPTZColor[a].fG=0,this.stPTZColor[a].fB=0,this.stPTZColor[a].fA=0,this.nBasePTZPointNum[a]=0,this.nOriPTZPointNum[a]=0,this.nPanoPTZPointNum[a]=0,this.nPTZRectNum[a]=0,this.pPanoPTZPoints[a]=[],this.pRectPoints[a]=[],this.pBasePTZPoints[a]=[],this.pOriPTZPoints[a]=[];for(var r=0;r<4;++r)this.pRectPoints[a][r]={},this.pRectPoints[a][r].fX=0,this.pRectPoints[a][r].fY=0;for(var i=0;i<1024;++i)this.pBasePTZPoints[a][i]={},this.pBasePTZPoints[a][i].fX=0,this.pBasePTZPoints[a][i].fY=0,this.pOriPTZPoints[a][i]={},this.pOriPTZPoints[a][i].fX=0,this.pOriPTZPoints[a][i].fY=0,this.pPanoPTZPoints[a][i]={},this.pPanoPTZPoints[a][i].fX=0,this.pPanoPTZPoints[a][i].fY=0;this.nPTZFragmentNum[a]=0,this.nPTZFragmentNode[a]=[];for(var n=0;n<100;++n)this.nPTZFragmentNode[a][n]=0}this.InitColorList()}return d(t,[{key:"GetFECPort",value:function(t){for(var e=-1,a=0;a<32;++a)if(0==this.bPortAllocated[a]){e=a;break}if(-1==e)return e;if(t==St.SR_DE_NULL)return e;var r=this.JudgeDisplayEffect(t);if(pt.SR_OK!=r)return this.FreeFECPort(e),-1;if(St.SR_DE_FISH_PANORAMA_CEILING_360==t||St.SR_DE_FISH_PANORAMA_CEILING_180==t||St.SR_DE_FISH_PANORAMA_FLOOR_360==t||St.SR_DE_FISH_PANORAMA_FLOOR_180==t||St.SR_DE_FISH_PANORAMA_WALL==t||St.SR_DE_FISH_ORIGINAL==t){if(-1!=this.nWndPort)return this.FreeFECPort(e),-1;this.nWndPort=e}if(!(St.SR_DE_FISH_PTZ_CEILING!=t&&St.SR_DE_FISH_PTZ_FLOOR!=t&&St.SR_DE_FISH_PTZ_WALL!=t||-1==this.nWndPort||null==this.pRenderParam[this.nWndPort]||St.SR_DE_FISH_PANORAMA_CEILING_180!=this.pRenderParam[this.nWndPort].nDisplayEffect&&St.SR_DE_FISH_PANORAMA_FLOOR_180!=this.pRenderParam[this.nWndPort].nDisplayEffect))return this.FreeFECPort(e),-1;if(St.SR_DE_FISH_PANORAMA_CEILING_180==t||St.SR_DE_FISH_PANORAMA_FLOOR_180==t)for(var i=0;i<32;++i)if(null!=this.pRenderParam[i]&&(St.SR_DE_FISH_PTZ_CEILING==this.pRenderParam[i].nDisplayEffect||St.SR_DE_FISH_PTZ_FLOOR==this.pRenderParam[i].nDisplayEffect||St.SR_DE_FISH_PTZ_WALL==this.pRenderParam[i].nDisplayEffect))return this.FreeFECPort(e),-1;if(St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL==t)for(var n=0;n<32;++n)if(null!=this.pRenderParam[n]&&St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL==this.pRenderParam[n].nDisplayEffect)return this.FreeFECPort(e),-1;if(St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL==t)for(var s=0;s<32;++s)if(null!=this.pRenderParam[s]&&St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL==this.pRenderParam[s].nDisplayEffect)return this.FreeFECPort(e),-1;return this.pRenderParam[e]={},this.pRenderParam[e].fCosH=1,this.pRenderParam[e].fSinH=0,this.pRenderParam[e].fCosV=1,this.pRenderParam[e].fSinV=0,this.pRenderParam[e].fAngle=0,this.pRenderParam[e].fRX1=this.fRX1,this.pRenderParam[e].fRX2=this.fRX2,this.pRenderParam[e].fRY1=this.fRY1,this.pRenderParam[e].fRY2=this.fRY2,this.pRenderParam[e].bBlack=this.bBlack,this.pRenderParam[e].fZoom=.035+.8,this.pRenderParam[e].nDisplayEffect=t,this.pRenderParam[e].bBlack=!1,this.pRenderParam[e].bCut=!1,this.pFishParam[e]={},this.pFishParam[e].nFishParamType=0,this.pFishParam[e].bCut=!1,this.pFishParam[e].fAngle=this.pRenderParam[e].fAngle,this.pFishParam[e].fPTZX=.5,this.pFishParam[e].fPTZY=.5,this.pFishParam[e].fRXLeft=this.pRenderParam[e].fRX1,this.pFishParam[e].fRXRight=this.pRenderParam[e].fRX2,this.pFishParam[e].fRYTop=this.pRenderParam[e].fRY1,this.pFishParam[e].fRYBottom=this.pRenderParam[e].fRY2,this.pFishParam[e].bBlack=this.pRenderParam[e].bBlack,this.pFishParam[e].fZoom=(this.pRenderParam[e].fZoom-.8)/7,this.bPortAllocated[e]=!0,e}},{key:"FreeFECPort",value:function(t){if(t<0||t>=32)return pt.SR_ERR_PARAM;this.nWndPort==t&&(this.nWndPort=-1),null!=this.pRenderParam[t]&&(this.pRenderParam[t].fCosH=1,this.pRenderParam[t].fSinH=0,this.pRenderParam[t].fCosV=1,this.pRenderParam[t].fSinV=0,this.pRenderParam[t].fAngle=0,this.pRenderParam[t].fZoom=0,this.pRenderParam[t].fRX1=0,this.pRenderParam[t].fRX2=1,this.pRenderParam[t].fRY1=0,this.pRenderParam[t].fRY2=1,this.pRenderParam[t].nDisplayEffect=0,this.pRenderParam[t].bBlack=!1,this.pRenderParam[t].bCut=!1),null!=this.pFishParam[t]&&(this.pFishParam[t].nFishParamType=0,this.pFishParam[t].fRXLeft=0,this.pFishParam[t].fRXRight=1,this.pFishParam[t].fRYTop=0,this.pFishParam[t].fRYBottom=1,this.pFishParam[t].bBlack=!1,this.pFishParam[t].bCut=!1,this.pFishParam[t].fAngle=0,this.pFishParam[t].fZoom=0,this.pFishParam[t].fPTZX=.5,this.pFishParam[t].fPTZY=.5),this.nBasePTZPointNum[t]=0,this.nOriPTZPointNum[t]=0,this.nPanoPTZPointNum[t]=0,this.nPTZRectNum[t]=0;for(var e=0;e<4;++e)this.pRectPoints[t][e].fX=0,this.pRectPoints[t][e].fY=0;for(var a=0;a<1024;++a)this.pBasePTZPoints[t][a].fX=0,this.pBasePTZPoints[t][a].fY=0,this.pOriPTZPoints[t][a].fX=0,this.pOriPTZPoints[t][a].fY=0,this.pPanoPTZPoints[t][a].fX=0,this.pPanoPTZPoints[t][a].fY=0;if(this.pPTZSetColor[t].bSetColor&&(this.pPTZSetColor[t].fA=0,this.pPTZSetColor[t].fR=0,this.pPTZSetColor[t].fG=0,this.pPTZSetColor[t].fB=0,this.pPTZSetColor[t].bSetColor=!1),this.bPTZSelected[t]=!1,0!=this.nPlaceType){for(var r=!1,i=0;i<32;++i)if(null!=this.pRenderParam[i]&&(St.SR_DE_FISH_PTZ_CEILING==this.pRenderParam[i].nDisplayEffect||St.SR_DE_FISH_PTZ_FLOOR==this.pRenderParam[i].nDisplayEffect||St.SR_DE_FISH_PTZ_WALL==this.pRenderParam[i].nDisplayEffect||St.SR_DE_FISH_PANORAMA_CEILING_360==this.pRenderParam[i].nDisplayEffect||St.SR_DE_FISH_PANORAMA_CEILING_180==this.pRenderParam[i].nDisplayEffect||St.SR_DE_FISH_PANORAMA_FLOOR_360==this.pRenderParam[i].nDisplayEffect||St.SR_DE_FISH_PANORAMA_FLOOR_180==this.pRenderParam[i].nDisplayEffect||St.SR_DE_FISH_PANORAMA_WALL==this.pRenderParam[i].nDisplayEffect||St.SR_DE_FISH_CYLINDER_CEILING==this.pRenderParam[i].nDisplayEffect||St.SR_DE_FISH_CYLINDER_FLOOR==this.pRenderParam[i].nDisplayEffect||St.SR_DE_FISH_CYLINDER_SPLIT_CEILING==this.pRenderParam[i].nDisplayEffect||St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR==this.pRenderParam[i].nDisplayEffect||St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL==this.pRenderParam[i].nDisplayEffect||St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL==this.pRenderParam[i].nDisplayEffect)){r=!0;break}r||(this.nPlaceType=0)}for(var n=!1,s=0;s<32;++s)if(null!=this.pRenderParam[s]){n=!0;break}n||(this.fRX1=0,this.fRX2=1,this.fRY1=0,this.fRY2=1,this.bBlack=!1),this.nPTZFragmentNum[t]=0;for(var x=0;x<100;++x)this.nPTZFragmentNode[t][x]=0;return this.bPortAllocated[t]=!1,pt.SR_OK}},{key:"DeInit",value:function(){for(var t=0;t<32;++t){for(var e=0;e<4;++e)this.pRectPoints[t][e]=null;for(var a=0;a<1024;++a)this.pBasePTZPoints[t][a]=null,this.pOriPTZPoints[t][a]=null,this.pPanoPTZPoints[t][a]=null;this.nPTZFragmentNum[t]=0,this.nPTZFragmentNode[t]=null,this.bPortAllocated[t]=!1,this.bPTZSelected[t]=!1,this.pRenderParam[t]=null,this.pFishParam[t]=null,this.stPTZColor[t]=null,this.nBasePTZPointNum[t]=0,this.nOriPTZPointNum[t]=0,this.nPanoPTZPointNum[t]=0,this.nPTZRectNum[t]=0,this.pPanoPTZPoints[t]=null,this.pRectPoints[t]=null,this.pBasePTZPoints[t]=null,this.pOriPTZPoints[t]=null}return this.bPortAllocated=null,this.pRenderParam=null,this.pFishParam=null,this.stPTZColor=null,this.nBasePTZPointNum=null,this.nOriPTZPointNum=null,this.nPanoPTZPointNum=null,this.nPTZFragmentNum=null,this.pBasePTZPoints=null,this.pPanoPTZPoints=null,this.pRectPoints=null,this.nPTZRectNum=null,this.nPTZDisplayMode=yt.SR_DM_NULL,this.fRX1=0,this.fRX2=1,this.fRY1=0,this.fRY2=1,this.bBlack=!1,this.pOriPTZPoints=null,this.pBasePTZPoints=null,this.nWndPort=-1,this.nPlaceType=0,this.nPTZFragmentNode=null,this.bPTZSelected=null,this.nPTZDisplayMode=yt.SR_DM_RANGE,pt.SR_OK}},{key:"InitColorList",value:function(){this.stPTZColor[0].fR=.5,this.stPTZColor[0].fG=.5,this.stPTZColor[0].fB=0,this.stPTZColor[0].fA=1,this.stPTZColor[1].fR=1,this.stPTZColor[1].fG=0,this.stPTZColor[1].fB=0,this.stPTZColor[1].fA=1,this.stPTZColor[2].fR=0,this.stPTZColor[2].fG=1,this.stPTZColor[2].fB=0,this.stPTZColor[2].fA=1,this.stPTZColor[3].fR=0,this.stPTZColor[3].fG=0,this.stPTZColor[3].fB=1,this.stPTZColor[3].fA=1,this.stPTZColor[4].fR=1,this.stPTZColor[4].fG=1,this.stPTZColor[4].fB=0,this.stPTZColor[4].fA=1,this.stPTZColor[5].fR=.5,this.stPTZColor[5].fG=0,this.stPTZColor[5].fB=1,this.stPTZColor[5].fA=1,this.stPTZColor[6].fR=0,this.stPTZColor[6].fG=1,this.stPTZColor[6].fB=1,this.stPTZColor[6].fA=1,this.stPTZColor[7].fR=1,this.stPTZColor[7].fG=.5,this.stPTZColor[7].fB=0,this.stPTZColor[7].fA=1,this.stPTZColor[8].fR=0,this.stPTZColor[8].fG=.5,this.stPTZColor[8].fB=.5,this.stPTZColor[8].fA=1;for(var t=9;t<32;t++)this.stPTZColor[t].fR=1*t/32,this.stPTZColor[t].fG=1*t/32,this.stPTZColor[t].fB=1*t/32,this.stPTZColor[t].fA=1;return pt.SR_OK}},{key:"GetRangePoints",value:function(t){if(t<0||t>=32)return pt.SR_ERR_PARAM;if(null==this.pRenderParam[t])return pt.SR_ERR_CALL_ORDER;var e=0,a=0;switch(this.nOriPTZPointNum[t]=0,this.nBasePTZPointNum[t]=0,this.pRenderParam[t].nDisplayEffect){case St.SR_DE_FISH_PTZ_CEILING:for(a=0;a<1;a+=.01)this.GetFishPTZCeiling(e,a,t);for(a=.9995,e=0;e<1;e+=.02)this.GetFishPTZCeiling(e,a,t);for(e=.999,a=.9995;a>=0;a-=.01)this.GetFishPTZCeiling(e,a,t);for(a=0,e=.999;e>=0;e-=.02)this.GetFishPTZCeiling(e,a,t);break;case St.SR_DE_FISH_PTZ_FLOOR:for(a=0;a<1;a+=.01)this.GetFishPTZFloor(e,a,t);for(a=.9995,e=0;e<1;e+=.02)this.GetFishPTZFloor(e,a,t);for(e=.999,a=.9995;a>=0;a-=.01)this.GetFishPTZFloor(e,a,t);for(a=0,e=.999;e>=0;e-=.02)this.GetFishPTZFloor(e,a,t);break;case St.SR_DE_FISH_PTZ_WALL:for(a=0;a<1;a+=.01)this.GetFishPTZWALL(e,a,t);for(a=.9995,e=0;e<1;e+=.02)this.GetFishPTZWALL(e,a,t);for(e=.999,a=.9995;a>=0;a-=.01)this.GetFishPTZWALL(e,a,t);for(a=0,e=.999;e>=0;e-=.02)this.GetFishPTZWALL(e,a,t);break;default:return pt.SR_ERR_NOT_SUPPORT}return pt.SR_OK}},{key:"TransformPTZRangePoints",value:function(t){if(-1==this.nWndPort)return pt.SR_ERR_CALL_ORDER;if(null==this.pBasePTZPoints[t]||null==this.pRenderParam[this.nWndPort])return pt.SR_ERR_CALL_ORDER;this.nPanoPTZPointNum[t]=0;var e=pt.SR_OK,a=this.nWndPort;switch(this.pRenderParam[a].nDisplayEffect){case St.SR_DE_FISH_PANORAMA_WALL:if(e=this.GetPanoPTZWall(t),pt.SR_OK!=e)return e;break;case St.SR_DE_FISH_PANORAMA_FLOOR_360:if(e=this.GetPanoPTZFloor(t),pt.SR_OK!=e)return e;break;case St.SR_DE_FISH_PANORAMA_CEILING_360:if(e=this.GetPanoPTZCeiling(t),pt.SR_OK!=e)return e}return this.CalcPTZFragmentPoints(t),pt.SR_OK}},{key:"GetRectPoints",value:function(t){if(t<0||t>=32)return pt.SR_ERR_PARAM;if(-1==this.nWndPort)return pt.SR_ERR_CALL_ORDER;if(null==this.pRenderParam[this.nWndPort]||null==this.pFishParam[t])return pt.SR_ERR_CALL_ORDER;var e=this.pRenderParam[this.nWndPort].nDisplayEffect,a=pt.SR_OK,r={fX:0,fY:0};switch(e){case St.SR_DE_FISH_PANORAMA_WALL:if(a=this.GetPointFish2PanoWall(r,this.pFishParam[t].fPTZX,this.pFishParam[t].fPTZY),pt.SR_OK!=a)return a;break;case St.SR_DE_FISH_PANORAMA_FLOOR_360:if(a=this.GetPointFish2PanoFloor(r,this.pFishParam[t].fPTZX,this.pFishParam[t].fPTZY),pt.SR_OK!=a)return pt.SR_ERR_NOT_SUPPORT==a&&(this.pRectPoints[t]=null),a;break;case St.SR_DE_FISH_PANORAMA_CEILING_360:if(a=this.GetPointFish2PanoCeiling(r,this.pFishParam[t].fPTZX,this.pFishParam[t].fPTZY),pt.SR_OK!=a)return pt.SR_ERR_NOT_SUPPORT==a&&(this.pRectPoints[t]=null),a;break;case St.SR_DE_FISH_ORIGINAL:r.fX=this.pFishParam[t].fPTZX,r.fY=this.pFishParam[t].fPTZY}if(null==this.pRectPoints[t]){this.pRectPoints[t]=[];for(var i=0;i<4;++i)this.pRectPoints[t][i]={},this.pRectPoints[t][i].fX=0,this.pRectPoints[t][i].fY=0}return this.pRectPoints[t][0].fX=r.fX-.05,this.pRectPoints[t][0].fY=r.fY-.05,this.pRectPoints[t][1].fX=r.fX+.05,this.pRectPoints[t][1].fY=r.fY-.05,this.pRectPoints[t][2].fX=r.fX+.05,this.pRectPoints[t][2].fY=r.fY+.05,this.pRectPoints[t][3].fX=r.fX-.05,this.pRectPoints[t][3].fY=r.fY+.05,this.nPTZRectNum[t]=4,pt.SR_OK}},{key:"GetFishPTZCeiling",value:function(t,e,a){var r,i,n,s,x,o,f,l={fX:0,fY:0},_={fX:0,fY:0},h={fX:0,fY:0},c={};s=(this.fRX2-this.fRX1)/(this.fRY2-this.fRY1),x=(this.fRX1+this.fRX2)/2*1,o=(this.fRY1+this.fRY2)/2*s,f=(this.fRX2-this.fRX1)/2*1,l.fX=e-.5,l.fY=.5-t,r=this.pRenderParam[a].fZoom,_.fX=l.fX,_.fY=l.fY*this.pRenderParam[a].fCosV+r*this.pRenderParam[a].fSinV,i=r*this.pRenderParam[a].fCosV-l.fY*this.pRenderParam[a].fSinV,n=Math.sqrt(_.fX*_.fX+_.fY*_.fY);var u=Math.sqrt(_.fX*_.fX+_.fY*_.fY+i*i),d=Math.asin(n/u)/1.5707963*.5;_.fX=d*_.fX/n,_.fY=d*_.fY/n,h.fX=_.fX*this.pRenderParam[a].fCosH-_.fY*this.pRenderParam[a].fSinH,h.fY=_.fX*this.pRenderParam[a].fSinH+_.fY*this.pRenderParam[a].fCosH,c.fX=2*h.fX*f+x,c.fY=2*-h.fY*f+o;var p=this.nBasePTZPointNum[a];this.pBasePTZPoints[a][p].fX=h.fX+.5,this.pBasePTZPoints[a][p].fY=.5-h.fY,this.nBasePTZPointNum[a]=this.nBasePTZPointNum[a]+1;var m=this.fRX1<=0?0:1*this.fRX1,S=this.fRY1<=0?0:this.fRY1*s,R=this.fRX2>=1?1-m:1*this.fRX2-m,P=this.fRY2>=1?s-S:this.fRY2*s-S;if(c.fX=(c.fX-m)/R,c.fY=(c.fY-S)/P,c.fX<=1&&c.fY<=1&&c.fX>=0&&c.fY>=0){var y=this.nOriPTZPointNum[a];this.pOriPTZPoints[a][y].fX=c.fX,this.pOriPTZPoints[a][y].fY=c.fY,this.nOriPTZPointNum[a]=this.nOriPTZPointNum[a]+1}return pt.SR_OK}},{key:"GetFishPTZFloor",value:function(t,e,a){var r,i,n,s,x,o,f,l={fX:0,fY:0},_={fX:0,fY:0},h={fX:0,fY:0},c={};s=(this.fRX2-this.fRX1)/(this.fRY2-this.fRY1),x=(this.fRX1+this.fRX2)/2*1,o=(this.fRY1+this.fRY2)/2*s,f=(this.fRX2-this.fRX1)/2*1,l.fX=t-.5,l.fY=e-.5,r=this.pRenderParam[a].fZoom,_.fX=l.fX,_.fY=l.fY*this.pRenderParam[a].fCosV+r*this.pRenderParam[a].fSinV,i=r*this.pRenderParam[a].fCosV-l.fY*this.pRenderParam[a].fSinV,n=Math.sqrt(_.fX*_.fX+_.fY*_.fY);var u=Math.sqrt(_.fX*_.fX+_.fY*_.fY+i*i),d=Math.asin(n/u)/1.5707963*.5;_.fX=d*_.fX/n,_.fY=d*_.fY/n,h.fX=_.fX*this.pRenderParam[a].fCosH-_.fY*this.pRenderParam[a].fSinH,h.fY=_.fX*this.pRenderParam[a].fSinH+_.fY*this.pRenderParam[a].fCosH,c.fX=2*h.fX*f+x,c.fY=2*h.fY*f+o;var p=this.nBasePTZPointNum[a];this.pBasePTZPoints[a][p].fX=h.fX+.5,this.pBasePTZPoints[a][p].fY=h.fY+.5,this.nBasePTZPointNum[a]=this.nBasePTZPointNum[a]+1;var m=this.fRX1<=0?0:1*this.fRX1,S=this.fRY1<=0?0:this.fRY1*s,R=this.fRX2>=1?1-m:1*this.fRX2-m,P=this.fRY2>=1?s-S:this.fRY2*s-S;if(c.fX=(c.fX-m)/R,c.fY=(c.fY-S)/P,c.fX<=1&&c.fY<=1&&c.fX>=0&&c.fY>=0){var y=this.nOriPTZPointNum[a];this.pOriPTZPoints[a][y].fX=c.fX,this.pOriPTZPoints[a][y].fY=c.fY,this.nOriPTZPointNum[a]=this.nOriPTZPointNum[a]+1}return pt.SR_OK}},{key:"GetFishPTZWALL",value:function(t,e,a){var r,i,n,s,x,o,f,l,_={fX:0,fY:0},h={fX:0,fY:0},c={fX:0,fY:0},u={};x=(this.fRX2-this.fRX1)/(this.fRY2-this.fRY1),o=(this.fRX1+this.fRX2)/2*1,f=(this.fRY1+this.fRY2)/2*x,l=(this.fRX2-this.fRX1)/2*1,_.fX=e-.5,_.fY=t-.5,r=this.pRenderParam[a].fZoom,h.fX=_.fX,h.fY=_.fY*this.pRenderParam[a].fCosV+r*this.pRenderParam[a].fSinV,i=r*this.pRenderParam[a].fCosV-_.fY*this.pRenderParam[a].fSinV,c.fX=h.fX*this.pRenderParam[a].fCosH+i*this.pRenderParam[a].fSinH,c.fY=h.fY,n=i*this.pRenderParam[a].fCosH-h.fX*this.pRenderParam[a].fSinH,s=Math.sqrt(c.fX*c.fX+c.fY*c.fY);var d=Math.sqrt(c.fX*c.fX+c.fY*c.fY+n*n),p=Math.asin(s/d)/1.5707963*.5;u.fX=p*c.fX/s*l*2+o,u.fY=p*c.fY/s*l*2+f;var m=this.nBasePTZPointNum[a];this.pBasePTZPoints[a][m].fX=p*c.fX/s+.5,this.pBasePTZPoints[a][m].fY=p*c.fY/s+.5,this.nBasePTZPointNum[a]=this.nBasePTZPointNum[a]+1;var S=this.fRX1<=0?0:1*this.fRX1,R=this.fRY1<=0?0:this.fRY1*x,P=this.fRX2>=1?1-S:1*this.fRX2-S,y=this.fRY2>=1?x-R:this.fRY2*x-R;if(u.fX=(u.fX-S)/P,u.fY=(u.fY-R)/y,u.fX<=1&&u.fY<=1&&u.fX>=0&&u.fY>=0){var b=this.nOriPTZPointNum[a];this.pOriPTZPoints[a][b].fX=u.fX,this.pOriPTZPoints[a][b].fY=u.fY,this.nOriPTZPointNum[a]=this.nOriPTZPointNum[a]+1}return pt.SR_OK}},{key:"GetPanoPTZCeiling",value:function(t){if(null==this.pRenderParam[t]||null==this.pRenderParam[this.nWndPort])return pt.SR_ERR_CALL_ORDER;if(null==this.pBasePTZPoints[t])return pt.SR_ERR_CALL_ORDER;var e,a,r=this.nBasePTZPointNum[t];e=(this.fRX2-this.fRX1)/(this.fRY2-this.fRY1),a=(this.fRX2-this.fRX1)/2*1;var i,n=0;(this.fRX2>1||this.fRY2>1||this.fRY1<0||this.fRX1<0)&&(this.fRX1<0&&(i=1*-this.fRX1)>n&&(n=i),this.fRX2>1&&(i=1*(this.fRX2-1))>n&&(n=i),this.fRY1<0&&(i=-this.fRY1*e)>n&&(n=i),this.fRY2>1&&(i=(this.fRY2-1)*e)>n&&(n=i));for(var s,x=n/a,o={fX:0,fY:0},f={fX:0,fY:0},l=0;l<r;++l)if(f.fX=this.pBasePTZPoints[t][l].fX,f.fY=this.pBasePTZPoints[t][l].fY,!(Math.abs(f.fX-.5)<1e-6&&Math.abs(f.fY-.5)<1e-6)){var _={fX:0,fY:0},h={fX:0,fY:0};_.fX=f.fX-.5,_.fY=f.fY-.5,h.fX=-.5*Math.sin(this.pRenderParam[this.nWndPort].fAngle),h.fY=.5*Math.cos(this.pRenderParam[this.nWndPort].fAngle);var c=Math.sqrt(_.fX*_.fX+_.fY*_.fY),u=Math.sqrt(h.fX*h.fX+h.fY*h.fY);if(s=Math.acos((_.fX*h.fX+_.fY*h.fY)/(c*u)),_.fX*h.fY-_.fY*h.fX>0&&(s=6.2831852-s),o.fX=s/6.2831853,o.fY=(2*(.5-c)-x)/(.8-x),o.fY>=0&&o.fX>=0&&o.fY<=1&&o.fX<=1){var d=this.nPanoPTZPointNum[t];this.pPanoPTZPoints[t][d].fX=o.fX,this.pPanoPTZPoints[t][d].fY=o.fY,this.nPanoPTZPointNum[t]=this.nPanoPTZPointNum[t]+1}}return pt.SR_OK}},{key:"GetPanoPTZFloor",value:function(t){if(null==this.pRenderParam[t]||null==this.pRenderParam[this.nWndPort])return pt.SR_ERR_CALL_ORDER;if(null==this.pBasePTZPoints[t])return pt.SR_ERR_CALL_ORDER;var e,a,r=this.nBasePTZPointNum[t];e=(this.fRX2-this.fRX1)/(this.fRY2-this.fRY1),a=(this.fRX2-this.fRX1)/2*1;var i,n=0;(this.fRX2>1||this.fRY2>1||this.fRY1<0||this.fRX1<0)&&(this.fRX1<0&&(i=1*-this.fRX1)>n&&(n=i),this.fRX2>1&&(i=1*(this.fRX2-1))>n&&(n=i),this.fRY1<0&&(i=-this.fRY1*e)>n&&(n=i),this.fRY2>1&&(i=(this.fRY2-1)*e)>n&&(n=i));for(var s,x=n/a,o={fX:0,fY:0},f={fX:0,fY:0},l=0;l<r;++l)if(f.fX=this.pBasePTZPoints[t][l].fX,f.fY=this.pBasePTZPoints[t][l].fY,!(Math.abs(f.fX-.5)<1e-6&&Math.abs(f.fY-.5)<1e-6)){var _={fX:0,fY:0},h={fX:0,fY:0};_.fX=f.fX-.5,_.fY=f.fY-.5,h.fX=-.5*Math.sin(this.pRenderParam[this.nWndPort].fAngle),h.fY=.5*Math.cos(this.pRenderParam[this.nWndPort].fAngle);var c=Math.sqrt(_.fX*_.fX+_.fY*_.fY),u=Math.sqrt(h.fX*h.fX+h.fY*h.fY);if(s=Math.acos((_.fX*h.fX+_.fY*h.fY)/(c*u)),_.fX*h.fY-_.fY*h.fX>0&&(s=6.2831852-s),o.fX=1-s/6.2831853,o.fY=1-(2*(.5-c)-x)/(.8-x),o.fY>=0&&o.fX>=0&&o.fY<=1&&o.fX<=1){var d=this.nPanoPTZPointNum[t];this.pPanoPTZPoints[t][d].fX=o.fX,this.pPanoPTZPoints[t][d].fY=o.fY,this.nPanoPTZPointNum[t]=this.nPanoPTZPointNum[t]+1}}return pt.SR_OK}},{key:"GetPanoPTZWall",value:function(t){if(null==this.pRenderParam[t]||null==this.pRenderParam[this.nWndPort])return pt.SR_ERR_CALL_ORDER;if(null==this.pBasePTZPoints[t])return pt.SR_ERR_CALL_ORDER;var e,a,r=this.nBasePTZPointNum[t];e=(this.fRX2-this.fRX1)/(this.fRY2-this.fRY1),a=(this.fRX2-this.fRX1)/2*1;var i,n,s,x,o,f=0,l=1,_=.1,h=.9;this.fRX1<0&&(i=1*-this.fRX1,f=i/=2*a),this.fRX2>1&&(n=1*(this.fRX2-1),l=1-(n/=2*a)),this.fRY1<0&&(s=-this.fRY1*e,_=(s/=2*a)>.1?s:.1),this.fRY2>1&&(x=(this.fRY2-1)*e,h=(x/=2*a)>1-.9?1-x:.9);for(var c={fX:0,fY:0},u={fX:0,fY:0},d=0;d<r;++d){u.fX=this.pBasePTZPoints[t][d].fX,u.fY=this.pBasePTZPoints[t][d].fY;var p=2*u.fX*a,m=2*u.fY*a;if(o=Math.sqrt(a*a-(m-a)*(m-a)),!(Math.abs(o)<1e-6)&&(u.fX=a*(p-a)/o+a,u.fY=m,c.fX=(u.fX-2*f*a)/(2*(l-f)*a),c.fY=(u.fY-2*_*a)/(2*(h-_)*a),c.fY>=0&&c.fX>=0&&c.fY<=1&&c.fX<=1)){var S=this.nPanoPTZPointNum[t];this.pPanoPTZPoints[t][S].fX=c.fX,this.pPanoPTZPoints[t][S].fY=c.fY,this.nPanoPTZPointNum[t]=this.nPanoPTZPointNum[t]+1}}return pt.SR_OK}},{key:"GetPointPano2FishCeiling",value:function(t,e,a){if(null==t||null==this.pRenderParam[this.nWndPort])return pt.SR_ERR_CALL_ORDER;var r,i;r=(this.fRX2-this.fRX1)/(this.fRY2-this.fRY1),i=(this.fRX2-this.fRX1)/2*1;var n,s=0,x=1,o=0,f=1,l=0;(this.fRX2>1||this.fRY2>1||this.fRX1<0||this.fRY1<0)&&(this.fRX1<0&&((n=1*-this.fRX1)>l&&(l=n),s=n/=2*i),this.fRX2>1&&((n=1*(this.fRX2-1))>l&&(l=n),x=1-(n/=2*i)),this.fRY1<0&&((n=-this.fRY1*r)>l&&(l=n),o=n/=2*i),this.fRY2>1&&((n=(this.fRY2-1)*r)>l&&(l=n),f=1-(n/=2*i)));var _,h,c=l/i,u={},d={};return u.fX=e,u.fY=(.8-c)*a+c,_=6.2831853*u.fX+this.pRenderParam[this.nWndPort].fAngle,h=.5*(1-u.fY),d.fX=.5-h*Math.sin(_),d.fY=.5+h*Math.cos(_),d.fX=(d.fX-s)/(x-s),d.fY=(d.fY-o)/(f-o),t.fX=d.fX,t.fY=d.fY,pt.SR_OK}},{key:"GetPointPano2FishFloor",value:function(t,e,a){if(null==this.pRenderParam[this.nWndPort])return pt.SR_ERR_CALL_ORDER;if(null==t)return pt.SR_ERR_PARAM;var r,i;r=(this.fRX2-this.fRX1)/(this.fRY2-this.fRY1),i=(this.fRX2-this.fRX1)/2*1;var n,s=0,x=1,o=0,f=1,l=0;(this.fRX2>1||this.fRY2>1||this.fRX1<0||this.fRY1<0)&&(this.fRX1<0&&((n=1*-this.fRX1)>l&&(l=n),s=n/=2*i),this.fRX2>1&&((n=1*(this.fRX2-1))>l&&(l=n),x=1-(n/=2*i)),this.fRY1<0&&((n=-this.fRY1*r)>l&&(l=n),o=n/=2*i),this.fRY2>1&&((n=(this.fRY2-1)*r)>l&&(l=n),f=1-(n/=2*i)));var _,h,c=l/i,u={},d={};return u.fX=1-e,u.fY=(.8-c)*(1-a)+c,_=6.2831853*u.fX+this.pRenderParam[this.nWndPort].fAngle,h=.5*(1-u.fY),d.fX=.5-h*Math.sin(_),d.fY=.5+h*Math.cos(_),d.fX=(d.fX-s)/(x-s),d.fY=(d.fY-o)/(f-o),t.fX=d.fX,t.fY=d.fY,pt.SR_OK}},{key:"GetPointPano2FishWall",value:function(t,e,a){if(null==this.pRenderParam[this.nWndPort])return pt.SR_ERR_CALL_ORDER;if(null==t)return pt.SR_ERR_PARAM;var r,i;r=(this.fRX2-this.fRX1)/(this.fRY2-this.fRY1),i=(this.fRX2-this.fRX1)/2*1;var n,s,x,o,f=0,l=1,_=.1,h=.9,c=0,u=1,d=0,p=1;this.fRX1<0&&(n=1*-this.fRX1,f=n/=2*i,c=n),this.fRX2>1&&(s=1*(this.fRX2-1),l=1-(s/=2*i),u=1-s),this.fRY1<0&&(x=-this.fRY1*r,_=(x/=2*i)>.1?x:.1,d=x),this.fRY2>1&&(o=(this.fRY2-1)*r,h=(o/=2*i)>1-.9?1-o:.9,p=1-o);var m={},S={};m.fX=e*(l-f)+f,m.fY=a*(h-_)+_;var R=Math.sqrt(.25-(m.fY-.5)*(m.fY-.5));return S.fX=(m.fX-.5)*R/.5+.5,S.fY=m.fY,S.fX=(S.fX-c)/(u-c),S.fY=(S.fY-d)/(p-d),t.fX=S.fX,t.fY=S.fY,pt.SR_OK}},{key:"UpdatePTZPosition",value:function(t,e,a){if(null==this.pRenderParam[t])return pt.SR_ERR_CALL_ORDER;var r={fHAngleSin:0,fHAngleCos:0,fVAngleSin:0,fVAngleCos:0},i=pt.SR_OK;if(St.SR_DE_FISH_PTZ_FLOOR==this.pRenderParam[t].nDisplayEffect||St.SR_DE_FISH_PTZ_CEILING==this.pRenderParam[t].nDisplayEffect){if((i=this.ComputeAngleVertical(e,a,r,this.pRenderParam[t].nDisplayEffect))!=pt.SR_OK)return i}else{if(St.SR_DE_FISH_PTZ_WALL!=this.pRenderParam[t].nDisplayEffect)return pt.SR_ERR_NOT_SUPPORT;if((i=this.ComputeAngleHorizontal(e,a,r))!=pt.SR_OK)return i}return 0==this.IsInImage(this.fRX1,this.fRX2,this.fRY1,this.fRY2,r,this.pRenderParam[t].fZoom,this.pRenderParam[t].nDisplayEffect)?pt.SR_ERR_PARAM:(this.pRenderParam[t].fCosH=r.fHAngleCos,this.pRenderParam[t].fSinH=r.fHAngleSin,this.pRenderParam[t].fCosV=r.fVAngleCos,this.pRenderParam[t].fSinV=r.fVAngleSin,pt.SR_OK)}},{key:"JudgeDisplayEffect",value:function(t){var e=0;switch(e){case 0:return e=this.GetPlaceType(t),4==this.nPlaceType&&(this.nPlaceType=0),pt.SR_OK;case 3:return(e=this.GetPlaceType(t))==this.nPlaceType||4==this.nPlaceType?pt.SR_OK:pt.SR_ERR_NOT_SUPPORT;case 2:case 1:return(e=this.GetPlaceType(t))==this.nPlaceType||4==e?pt.SR_OK:pt.SR_ERR_NOT_SUPPORT;default:return pt.SR_ERR_NOT_SUPPORT}return pt.SR_ERR_NOT_SUPPORT}},{key:"GetPlaceType",value:function(t){switch(t){case St.SR_DE_FISH_PTZ_CEILING:case St.SR_DE_FISH_PANORAMA_CEILING_360:case St.SR_DE_FISH_PANORAMA_CEILING_180:case St.SR_DE_FISH_CYLINDER_CEILING:case St.SR_DE_FISH_CYLINDER_SPLIT_CEILING:return 3;case St.SR_DE_FISH_PTZ_FLOOR:case St.SR_DE_FISH_PANORAMA_FLOOR_360:case St.SR_DE_FISH_PANARAMA_FLOOR_180:case St.SR_DE_FISH_CYLINDER_FLOOR:case St.SR_DE_FISH_CYLINDER_SPLIT_FLOOR:return 2;case St.SR_DE_FISH_PTZ_WALL:case St.SR_DE_FISH_PANORAMA_WALL:case St.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL:case St.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL:return 1;case St.SR_DE_FISH_SEMISPHERE:case St.SR_DE_FISH_ORIGINAL:case St.SR_DE_FISH_PLANET:case St.SR_DE_PANORAMA_SPHERE:case St.SR_DE_PANORAMA_PLANET:return 4;default:return 0}return 0}},{key:"SetFishParam",value:function(t,e){if(t<0||t>=32)return pt.SR_ERR_PARAM;if(null==e)return pt.SR_ERR_PARAM;if(null==this.pRenderParam[t])return pt.SR_ERR_CALL_ORDER;var a=pt.SR_OK;switch(e.nFishParamType){case Pt.SR_FPT_CENTER:if((a=this.UpdateCircyeParam(e.fRXLeft,e.fRXRight,e.fRYTop,e.fRYBottom))!=pt.SR_OK)return a;this.pRenderParam[t].bCut=e.bCut,this.bBlack=e.bBlack;break;case Pt.SR_FPT_ANGLE:if(St.SR_DE_FISH_PANORAMA_CEILING_360!=this.pRenderParam[t].nDisplayEffect&&St.SR_DE_FISH_PANORAMA_CEILING_180!=this.pRenderParam[t].nDisplayEffect&&St.SR_DE_FISH_PANORAMA_FLOOR_360!=this.pRenderParam[t].nDisplayEffect&&St.SR_DE_FISH_PANORAMA_FLOOR_180!=this.pRenderParam[t].nDisplayEffect)return pt.SR_ERR_NOT_SUPPORT;if((a=this.UpdateWideScanAngle(t,e.fAngle))!=pt.SR_OK)return a;this.pFishParam[t].fAngle=e.fAngle;break;case Pt.SR_FPT_ZOOM:if(St.SR_DE_FISH_PTZ_WALL!=this.pRenderParam[t].nDisplayEffect&&St.SR_DE_FISH_PTZ_CEILING!=this.pRenderParam[t].nDisplayEffect&&St.SR_DE_FISH_PTZ_FLOOR!=this.pRenderParam[t].nDisplayEffect)return pt.SR_ERR_NOT_SUPPORT;if((a=this.UpdateRangeParam(t,e.fZoom))!=pt.SR_OK)return a;this.pFishParam[t].fZoom=e.fZoom;break;case Pt.SR_FPT_PTZ:if(St.SR_DE_FISH_PTZ_WALL!=this.pRenderParam[t].nDisplayEffect&&St.SR_DE_FISH_PTZ_CEILING!=this.pRenderParam[t].nDisplayEffect&&St.SR_DE_FISH_PTZ_FLOOR!=this.pRenderParam[t].nDisplayEffect)return pt.SR_ERR_NOT_SUPPORT;if((a=this.UpdatePTZPosition(t,e.fPTZX,e.fPTZY,this.pRenderParam[t].fZoom,!0))!=pt.SR_OK)return a;this.pFishParam[t].fPTZX=e.fPTZX,this.pFishParam[t].fPTZY=e.fPTZY;break;case Pt.SR_FPT_NULL:default:return pt.SR_ERR_NOT_SUPPORT}return this.ComputePTZPoints(),pt.SR_OK}},{key:"GetFishParam",value:function(t,e){return t<0||t>=32||null==e||null==this.pFishParam[t]?pt.SR_ERR_PARAM:(e.fRXLeft=this.fRX1,e.fRXRight=this.fRX2,e.fRYTop=this.fRY1,e.fRYBottom=this.fRY2,e.bBlack=this.bBlack,e.bCut=this.pRenderParam[t].bCut,e.nFishParamType=this.pFishParam[t].nFishParamType,e.fAngle=this.pFishParam[t].fAngle,e.fZoom=this.pFishParam[t].fZoom,e.fPTZX=this.pFishParam[t].fPTZX,e.fPTZY=this.pFishParam[t].fPTZY,pt.SR_OK)}},{key:"GetRenderParam",value:function(t,e){return t<0||t>=32||null==e||null==this.pRenderParam[t]?pt.SR_ERR_PARAM:(e.fRXLeft=this.fRX1,e.fRXRight=this.fRX2,e.fRYTop=this.fRY1,e.fRYBottom=this.fRY2,e.bBlack=this.bBlack,e.fCosH=this.pRenderParam[t].fCosH,e.fSinH=this.pRenderParam[t].fSinH,e.fCosV=this.pRenderParam[t].fCosV,e.fSinV=this.pRenderParam[t].fSinV,e.fAngle=this.pRenderParam[t].fAngle,e.fZoom=this.pRenderParam[t].fZoom,e.nDisplayEffect=this.pRenderParam[t].nDisplayEffect,e.bCut=this.pRenderParam[t].bCut,pt.SR_OK)}},{key:"UpdateCircyeParam",value:function(t,e,a,r){if(t<=-.5||t>=.4||e<=.6||e>=1.5||a<=-.5||a>=.4||r<=.6||r>=1.5||t+e<=.8||t+e>=1.2||a+r<=.8||a+r>=1.2)return pt.SR_ERR_PARAM;if(t<0||e>1||a<0||r>1)for(var i=0;i<32;++i)if(null!=this.pRenderParam[i]&&(St.SR_DE_FISH_PTZ_CEILING==this.pRenderParam[i].nDisplayEffect||St.SR_DE_FISH_PTZ_FLOOR==this.pRenderParam[i].nDisplayEffect||St.SR_DE_FISH_PTZ_WALL==this.pRenderParam[i].nDisplayEffect)){var n={};if(n.fHAngleCos=this.pRenderParam[i].fCosH,n.fHAngleSin=this.pRenderParam[i].fSinH,n.fVAngleCos=this.pRenderParam[i].fCosV,n.fVAngleSin=this.pRenderParam[i].fSinV,0==this.IsInImage(t,e,a,r,n,this.pRenderParam[i].fZoom,this.pRenderParam[i].nDisplayEffect))return pt.SR_ERR_PARAM}return this.fRX1=t,this.fRX2=e,this.fRY1=a,this.fRY2=r,pt.SR_OK}},{key:"UpdateWideScanAngle",value:function(t,e){return null==this.pRenderParam[t]?pt.SR_ERR_CALL_ORDER:(St.SR_DE_FISH_PANORAMA_FLOOR_360==this.pRenderParam[t].nDisplayEffect||St.SR_DE_FISH_PANORAMA_FLOOR_180==this.pRenderParam[t].nDisplayEffect?this.pRenderParam[t].fAngle=e:St.SR_DE_FISH_PANORAMA_CEILING_360!=this.pRenderParam[t].nDisplayEffect&&St.SR_DE_FISH_PANORAMA_CEILING_180!=this.pRenderParam[t].nDisplayEffect||(this.pRenderParam[t].fAngle=-e),pt.SR_OK)}},{key:"ComputeAngleVertical",value:function(t,e,a,r){var i=t,n=e,s=Math.sqrt((n-.5)*(n-.5)+(i-.5)*(i-.5));if(s>.5)return pt.SR_ERR_PARAM;if(s<.001)return a.fVAngleCos=1,a.fVAngleSin=0,a.fHAngleCos=1,a.fHAngleSin=0,pt.SR_OK;if(r==St.SR_DE_FISH_PTZ_CEILING){a.fHAngleCos=(.5-n)/s,a.fHAngleSin=(.5-i)/s;var x=s*ut;a.fVAngleCos=Math.cos(x),a.fVAngleSin=Math.sin(x)}else{if(r!=St.SR_DE_FISH_PTZ_FLOOR)return pt.SR_ERR_PARAM;a.fHAngleCos=(n-.5)/s,a.fHAngleSin=(.5-i)/s;var o=s*ut;a.fVAngleCos=Math.cos(o),a.fVAngleSin=Math.sin(o)}return pt.SR_OK}},{key:"ComputeAngleHorizontal",value:function(t,e,a){var r,i,n,s,x,o,f,l=t,_=e;return(_-(x=.5))*(_-x)+(l-x)*(l-x)>.25?pt.SR_ERR_PARAM:(o=(_-x)/x*ut/2,r=Math.cos(o),i=Math.sin(o),(l-x)/x/r>1||(l-x)/x/r<-1?pt.SR_ERR_PARAM:(f=(l-x)/x/r*ut/2,n=Math.cos(f),s=Math.sin(f),a.fVAngleCos=r,a.fVAngleSin=i,a.fHAngleCos=n,a.fHAngleSin=s,pt.SR_OK))}},{key:"IsInImage",value:function(t,e,a,r,i,n,s){return 1!=this.IsOutofImage(t,e,a,r,i.fHAngleCos,i.fHAngleSin,i.fVAngleCos,i.fVAngleSin,n,1,.5,s)&&1!=this.IsOutofImage(t,e,a,r,i.fHAngleCos,i.fHAngleSin,i.fVAngleCos,i.fVAngleSin,n,0,.5,s)&&1!=this.IsOutofImage(t,e,a,r,i.fHAngleCos,i.fHAngleSin,i.fVAngleCos,i.fVAngleSin,n,.5,1,s)&&1!=this.IsOutofImage(t,e,a,r,i.fHAngleCos,i.fHAngleSin,i.fVAngleCos,i.fVAngleSin,n,.5,0,s)&&1!=this.IsOutofImage(t,e,a,r,i.fHAngleCos,i.fHAngleSin,i.fVAngleCos,i.fVAngleSin,n,0,0,s)&&1!=this.IsOutofImage(t,e,a,r,i.fHAngleCos,i.fHAngleSin,i.fVAngleCos,i.fVAngleSin,n,0,1,s)&&1!=this.IsOutofImage(t,e,a,r,i.fHAngleCos,i.fHAngleSin,i.fVAngleCos,i.fVAngleSin,n,1,1,s)&&1!=this.IsOutofImage(t,e,a,r,i.fHAngleCos,i.fHAngleSin,i.fVAngleCos,i.fVAngleSin,n,1,0,s)}},{key:"IsOutofImage",value:function(t,e,a,r,i,n,s,x,o,f,l,_){var h,c,u,d,p,m,S,R,P,y,b,E,g;if(b=(t+e)/2*1,E=(a+r)/2*(y=(e-t)/(r-a)),g=(e-t)/2*1,_==St.SR_DE_FISH_PTZ_CEILING){if(c=f-.5,u=(h=.5-l)*s+(m=o)*x,(S=m*s-h*x)<=0)return!0;P=Math.sqrt(c*c+u*u);var F=Math.sqrt(c*c+u*u+S*S),C=Math.asin(P/F)/1.5707963*.5;if(p=(-((c=C*c/P)*n+(u=C*u/P)*i)*g*2+E)/y,(d=((c*i-u*n)*g*2+b)/1)<0||d>1||p<0||p>1)return!0}if(_==St.SR_DE_FISH_PTZ_FLOOR){if(c=f-.5,u=(h=l-.5)*s+(m=o)*x,(S=m*s-h*x)<=0)return!0;P=Math.sqrt(c*c+u*u);var v=Math.sqrt(c*c+u*u+S*S),T=Math.asin(P/v)/1.5707963*.5;if(p=(((c=T*c/P)*n+(u=T*u/P)*i)*g*2+E)/y,(d=((c*i-u*n)*g*2+b)/1)<0||d>1||p<0||p>1)return!0}if(_==St.SR_DE_FISH_PTZ_WALL){if(d=(c=f-.5)*i+(S=(m=o)*s-(h=l-.5)*x)*n,p=u=h*s+m*x,(R=S*i-c*n)<=0)return!0;P=Math.sqrt(d*d+p*p);var D=Math.sqrt(d*d+p*p+R*R),A=Math.asin(P/D)/1.5707963*.5;if(p=(A*p/P*g*2+E)/y,(d=(A*d/P*g*2+b)/1)<0||d>1||p<0||p>1)return!0}return!1}},{key:"ComputePTZPoints",value:function(){if(-1==this.nWndPort)return pt.SR_ERR_CALL_ORDER;for(var t=0;t<32;++t)if(null!=this.pRenderParam[t]&&(St.SR_DE_FISH_PTZ_CEILING==this.pRenderParam[t].nDisplayEffect||St.SR_DE_FISH_PTZ_FLOOR==this.pRenderParam[t].nDisplayEffect||St.SR_DE_FISH_PTZ_WALL==this.pRenderParam[t].nDisplayEffect)){var e=pt.SR_OK;if(this.nPTZDisplayMode==yt.SR_DM_RANGE){if(e=this.GetRangePoints(t),pt.SR_OK!=e)continue;if(e=this.TransformPTZRangePoints(t),pt.SR_OK!=e)continue}else if(this.nPTZDisplayMode==yt.SR_DM_RECT&&(e=this.GetRectPoints(t),pt.SR_OK!=e))continue}return pt.SR_OK}},{key:"GetWndPort",value:function(){return this.nWndPort}},{key:"GetPTZDisplayMode",value:function(){return this.nPTZDisplayMode}},{key:"GetPTZColor",value:function(t,e){return t<0||t>=32||null==e?pt.SR_ERR_PARAM:(e.fA=this.stPTZColor[t].fA,e.fR=this.stPTZColor[t].fR,e.fG=this.stPTZColor[t].fG,e.fB=this.stPTZColor[t].fB,this.pPTZSetColor[t].bSetColor&&(Math.abs(this.pPTZSetColor[t].fA)<1e-6||Math.abs(this.pPTZSetColor[t].fR)<1e-6||Math.abs(this.pPTZSetColor[t].fG)<1e-6||Math.abs(this.pPTZSetColor[t].fB)<1e-6)&&(e.fA=this.pPTZSetColor[t].fA,e.fR=this.pPTZSetColor[t].fR,e.fG=this.pPTZSetColor[t].fG,e.fB=this.pPTZSetColor[t].fB),pt.SR_OK)}},{key:"SetPTZColor",value:function(t,e){return t<0||t>=32||null==e?pt.SR_ERR_PARAM:(this.pPTZSetColor[t].fR=e.fR,this.pPTZSetColor[t].fG=e.fG,this.pPTZSetColor[t].fB=e.fB,this.pPTZSetColor[t].fA=e.fA,this.pPTZSetColor[t].bSetColor=!0,pt.SR_OK)}},{key:"IsPTZSelected",value:function(t){return!(t<0||t>=32)&&this.bPTZSelected[t]}},{key:"GetPTZPort",value:function(t,e,a){if(-1==this.nWndPort)return pt.SR_ERR_CALL_ORDER;if(null==this.pRenderParam[this.nWndPort])return pt.SR_ERR_CALL_ORDER;var r=32,i={};i.fX=t,i.fY=e;for(var n=0;n<32;++n)this.bPTZSelected[n]=!1;if(this.nPTZDisplayMode==yt.SR_DM_RANGE){switch(this.pRenderParam[this.nWndPort].nDisplayEffect){case St.SR_DE_FISH_PANORAMA_FLOOR_360:this.GetPointPano2FishFloor(i,t,e);break;case St.SR_DE_FISH_PANORAMA_CEILING_360:this.GetPointPano2FishCeiling(i,t,e);break;case St.SR_DE_FISH_PANORAMA_WALL:this.GetPointPano2FishWall(i,t,e)}for(var s=0;s<32;++s)if(0!=this.nOriPTZPointNum[s]){var x={};x.fX=this.pOriPTZPoints[s][0].fX,x.fY=this.pOriPTZPoints[s][0].fY;var o={};o.fX=this.pOriPTZPoints[s][0].fX,o.fY=this.pOriPTZPoints[s][0].fY;for(var f=1;f<this.nOriPTZPointNum[s];++f)this.GetPTZRectange(x,o,this.pOriPTZPoints[s][f]);if(i.fX<=x.fX&&i.fX>=o.fX&&i.fY>=o.fY&&i.fY<=x.fY){r=s;break}}}else{if(this.nPTZDisplayMode!=yt.SR_DM_RECT)return pt.SR_ERR_NOT_SUPPORT;for(var l=0;l<32;++l)if(i.fX<=this.pRectPoints[l][2].fX&&i.fX>=this.pRectPoints[l][0].fX&&i.fY>=this.pRectPoints[l][0].fY&&i.fY<=this.pRectPoints[l][2].fY){r=l;break}}return r<32?(this.bPTZSelected[r]=!0,a.nPTZPort=r,pt.SR_OK):pt.SR_ERR_NOT_SUPPORT}},{key:"SetPTZPort",value:function(t){if(t<0||t>=32)return pt.SR_ERR_PARAM;for(var e=0;e<32;++e)this.bPTZSelected[e]=!1;if(this.nPTZDisplayMode==yt.SR_DM_RANGE){if(0==this.nOriPTZPointNum[t])return pt.SR_ERR_PARAM;this.bPTZSelected[t]=!0}else{if(0==this.nPTZRectNum[t])return pt.SR_ERR_PARAM;this.bPTZSelected[t]=!0}return pt.SR_OK}},{key:"GetPTZRectange",value:function(t,e,a){return a.fX<e.fX&&(e.fX=a.fX),a.fY<e.fY&&(e.fY=a.fY),a.fX>t.fX&&(t.fX=a.fX),a.fY>t.fY&&(t.fY=a.fY),pt.SR_OK}},{key:"GetPTZPoints",value:function(t,e,a){return t<0||t>=32?pt.SR_ERR_PARAM:null==this.pRenderParam[this.nWndPort]?pt.SR_ERR_CALL_ORDER:(yt.SR_DM_RANGE==a?null!=this.pOriPTZPoints[t]&&0!=this.nOriPTZPointNum[t]&&(e.pstPoints=this.pOriPTZPoints[t],e.nPointNum=this.nOriPTZPointNum[t]):yt.SR_DM_RECT==a&&null!=this.pRectPoints[t]&&(e.pstPoints=this.pRectPoints[t],e.nPointNum=4),pt.SR_OK)}},{key:"SetPTZDisplayMode",value:function(t){return this.nPTZDisplayMode=t,this.ComputePTZPoints()}},{key:"GetDisplayEffect",value:function(t){return t<0||t>=32||null==this.pRenderParam?St.SR_DE_NULL:this.pRenderParam[t].nDisplayEffect}},{key:"GetPTZFragmentPoints",value:function(t,e,a){if(t<0||t>=32)return pt.SR_ERR_PARAM;if(null==this.pPanoPTZPoints[t]||0==this.nPanoPTZPointNum[t])return pt.SR_ERR_PARAM;var r=this.nPTZFragmentNode[t][a];if(e.nPointNum=this.nPTZFragmentNode[t][a+1]-this.nPTZFragmentNode[t][a],e.nPointNum<0)return pt.SR_ERR_CALL_ORDER;e.pstPoints=[];for(var i=0;i<e.nPointNum;++i){var n={};n.fX=this.pPanoPTZPoints[t][r+i].fX,n.fY=this.pPanoPTZPoints[t][r+i].fY,e.pstPoints.push(n)}return pt.SR_OK}},{key:"GetPTZFragmentNum",value:function(t){return t<0||t>=32||0==this.nPTZFragmentNum[t]?0:this.nPTZFragmentNum[t]}},{key:"CalcPTZFragmentPoints",value:function(t){if(t<0||t>=32)return pt.SR_ERR_PARAM;if(null==this.pPanoPTZPoints[t]||0==this.nPanoPTZPointNum[t])return pt.SR_ERR_CALL_ORDER;this.nPTZFragmentNode[t][0]=0,this.nPTZFragmentNum[t]=1;for(var e=0,a=0;a<this.nPanoPTZPointNum[t]-1;a++)Math.abs(this.pPanoPTZPoints[t][a+1].fX-this.pPanoPTZPoints[t][a].fX)>.5&&(e=this.nPTZFragmentNum[t],this.nPTZFragmentNode[t][e]=a+1,this.nPTZFragmentNum[t]=this.nPTZFragmentNum[t]+1);var r=this.nPanoPTZPointNum[t];return Math.abs(this.pPanoPTZPoints[t][0].fX-this.pPanoPTZPoints[t][r-1].fX)<.5&&(this.pPanoPTZPoints[t][r].fX=this.pPanoPTZPoints[t][0].fX,this.pPanoPTZPoints[t][r].fY=this.pPanoPTZPoints[t][0].fY,this.nPanoPTZPointNum[t]=this.nPanoPTZPointNum[t]+1),e=this.nPTZFragmentNum[t],this.nPTZFragmentNode[t][e]=this.nPanoPTZPointNum[t],pt.SR_OK}},{key:"IsPortAllocated",value:function(t){return this.bPortAllocated[t]}},{key:"GetPointFish2PanoCeiling",value:function(t,e,a){if(null==this.pRenderParam[this.nWndPort])return pt.SR_ERR_CALL_ORDER;if(null==t)return pt.SR_ERR_PARAM;var r,i;r=(this.fRX2-this.fRX1)/(this.fRY2-this.fRY1),i=(this.fRX2-this.fRX1)/2*1;var n,s=0;(this.fRX2>1||this.fRY2>1||this.fRX1<0||this.fRY1<0)&&(this.fRX1<0&&(n=1*-this.fRX1)>s&&(s=n),this.fRX2>1&&(n=1*(this.fRX2-1))>s&&(s=n),this.fRY1<0&&(n=-this.fRY1*r)>s&&(s=n),this.fRY2>1&&(n=(this.fRY2-1)*r)>s&&(s=n));var x,o=s/i,f={fX:0,fY:0};if(Math.abs(e-.5)<1e-6&&Math.abs(a-.5)<1e-6)return pt.SR_ERR_NOT_SUPPORT;var l={},_={};l.fX=e-.5,l.fY=a-.5,_.fX=-.5*Math.sin(this.pRenderParam[this.nWndPort].fAngle),_.fY=.5*Math.cos(this.pRenderParam[this.nWndPort].fAngle);var h=Math.sqrt(l.fX*l.fX+l.fY*l.fY),c=Math.sqrt(_.fX*_.fX+_.fY*_.fY);return x=Math.acos((l.fX*_.fX+l.fY*_.fY)/(h*c)),l.fX*_.fY-l.fY*_.fX>0&&(x=6.2831852-x),f.fX=x/6.2831853,f.fY=(2*(.5-h)-o)/(.8-o),f.fY>=0&&f.fX>=0&&f.fY<=1&&f.fX<=1?(t.fX=f.fX,t.fY=f.fY,pt.SR_OK):pt.SR_ERR_PARAM}},{key:"GetPointFish2PanoFloor",value:function(t,e,a){if(null==this.pRenderParam[this.nWndPort])return pt.SR_ERR_CALL_ORDER;if(null==t)return pt.SR_ERR_PARAM;var r,i;r=(this.fRX2-this.fRX1)/(this.fRY2-this.fRY1),i=(this.fRX2-this.fRX1)/2*1;var n,s=0;(this.fRX2>1||this.fRY2>1||this.fRX1<0||this.fRY1<0)&&(this.fRX1<0&&(n=1*-this.fRX1)>s&&(s=n),this.fRX2>1&&(n=1*(this.fRX2-1))>s&&(s=n),this.fRY1<0&&(n=-this.fRY1*r)>s&&(s=n),this.fRY2>1&&(n=(this.fRY2-1)*r)>s&&(s=n));var x,o=s/i,f={fX:0,fY:0};if(Math.abs(e-.5)<1e-6&&Math.abs(a-.5)<1e-6)return pt.SR_ERR_NOT_SUPPORT;var l={},_={};l.fX=e-.5,l.fY=a-.5,_.fX=-.5*Math.sin(this.pRenderParam[this.nWndPort].fAngle),_.fY=.5*Math.cos(this.pRenderParam[this.nWndPort].fAngle);var h=Math.sqrt(l.fX*l.fX+l.fY*l.fY),c=Math.sqrt(_.fX*_.fX+_.fY*_.fY);return x=Math.acos((l.fX*_.fX+l.fY*_.fY)/(h*c)),l.fX*_.fY-l.fY*_.fX>0&&(x=6.2831852-x),f.fX=1-x/6.2831853,f.fY=1-(2*(.5-h)-o)/(.8-o),f.fY>=0&&f.fX>=0&&f.fY<=1&&f.fX<=1?(t.fX=f.fX,t.fY=f.fY,pt.SR_OK):pt.SR_ERR_PARAM}},{key:"GetPointFish2PanoWall",value:function(t,e,a){if(null==this.pRenderParam[this.nWndPort])return pt.SR_ERR_CALL_ORDER;if(null==t)return pt.SR_ERR_PARAM;var r,i;r=(this.fRX2-this.fRX1)/(this.fRY2-this.fRY1),i=(this.fRX2-this.fRX1)/2*1;var n,s,x,o,f,l=0,_=1,h=.1,c=.9;this.fRX1<0&&(n=1*-this.fRX1,l=n/=2*i),this.fRX2>1&&(s=1*(this.fRX2-1),_=1-(s/=2*i)),this.fRY1<0&&(x=-this.fRY1*r,h=(x/=2*i)>.1?x:.1),this.fRY2>1&&(o=(this.fRY2-1)*r,c=(o/=2*i)>1-.9?1-o:.9);var u={fX:0,fY:0},d=2*e*i,p=2*a*i;return f=Math.sqrt(i*i-(p-i)*(p-i)),Math.abs(f)<1e-6?pt.SR_ERR_PARAM:(e=i*(d-i)/f+i,a=p,u.fX=(e-2*l*i)/(2*(_-l)*i),u.fY=(a-2*h*i)/(2*(c-h)*i),u.fY>=0&&u.fX>=0&&u.fY<=1&&u.fX<=1?(t.fX=u.fX,t.fY=u.fY,pt.SR_OK):pt.SR_ERR_PARAM)}},{key:"UpdateRangeParam",value:function(t,e){if(null==this.pRenderParam[t])return pt.SR_ERR_CALL_ORDER;if(e<1e-5||e>.6)return pt.SR_ERR_PARAM;var a=0;return St.SR_DE_FISH_PTZ_WALL!=this.pRenderParam[t].nDisplayEffect&&St.SR_DE_FISH_PTZ_CEILING!=this.pRenderParam[t].nDisplayEffect&&St.SR_DE_FISH_PTZ_FLOOR!=this.pRenderParam[t].nDisplayEffect||(a=7*e+.8,this.IsInImage(this.fRX1,this.fRX2,this.fRY1,this.fRY2,this.pRenderParam[t].fCosH,this.pRenderParam[t].fSinH,this.pRenderParam[t].fCosV,this.pRenderParam[t].fSinV,a,this.pRenderParam[t].nDisplayEffect))?(this.pRenderParam[t].fZoom=a,pt.SR_OK):pt.SR_ERR_PARAM}}]),t}(),Yt=ht.Dv,Gt=ht.CF,Xt=ht.bC,Jt=function(){function a(){t(this,a),this.canvas=null,this.ctx=null,this.regionSx=0,this.regionSy=0,this.regionSw=0,this.regionSh=0,this.needRect=!1,this.bAntialias=!1,this.bRecreateAntia=!1,this.pfuncCBIn=null,this.pUserIn=null,this.pfuncCBOut=null,this.pUserOut=null}return e(a,[{key:"SR_Init",value:function(t){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.ctx||console.log("your browser does not support 2d render")}},{key:"SR_Draw",value:function(t){return this.needRect?this.ctx.drawImage(t,this.regionSx,this.regionSy,this.regionSw,this.regionSh,0,0,this.canvas.width,this.canvas.height):this.ctx.drawImage(t,0,0,t.displayWidth,t.displayHeight,0,0,this.canvas.width,this.canvas.height),null!=this.pfuncCBIn&&this.pfuncCBIn(this.pUserIn),1}},{key:"GetCanvasData",value:function(t){console.log("%c start time:"+(new Date).getMinutes()+":"+(new Date).getSeconds()+"."+(new Date).getMilliseconds(),"color: blue");var e=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height);console.log("%c 2 time:"+(new Date).getMinutes()+":"+(new Date).getSeconds()+"."+(new Date).getMilliseconds(),"color: blue");var a=document.createElement("canvas"),r=a.getContext("2d");a.width=this.canvas.width,a.height=this.canvas.height,r.putImageData(e,0,0);var i=a.toDataURL(),n=document.createElement("a");n.download=(new Date).getTime()+".jpeg",n.href=i,n.dataset.downloadurl=["image/jpeg",n.download,n.href].join(":"),document.body.appendChild(n),n.click(),document.body.removeChild(n),console.log("%c end time:"+(new Date).getMinutes()+":"+(new Date).getSeconds()+"."+(new Date).getMilliseconds(),"color: blue")}},{key:"SR_DelSubPort",value:function(t){return 0}},{key:"SR_AddSubPort",value:function(t){return 0}},{key:"SR_SetDisplayRect",value:function(t,e,a,r){this.regionSx=t,this.regionSy=e,this.regionSw=a,this.regionSh=r,this.needRect=!0}},{key:"SR_Destroy",value:function(){this.canvas=null,this.ctx=null,this.regionSx=0,this.regionSy=0,this.regionSw=0,this.regionSh=0,this.needRect=!1}},{key:"SR_SetCanvasSize",value:function(t,e){this.canvas.width=t,this.canvas.height=e}},{key:"SR_GetCanvasSize",value:function(){console.log("canvas width:"+this.canvas.width+",height:"+this.canvas.height)}},{key:"SR_SetAntialias",value:function(t){return t!=this.bAntialias?(this.bAntialias=t,this.bRecreateAntia=!0):this.bRecreateAntia=!1,this.bRecreateAntia&&(this.bAntialias?(this.canvas.width=5*this.canvas.width,this.canvas.height=5*this.canvas.height,this.canvas.style.transform="scale(0.2)",this.canvas.style.transformOrigin="0 0"):(this.canvas.width=this.canvas.width/5,this.canvas.height=this.canvas.height/5,this.canvas.style.transform="scale(1)",this.canvas.style.transformOrigin="0 0")),1}},{key:"SR_SetCallBack",value:function(t,e,a){switch(a){case Xt.SRCALLBACKTYPE.SR_CBT_NULL:this.pfuncCBIn=t,this.pUserIn=e;break;case Xt.SRCALLBACKTYPE.SR_CBT_OUT:this.pfuncCBOut=t,this.pUserOut=e;break;default:return 0}return 1}},{key:"SR_DrawFont",value:function(t,e,a,r,i,n,s,x,o){var f=[],l={};return l.bBackground=n,l.nFontWidth=r,l.nFontHeight=i,l.pstBGColor=s,l.pstFontColor=a,l.pString=t,l.pstStartPos=e,l.fRotateAngle=x,l.pFontFamily=o,f.push(l),this.SR_DrawFontEx(f,1),1}},{key:"SR_DrawFontEx",value:function(t,e){for(var a=0;a<e;a++){this.ctx.textBaseline="top";var r=t[a].nFontWidth,i=t[a].nFontHeight,n=(r=Math.round(r))<(i=Math.round(i))?r:i;this.ctx.font=n.toString()+"px "+t[a].pFontFamily;var s=parseInt(255*t[a].pstFontColor.fR),x=parseInt(255*t[a].pstFontColor.fG),o=parseInt(255*t[a].pstFontColor.fB),f=s<16?"0"+s.toString(16):s.toString(16),l=x<16?"0"+x.toString(16):x.toString(16),_=o<16?"0"+o.toString(16):o.toString(16);this.ctx.fillStyle="#"+f+l+_,this.ctx.globalAlpha=t[a].pstFontColor.fA,this.ctx.fillText(t[a].pString,t[a].pstStartPos.fX*this.canvas.width,t[a].pstStartPos.fY*this.canvas.height)}return 1}},{key:"SR_DrawImage",value:function(t,e,a,r,i,n){return 1}},{key:"SR_DrawLinesEx",value:function(t,e,a,r){return 1}}]),a}(),Zt=16,jt=16,zt=30,Kt=function(){function a(e){t(this,a),this.oVideoRenderHandle=e,this.renderEngine="webgl",this.oVideoHandle=null,this.mainCanvasID=null,this.curTimestamp=0,this.mainSubPort=0,this.mainVaildSubPort=0,this.mainFECCorrect=Xt.SRDISPLAYEFFECT.SR_DE_NULL,this.FECErrorCode=0,this.subPortNum=0,this.FECShowMode=Xt.SRPTZDISPLAYMODE.SR_DM_RANGE,this.pFishParamManager=null,this.enPixelFormat=Xt.SRPIXELFORMAT.SR_PF_NULL,this.InitFECParam(),this.nTimePerFrame=0,this.nFrameRate=0,this.privateNormalLinesInfo=[],this.maxNormalPrivateLineTimeStamp=0,this.curNormalLinesInfo=null,this.privateThermalLinesInfo=[],this.curThermalLinesInfo=null,this.privateTemLinesInfo=[],this.maxTemPrivateLineTimeStamp=0,this.curTemLinesInfo=null,this.m_nTEMDrawLinescount=0,this.m_nTEMDrawFontscount=0,this.privateTargetLinesInfo=[],this.maxTargetPrivateLineTimeStamp=0,this.curTargetLinesInfo=null,this.privateMDLinesInfo=[],this.maxMDPrivateLineTimeStamp=0,this.curMDLinesInfo=null,this.privateExactLinesInfo=[],this.maxExactPrivateLineTimeStamp=0,this.curExactLinesInfo=null,this.privateExactRuleLinesInfo=[],this.maxExactRulePrivateLineTimeStamp=0,this.curExactRuleLinesInfo=null,this.DrawlinesParamArray=[],this.DrawlinesParamArrayAllPointNum=0,this.bDrawlinesParamArrayFill=0,this.DrawMosaiclinesParamArray=[],this.DrawTargetlinesParamArray=[],this.DrawPOSFontsParamArray=[],this.DrawTargetEventIDList=[],this.privateNormalFontsInfo=[],this.maxNormalPrivateFontTimeStamp=0,this.curNormalFontsInfo=null,this.curNormalPOSFontsInfo=null,this.privateTemFontsInfo=[],this.maxTemPrivateFontTimeStamp=0,this.curTemFontsInfo=null,this.privateTargetFontsInfo=[],this.maxTargetPrivateFontTimeStamp=0,this.curTargetFontsInfo=null,this.privateExactPOSFontsInfo=[],this.maxExactPOSPrivateFontTimeStamp=0,this.curExactPOSFontsInfo=null,this.privateExactFontsInfo=[],this.maxExactPrivateFontTimeStamp=0,this.curExactFontsInfo=null,this.DrawFontParamArray=[],this.privateImageInfo=[],this.maxPrivateImageTimeStamp=0,this.curImagesInfo={},this.privatePNGImageInfo=[],this.m_bEnableIVSEx=!0,this.m_bEnableMDEx=!0,this.m_bEnablePICEx=!1,this.m_bDisPos=!1,this.m_bEnableTEMEx=!1,this.m_bEnableTEMBox=!1,this.m_bEnableTEMLine=!1,this.m_bEnableTEMPoint=!1,this.m_bEnableTrackEx=!1,this.m_bEnableTrackPeople=!0,this.m_bEnableTrackVehicle=!0,this.m_bEnableThermal=!1,this.m_bEnableThermalFireMask=!1,this.m_bEnableThermalRuleGas=!1,this.m_bEnableThermalTargetGas=!1,this.m_bEnableFIREEx=!0,this.m_bEnableFireDis=!0,this.m_bEnableFireMax=!1,this.m_bEnableFireMaxPos=!0,this.m_bEnableFireDistance=!0,this.bSRCallBackFlag=!1,this.hasSetFECParamManager=!1,this.panoramaDisplayEffect=0,this.viewParamType=3,this.viewParamValue=.2,this.pstWaterFontParamArray=[];for(var r=0;r<Zt;r++)this.pstWaterFontParamArray[r]=[];this.pstWaterFontParam=null,this.pWaterImageParam=[],this.waterMarkImageIndex=0,this.waterMarkImageMax=1,this.baseWaterMarkImageTime=0,this.finishDecodeImage=!1,this.aPOSAdaptBuf=[],this.textCanvas=null,this.MosaicType=0,this.MosaicSize=0,this.MosaicColorR=0,this.MosaicColorG=0,this.MosaicColorB=0,this.MosaicColorA=0}return e(a,[{key:"InitDisplay",value:function(t,e,a){if(this.renderEngine=e,this.mainCanvasID=t,this.printfFlag=this.oVideoRenderHandle.printfFlag,"2d"===this.renderEngine||"2D"===this.renderEngine)this.oVideoHandle=new Jt,this.printfFlag>=0&&console.log("2d render");else{if(this.oVideoHandle=new Gt,this.mainFECCorrect!=Xt.SRDISPLAYEFFECT.SR_DE_NULL)null==this.pFishParamManager&&(this.pFishParamManager=new Yt),this.oVideoHandle.SR_SetFishParamManager(this.pFishParamManager),this.hasSetFECParamManager=!0;else{null==this.pFishParamManager&&(this.pFishParamManager=new Yt),this.oVideoHandle.SR_SetFishParamManager(this.pFishParamManager),this.hasSetFECParamManager=!0;var r=Xt.SRDISPLAYEFFECT.SR_DE_NULL;r=1==this.panoramaDisplayEffect?Xt.SRDISPLAYEFFECT.SR_DE_PANORAMA_SPHERE:3==this.panoramaDisplayEffect?Xt.SRDISPLAYEFFECT.SR_DE_PANORAMA_PLANET:Xt.SRDISPLAYEFFECT.SR_DE_NULL,this.mainFECCorrect=r}this.printfFlag>=0&&console.log("webgl render this.printfFlag:"+this.printfFlag)}return this.enPixelFormat=a,this.oVideoHandle.SR_Init(t,a),this.mainVaildSubPort=this.oVideoHandle.SR_AddSubPort(this.mainFECCorrect),-1==this.mainVaildSubPort?(console.info("%c InitDisplay SR_AddSubPort error subport:%d","color: red",this.mainVaildSubPort),0):(this.mainFECCorrect==Xt.SRDISPLAYEFFECT.SR_DE_PANORAMA_SPHERE&&this.oVideoHandle.SR_SetViewParam(this.viewParamType,this.viewParamValue),1)}},{key:"ReleaseDisplay",value:function(){if(null!=this.oVideoHandle&&(this.oVideoHandle.SR_DelSubPort(this.mainVaildSubPort),this.oVideoHandle.SR_Destroy(),this.oVideoHandle=null),this.subPortNum>0)for(var t=1;t<Zt;t++)0!=this.stFishEyeManager[t].nSubPort&&null!=this.stFishEyeManager[t].sCanvasID&&0!=this.stFishEyeManager[t].bInited&&(this.FEC_Disable(t),this.FEC_DelPort(t));for(var e=0;e<Zt;e++)this.stFishEyeManager[e].pRender=null;return this.stFishEyeManager.splice(0,this.stFishEyeManager.length),this.stFishParam.splice(0,this.stFishParam.length),null!=this.pFishParamManager&&(this.pFishParamManager.DeInit(),this.pFishParamManager=null),this.FECShowMode=Xt.SRPTZDISPLAYMODE.SR_DM_RANGE,this.DeInitPrivateParam(),1}},{key:"DeInitPrivateParam",value:function(){this.privateNormalLinesInfo.splice(0,this.privateNormalLinesInfo.length),this.curNormalLinesInfo=null,this.privateThermalLinesInfo.splice(0,this.privateThermalLinesInfo.length),this.curThermalLinesInfo=null,this.privateTemLinesInfo.splice(0,this.privateTemLinesInfo.length),this.curTemLinesInfo=null,this.privateTargetLinesInfo.splice(0,this.privateTargetLinesInfo.length),this.curTargetLinesInfo=null,this.privateMDLinesInfo.splice(0,this.privateMDLinesInfo.length),this.curMDLinesInfo=null,this.privateExactLinesInfo.splice(0,this.privateExactLinesInfo.length),this.curExactLinesInfo=null,this.privateExactRuleLinesInfo.splice(0,this.privateExactRuleLinesInfo.length),this.curExactRuleLinesInfo=null,this.privateNormalFontsInfo.splice(0,this.privateNormalFontsInfo.length),this.curNormalFontsInfo=null,this.curNormalPOSFontsInfo=null,this.privateTemFontsInfo.splice(0,this.privateTemFontsInfo.length),this.curTemFontsInfo=null,this.privateTargetFontsInfo.splice(0,this.privateTargetFontsInfo.length),this.curTargetFontsInfo=null,this.privateExactPOSFontsInfo.splice(0,this.privateExactPOSFontsInfo.length),this.curExactPOSFontsInfo=null,this.privateExactFontsInfo.splice(0,this.privateExactFontsInfo.length),this.curExactFontsInfo=null,this.privateImageInfo.splice(0,this.privateImageInfo.length),this.curImagesInfo=null,this.privatePNGImageInfo.splice(0,this.privatePNGImageInfo.length),this.DrawlinesParamArray.splice(0,this.DrawlinesParamArray.length),this.DrawTargetlinesParamArray.splice(0,this.DrawTargetlinesParamArray.length),this.DrawMosaiclinesParamArray.splice(0,this.DrawMosaiclinesParamArray.length),this.DrawPOSFontsParamArray.splice(0,this.DrawPOSFontsParamArray.length),this.DrawTargetEventIDList.splice(0,this.DrawTargetEventIDList.length),this.DrawFontParamArray.splice(0,this.DrawFontParamArray.length);for(var t=0;t<Zt;t++)this.pstWaterFontParamArray[t].splice(0,this.pstWaterFontParamArray[t].length);this.pWaterImageParam.splice(0,this.pWaterImageParam.length),this.bSRCallBackFlag=!1,this.textCanvas=null,this.curLinesInfo=null,this.pstWaterFontParam=null}},{key:"DisplayFrame",value:function(t,e,a,r,i,n,s,x){var o=this;return new Promise((function(f){null!=t&&(o.curTimestamp=r),o.bSRCallBackFlag||(null!=o.oVideoHandle&&o.oVideoHandle.SR_SetCallBack(o.WebGLDisplayCallBack,o,Xt.SRCALLBACKTYPE.SR_CBT_NULL),o.bSRCallBackFlag=!0);var l=1;if(2==o.panoramaDisplayEffect&&(e==2*a?o.SetPanoramaDisplayEffect(1):o.SetPanoramaDisplayEffect(0)),null!=t&&(o.nFrameRate=s,o.nTimePerFrame=1e3/s,0==x&&(o.FindIntelNodefromList(o.curTimestamp),o.CheckLinesInfo(),o.CheckFontsInfo()),null!=o.oVideoHandle&&1==(l=o.oVideoHandle.SR_UpdateFrameData(t,e,a,i,n))&&(l=o.oVideoHandle.SR_Display(!1)),o.subPortNum>0))for(var _=1;_<Zt;_++)0!=o.stFishEyeManager[_].nSubPort&&null!=o.stFishEyeManager[_].sCanvasID&&0!=o.stFishEyeManager[_].bInited&&null!=o.stFishEyeManager[_].pRender&&1==(l=o.stFishEyeManager[_].pRender.SR_UpdateFrameData(t,e,a,null,null))&&(l=o.stFishEyeManager[_].pRender.SR_Display(!1));f({timestamp:o.curTimestamp,DrawRet:l})}))}},{key:"SetDisplayRect",value:function(t,e,a,r){return null!=this.oVideoHandle&&(this.oVideoHandle.SR_SetDisplayRect(t,e,a,r,Xt.SRSETRECTTYPE.SR_SRT_SRC),null!=this.pstWaterFontParam&&this.pstWaterFontParam.nColorAdapt&&(this.pstWaterFontParamArray[0].splice(0,this.pstWaterFontParamArray[0].length),this.CalculateWaterMarkParam(this.oVideoHandle,0,this.pstWaterFontParam))),1}},{key:"SetCanvasSize",value:function(t,e,a){var r=this.oVideoHandle;if(a>0&&(r=this.stFishEyeManager[a].pRender),null!=r){if(r.SR_SetCanvasSize(t,e),0!=this.pstWaterFontParamArray[a].length&&null!=this.pstWaterFontParam)if(1==this.pstWaterFontParam.pstCanvasAdapt.nCanvasAdaptMode)this.pstWaterFontParamArray[a].splice(0,this.pstWaterFontParamArray[a].length),this.CalculateWaterMarkParam(r,a,this.pstWaterFontParam);else if(2==this.pstWaterFontParam.pstCanvasAdapt.nCanvasAdaptMode){var i=this.mainCanvasID.width,n=this.mainCanvasID.height;a>0&&(i=this.stFishEyeManager[a].sCanvasID.width,n=this.stFishEyeManager[a].sCanvasID.height);for(var s=0;s<this.pstWaterFontParamArray[a].length;++s)this.pstWaterFontParamArray[a][s].nFontWidth=this.pstWaterFontParam.pstFontSize.nFontWidth*i/this.pstWaterFontParam.pstCanvasAdapt.nBaseCanvasWidth,this.pstWaterFontParamArray[a][s].nFontHeight=this.pstWaterFontParam.pstFontSize.nFontHeight*n/this.pstWaterFontParam.pstCanvasAdapt.nBaseCanvasHeight}return 1}return 0}},{key:"GetCanvasSize",value:function(){return null!=this.oVideoHandle?this.oVideoHandle.SR_GetCanvasSize():0}},{key:"SetAntialias",value:function(t){return null!=this.oVideoHandle?this.oVideoHandle.SR_SetAntialias(t):0}},{key:"SetD3DPostProcess",value:function(t,e){var a=1;return null!=this.oVideoHandle?(a=this.oVideoHandle.SR_SetImagePostProcess(t,e),null!=this.pstWaterFontParam&&this.pstWaterFontParam.nColorAdapt&&(this.pstWaterFontParamArray[0].splice(0,this.pstWaterFontParamArray[0].length),this.CalculateWaterMarkParam(this.oVideoHandle,0,this.pstWaterFontParam))):a=0,a}},{key:"InitFECParam",value:function(){this.stFishEyeManager=[];for(var t=0;t<Zt;t++)this.stFishEyeManager[t]={},this.stFishEyeManager[t].pRender=null,this.stFishEyeManager[t].nSubPort=0,this.stFishEyeManager[t].sCanvasID=null,this.stFishEyeManager[t].bUsed=0,this.stFishEyeManager[t].bInited=0,this.stFishEyeManager[t].nValidSubPort=0,this.stFishEyeManager[t].emPlaceType=3,this.stFishEyeManager[t].emCorrectType=0,this.stFishEyeManager[t].emEffect=Xt.SRDISPLAYEFFECT.SR_DE_FISH_ORIGINAL;this.stFishParam=[];for(var e=0;e<Zt;e++)this.stFishParam[e]={},this.stFishParam[e].nUpDateType=0,this.stFishParam[e].stPTZParam={},this.stFishParam[e].stPTZParam.fPTZPositionX=0,this.stFishParam[e].stPTZParam.fPTZPositionY=0,this.stFishParam[e].stCycleParam={},this.stFishParam[e].stCycleParam.fRadiusLeft=0,this.stFishParam[e].stCycleParam.fRadiusRight=0,this.stFishParam[e].stCycleParam.fRadiusTop=0,this.stFishParam[e].stCycleParam.fRadiusBottom=0,this.stFishParam[e].fZoom=0,this.stFishParam[e].fWideScanOffset=0,this.stFishParam[e].stPTZColor={},this.stFishParam[e].stPTZColor.nR=0,this.stFishParam[e].stPTZColor.nG=0,this.stFishParam[e].stPTZColor.nB=0,this.stFishParam[e].stPTZColor.nAlpha=0,this.stFishParam[e].stPTZSelect={},this.stFishParam[e].stPTZSelect.fTop=0,this.stFishParam[e].stPTZSelect.fBottom=0,this.stFishParam[e].stPTZSelect.fLeft=0,this.stFishParam[e].stPTZSelect.fRight=0,this.stFishParam[e].nCut=0}},{key:"FEC_SetCanvasID",value:function(t){return this.mainFECCorrect=Xt.SRDISPLAYEFFECT.SR_DE_FISH_ORIGINAL,1}},{key:"FEC_ResetCorrectType",value:function(t,e,a){if(!1===this.hasSetFECParamManager&&(null==this.pFishParamManager&&(this.pFishParamManager=new Yt),this.oVideoHandle.SR_SetFishParamManager(this.pFishParamManager),this.hasSetFECParamManager=!0),0!=a&&a!=G&&a!=X&&a!=Z&&a!=Y&&a!=J&&a!=j&&a!=z&&a!=K&&a!=q&&a!=Q)return console.log("%c hardDecoder not support correctType:%d","color:red",a),this.FECErrorCode=w,0;if(1!=this.FECParamJudge(t,e,a))return 0;var r=Xt.SRDISPLAYEFFECT.SR_DE_FISH_ORIGINAL;if(r=this._ConvertDisplayEffect(e,a),0==t&&null==this.stFishEyeManager[t].pRender&&(this.stFishEyeManager[t].pRender=this.oVideoHandle,this.stFishEyeManager[t].nSubPort=t,this.stFishEyeManager[t].sCanvasID=this.mainCanvasID,this.stFishEyeManager[t].bUsed=1,this.stFishEyeManager[t].bInited=1,this.stFishEyeManager[t].nValidSubPort=this.mainVaildSubPort,this.stFishEyeManager[t].emPlaceType=e,this.stFishEyeManager[t].emCorrectType=a,this.stFishEyeManager[t].emEffect=r,this.mainFECCorrect=r),null!=this.stFishEyeManager[t].pRender){this.stFishEyeManager[t].pRender.SR_DelSubPort(this.stFishEyeManager[t].nValidSubPort);var i=this.stFishEyeManager[t].pRender.SR_AddSubPort(r);if(0==t?this.oVideoHandle.SR_SetCallBack(this.WebGLDisplayCallBack,this,Xt.SRCALLBACKTYPE.SR_CBT_NULL):this.stFishEyeManager[t].pRender.SR_SetCallBack(this.WebGLDisplaySubCallBack,{nUser:this,handle:this.stFishEyeManager[t].pRender,nSubPort:t},Xt.SRCALLBACKTYPE.SR_CBT_NULL),null!=this.pstWaterFontParam&&this.pstWaterFontParam.nColorAdapt&&(this.pstWaterFontParamArray[t].splice(0,this.pstWaterFontParamArray[t].length),this.CalculateWaterMarkParam(this.stFishEyeManager[t].pRender,t,this.pstWaterFontParam)),-1==i)return console.info("%c FEC_ResetCorrectType SR_AddSubPort error subport:%d","color: red",i),0;if(this.stFishEyeManager[t].nValidSubPort=i,this.stFishEyeManager[t].emPlaceType=e,this.stFishEyeManager[t].emCorrectType=a,this.stFishEyeManager[t].emEffect=r,Z<=this.stFishEyeManager[t].emCorrectType){var n=this.stFishEyeManager[t].pRender.SR_SetRenderState(Xt.SRRENDERSTATETYPE.SR_RST_BACK_CULL,0);Xt.ERRCODE.SR_OK!=n&&console.log(">>>VideoRender.js SR_SetRenderState failed ret：%08x\n",n)}}return this.FECShowMode>0&&null!=this.stFishEyeManager[t].pRender&&this.stFishEyeManager[t].pRender.SR_SetPTZDisplayMode(this.FECShowMode),0==t&&(this.mainVaildSubPort=this.stFishEyeManager[t].nValidSubPort),1}},{key:"FEC_GetPort",value:function(t,e){if(0!=e&&e!=G&&e!=X&&e!=Z&&e!=Y&&e!=J&&e!=j&&e!=q&&e!=Q)return console.log("%c 20231112 hardDecoder not support emCorrectType:%d","color:red",e),this.FECErrorCode=w,-1;var a;if(1!=this.FECParamJudge(-1,t,e))return console.log("VideoRender.js FEC_GetPort FECParamJudge Get error"),-1;var r=0;for(a=1;a<Zt;a++)if(0==this.stFishEyeManager[a].nSubPort&&0==this.stFishEyeManager[a].bUsed){this.stFishEyeManager[a].nSubPort=a,this.stFishEyeManager[a].nValidSubPort=-1,this.stFishEyeManager[a].bUsed=1,this.stFishEyeManager[a].emPlaceType=t,this.stFishEyeManager[a].emCorrectType=e,r=a;break}if(Zt==a)return console.info("%c FEC_GetPort-12 fish subport max","color: red"),this.FECErrorCode=1284,-1;var i=Xt.SRDISPLAYEFFECT.SR_DE_FISH_ORIGINAL;return i=this._ConvertDisplayEffect(this.stFishEyeManager[r].emPlaceType,this.stFishEyeManager[r].emCorrectType),Xt.SRDISPLAYEFFECT.SR_DE_FISH_ORIGINAL!=i?(0==this.stFishEyeManager[r].bInited&&(this.stFishEyeManager[r].emEffect=i,this.stFishEyeManager[r].bInited=0,this.stFishParam[r].fZoom=.005,this.stFishParam[r].stPTZParam.fPTZPositionX=.5,this.stFishParam[r].stPTZParam.fPTZPositionY=.5,this.stFishParam[r].fWideScanOffset=0),this.FECErrorCode=0,this.subPortNum++,r):r<Zt&&0==this.stFishEyeManager[r].bInited?(this.stFishEyeManager[r].emEffect=i,this.stFishEyeManager[r].bInited=0,this.stFishParam[r].fZoom=0,this.stFishParam[r].stPTZParam.fPTZPositionX=0,this.stFishParam[r].stPTZParam.fPTZPositionY=0,this.stFishParam[r].fWideScanOffset=0,this.FECErrorCode=0,this.subPortNum++,r):(this.stFishEyeManager[a].pRender=null,this.stFishEyeManager[a].nSubPort=0,this.stFishEyeManager[a].sCanvasID=null,this.stFishEyeManager[a].bUsed=0,this.stFishEyeManager[a].bInited=0,this.stFishEyeManager[a].nValidSubPort=0,this.stFishEyeManager[a].emPlaceType=3,this.stFishEyeManager[a].emCorrectType=0,this.stFishEyeManager[a].emEffect=Xt.SRDISPLAYEFFECT.SR_DE_FISH_ORIGINAL,this.FECErrorCode=k,-1)}},{key:"FECParamJudge",value:function(t,e,a){if(0!=t){if(0==a||a==G||a==X||a==J||a==K||a==q||a==Q)return console.log("VideoRender.js FECParamJudge 1 emCorrectType:"+a),this.FECErrorCode=k,0;if(this.stFishEyeManager[0].emCorrectType==Q||this.stFishEyeManager[0].emCorrectType==q)return this.FECErrorCode=k,console.log("VideoRender.js FECParamJudge 2 emCorrectType:"+a),0}if(0==t&&(q==a||Q==a))for(var r=1;r<Zt;r++)if(this.stFishEyeManager[r].bUsed)return this.FECErrorCode=k,console.log("VideoRender.js FECParamJudge 3 subPort:"+t+",emCorrectType:"+a),0;if(!(2!=e&&3!=e||J!=a&&q!=a&&Q!=a))return console.info("%c VideoRender.js FECParamJudge 4 floor and ceiling not support lat","color: red"),this.FECErrorCode=k,0;if(1==e&&(j==a||z==a||G==a))return console.info("%c VideoRender.js FECParamJudge 5 wall not support cylinger","color: red"),this.FECErrorCode=k,0;if(1!=e&&2!=e&&3!=e)return console.info("%c VideoRender.js FECParamJudge 6 emPlaceType only support floor, ceiling and wall","color: red"),this.FECErrorCode=MP_E_SUPPORT,0;if(0!=a&&a!=Y&&a!=G&&a!=X&&a!=J&&a!=Z&&a!=j&&a!=z&&a!=K&&a!=q&&a!=Q)return console.info("%c VideoRender.js FECParamJudge 7 emCorrectType error","color: red"),this.FECErrorCode=MP_E_SUPPORT,0;for(var i=0;i<Zt;i++){if(this.stFishEyeManager[i].bUsed&&this.stFishEyeManager[i].emPlaceType!=e)return console.info("%c VideoRender.js FECParamJudge 8 emPlaceType changed","color: red"),this.FECErrorCode=1303,0;if(i!=t){if(this.stFishEyeManager[i].bUsed&&this.stFishEyeManager[i].emCorrectType!=Y&&this.stFishEyeManager[i].emCorrectType!=Z&&this.stFishEyeManager[i].emCorrectType!=j&&this.stFishEyeManager[i].emCorrectType!=z&&this.stFishEyeManager[i].emCorrectType!=K&&this.stFishEyeManager[i].emCorrectType!=q&&this.stFishEyeManager[i].emCorrectType!=Q&&a!=Y&&a!=Z&&a!=j&&a!=z&&a!=K&&a!=q&&a!=Q)return console.info("%c VideoRender.js FECParamJudge 9 origin/180/360/lat only display one port","color: red"),this.FECErrorCode=1304,0;if(this.stFishEyeManager[i].bUsed&&(this.stFishEyeManager[i].emCorrectType==Y&&a==G||this.stFishEyeManager[i].emCorrectType==G&&a==Y))return console.info("%c VideoRender.js FECParamJudge 10 180 cannot support ptz","color: red"),this.FECErrorCode=1304,0}}return 1}},{key:"FEC_Enable",value:function(t){return t<1||t>31||null==t?(console.info("%c FEC_Enable-1 nSubPort:%d","color: red",t),this.FECErrorCode=H,0):null!==this.stFishEyeManager[t].pRender?(console.info("%c FEC_Enable-2 nSubPort:%d","color: red",t),this.FECErrorCode=1301,0):(null==this.stFishEyeManager[t].pRender&&(this.stFishEyeManager[t].pRender=new Gt,null==this.pFishParamManager&&(this.pFishParamManager=new Yt),this.stFishEyeManager[t].pRender.SR_SetFishParamManager(this.pFishParamManager)),1)}},{key:"FEC_SetWnd",value:function(t,e){if(t<1||t>31||null==t)return console.info("%c FEC_SetWnd-1 nSubPort:%d","color: red",t),this.FECErrorCode=H,0;if(null==this.stFishEyeManager[t].pRender)return console.info("%c FEC_SetWnd-2 nSubPort:%d pRender is null","color: red",t),this.FECErrorCode=O,0;if(0==this.stFishEyeManager[t].bUsed)return console.info("%c FEC_SetWnd-3 nSubPort:%d bUsed:%d","color: red",t,this.stFishEyeManager[t].bUsed),this.FECErrorCode=B,0;if(null==e)return console.info("%c FEC_SetWnd-4 nSubPort:%d sCanvasID:%s","color: red",t,e),this.FECErrorCode=1305,0;if(0!=this.stFishEyeManager[t].nSubPort&&0!=this.stFishEyeManager[t].bUsed){if(0!=this.stFishEyeManager[t].bInited&&null!=this.stFishEyeManager[t].sCanvasID)return e!=this.stFishEyeManager[t].sCanvasID?(console.info("%c FEC_SetWnd-5 nSubPort:%d sCanvasID:%s already init","color: red",t,e),this.FECErrorCode=1286,0):1;var a=Xt.SRDISPLAYEFFECT.SR_DE_FISH_ORIGINAL;a=this._ConvertDisplayEffect(this.stFishEyeManager[t].emPlaceType,this.stFishEyeManager[t].emCorrectType);var r=this.stFishEyeManager[t].pRender.SR_Init(e,this.enPixelFormat),i=this.stFishEyeManager[t].pRender.SR_AddSubPort(a);if(-1==i)return console.info("%c FEC_SetWnd SR_AddSubPort error subport:%d","color: red",t),0;if(this.stFishEyeManager[t].nValidSubPort=i,Xt.ERRCODE.SR_OK!=r)return this.stFishEyeManager[t].bInited=0,this.stFishEyeManager[t].sCanvasID=null,this.FECErrorCode=B,0;if(this.stFishEyeManager[t].bInited=1,this.stFishEyeManager[t].sCanvasID=e,Z<=this.stFishEyeManager[t].emCorrectType){var n=this.stFishEyeManager[t].pRender.SR_SetRenderState(Xt.SRRENDERSTATETYPE.SR_RST_BACK_CULL,0);Xt.ERRCODE.SR_OK!=n&&console.log(">>>VideoRender.js SR_SetRenderState failed ret：%08x\n",n)}return this.stFishEyeManager[t].pRender.SR_SetCallBack(this.WebGLDisplaySubCallBack,{nUser:this,handle:this.stFishEyeManager[t].pRender,nSubPort:t},Xt.SRCALLBACKTYPE.SR_CBT_NULL),null!=this.pstWaterFontParam&&this.SetWaterMarkFont(this.pstWaterFontParam),this.FECShowMode>0&&this.stFishEyeManager[t].pRender.SR_SetPTZDisplayMode(this.FECShowMode),1}return this.FECErrorCode=B,0}},{key:"FEC_Disable",value:function(t,e,a){if(t<1||t>31||null==t)return console.info("%c FEC_Disable-1 nSubPort:%d","color: red",t),this.FECErrorCode=H,0;if(1==this.stFishEyeManager[t].bInited&&null!=this.stFishEyeManager[t].pRender){if(Xt.ERRCODE.SR_OK!=this.stFishEyeManager[t].pRender.SR_DelSubPort(this.stFishEyeManager[t].nValidSubPort))return console.info("%c FEC_Disable-2 SR_DelSubPort error nSubPort:%d","color: red",t),0;this.stFishEyeManager[t].bInited=0,this.stFishEyeManager[t].nValidSubPort=-1,this.stFishEyeManager[t].pRender.SR_Destroy(),this.stFishEyeManager[t].pRender=null}return 1}},{key:"FEC_DelPort",value:function(t){return t<1||t>31||null==t?(console.info("%c FEC_DelPort-1 nSubPort:%d","color: red",t),this.FECErrorCode=H,0):0==this.stFishEyeManager[t].bUsed?(console.info("%c FEC_DelPort-2 nSubPort:%d bUsed：%d","color: red",t,this.stFishEyeManager[t].bUsed),this.FECErrorCode=B,0):(this.stFishEyeManager[t].nSubPort=0,this.stFishEyeManager[t].sCanvasID=null,this.stFishEyeManager[t].bUsed=0,this.stFishEyeManager[t].bInited=0,this.stFishEyeManager[t].nValidSubPort=0,this.stFishEyeManager[t].emPlaceType=3,this.stFishEyeManager[t].emCorrectType=0,this.stFishEyeManager[t].emEffect=Xt.SRDISPLAYEFFECT.SR_DE_FISH_ORIGINAL,this.stFishParam[t].stCycleParam.fRadiusLeft=0,this.stFishParam[t].stCycleParam.fRadiusRight=1,this.stFishParam[t].stCycleParam.fRadiusTop=0,this.stFishParam[t].stCycleParam.fRadiusBottom=1,this.subPortNum>0&&this.subPortNum--,1)}},{key:"FEC_SetParam",value:function(t,e){if(this.FECErrorCode=0,t<0||t>31||null==t)return console.info("%c FEC_SetParam-1 nSubPort:%d","color: red",t),this.FECErrorCode=H,0;if(null==this.stFishEyeManager[t].pRender)return console.info("%c FEC_SetParam-2 nSubPort:%d pRender:%d","color: red",t,this.stFishEyeManager[t].pRender),this.FECErrorCode=O,0;if(0==this.stFishEyeManager[t].bUsed)return console.info("%c FEC_SetParam-3 nSubPort:%d bUsed:%d","color: red",t,this.stFishEyeManager[t].bUsed),this.FECErrorCode=B,0;if(this.stFishEyeManager[t].emCorrectType>=Z&&this.stFishEyeManager[t].emCorrectType<=Q&&30&e.upDateType)return console.info("%c FEC_SetParam-4 nSubPort:%d not 3D","color: red",t),this.FECErrorCode=U,0;if(1&e.upDateType){if(null==e.stCycleParam)return this.FECErrorCode=V,0;for(var a=1;a<Zt;a++){if(this.stFishEyeManager[a].bUsed&&this.stFishEyeManager[a].nSubPort&&q==this.stFishEyeManager[a].emCorrectType&&(e.stCycleParam.fRadiusLeft<=-.5||e.stCycleParam.fRadiusLeft>=.4||e.stCycleParam.fRadiusRight<=.6||e.stCycleParam.fRadiusRight>=1.5||e.stCycleParam.fRadiusTop<=-.5||e.stCycleParam.fRadiusTop>0||e.stCycleParam.fRadiusBottom<1||e.stCycleParam.fRadiusBottom>=1.5||e.stCycleParam.fRadiusLeft+e.stCycleParam.fRadiusRight<=.8||e.stCycleParam.fRadiusLeft+e.stCycleParam.fRadiusRight>=1.2||e.stCycleParam.fRadiusTop+e.stCycleParam.fRadiusBottom<=.8||e.stCycleParam.fRadiusTop+e.stCycleParam.fRadiusBottom>=1.2))return this.FECErrorCode=V,0;if(this.stFishEyeManager[a].bUsed&&this.stFishEyeManager[a].nSubPort&&Q==this.stFishEyeManager[a].emCorrectType&&(e.stCycleParam.fRadiusLeft<=-.5||e.stCycleParam.fRadiusLeft>0||e.stCycleParam.fRadiusRight<1||e.stCycleParam.fRadiusRight>=1.5||e.stCycleParam.fRadiusTop<=-.5||e.stCycleParam.fRadiusTop>=.4||e.stCycleParam.fRadiusBottom<=.6||e.stCycleParam.fRadiusBottom>=1.5||e.stCycleParam.fRadiusLeft+e.stCycleParam.fRadiusRight<=.8||e.stCycleParam.fRadiusLeft+e.stCycleParam.fRadiusRight>=1.2||e.stCycleParam.fRadiusTop+e.stCycleParam.fRadiusBottom<=.8||e.stCycleParam.fRadiusTop+e.stCycleParam.fRadiusBottom>=1.2))return this.FECErrorCode=V,0}}if(0==this.stFishEyeManager[t].bInited){if(4&e.upDateType){if(G!=this.stFishEyeManager[t].emCorrectType&&X!=this.stFishEyeManager[t].emCorrectType||1==this.stFishEyeManager[t].emPlaceType)return this.FECErrorCode=U,0;for(var r=1;r<Zt;r++)if(this.stFishEyeManager[r].nSubPort&&this.stFishEyeManager[r].bUsed&&this.stFishEyeManager[r].emCorrectType==Y)return this.FECErrorCode=N,0;this.stFishParam[t].fWideScanOffset=e.fValue}if(16&e.upDateType){if(null==e.stPTZColor)return this.FECErrorCode=V,0;if(e.stPTZColor.nR>255||e.stPTZColor.nG>255||e.stPTZColor.nB>255||e.stPTZColor.nAlpha>255)return this.FECErrorCode=U,0;this.stFishParam[t].stPTZColor.nR=e.stPTZColor.nR,this.stFishParam[t].stPTZColor.nG=e.stPTZColor.nG,this.stFishParam[t].stPTZColor.nB=e.stPTZColor.nB,this.stFishParam[t].stPTZColor.nAlpha=e.stPTZColor.nAlpha}if(8&e.upDateType){if(Y!=this.stFishEyeManager[t].emCorrectType)return this.FECErrorCode=U,0;this.stFishParam[t].stPTZParam.fPTZPositionX=e.fPTZParam.fPTZPositionX,this.stFishParam[t].stPTZParam.fPTZPositionY=e.fPTZParam.fPTZPositionY}if(2&e.upDateType){if(Y!=this.stFishEyeManager[t].emCorrectType)return this.FECErrorCode=U,0;this.stFishParam[t].fZoom=e.fPTZZoom}if(32&e.upDateType){if(null==this.stFishParam.stPTZSelect)return 0;if(Y!=this.stFishEyeManager[t].emCorrectType)return this.FECErrorCode=U,0;this.stFishParam.stPTZSelect.fTop=e.stPTZSelect.fTop,this.stFishParam.stPTZSelect.fBottom=e.stPTZSelect.fBottom,this.stFishParam.stPTZSelect.fLeft=e.stPTZSelect.fLeft,this.stFishParam.stPTZSelect.fRight=e.stPTZSelect.fRight}if(1&e.upDateType){if(null==e.stCycleParam)return this.FECErrorCode=V,0;if(0==this._IsValidRadiusParam(e.stCycleParam))return this.FECErrorCode=V,0;this.stFishParam[0].stCycleParam.fRadiusLeft=e.stCycleParam.fRadiusLeft,this.stFishParam[0].stCycleParam.fRadiusRight=e.stCycleParam.fRadiusRight,this.stFishParam[0].stCycleParam.fRadiusTop=e.stCycleParam.fRadiusTop,this.stFishParam[0].stCycleParam.fRadiusBottom=e.stCycleParam.fRadiusBottom}return 1}if(4&e.upDateType){if(G!=this.stFishEyeManager[t].emCorrectType&&X!=this.stFishEyeManager[t].emCorrectType||1==this.stFishEyeManager[t].emPlaceType)return this.FECErrorCode=U,0;for(var i=1;i<Zt;i++)if(this.stFishEyeManager[i].nSubPort&&this.stFishEyeManager[i].bUsed&&this.stFishEyeManager[i].emCorrectType==Y)return this.FECErrorCode=N,0;var n={};if(n.nFishParamType=Xt.SRFISHPARAMTYPE.SR_FPT_ANGLE,n.bBlack=0,n.fAngle=e.fValue,Xt.ERRCODE.SR_OK!=this.stFishEyeManager[t].pRender.SR_SetFishParam(n))return this.FECErrorCode=N,0;this.stFishParam[t].fWideScanOffset=e.fValue}if(16&e.upDateType){if(null==e.stPTZColor)return this.FECErrorCode=U,0;if(e.stPTZColor.nR>255||e.stPTZColor.nG>255||e.stPTZColor.nB>255||e.stPTZColor.nAlpha>255)return this.FECErrorCode=U,0;var s={};if(s.fR=e.stPTZColor.nR/255,s.fG=e.stPTZColor.nG/255,s.fB=e.stPTZColor.nB/255,s.fA=e.stPTZColor.nAlpha/255,Xt.ERRCODE.SR_OK!=this.stFishEyeManager[t].pRender.SR_SetPTZColor(t,s))return this.FECErrorCode=N,N;this.stFishParam[t].stPTZColor.nR=e.stPTZColor.nR,this.stFishParam[t].stPTZColor.nG=e.stPTZColor.nG,this.stFishParam[t].stPTZColor.nB=e.stPTZColor.nB,this.stFishParam[t].stPTZColor.nAlpha=e.stPTZColor.nAlpha}if(8&e.upDateType){if(Y!=this.stFishEyeManager[t].emCorrectType)return this.FECErrorCode=U,0;var x={};x.nFishParamType=Xt.SRFISHPARAMTYPE.SR_FPT_PTZ,x.bBlack=0,x.fPTZX=e.fPTZParam.fPTZPositionX,x.fPTZY=e.fPTZParam.fPTZPositionY;var o=this.stFishEyeManager[t].pRender.SR_SetFishParam(x);if(Xt.ERRCODE.SR_OK!=o)return this.FECErrorCode=N,0;this.stFishParam[t].stPTZParam.fPTZPositionX=e.fPTZParam.fPTZPositionX,this.stFishParam[t].stPTZParam.fPTZPositionY=e.fPTZParam.fPTZPositionY}if(2&e.upDateType){if(Y!=this.stFishEyeManager[t].emCorrectType)return this.FECErrorCode=U,0;var f={};if(f.nFishParamType=Xt.SRFISHPARAMTYPE.SR_FPT_ZOOM,f.bBlack=0,f.fZoom=e.fPTZZoom,Xt.ERRCODE.SR_OK!=this.stFishEyeManager[t].pRender.SR_SetFishParam(f))return this.FECErrorCode=N,0;this.stFishParam[t].fZoom=e.fPTZZoom}if(1&e.upDateType){if(0==this._IsValidRadiusParam(e.stCycleParam))return this.FECErrorCode=V,0;var l={};if(l.nFishParamType=Xt.SRFISHPARAMTYPE.SR_FPT_CENTER,l.bBlack=1,l.fRXLeft=e.stCycleParam.fRadiusLeft,l.fRXRight=e.stCycleParam.fRadiusRight,l.fRYTop=e.stCycleParam.fRadiusTop,l.fRYBottom=e.stCycleParam.fRadiusBottom,Xt.ERRCODE.SR_OK!=this.stFishEyeManager[t].pRender.SR_SetFishParam(this.stFishEyeManager[t].nValidSubPort,l))return this.FECErrorCode=V,0;this.stFishParam[0].stCycleParam.fRadiusLeft=e.stCycleParam.fRadiusLeft,this.stFishParam[0].stCycleParam.fRadiusRight=e.stCycleParam.fRadiusRight,this.stFishParam[0].stCycleParam.fRadiusTop=e.stCycleParam.fRadiusTop,this.stFishParam[0].stCycleParam.fRadiusBottom=e.stCycleParam.fRadiusBottom}return 32&e.upDateType&&Y==this.stFishEyeManager[t].emCorrectType&&Xt.ERRCODE.SR_OK!=this.stFishEyeManager[t].pRender.SR_SetFishParam(this.stFishEyeManager[t].stPTZSelect)?(this.FECErrorCode=1299,0):(null!=this.pstWaterFontParam&&this.pstWaterFontParam.nColorAdapt&&(this.pstWaterFontParamArray[t].splice(t,this.pstWaterFontParamArray[t].length),this.CalculateWaterMarkParam(this.stFishEyeManager[t].pRender,t,this.pstWaterFontParam)),1)}},{key:"FEC_GetParam",value:function(t,e){return t<0||t>31||null==t?(console.info("%c FEC_GetParam-1 nSubPort:%d","color: red",t),this.FECErrorCode=H,0):null==this.stFishEyeManager[t].pRender?(console.info("%c FEC_GetParam-2 pRender:%d","color: red",this.stFishEyeManager[t].pRender),this.FECErrorCode=O,0):(this.stFishEyeManager[t].pRender.SR_GetFishParam(e),e.emCorrectType=this.stFishEyeManager[t].emCorrectType,1)}},{key:"_IsValidRadiusParam",value:function(t){return t.fRadiusBottom<=t.fRadiusTop||t.fRadiusRight<=t.fRadiusLeft?0:1}},{key:"FEC_SetViewParam",value:function(t,e,a){return t<0||t>31||null==t?(console.info("%c FEC_SetViewParam-1 nSubPort:%d","color: red",t),this.FECErrorCode=H,0):null==this.stFishEyeManager[t].pRender?(console.info("%c FEC_SetViewParam-2 pRender:%d","color: red",this.stFishEyeManager[t].pRender),this.FECErrorCode=O,0):e<Xt.SRVIEWTYPE.SR_VT_ROTATION_X||e>Xt.SRVIEWTYPE.SR_VT_SCALE?(this.FECErrorCode=W,0):(this.FECErrorCode=0,0==this.stFishEyeManager[t].bInited?(this.FECErrorCode=B,0):Z<=this.stFishEyeManager[t].emCorrectType?Xt.ERRCODE.SR_OK!=this.stFishEyeManager[t].pRender.SR_SetViewParam(e,a)?(this.FECErrorCode=W,0):(null!=this.pstWaterFontParam&&this.pstWaterFontParam.nColorAdapt&&(this.pstWaterFontParamArray[t].splice(0,this.pstWaterFontParamArray[t].length),this.CalculateWaterMarkParam(this.stFishEyeManager[t].pRender,t,this.pstWaterFontParam)),1):(this.FECErrorCode=U,0))}},{key:"FEC_GetViewParam",value:function(t,e,a){return a.fValue=-1,t<0||t>31||null==t?(console.info("%c FEC_GetViewParam-1 nSubPort:%d","color: red",t),this.FECErrorCode=H,0):null==this.stFishEyeManager[t].pRender?(console.info("%c FEC_GetViewParam-2 pRender:%d","color: red",this.stFishEyeManager[t].pRender),this.FECErrorCode=O,0):e<1||e>3||0==this.stFishEyeManager[t].bInited?0:(Z<=this.stFishEyeManager[t].emCorrectType&&this.stFishEyeManager[t].pRender.SR_GetViewParam(e,a),1)}},{key:"FEC_SetDisplayRegion",value:function(t,e,a,r,i,n,s){return t<0||t>31||null==t?(console.info("%c FEC_SetDisplayRegion-1 nSubPort:%d","color: red",t),this.FECErrorCode=H,0):null==this.stFishEyeManager[t].pRender?(console.info("%c FEC_SetDisplayRegion-2 pRender:%d","color: red",this.stFishEyeManager[t].pRender),this.FECErrorCode=O,0):0!=e||0!=a?(this.FECErrorCode=W,0):0!=this.stFishEyeManager[t].emCorrectType&&this.stFishEyeManager[t].emCorrectType!=G&&this.stFishEyeManager[t].emCorrectType!=X&&this.stFishEyeManager[t].emCorrectType!=J?(this.FECErrorCode=k,0):0==this.stFishEyeManager[t].bInited?(this.FECErrorCode=B,0):r<0||i<0||n<0||s<0?(this.FECErrorCode=W,0):Xt.ERRCODE.SR_OK!=this.stFishEyeManager[t].pRender.SR_SetDisplayRect(r,i,n,s,Xt.SRSETRECTTYPE.SR_SRT_SRC)?(this.FECErrorCode=1297,0):(null!=this.pstWaterFontParam&&this.pstWaterFontParam.nColorAdapt&&(this.pstWaterFontParamArray[t].splice(0,this.pstWaterFontParamArray[t].length),this.CalculateWaterMarkParam(this.stFishEyeManager[t].pRender,t,this.pstWaterFontParam)),1)}},{key:"FEC_SetBackCilling",value:function(t,e){return t<0||t>31||null==t?(this.FECErrorCode=H,0):null==this.stFishEyeManager[t].pRender?(this.FECErrorCode=O,0):0==this.stFishEyeManager[t].bInited?(this.FECErrorCode=B,0):Xt.ERRCODE.SR_OK!=this.stFishEyeManager[t].pRender.SR_SetRenderState(Xt.SRRENDERSTATETYPE.SR_RST_BACK_CULL,e)?(this.FECErrorCode=1297,0):(null!=this.pstWaterFontParam&&this.pstWaterFontParam.nColorAdapt&&(this.pstWaterFontParamArray[t].splice(0,this.pstWaterFontParamArray[t].length),this.CalculateWaterMarkParam(this.stFishEyeManager[t].pRender,t,this.pstWaterFontParam)),1)}},{key:"FEC_GetPTZPort",value:function(t,e,a){if(null!=this.stFishEyeManager[t].pRender){var r={nPTZPort:-1};if(this.stFishEyeManager[t].pRender.SR_GetPTZPort(e,a,r)==Xt.ERRCODE.SR_OK)return r.nPTZPort}return-1}},{key:"FEC_SetPTZDisplayMode",value:function(t){return t>=0&&t<=2?(null!=this.stFishEyeManager[0].pRender&&this.stFishEyeManager[0].pRender.SR_SetPTZDisplayMode(t),this.FECShowMode=t,1):(console.info("%c FEC_SetPTZDisplayMode ptzMode:%d","color: red",t),0)}},{key:"FEC_Capture",value:function(t,e){if(null!=this.stFishEyeManager[t].pRender){var a={nWidth:0,nHeight:0,nBufferLen:0},r=this.stFishEyeManager[t].pRender.SR_GetCaptureSize(a);if(Xt.ERRCODE.SR_OK!=r||a.nBufferLen<=0)return e(null,0,0,t),0;var i=new Uint8Array(a.nBufferLen);if(null==i)return e(null,0,0,t),0;var n={};return n.pBuffer=i,this.stFishEyeManager[t].pRender.SR_CaptureScreen(n),e(i,a.nWidth,a.nHeight,t),i=null,1}return e(null,0,0,t),0}},{key:"CheckFrameRGB",value:function(t,e,a,r,i,n){if(null==t||null==t.width||null==t.height||null==t.pBuffer||t.width<=0||t.height<=0||t.pBuffer.length<=0)return 0;for(var s=t.width/(r-1),x=t.height/(a-1),o=0,f=0,l=[],_=0;_<a*r;_++)l[_]=0,this.aPOSAdaptBuf[_]=0;if(e){for(var h=0,c=0;c<t.height;c++)for(var u=0;u<t.width;u++){o=(o=Math.round(u/(s/2)/2))<r?o:r-1,f=(f=Math.round(c/(x/2)/2))<a?f:a-1;var d=t.pBuffer[h],p=t.pBuffer[h+1],m=t.pBuffer[h+2],S=Math.round(.299*d+.587*p+.114*m);this.aPOSAdaptBuf[o+f*r]+=S,l[o+f*r]++,h+=4}for(var R=0,P=0;P<a*r;P++)R=this.aPOSAdaptBuf[P]/l[P],this.aPOSAdaptBuf[P]=R>128?0:1}else{var y=Math.round(i*t.width),b=Math.round(n*t.height),E=y-2;E=(E=E>0?E:0)<t.width?E:t.width-1;var g=y+2;g=(g=g>0?g:0)<t.width?g:t.width-1;var F=b-2;F=(F=F>0?F:0)<t.height?F:t.height-1;var C=b+2;C=(C=C>0?C:0)<t.height?C:t.height-1;for(var v=F;v<C;v++)for(var T=E;T<g;T++){var D=4*Math.floor((4*T+v*t.width*4)/4),A=t.pBuffer[D],I=t.pBuffer[D+1],M=t.pBuffer[D+2],L=Math.round(.299*A+.587*I+.114*M);this.aPOSAdaptBuf[0]+=L,l[0]++}this.aPOSAdaptBuf[0]=this.aPOSAdaptBuf[0]/l[0]>128?0:1}return 1}},{key:"GetWaterFontParam",value:function(t,e,a,r,i,n,s){var x=a.pFontString.length,o=a.pstFontRotate.fRotateAngle%360/360*2*Math.PI,f=Math.min(a.pstFontSize.nFontWidth,a.pstFontSize.nFontHeight);if(2==a.pstCanvasAdapt.nCanvasAdaptMode){var l=a.pstFontSize.nFontWidth*r/a.pstCanvasAdapt.nBaseCanvasWidth,_=a.pstFontSize.nFontHeight*i/a.pstCanvasAdapt.nBaseCanvasHeight;f=Math.min(l,_)}var h=f/r,c=f/i,u=h*Math.cos(Math.PI/2-o)*a.pSpace,d=c*Math.sin(Math.PI/2-o)*a.pSpace,p=[],m=[],S=[];if(a.nFontAlign)for(var R=0;R<x;R++)p[R]=a.pFontString[0].length*h/6,m[R]=Math.atan2(p[0],d),S[R]=Math.sqrt(p[0]*p[0],d*d);else for(var P=0;P<x;P++)p[P]=0,m[P]=0,S[P]=0;var y={};if(this.pstWaterFontParam.nColorAdapt){var b={nWidth:16,nHeight:16,nBufferLen:0},E=t.SR_GetCaptureSize(b);if(Xt.ERRCODE.SR_OK==E){var g=new Uint8Array(b.nBufferLen);y.pBuffer=g,t.SR_CaptureScreen(y,!0),y.width=b.nWidth,y.height=b.nHeight,g=null}}var F=n*s;if(a.pstFontRotate.fFillFullScreen){var C=[],v=[];if(1==a.pstCanvasAdapt.nCanvasAdaptMode){if(s<jt)for(var T=0;T*a.pstCanvasAdapt.ntotalColSpace<=r;T++)v[T]=(T*a.pstCanvasAdapt.ntotalColSpace+a.pstCanvasAdapt.nColSpace/2)/r;else for(var D=1/(s-1),A=0;A<s;A++)v[A]=D*A+u*((x-1)/2);if(n<jt)for(var I=0;I*a.pstCanvasAdapt.ntotalRowSpace<=i;I++)C[I]=(I*a.pstCanvasAdapt.ntotalRowSpace+a.pstCanvasAdapt.nRowSpace/2)/i;else for(var M=1/(n-1),L=0;L<n;L++)C[L]=M*L-d*((x-1)/2);for(var w=0;w<x;w++)p[w]=0,m[w]=0,S[w]=0}else{if(1==n)C[0]=.5;else for(var O=1/(n-1),B=0;B<n;B++)C[B]=O*B-d*((x-1)/2);if(1==s)v[0]=.5;else for(var k=1/(s-1),N=0;N<s;N++)v[N]=k*N+u*((x-1)/2)}this.pstWaterFontParamArray[e]=[];for(var V=0;V<F;++V)for(var U=0;U<x;U++){this.pstWaterFontParamArray[e][x*V+U]={},this.pstWaterFontParamArray[e][x*V+U].pString=a.pFontString[U],this.pstWaterFontParamArray[e][x*V+U].nFontWidth=f,this.pstWaterFontParamArray[e][x*V+U].nFontHeight=f,this.pstWaterFontParamArray[e][x*V+U].pstStartPos={};var H=V%s,W=Math.floor(V/s),Y=Math.PI/2-o+m[U];this.pstWaterFontParamArray[e][x*V+U].pstStartPos.fX=v[H]-U*u+S[U]*Math.cos(Y),this.pstWaterFontParamArray[e][x*V+U].pstStartPos.fY=C[W]+U*d-S[U]*Math.sin(Y),a.nColorAdapt?(0==U&&this.CheckFrameRGB(y,0,1,1,this.pstWaterFontParamArray[e][x*V+U].pstStartPos.fX,this.pstWaterFontParamArray[e][x*V+U].pstStartPos.fY),this.pstWaterFontParamArray[e][x*V+U].pstFontColor={},this.pstWaterFontParamArray[e][x*V+U].pstFontColor.fR=this.aPOSAdaptBuf[0],this.pstWaterFontParamArray[e][x*V+U].pstFontColor.fG=this.aPOSAdaptBuf[0],this.pstWaterFontParamArray[e][x*V+U].pstFontColor.fB=this.aPOSAdaptBuf[0],this.pstWaterFontParamArray[e][x*V+U].pstFontColor.fA=a.pstFontColor.fA):this.pstWaterFontParamArray[e][x*V+U].pstFontColor=a.pstFontColor,this.pstWaterFontParamArray[e][x*V+U].bBackGround=!1,this.pstWaterFontParamArray[e][x*V+U].pstBGColor=null,this.pstWaterFontParamArray[e][x*V+U].fRotateAngle=a.pstFontRotate.fRotateAngle,this.pstWaterFontParamArray[e][x*V+U].pFontFamily=a.pFontFamily,a.nFontAlign?(this.pstWaterFontParamArray[e][x*V+U].textAlign="left",this.pstWaterFontParamArray[e][x*V+U].textBaseline="top"):(this.pstWaterFontParamArray[e][x*V+U].textAlign="center",this.pstWaterFontParamArray[e][x*V+U].textBaseline="middle")}}else for(var G=0;G<a.pFontString.length;G++)this.pstWaterFontParamArray[e][G]={},this.pstWaterFontParamArray[e][G].pString=a.pFontString[G],this.pstWaterFontParamArray[e][G].nFontWidth=f,this.pstWaterFontParamArray[e][G].nFontHeight=f,this.pstWaterFontParamArray[e][G].pstStartPos={},this.pstWaterFontParamArray[e][G].pstStartPos.fX=a.pstStartPos.fX-G*u,this.pstWaterFontParamArray[e][G].pstStartPos.fY=a.pstStartPos.fY+G*d,a.nColorAdapt?(this.CheckFrameRGB(y,0,1,1,this.pstWaterFontParamArray[e][G].pstStartPos.fX,this.pstWaterFontParamArray[e][G].pstStartPos.fY),this.pstWaterFontParamArray[e][G].pstFontColor={},this.pstWaterFontParamArray[e][G].pstFontColor.fR=this.aPOSAdaptBuf[0],this.pstWaterFontParamArray[e][G].pstFontColor.fG=this.aPOSAdaptBuf[0],this.pstWaterFontParamArray[e][G].pstFontColor.fB=this.aPOSAdaptBuf[0],this.pstWaterFontParamArray[e][G].pstFontColor.fA=a.pstFontColor.fA):this.pstWaterFontParamArray[e][G].pstFontColor=a.pstFontColor,this.pstWaterFontParamArray[e][G].bBackGround=!1,this.pstWaterFontParamArray[e][G].pstBGColor=null,this.pstWaterFontParamArray[e][G].fRotateAngle=a.pstFontRotate.fRotateAngle,this.pstWaterFontParamArray[e][G].pFontFamily=a.pFontFamily,a.nFontAlign?(this.pstWaterFontParamArray[e][G].textAlign="left",this.pstWaterFontParamArray[e][G].textBaseline="top"):(this.pstWaterFontParamArray[e][G].textAlign="center",this.pstWaterFontParamArray[e][G].textBaseline="middle");return 1}},{key:"CalculateWaterMarkParam",value:function(t,e,a){var r=this.mainCanvasID.width,i=this.mainCanvasID.height;e>0&&(r=this.stFishEyeManager[e].sCanvasID.width,i=this.stFishEyeManager[e].sCanvasID.height);var n=Math.floor(a.pstFontNumber.nRowNumber),s=Math.floor(a.pstFontNumber.nColNumber);1==a.pstCanvasAdapt.nCanvasAdaptMode&&(n=(n=(n=Math.floor(i/a.pstCanvasAdapt.ntotalRowSpace+1))<1?1:n)>jt?jt:n,s=(s=(s=Math.floor(r/a.pstCanvasAdapt.ntotalColSpace+1))<1?1:s)>jt?jt:s),this.GetWaterFontParam(t,e,a,r,i,n,s)}},{key:"SetWaterMarkFont",value:function(t){if(0!=this.pstWaterFontParamArray.length)for(var e=0;e<Zt;e++)this.pstWaterFontParamArray[e].splice(0,this.pstWaterFontParamArray[e].length);if(this.pstWaterFontParam=t,null===t)return 1;this.CalculateWaterMarkParam(this.oVideoHandle,0,t);for(var a=1;a<Zt;a++)null!=this.stFishEyeManager[a].pRender&&this.CalculateWaterMarkParam(this.stFishEyeManager[a].pRender,a,t);return 1}},{key:"SetMosaicType",value:function(t){return this.MosaicType=t.nMosaicType,this.MosaicSize=t.nMosaicSize,this.MosaicColorR=t.pstMosaicColor.fMosaicColorR/255,this.MosaicColorG=t.pstMosaicColor.fMosaicColorG/255,this.MosaicColorB=t.pstMosaicColor.fMosaicColorB/255,this.MosaicColorA=t.pstMosaicColor.fMosaicColorA/100,1}},{key:"SetTextCanvas",value:function(t){return this.textCanvas=t,1}},{key:"SetPrintLogFlag",value:function(t){return this.printfFlag=t,1}},{key:"SetRotateAngle",value:function(t){var e;if(null!=this.oVideoHandle&&(e=this.oVideoHandle.SR_SetRenderState(Xt.SRRENDERSTATETYPE.SR_RST_IMAGE_ROTATE,t),null!=this.pstWaterFontParam&&this.pstWaterFontParam.nColorAdapt&&(this.pstWaterFontParamArray[0].splice(0,this.pstWaterFontParamArray[0].length),this.CalculateWaterMarkParam(this.oVideoHandle,0,this.pstWaterFontParam)),e==Xt.ERRCODE.SR_OK))return 1;return 0}},{key:"ImageDecoder",value:function(t,e,a){var r=this;t.decode({frameIndex:a}).then((function(i){r.pWaterImageParam[a]={},r.pWaterImageParam[a].videoStream=i.image,r.pWaterImageParam[a].nImageWidth=i.image.displayWidth,r.pWaterImageParam[a].nImageHeight=i.image.displayHeight,r.pWaterImageParam[a].timeStamp=i.image.timestamp/1e3,r.pWaterImageParam[a].duration=i.image.duration/1e3,null!=e.pstRectPos?r.pWaterImageParam[a].pstRectPos=e.pstRectPos:r.pWaterImageParam[a].pstRectPos={fLeft:0,fRight:.1,fTop:0,fBottom:.1},null!=e.fAlpha&&e.fAlpha<=1&&e.fAlpha>=0?r.pWaterImageParam[a].fAlpha=e.fAlpha:r.pWaterImageParam[a].fAlpha=1,r.waterMarkImageMax=t.tracks.selectedTrack.frameCount,a<t.tracks.selectedTrack.frameCount-1?r.ImageDecoder(t,e,a+1):(r.baseWaterMarkImageTime=r.curTimestamp,r.finishDecodeImage=!0)}))}},{key:"SetWaterMarkImage",value:function(t){var e=this;if(this.pWaterImageParam.splice(0,this.pWaterImageParam.length),null===t)return 1;if(null!=t.pImageData){var a=new ImageDecoder({data:t.pImageData,type:"image/"+t.pImageType});a.tracks.ready.then((function(){a.completed.then((function(){e.ImageDecoder(a,t,0)}))}))}return this.waterMarkImageIndex=0,1}},{key:"SelectIntelInfoFeatureToDraw",value:function(t){if(this.DrawTargetEventIDList.splice(0,this.DrawTargetEventIDList.length),null===t)return 0;if(pImageParam.NodeNumber>0)for(var e=0;e<pImageParam.NodeNumber;e++)this.DrawTargetEventIDList.push(t.pIntelInfoNode[e]);return 1}},{key:"_ConvertDisplayEffect",value:function(t,e){switch(t){case 1:return Y==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_PTZ_WALL:X==e||J==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_PANORAMA_WALL:Z==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_SEMISPHERE:K==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_PLANET:q==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_ARCSPHERE_HORIZONTAL_WALL:Q==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_ARCSPHERE_VERTICAL_WALL:Xt.SRDISPLAYEFFECT.SR_DE_FISH_ORIGINAL;case 2:return Y==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_PTZ_FLOOR:X==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_PANORAMA_FLOOR_360:G==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_PANORAMA_FLOOR_180:Z==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_SEMISPHERE:j==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_CYLINDER_FLOOR:z==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_CYLINDER_SPLIT_FLOOR:K==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_PLANET:Xt.SRDISPLAYEFFECT.SR_DE_FISH_ORIGINAL;case 3:return Y==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_PTZ_CEILING:X==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_PANORAMA_CEILING_360:G==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_PANORAMA_CEILING_180:Z==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_SEMISPHERE:j==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_CYLINDER_CEILING:z==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_CYLINDER_SPLIT_CEILING:K==e?Xt.SRDISPLAYEFFECT.SR_DE_FISH_PLANET:Xt.SRDISPLAYEFFECT.SR_DE_FISH_ORIGINAL;default:return Xt.SRDISPLAYEFFECT.SR_DE_FISH_ORIGINAL}}},{key:"GetCanvasData",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i={};i.nWidth=e,i.nHeight=a,i.nBufferLen=0;var n=this.oVideoHandle.SR_GetCaptureSize(i,r);if(Xt.ERRCODE.SR_OK!=n||i.nBufferLen<=0)t(null);else{var s=new Uint8Array(i.nBufferLen);if(null!=s){var x={};x.pBuffer=s,this.oVideoHandle.SR_CaptureScreen(x),t(s,i.nWidth,i.nHeight)}else t(null)}}},{key:"FindIntelNodefromList",value:function(t){if(0!=this.privateNormalLinesInfo.length){for(var e=!1,a=0,r=!1,i=0,n=0,s=1e8,x=0;x<this.privateNormalLinesInfo.length;x++){if(0==(n=Math.abs(this.privateNormalLinesInfo[x].absTimeStamp-t))){r=!0,i=x;break}n<=this.nTimePerFrame+1e3&&n<s&&(e=!0,a=x,s=n)}r?(this.curNormalLinesInfo=this.privateNormalLinesInfo[i],this.privateNormalLinesInfo.shift()):e&&(this.curNormalLinesInfo=this.privateNormalLinesInfo[a],this.privateNormalLinesInfo.shift())}if(0!=this.privateThermalLinesInfo.length&&(this.curThermalLinesInfo=this.privateThermalLinesInfo[0]),0!=this.privateTemLinesInfo.length){for(var o=!1,f=0,l=!1,_=0,h=0,c=1e8,u=0;u<this.privateTemLinesInfo.length;u++){if(0==(h=Math.abs(this.privateTemLinesInfo[u].absTimeStamp-t))){l=!0,_=u;break}h<=this.nTimePerFrame+1e3&&h<c&&(o=!0,f=u,c=h)}l?(this.curTemLinesInfo=this.privateTemLinesInfo[_],this.privateTemLinesInfo.shift()):o?(this.curTemLinesInfo=this.privateTemLinesInfo[f],this.privateTemLinesInfo.shift()):this.nFrameRate<=30?this.m_nTEMDrawLinescount<=30?this.m_nTEMDrawLinescount++:this.curTemLinesInfo=null:this.m_nTEMDrawLinescount<=60?this.m_nTEMDrawLinescount++:this.curTemLinesInfo=null}else this.nFrameRate<=30?this.m_nTEMDrawLinescount<=30?this.m_nTEMDrawLinescount++:this.curTemLinesInfo=null:this.m_nTEMDrawLinescount<=60?this.m_nTEMDrawLinescount++:this.curTemLinesInfo=null;if(0!=this.privateTargetLinesInfo.length){for(var d=!1,p=0,m=!1,S=0,R=0,P=1e8,y=0;y<this.privateTargetLinesInfo.length;y++){if(0==(R=Math.abs(this.privateTargetLinesInfo[y].absTimeStamp-t))){m=!0,S=y;break}R<=this.nTimePerFrame+1e3&&R<P&&(d=!0,p=y,P=R)}m?(this.curTargetLinesInfo=this.privateTargetLinesInfo[S],this.privateTargetLinesInfo.shift()):d?(this.curTargetLinesInfo=this.privateTargetLinesInfo[p],this.privateTargetLinesInfo.shift()):this.curTargetLinesInfo=null}else this.curTargetLinesInfo=null;if(0!=this.privateMDLinesInfo.length){for(var b=!1,E=0,g=!1,F=0,C=0,v=1e8,T=0;T<this.privateMDLinesInfo.length;T++){if(0==(C=Math.abs(this.privateMDLinesInfo[T].absTimeStamp-t))){g=!0,F=T;break}C<=this.nTimePerFrame+1e3&&C<v&&(b=!0,E=T,v=C)}g?(this.curMDLinesInfo=this.privateMDLinesInfo[F],this.privateMDLinesInfo.shift()):b?(this.curMDLinesInfo=this.privateMDLinesInfo[E],this.privateMDLinesInfo.shift()):this.curMDLinesInfo=null}else this.curMDLinesInfo=null;if(0!=this.privateExactLinesInfo.length){for(var D=!1,A=0,I=!1,M=0,L=0,w=1e8,O=0;O<this.privateExactLinesInfo.length;O++){if(0==(L=Math.abs(this.privateExactLinesInfo[O].absTimeStamp-t))){I=!0,M=O;break}L<=this.nTimePerFrame/2&&L<w&&(D=!0,A=O,w=L)}I?(this.curExactLinesInfo=this.privateExactLinesInfo[M],this.privateExactLinesInfo.shift()):D?(this.curExactLinesInfo=this.privateExactLinesInfo[A],this.privateExactLinesInfo.shift()):this.curExactLinesInfo=null}else this.curExactLinesInfo=null;if(0!=this.privateExactRuleLinesInfo.length){for(var B=!1,k=0,N=!1,V=0,U=0,H=1e8,W=0;W<this.privateExactRuleLinesInfo.length;W++){if(0==(U=Math.abs(this.privateExactRuleLinesInfo[W].absTimeStamp-t))){N=!0,V=W;break}U<=this.nTimePerFrame/2&&U<H&&(B=!0,k=W,H=U)}N?(this.curExactRuleLinesInfo=this.privateExactRuleLinesInfo[V],this.privateExactRuleLinesInfo.shift()):B&&(this.curExactRuleLinesInfo=this.privateExactRuleLinesInfo[k],this.privateExactRuleLinesInfo.shift())}if(0!=this.privateNormalFontsInfo.length){for(var Y=!1,G=0,X=!1,J=0,Z=0,j=1e8,z=0;z<this.privateNormalFontsInfo.length;z++){if(0==(Z=Math.abs(this.privateNormalFontsInfo[z].absTimeStamp-t))){X=!0,J=z;break}Z<=this.nTimePerFrame+1e3&&Z<j&&(Y=!0,G=z,j=Z)}X?(this.curNormalFontsInfo=this.privateNormalFontsInfo[J],this.privateNormalFontsInfo.shift()):Y&&(this.curNormalFontsInfo=this.privateNormalFontsInfo[G],this.privateNormalFontsInfo.shift())}if(0!=this.privateTemFontsInfo.length){for(var K=!1,q=0,Q=!1,$=0,tt=0,et=1e8,at=0;at<this.privateTemFontsInfo.length;at++){if(0==(tt=Math.abs(this.privateTemFontsInfo[at].absTimeStamp-t))){Q=!0,$=at;break}tt<=this.nTimePerFrame+1e3&&tt<et&&(K=!0,q=at,et=tt)}Q?(this.curTemFontsInfo=this.privateTemFontsInfo[$],this.privateTemFontsInfo.shift()):K?(this.curTemFontsInfo=this.privateTemFontsInfo[q],this.privateTemFontsInfo.shift()):this.nFrameRate<=30?this.m_nTEMDrawFontscount<=30?this.m_nTEMDrawFontscount++:this.curTemFontsInfo=null:this.m_nTEMDrawFontscount<=60?this.m_nTEMDrawFontscount++:this.curTemFontsInfo=null}else this.nFrameRate<=30?this.m_nTEMDrawFontscount<=30?this.m_nTEMDrawFontscount++:this.curTemFontsInfo=null:this.m_nTEMDrawFontscount<=60?this.m_nTEMDrawFontscount++:this.curTemFontsInfo=null;if(0!=this.privateTargetFontsInfo.length){for(var rt=!1,it=0,nt=!1,st=0,xt=0,ot=1e8,ft=0;ft<this.privateTargetFontsInfo.length;ft++){if(0==(xt=Math.abs(this.privateTargetFontsInfo[ft].absTimeStamp-t))){nt=!0,st=ft;break}xt<=this.nTimePerFrame+1e3&&xt<ot&&(rt=!0,it=ft,ot=xt)}nt?(this.curTargetFontsInfo=this.privateTargetFontsInfo[st],this.privateTargetFontsInfo.shift()):rt?(this.curTargetFontsInfo=this.privateTargetFontsInfo[it],this.privateTargetFontsInfo.shift()):this.curTargetFontsInfo=null}else this.curTargetFontsInfo=null;if(0!=this.privateExactPOSFontsInfo.length){for(var lt=!1,_t=0,ht=!1,ct=0,ut=0,dt=1e8,pt=0;pt<this.privateExactPOSFontsInfo.length;pt++){if(0==(ut=Math.abs(this.privateExactPOSFontsInfo[pt].absTimeStamp-t))){ht=!0,ct=pt;break}ut<=this.nTimePerFrame/2&&ut<dt&&(lt=!0,_t=pt,dt=ut)}ht?(this.curExactPOSFontsInfo=this.privateExactPOSFontsInfo[ct],this.privateExactPOSFontsInfo.shift()):lt?(this.curExactPOSFontsInfo=this.privateExactPOSFontsInfo[_t],this.privateExactPOSFontsInfo.shift()):this.curExactPOSFontsInfo=null}else this.curExactPOSFontsInfo=null;if(0!=this.privateExactFontsInfo.length){for(var mt=!1,St=0,Rt=!1,Pt=0,yt=0,bt=1e8,Et=0;Et<this.privateExactFontsInfo.length;Et++){if(0==(yt=Math.abs(this.privateExactFontsInfo[Et].absTimeStamp-t))){Rt=!0,Pt=Et;break}yt<=this.nTimePerFrame/2&&yt<bt&&(mt=!0,St=Et,bt=yt)}Rt?(this.curExactFontsInfo=this.privateExactFontsInfo[Pt],this.privateExactFontsInfo.shift()):mt?(this.curExactFontsInfo=this.privateExactFontsInfo[St],this.privateExactFontsInfo.shift()):this.curExactFontsInfo=null}else this.curExactFontsInfo=null;if(0!=this.privateImageInfo.length){for(var gt=!1,Ft=0,Ct=!1,vt=0,Tt=0,Dt=1e8,At=0;At<this.privateImageInfo.length;At++){if(0==(Tt=Math.abs(this.privateImageInfo[At].absTimeStamp-t))){Ct=!0,vt=At;break}Tt<=this.nTimePerFrame+1e8&&Tt<Dt&&(gt=!0,Ft=At,Dt=Tt)}Ct?(this.curImagesInfo=this.privateImageInfo[vt],this.privateImageInfo.shift()):gt&&(this.curImagesInfo=this.privateImageInfo[Ft],this.privateImageInfo.shift())}return 1}},{key:"RenderPrivateData",value:function(t,e){return 1&t&&(this.m_bEnableIVSEx=e),2&t&&(this.m_bEnableMDEx=e),4&t&&(this.m_bDisPos=e),8&t&&(this.m_bEnablePICEx=e),16&t&&(this.m_bEnableFIREEx=e),32&t&&(this.m_bEnableTEMEx=e),64&t&&(this.m_bEnableTrackEx=e),128&t&&(this.m_bEnableThermal=e),1}},{key:"RenderPrivateDataEx",value:function(t,e,a){return 16==t&&(1&e&&(this.m_bEnableFireDis=a),4&e&&(this.m_bEnableFireMaxPos=a),8&e&&(this.m_bEnableFireDistance=a)),32==t&&(1&e&&(this.m_bEnableTEMBox=a),2&e&&(this.m_bEnableTEMLine=a),4&e&&(this.m_bEnableTEMPoint=a)),64==t&&(1&e&&(this.m_bEnableTrackPeople=a),2&e&&(this.m_bEnableTrackVehicle=a)),128==t&&(1&e&&(this.m_bEnableThermalFireMask=a),2&e&&(this.m_bEnableThermalRuleGas=a),4&e&&(this.m_bEnableThermalTargetGas=a)),1}},{key:"InputPrivateInfo",value:function(t,e,a){var r=this,i=!1,n=0;if(t.linesNum>0){var s={linesNum:0};s.absTimeStamp=t.absTimeStamp,s.stDrawLinesArray=[];var x={linesNum:0};x.absTimeStamp=t.absTimeStamp,x.stDrawLinesArray=[];var o={linesNum:0};o.absTimeStamp=t.absTimeStamp,o.stDrawLinesArray=[];var f={linesNum:0};f.absTimeStamp=t.absTimeStamp,f.stDrawLinesArray=[];var l={linesNum:0};l.absTimeStamp=t.absTimeStamp,l.stDrawLinesArray=[];var _={linesNum:0};_.absTimeStamp=t.absTimeStamp,_.stDrawLinesArray=[];var h={linesNum:0};h.absTimeStamp=t.absTimeStamp,h.stDrawLinesArray=[];for(var c=0;c<t.linesNum;c++)1==t.stDrawLinesArray[c].dwMatchType?2==t.stDrawLinesArray[c].dwIntelFlag?(_.stDrawLinesArray.push(t.stDrawLinesArray[c]),++_.linesNum):(l.stDrawLinesArray.push(t.stDrawLinesArray[c]),++l.linesNum):1==t.stDrawLinesArray[c].dwIntelFlag?(s.stDrawLinesArray.push(t.stDrawLinesArray[c]),++s.linesNum):4==t.stDrawLinesArray[c].dwIntelFlag?(this.m_nTEMDrawLinescount=0,x.stDrawLinesArray.push(t.stDrawLinesArray[c]),++x.linesNum):6==t.stDrawLinesArray[c].dwIntelFlag?(o.stDrawLinesArray.push(t.stDrawLinesArray[c]),++o.linesNum):8!=t.stDrawLinesArray[c].dwIntelFlag||1!=t.stDrawLinesArray[c].dwSubIntelFlag&&2!=t.stDrawLinesArray[c].dwSubIntelFlag?(f.stDrawLinesArray.push(t.stDrawLinesArray[c]),++f.linesNum):(h.stDrawLinesArray.push(t.stDrawLinesArray[c]),++h.linesNum);if(l.linesNum>0){if(l.absTimeStamp<=this.maxExactPrivateLineTimeStamp){var u=0;for(u=0;u<this.privateExactLinesInfo.length;u++)if(this.privateExactLinesInfo[u].absTimeStamp==l.absTimeStamp){i=!0,n=u;break}}if(i){this.privateExactLinesInfo[n].linesNum=l.linesNum;for(var d=0;d<l.linesNum;d++){this.privateExactLinesInfo[n].stDrawLinesArray[d]={},this.privateExactLinesInfo[n].stDrawLinesArray[d].vertex_num=l.stDrawLinesArray[d].vertex_num,this.privateExactLinesInfo[n].stDrawLinesArray[d].lineWidth=l.stDrawLinesArray[d].lineWidth,this.privateExactLinesInfo[n].stDrawLinesArray[d].bFill=l.stDrawLinesArray[d].bFill,this.privateExactLinesInfo[n].stDrawLinesArray[d].bLoop=l.stDrawLinesArray[d].bLoop,this.privateExactLinesInfo[n].stDrawLinesArray[d].dwMatchType=l.stDrawLinesArray[d].dwMatchType,this.privateExactLinesInfo[n].stDrawLinesArray[d].dwIntelFlag=l.stDrawLinesArray[d].dwIntelFlag,this.privateExactLinesInfo[n].stDrawLinesArray[d].dwSubIntelFlag=l.stDrawLinesArray[d].dwSubIntelFlag,this.privateExactLinesInfo[n].stDrawLinesArray[d].color={},this.privateExactLinesInfo[n].stDrawLinesArray[d].color.R=l.stDrawLinesArray[d].color.R,this.privateExactLinesInfo[n].stDrawLinesArray[d].color.G=l.stDrawLinesArray[d].color.G,this.privateExactLinesInfo[n].stDrawLinesArray[d].color.B=l.stDrawLinesArray[d].color.B,this.privateExactLinesInfo[n].stDrawLinesArray[d].color.A=l.stDrawLinesArray[d].color.A,this.privateExactLinesInfo[n].stDrawLinesArray[d].stPoint=[];for(var p=0;p<l.stDrawLinesArray[d].vertex_num;p++)this.privateExactLinesInfo[n].stDrawLinesArray[d].stPoint[p]={},this.privateExactLinesInfo[n].stDrawLinesArray[d].stPoint[p].x=l.stDrawLinesArray[d].stPoint[p].x,this.privateExactLinesInfo[n].stDrawLinesArray[d].stPoint[p].y=l.stDrawLinesArray[d].stPoint[p].y;this.privateExactLinesInfo[n].stDrawLinesArray[d].dwFillPicID=l.stDrawLinesArray[d].dwFillPicID,this.privateExactLinesInfo[n].stDrawLinesArray[d].eventid=l.stDrawLinesArray[d].dwEventID}}else this.maxExactPrivateLineTimeStamp<l.absTimeStamp&&(this.maxExactPrivateLineTimeStamp=l.absTimeStamp),this.privateExactLinesInfo.push(l)}if(i=!1,n=0,f.linesNum>0){if(this.privateNormalLinesInfo.length>=zt&&this.privateNormalLinesInfo.shift(),f.absTimeStamp<=this.maxNormalPrivateLineTimeStamp){var m=0;for(m=0;m<this.privateNormalLinesInfo.length;m++)if(this.privateNormalLinesInfo[m].absTimeStamp==f.absTimeStamp){i=!0,n=m;break}}if(i)for(var S=0;S<f.linesNum;S++)this.privateNormalLinesInfo[n].stDrawLinesArray.push(f.stDrawLinesArray[S]),++this.privateNormalLinesInfo[n].linesNum;else this.maxNormalPrivateLineTimeStamp<f.absTimeStamp&&(this.maxNormalPrivateLineTimeStamp=f.absTimeStamp),this.privateNormalLinesInfo.push(f)}if(h.linesNum>0)if(this.privateThermalLinesInfo.length>=zt&&this.privateThermalLinesInfo.shift(),0!=this.privateThermalLinesInfo.length){this.privateThermalLinesInfo[0].linesNum=h.linesNum;for(var R=0;R<h.linesNum;R++){this.privateThermalLinesInfo[0].stDrawLinesArray[R]={},this.privateThermalLinesInfo[0].stDrawLinesArray[R].vertex_num=h.stDrawLinesArray[R].vertex_num,this.privateThermalLinesInfo[0].stDrawLinesArray[R].lineWidth=h.stDrawLinesArray[R].lineWidth,this.privateThermalLinesInfo[0].stDrawLinesArray[R].bFill=h.stDrawLinesArray[R].bFill,this.privateThermalLinesInfo[0].stDrawLinesArray[R].bLoop=h.stDrawLinesArray[R].bLoop,this.privateThermalLinesInfo[0].stDrawLinesArray[R].dwMatchType=h.stDrawLinesArray[R].dwMatchType,this.privateThermalLinesInfo[0].stDrawLinesArray[R].dwIntelFlag=h.stDrawLinesArray[R].dwIntelFlag,this.privateThermalLinesInfo[0].stDrawLinesArray[R].dwSubIntelFlag=h.stDrawLinesArray[R].dwSubIntelFlag,this.privateThermalLinesInfo[0].stDrawLinesArray[R].color={},this.privateThermalLinesInfo[0].stDrawLinesArray[R].color.R=h.stDrawLinesArray[R].color.R,this.privateThermalLinesInfo[0].stDrawLinesArray[R].color.G=h.stDrawLinesArray[R].color.G,this.privateThermalLinesInfo[0].stDrawLinesArray[R].color.B=h.stDrawLinesArray[R].color.B,this.privateThermalLinesInfo[0].stDrawLinesArray[R].color.A=h.stDrawLinesArray[R].color.A,this.privateThermalLinesInfo[0].stDrawLinesArray[R].stPoint=[];for(var P=0;P<h.stDrawLinesArray[R].vertex_num;P++)this.privateThermalLinesInfo[0].stDrawLinesArray[R].stPoint[P]={},this.privateThermalLinesInfo[0].stDrawLinesArray[R].stPoint[P].x=h.stDrawLinesArray[R].stPoint[P].x,this.privateThermalLinesInfo[0].stDrawLinesArray[R].stPoint[P].y=h.stDrawLinesArray[R].stPoint[P].y}}else this.privateThermalLinesInfo.push(h);if(i=!1,n=0,_.linesNum>0){if(_.absTimeStamp<=this.maxExactRulePrivateLineTimeStamp){var y=0;for(y=0;y<this.privateExactRuleLinesInfo.length;y++)if(this.privateExactRuleLinesInfo[y].absTimeStamp==_.absTimeStamp){i=!0,n=y;break}}if(i){this.privateExactRuleLinesInfo[n].linesNum=_.linesNum;for(var b=0;b<_.linesNum;b++){this.privateExactRuleLinesInfo[n].stDrawLinesArray[b]={},this.privateExactRuleLinesInfo[n].stDrawLinesArray[b].vertex_num=_.stDrawLinesArray[b].vertex_num,this.privateExactRuleLinesInfo[n].stDrawLinesArray[b].lineWidth=_.stDrawLinesArray[b].lineWidth,this.privateExactRuleLinesInfo[n].stDrawLinesArray[b].bFill=_.stDrawLinesArray[b].bFill,this.privateExactRuleLinesInfo[n].stDrawLinesArray[b].bLoop=_.stDrawLinesArray[b].bLoop,this.privateExactRuleLinesInfo[n].stDrawLinesArray[b].dwMatchType=_.stDrawLinesArray[b].dwMatchType,this.privateExactRuleLinesInfo[n].stDrawLinesArray[b].dwIntelFlag=_.stDrawLinesArray[b].dwIntelFlag,this.privateExactRuleLinesInfo[n].stDrawLinesArray[b].dwSubIntelFlag=_.stDrawLinesArray[b].dwSubIntelFlag,this.privateExactRuleLinesInfo[n].stDrawLinesArray[b].color={},this.privateExactRuleLinesInfo[n].stDrawLinesArray[b].color.R=_.stDrawLinesArray[b].color.R,this.privateExactRuleLinesInfo[n].stDrawLinesArray[b].color.G=_.stDrawLinesArray[b].color.G,this.privateExactRuleLinesInfo[n].stDrawLinesArray[b].color.B=_.stDrawLinesArray[b].color.B,this.privateExactRuleLinesInfo[n].stDrawLinesArray[b].color.A=_.stDrawLinesArray[b].color.A,this.privateExactRuleLinesInfo[n].stDrawLinesArray[b].stPoint=[];for(var E=0;E<_.stDrawLinesArray[b].vertex_num;E++)this.privateExactRuleLinesInfo[n].stDrawLinesArray[b].stPoint[E]={},this.privateExactRuleLinesInfo[n].stDrawLinesArray[b].stPoint[E].x=_.stDrawLinesArray[b].stPoint[E].x,this.privateExactRuleLinesInfo[n].stDrawLinesArray[b].stPoint[E].y=_.stDrawLinesArray[b].stPoint[E].y}}else this.maxExactRulePrivateLineTimeStamp<_.absTimeStamp&&(this.maxExactRulePrivateLineTimeStamp=_.absTimeStamp),this.privateExactRuleLinesInfo.push(_)}if(i=!1,n=0,s.linesNum>0){if(s.absTimeStamp<=this.maxTargetPrivateLineTimeStamp){var g=0;for(g=0;g<this.privateTargetLinesInfo.length;g++)if(this.privateTargetLinesInfo[g].absTimeStamp==s.absTimeStamp){i=!0,n=g;break}}if(i){this.privateTargetLinesInfo[n].linesNum=s.linesNum;for(var C=0;C<s.linesNum;C++){this.privateTargetLinesInfo[n].stDrawLinesArray[C]={},this.privateTargetLinesInfo[n].stDrawLinesArray[C].vertex_num=s.stDrawLinesArray[C].vertex_num,this.privateTargetLinesInfo[n].stDrawLinesArray[C].lineWidth=s.stDrawLinesArray[C].lineWidth,this.privateTargetLinesInfo[n].stDrawLinesArray[C].bFill=s.stDrawLinesArray[C].bFill,this.privateTargetLinesInfo[n].stDrawLinesArray[C].bLoop=s.stDrawLinesArray[C].bLoop,this.privateTargetLinesInfo[n].stDrawLinesArray[C].dwMatchType=s.stDrawLinesArray[C].dwMatchType,this.privateTargetLinesInfo[n].stDrawLinesArray[C].dwIntelFlag=s.stDrawLinesArray[C].dwIntelFlag,this.privateTargetLinesInfo[n].stDrawLinesArray[C].dwSubIntelFlag=s.stDrawLinesArray[C].dwSubIntelFlag,this.privateTargetLinesInfo[n].stDrawLinesArray[C].color={},this.privateTargetLinesInfo[n].stDrawLinesArray[C].color.R=s.stDrawLinesArray[C].color.R,this.privateTargetLinesInfo[n].stDrawLinesArray[C].color.G=s.stDrawLinesArray[C].color.G,this.privateTargetLinesInfo[n].stDrawLinesArray[C].color.B=s.stDrawLinesArray[C].color.B,this.privateTargetLinesInfo[n].stDrawLinesArray[C].color.A=s.stDrawLinesArray[C].color.A,this.privateTargetLinesInfo[n].stDrawLinesArray[C].stPoint=[];for(var v=0;v<s.stDrawLinesArray[C].vertex_num;v++)this.privateTargetLinesInfo[n].stDrawLinesArray[C].stPoint[v]={},this.privateTargetLinesInfo[n].stDrawLinesArray[C].stPoint[v].x=s.stDrawLinesArray[C].stPoint[v].x,this.privateTargetLinesInfo[n].stDrawLinesArray[C].stPoint[v].y=s.stDrawLinesArray[C].stPoint[v].y;this.privateTargetLinesInfo[n].stDrawLinesArray[C].dwFillPicID=s.stDrawLinesArray[C].dwFillPicID,this.privateTargetLinesInfo[n].stDrawLinesArray[C].eventid=s.stDrawLinesArray[C].dwEventID}}else this.maxTargetPrivateLineTimeStamp<s.absTimeStamp&&(this.maxTargetPrivateLineTimeStamp=s.absTimeStamp),this.privateTargetLinesInfo.push(s)}if(i=!1,n=0,o.linesNum>0){if(this.privateMDLinesInfo.length>=zt&&this.privateMDLinesInfo.shift(),o.absTimeStamp<=this.maxMDPrivateLineTimeStamp){var T=0;for(T=0;T<this.privateMDLinesInfo.length;T++)if(this.privateMDLinesInfo[T].absTimeStamp==o.absTimeStamp){i=!0,n=T;break}}if(i){this.privateMDLinesInfo[n].linesNum=o.linesNum;for(var D=0;D<o.linesNum;D++){this.privateMDLinesInfo[n].stDrawLinesArray[D]={},this.privateMDLinesInfo[n].stDrawLinesArray[D].vertex_num=o.stDrawLinesArray[D].vertex_num,this.privateMDLinesInfo[n].stDrawLinesArray[D].lineWidth=o.stDrawLinesArray[D].lineWidth,this.privateMDLinesInfo[n].stDrawLinesArray[D].bFill=o.stDrawLinesArray[D].bFill,this.privateMDLinesInfo[n].stDrawLinesArray[D].bLoop=o.stDrawLinesArray[D].bLoop,this.privateMDLinesInfo[n].stDrawLinesArray[D].dwMatchType=o.stDrawLinesArray[D].dwMatchType,this.privateMDLinesInfo[n].stDrawLinesArray[D].dwIntelFlag=o.stDrawLinesArray[D].dwIntelFlag,this.privateMDLinesInfo[n].stDrawLinesArray[D].dwSubIntelFlag=o.stDrawLinesArray[D].dwSubIntelFlag,this.privateMDLinesInfo[n].stDrawLinesArray[D].color={},this.privateMDLinesInfo[n].stDrawLinesArray[D].color.R=o.stDrawLinesArray[D].color.R,this.privateMDLinesInfo[n].stDrawLinesArray[D].color.G=o.stDrawLinesArray[D].color.G,this.privateMDLinesInfo[n].stDrawLinesArray[D].color.B=o.stDrawLinesArray[D].color.B,this.privateMDLinesInfo[n].stDrawLinesArray[D].color.A=o.stDrawLinesArray[D].color.A,this.privateMDLinesInfo[n].stDrawLinesArray[D].stPoint=[];for(var A=0;A<o.stDrawLinesArray[D].vertex_num;A++)this.privateMDLinesInfo[n].stDrawLinesArray[D].stPoint[A]={},this.privateMDLinesInfo[n].stDrawLinesArray[D].stPoint[A].x=o.stDrawLinesArray[D].stPoint[A].x,this.privateMDLinesInfo[n].stDrawLinesArray[D].stPoint[A].y=o.stDrawLinesArray[D].stPoint[A].y}}else this.maxMDPrivateLineTimeStamp<o.absTimeStamp&&(this.maxMDPrivateLineTimeStamp=o.absTimeStamp),this.privateMDLinesInfo.push(o)}if(i=!1,n=0,x.linesNum>0){if(this.privateTemLinesInfo.length>=zt&&this.privateTemLinesInfo.shift(),x.absTimeStamp<=this.maxTemPrivateLineTimeStamp){var I=0;for(I=0;I<this.privateTemLinesInfo.length;I++)if(this.privateTemLinesInfo[I].absTimeStamp==x.absTimeStamp){i=!0,n=I;break}}if(i){this.privateTemLinesInfo[n].linesNum=x.linesNum;for(var M=0;M<x.linesNum;M++){this.privateTemLinesInfo[n].stDrawLinesArray[M]={},this.privateTemLinesInfo[n].stDrawLinesArray[M].vertex_num=x.stDrawLinesArray[M].vertex_num,this.privateTemLinesInfo[n].stDrawLinesArray[M].lineWidth=x.stDrawLinesArray[M].lineWidth,this.privateTemLinesInfo[n].stDrawLinesArray[M].bFill=x.stDrawLinesArray[M].bFill,this.privateTemLinesInfo[n].stDrawLinesArray[M].bLoop=x.stDrawLinesArray[M].bLoop,this.privateTemLinesInfo[n].stDrawLinesArray[M].dwMatchType=x.stDrawLinesArray[M].dwMatchType,this.privateTemLinesInfo[n].stDrawLinesArray[M].dwIntelFlag=x.stDrawLinesArray[M].dwIntelFlag,this.privateTemLinesInfo[n].stDrawLinesArray[M].dwSubIntelFlag=x.stDrawLinesArray[M].dwSubIntelFlag,this.privateTemLinesInfo[n].stDrawLinesArray[M].color={},this.privateTemLinesInfo[n].stDrawLinesArray[M].color.R=x.stDrawLinesArray[M].color.R,this.privateTemLinesInfo[n].stDrawLinesArray[M].color.G=x.stDrawLinesArray[M].color.G,this.privateTemLinesInfo[n].stDrawLinesArray[M].color.B=x.stDrawLinesArray[M].color.B,this.privateTemLinesInfo[n].stDrawLinesArray[M].color.A=x.stDrawLinesArray[M].color.A,this.privateTemLinesInfo[n].stDrawLinesArray[M].stPoint=[];for(var L=0;L<x.stDrawLinesArray[M].vertex_num;L++)this.privateTemLinesInfo[n].stDrawLinesArray[M].stPoint[L]={},this.privateTemLinesInfo[n].stDrawLinesArray[M].stPoint[L].x=x.stDrawLinesArray[M].stPoint[L].x,this.privateTemLinesInfo[n].stDrawLinesArray[M].stPoint[L].y=x.stDrawLinesArray[M].stPoint[L].y}}else this.maxTemPrivateLineTimeStamp<x.absTimeStamp&&(this.maxTemPrivateLineTimeStamp=x.absTimeStamp),this.privateTemLinesInfo.push(x)}}if(e.nFontsNum>0){var w={nFontsNum:0};w.absTimeStamp=e.absTimeStamp,w.stDrawFontsArray=[];var O={nFontsNum:0};O.absTimeStamp=e.absTimeStamp,O.stDrawFontsArray=[];var B={nFontsNum:0};B.absTimeStamp=e.absTimeStamp,B.stDrawFontsArray=[];var k={nFontsNum:0};k.absTimeStamp=e.absTimeStamp,k.stDrawFontsArray=[];var N={nFontsNum:0};N.absTimeStamp=e.absTimeStamp,N.stDrawFontsArray=[];var V={nFontsNum:0};V.absTimeStamp=e.absTimeStamp,V.stDrawFontsArray=[];for(var U=0;U<e.nFontsNum;U++)1==e.stDrawFontsArray[U].dwMatchType?1==e.stDrawFontsArray[U].dwIntelFlag?(N.stDrawFontsArray.push(e.stDrawFontsArray[U]),++N.nFontsNum):3==e.stDrawFontsArray[U].dwIntelFlag&&(V.stDrawFontsArray.push(e.stDrawFontsArray[U]),++V.nFontsNum):1==e.stDrawFontsArray[U].dwIntelFlag?(w.stDrawFontsArray.push(e.stDrawFontsArray[U]),++w.nFontsNum):4==e.stDrawFontsArray[U].dwIntelFlag?(this.m_nTEMDrawFontscount=0,O.stDrawFontsArray.push(e.stDrawFontsArray[U]),++O.nFontsNum):3==e.stDrawFontsArray[U].dwIntelFlag?e.stDrawFontsArray[U].NeedClearNormalPos?this.curNormalPOSFontsInfo=null:(k.stDrawFontsArray.push(e.stDrawFontsArray[U]),++k.nFontsNum):(B.stDrawFontsArray.push(e.stDrawFontsArray[U]),++B.nFontsNum);if(i=!1,n=0,V.nFontsNum>0){if(this.privateExactPOSFontsInfo.length>=zt&&this.privateExactPOSFontsInfo.shift(),V.absTimeStamp<=this.maxExactPOSPrivateFontTimeStamp){var H=0;for(H=0;H<this.privateExactPOSFontsInfo.length;H++)if(this.privateExactPOSFontsInfo[H].absTimeStamp==V.absTimeStamp){i=!0,n=H;break}}if(i){this.privateExactPOSFontsInfo[n].nFontsNum=V.nFontsNum;for(var W=0;W<V.nFontsNum;W++)this.privateExactPOSFontsInfo[n].stDrawFontsArray[W]={},this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].nFontSizeW=V.stDrawFontsArray[W].nFontSizeW,this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].nFontSizeH=V.stDrawFontsArray[W].nFontSizeH,this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].dwMatchType=V.stDrawFontsArray[W].dwMatchType,this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].dwIntelFlag=V.stDrawFontsArray[W].dwIntelFlag,this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].dwSubIntelFlag=V.stDrawFontsArray[W].dwSubIntelFlag,this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].color={},this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].color.R=V.stDrawFontsArray[W].color.R,this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].color.G=V.stDrawFontsArray[W].color.G,this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].color.B=V.stDrawFontsArray[W].color.B,this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].color.A=V.stDrawFontsArray[W].color.A,this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].stPoint={},this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].stPoint.x=V.stDrawFontsArray[W].stPoint.x,this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].stPoint.y=V.stDrawFontsArray[W].stPoint.y,this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].fontString=V.stDrawFontsArray[W].fontString,this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].BGcolor={},this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].BGcolor.R=V.stDrawFontsArray[W].BGcolor.R,this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].BGcolor.G=V.stDrawFontsArray[W].BGcolor.G,this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].BGcolor.B=V.stDrawFontsArray[W].BGcolor.B,this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].BGcolor.A=V.stDrawFontsArray[W].BGcolor.A,this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].bBackGround=V.stDrawFontsArray[W].bBackGround,this.privateExactPOSFontsInfo[n].stDrawFontsArray[W].EventID=V.stDrawFontsArray[W].dwEventID}else this.maxExactPOSPrivateFontTimeStamp<V.absTimeStamp&&(this.maxExactPOSPrivateFontTimeStamp=V.absTimeStamp),this.privateExactPOSFontsInfo.push(V)}if(i=!1,n=0,N.nFontsNum>0){if(this.privateExactFontsInfo.length>=zt&&this.privateExactFontsInfo.shift(),N.absTimeStamp<=this.maxExactPrivateFontTimeStamp){var Y=0;for(Y=0;Y<this.privateExactFontsInfo.length;Y++)if(this.privateExactFontsInfo[Y].absTimeStamp==N.absTimeStamp){i=!0,n=Y;break}}if(i)for(var G=0;G<N.nFontsNum;G++)this.privateExactFontsInfo[n].stDrawFontsArray.push(N.stDrawFontsArray[G]),++this.privateExactFontsInfo[n].nFontsNum;else this.maxExactPrivateFontTimeStamp<N.absTimeStamp&&(this.maxExactPrivateFontTimeStamp=N.absTimeStamp),this.privateExactFontsInfo.push(N)}if(i=!1,n=0,B.nFontsNum>0){if(this.privateNormalFontsInfo.length>=zt&&this.privateNormalFontsInfo.shift(),B.absTimeStamp<=this.maxNormalPrivateFontTimeStamp){var X=0;for(X=0;X<this.privateNormalFontsInfo.length;X++)if(this.privateNormalFontsInfo[X].absTimeStamp==B.absTimeStamp){i=!0,n=X;break}}if(i)for(var J=0;J<B.nFontsNum;J++)this.privateNormalFontsInfo[n].stDrawFontsArray.push(B.stDrawFontsArray[J]),++this.privateNormalFontsInfo[n].nFontsNum;else this.maxNormalPrivateFontTimeStamp<B.absTimeStamp&&(this.maxNormalPrivateFontTimeStamp=B.absTimeStamp),this.privateNormalFontsInfo.push(B)}if(k.nFontsNum>0)if(null==this.curNormalPOSFontsInfo)this.curNormalPOSFontsInfo=k;else{this.curNormalPOSFontsInfo.nFontsNum=k.nFontsNum,this.curNormalPOSFontsInfo.absTimeStamp=k.absTimeStamp;for(var Z=0;Z<k.nFontsNum;Z++)this.curNormalPOSFontsInfo.stDrawFontsArray[Z]={},this.curNormalPOSFontsInfo.stDrawFontsArray[Z].nFontSizeW=k.stDrawFontsArray[Z].nFontSizeW,this.curNormalPOSFontsInfo.stDrawFontsArray[Z].nFontSizeH=k.stDrawFontsArray[Z].nFontSizeH,this.curNormalPOSFontsInfo.stDrawFontsArray[Z].dwMatchType=k.stDrawFontsArray[Z].dwMatchType,this.curNormalPOSFontsInfo.stDrawFontsArray[Z].dwIntelFlag=k.stDrawFontsArray[Z].dwIntelFlag,this.curNormalPOSFontsInfo.stDrawFontsArray[Z].dwSubIntelFlag=k.stDrawFontsArray[Z].dwSubIntelFlag,this.curNormalPOSFontsInfo.stDrawFontsArray[Z].color={},this.curNormalPOSFontsInfo.stDrawFontsArray[Z].color.R=k.stDrawFontsArray[Z].color.R,this.curNormalPOSFontsInfo.stDrawFontsArray[Z].color.G=k.stDrawFontsArray[Z].color.G,this.curNormalPOSFontsInfo.stDrawFontsArray[Z].color.B=k.stDrawFontsArray[Z].color.B,this.curNormalPOSFontsInfo.stDrawFontsArray[Z].color.A=k.stDrawFontsArray[Z].color.A,this.curNormalPOSFontsInfo.stDrawFontsArray[Z].stPoint={},this.curNormalPOSFontsInfo.stDrawFontsArray[Z].stPoint.x=k.stDrawFontsArray[Z].stPoint.x,this.curNormalPOSFontsInfo.stDrawFontsArray[Z].stPoint.y=k.stDrawFontsArray[Z].stPoint.y,this.curNormalPOSFontsInfo.stDrawFontsArray[Z].fontString=k.stDrawFontsArray[Z].fontString,this.curNormalPOSFontsInfo.stDrawFontsArray[Z].BGcolor={},this.curNormalPOSFontsInfo.stDrawFontsArray[Z].BGcolor.R=k.stDrawFontsArray[Z].BGcolor.R,this.curNormalPOSFontsInfo.stDrawFontsArray[Z].BGcolor.G=k.stDrawFontsArray[Z].BGcolor.G,this.curNormalPOSFontsInfo.stDrawFontsArray[Z].BGcolor.B=k.stDrawFontsArray[Z].BGcolor.B,this.curNormalPOSFontsInfo.stDrawFontsArray[Z].BGcolor.A=k.stDrawFontsArray[Z].BGcolor.A,this.curNormalPOSFontsInfo.stDrawFontsArray[Z].bBackGround=k.stDrawFontsArray[Z].bBackGround,this.curNormalPOSFontsInfo.stDrawFontsArray[Z].EventID=k.stDrawFontsArray[Z].dwEventID}if(i=!1,n=0,w.nFontsNum>0){if(this.privateTargetFontsInfo.length>=zt&&this.privateTargetFontsInfo.shift(),w.absTimeStamp<=this.maxTargetPrivateFontTimeStamp){var j=0;for(j=0;j<this.privateTargetFontsInfo.length;j++)if(this.privateTargetFontsInfo[j].absTimeStamp==w.absTimeStamp){i=!0,n=j;break}}if(i){this.privateTargetFontsInfo[n].nFontsNum=w.nFontsNum;for(var z=0;z<w.nFontsNum;z++)this.privateTargetFontsInfo[n].stDrawFontsArray[z]={},this.privateTargetFontsInfo[n].stDrawFontsArray[z].nFontSizeW=w.stDrawFontsArray[z].nFontSizeW,this.privateTargetFontsInfo[n].stDrawFontsArray[z].nFontSizeH=w.stDrawFontsArray[z].nFontSizeH,this.privateTargetFontsInfo[n].stDrawFontsArray[z].dwMatchType=w.stDrawFontsArray[z].dwMatchType,this.privateTargetFontsInfo[n].stDrawFontsArray[z].dwIntelFlag=w.stDrawFontsArray[z].dwIntelFlag,this.privateTargetFontsInfo[n].stDrawFontsArray[z].dwSubIntelFlag=w.stDrawFontsArray[z].dwSubIntelFlag,this.privateTargetFontsInfo[n].stDrawFontsArray[z].color={},this.privateTargetFontsInfo[n].stDrawFontsArray[z].color.R=w.stDrawFontsArray[z].color.R,this.privateTargetFontsInfo[n].stDrawFontsArray[z].color.G=w.stDrawFontsArray[z].color.G,this.privateTargetFontsInfo[n].stDrawFontsArray[z].color.B=w.stDrawFontsArray[z].color.B,this.privateTargetFontsInfo[n].stDrawFontsArray[z].color.A=w.stDrawFontsArray[z].color.A,this.privateTargetFontsInfo[n].stDrawFontsArray[z].stPoint={},this.privateTargetFontsInfo[n].stDrawFontsArray[z].stPoint.x=w.stDrawFontsArray[z].stPoint.x,this.privateTargetFontsInfo[n].stDrawFontsArray[z].stPoint.y=w.stDrawFontsArray[z].stPoint.y,this.privateTargetFontsInfo[n].stDrawFontsArray[z].fontString=w.stDrawFontsArray[z].fontString,this.privateTargetFontsInfo[n].stDrawFontsArray[z].BGcolor={},this.privateTargetFontsInfo[n].stDrawFontsArray[z].BGcolor.R=w.stDrawFontsArray[z].BGcolor.R,this.privateTargetFontsInfo[n].stDrawFontsArray[z].BGcolor.G=w.stDrawFontsArray[z].BGcolor.G,this.privateTargetFontsInfo[n].stDrawFontsArray[z].BGcolor.B=w.stDrawFontsArray[z].BGcolor.B,this.privateTargetFontsInfo[n].stDrawFontsArray[z].BGcolor.A=w.stDrawFontsArray[z].BGcolor.A,this.privateTargetFontsInfo[n].stDrawFontsArray[z].bBackGround=w.stDrawFontsArray[z].bBackGround}else this.maxTargetPrivateFontTimeStamp<w.absTimeStamp&&(this.maxTargetPrivateFontTimeStamp=w.absTimeStamp),this.privateTargetFontsInfo.push(w)}if(i=!1,n=0,O.nFontsNum>0){if(this.privateTemFontsInfo.length>=zt&&this.privateTemFontsInfo.shift(),O.absTimeStamp<=this.maxTemPrivateFontTimeStamp){var K=0;for(K=0;K<this.privateTemFontsInfo.length;K++)if(this.privateTemFontsInfo[K].absTimeStamp==O.absTimeStamp){i=!0,n=K;break}}if(i){this.privateTemFontsInfo[n].nFontsNum=O.nFontsNum;for(var q=0;q<O.nFontsNum;q++)this.privateTemFontsInfo[n].stDrawFontsArray[q]={},this.privateTemFontsInfo[n].stDrawFontsArray[q].nFontSizeW=O.stDrawFontsArray[q].nFontSizeW,this.privateTemFontsInfo[n].stDrawFontsArray[q].nFontSizeH=O.stDrawFontsArray[q].nFontSizeH,this.privateTemFontsInfo[n].stDrawFontsArray[q].dwMatchType=O.stDrawFontsArray[q].dwMatchType,this.privateTemFontsInfo[n].stDrawFontsArray[q].dwIntelFlag=O.stDrawFontsArray[q].dwIntelFlag,this.privateTemFontsInfo[n].stDrawFontsArray[q].dwSubIntelFlag=O.stDrawFontsArray[q].dwSubIntelFlag,this.privateTemFontsInfo[n].stDrawFontsArray[q].color={},this.privateTemFontsInfo[n].stDrawFontsArray[q].color.R=O.stDrawFontsArray[q].color.R,this.privateTemFontsInfo[n].stDrawFontsArray[q].color.G=O.stDrawFontsArray[q].color.G,this.privateTemFontsInfo[n].stDrawFontsArray[q].color.B=O.stDrawFontsArray[q].color.B,this.privateTemFontsInfo[n].stDrawFontsArray[q].color.A=O.stDrawFontsArray[q].color.A,this.privateTemFontsInfo[n].stDrawFontsArray[q].stPoint={},this.privateTemFontsInfo[n].stDrawFontsArray[q].stPoint.x=O.stDrawFontsArray[q].stPoint.x,this.privateTemFontsInfo[n].stDrawFontsArray[q].stPoint.y=O.stDrawFontsArray[q].stPoint.y,this.privateTemFontsInfo[n].stDrawFontsArray[q].fontString=O.stDrawFontsArray[q].fontString}else this.maxTemPrivateFontTimeStamp<O.absTimeStamp&&(this.maxTemPrivateFontTimeStamp=O.absTimeStamp),this.privateTemFontsInfo.push(O)}}if(i=!1,n=0,4==a.nPixelFormat){if(this.privateImageInfo.length>=zt&&this.privateImageInfo.shift(),a.absTimeStamp<=this.maxPrivateImageTimeStamp){var Q=0;for(Q=0;Q<this.privateImageInfo.length;Q++)if(this.privateImageInfo[Q].absTimeStamp==a.absTimeStamp){i=!0,n=Q;break}}i?(this.privateImageInfo[n].nWidth=a.nWidth,this.privateImageInfo[n].nHeight=a.nHeight,this.privateImageInfo[n].pstRect={},this.privateImageInfo[n].pstRect.fTop=a.pstRect.fTop,this.privateImageInfo[n].pstRect.fBottom=a.pstRect.fBottom,this.privateImageInfo[n].pstRect.fLeft=a.pstRect.fLeft,this.privateImageInfo[n].pstRect.fRight=a.pstRect.fRight,this.privateImageInfo[n].nPixelFormat=a.nPixelFormat,this.privateImageInfo[n].fAlpha=a.fAlpha,this.privateImageInfo[n].picImageData=a.picImageData):(this.maxPrivateImageTimeStamp<a.absTimeStamp&&(this.maxPrivateImageTimeStamp=a.absTimeStamp),this.privateImageInfo.push(a))}else if(256==a.nPixelFormat&&null!=a.picImageData)try{var $=new ImageDecoder({data:a.picImageData,type:"image/png"});$.tracks.ready.then((function(){return $.completed})).then((function(){return $.decode({frameIndex:0})})).then((function(t){r.privatePNGImageInfo.length>=20&&r.privatePNGImageInfo.shift();var e=r.privatePNGImageInfo.findIndex((function(t){return t.PicID===a.PicID}));-1!==e?r.privatePNGImageInfo[e]=F(F({},r.privatePNGImageInfo[e]),{},{PicID:a.PicID,videoStream:t.image,nImageWidth:t.image.displayWidth,nImageHeight:t.image.displayHeight,pstRectPos:{fTop:a.pstRect.fTop,fBottom:a.pstRect.fBottom,fLeft:a.pstRect.fLeft,fRight:a.pstRect.fRight},nPixelFormat:a.nPixelFormat,fAlpha:a.fAlpha}):r.privatePNGImageInfo.push({PicID:a.PicID,videoStream:t.image,nImageWidth:t.image.displayWidth,nImageHeight:t.image.displayHeight,pstRectPos:{fTop:a.pstRect.fTop,fBottom:a.pstRect.fBottom,fLeft:a.pstRect.fLeft,fRight:a.pstRect.fRight},nPixelFormat:a.nPixelFormat,fAlpha:a.fAlpha})})).catch((function(t){console.error("Image processing failed:",t)}))}catch(t){console.error("ImageDecoder initialization failed:",t)}return 1}},{key:"CheckLinesInfo",value:function(){if(this.DrawlinesParamArray.splice(0,this.DrawlinesParamArray.length),this.DrawlinesParamArrayAllPointNum=0,this.bDrawlinesParamArrayFill=0,this.DrawMosaiclinesParamArray.splice(0,this.DrawMosaiclinesParamArray.length),this.DrawTargetlinesParamArray.splice(0,this.DrawTargetlinesParamArray.length),null!=this.curNormalLinesInfo)for(var t=[],e=0,a=0;a<this.curNormalLinesInfo.linesNum;a++)if(2==this.curNormalLinesInfo.stDrawLinesArray[a].dwIntelFlag&&1==this.m_bEnableIVSEx||7==this.curNormalLinesInfo.stDrawLinesArray[a].dwIntelFlag&&1==this.m_bEnableFIREEx&&(1==this.curNormalLinesInfo.stDrawLinesArray[a].dwSubIntelFlag&&1==this.m_bEnableFireDis||4==this.curNormalLinesInfo.stDrawLinesArray[a].dwSubIntelFlag&&1==this.m_bEnableFireMaxPos)||8==this.curNormalLinesInfo.stDrawLinesArray[a].dwIntelFlag&&1==this.m_bEnableThermal&&4==this.curNormalLinesInfo.stDrawLinesArray[a].dwSubIntelFlag&&1==this.m_bEnableThermalTargetGas||9==this.curNormalLinesInfo.stDrawLinesArray[a].dwIntelFlag&&1==this.m_bEnableTrackEx&&(1==this.curNormalLinesInfo.stDrawLinesArray[a].dwSubIntelFlag&&1==this.m_bEnableTrackPeople||2==this.curNormalLinesInfo.stDrawLinesArray[a].dwSubIntelFlag&&1==this.m_bEnableTrackVehicle)){t[e]={},t[e].nPointNum=this.curNormalLinesInfo.stDrawLinesArray[a].vertex_num,t[e].nLineWidth=this.curNormalLinesInfo.stDrawLinesArray[a].lineWidth,this.curNormalLinesInfo.stDrawLinesArray[a].bFill,t[e].bLoop=this.curNormalLinesInfo.stDrawLinesArray[a].bLoop,t[e].pstColor={},t[e].pstColor.fR=this.curNormalLinesInfo.stDrawLinesArray[a].color.R,t[e].pstColor.fG=this.curNormalLinesInfo.stDrawLinesArray[a].color.G,t[e].pstColor.fB=this.curNormalLinesInfo.stDrawLinesArray[a].color.B,t[e].pstColor.fA=this.curNormalLinesInfo.stDrawLinesArray[a].color.A,t[e].pstPoints=[];for(var r=0;r<t[e].nPointNum;r++)t[e].pstPoints[r]={},t[e].pstPoints[r].fX=this.curNormalLinesInfo.stDrawLinesArray[a].stPoint[r].x,t[e].pstPoints[r].fY=this.curNormalLinesInfo.stDrawLinesArray[a].stPoint[r].y;t[e].dwMosaictype=this.curNormalLinesInfo.stDrawLinesArray[a].dwMosaictype,t[e].dwMosaictype?this.DrawMosaiclinesParamArray.push(t[e]):(this.DrawlinesParamArray.push(t[e]),this.DrawlinesParamArrayAllPointNum+=t[e].nPointNum,t[e].nPointNum),++e}if(null!=this.curThermalLinesInfo)for(var i=[],n=0,s=0;s<this.curThermalLinesInfo.linesNum;s++)if(8==this.curThermalLinesInfo.stDrawLinesArray[s].dwIntelFlag&&1==this.m_bEnableThermal&&(1==this.curThermalLinesInfo.stDrawLinesArray[s].dwSubIntelFlag&&1==this.m_bEnableThermalFireMask||2==this.curThermalLinesInfo.stDrawLinesArray[s].dwSubIntelFlag&&1==this.m_bEnableThermalRuleGas)){i[n]={},i[n].nPointNum=this.curThermalLinesInfo.stDrawLinesArray[s].vertex_num,i[n].nLineWidth=this.curThermalLinesInfo.stDrawLinesArray[s].lineWidth,this.curThermalLinesInfo.stDrawLinesArray[s].bFill,i[n].bLoop=this.curThermalLinesInfo.stDrawLinesArray[s].bLoop,i[n].pstColor={},i[n].pstColor.fR=this.curThermalLinesInfo.stDrawLinesArray[s].color.R,i[n].pstColor.fG=this.curThermalLinesInfo.stDrawLinesArray[s].color.G,i[n].pstColor.fB=this.curThermalLinesInfo.stDrawLinesArray[s].color.B,i[n].pstColor.fA=this.curThermalLinesInfo.stDrawLinesArray[s].color.A,i[n].pstPoints=[];for(var x=0;x<i[n].nPointNum;x++)i[n].pstPoints[x]={},i[n].pstPoints[x].fX=this.curThermalLinesInfo.stDrawLinesArray[s].stPoint[x].x,i[n].pstPoints[x].fY=this.curThermalLinesInfo.stDrawLinesArray[s].stPoint[x].y;this.DrawlinesParamArray.push(i[n]),this.DrawlinesParamArrayAllPointNum+=i[n].nPointNum,i[n].nPointNum,++n}if(null!=this.curTemLinesInfo)for(var o=[],f=0,l=0;l<this.curTemLinesInfo.linesNum;l++)if(1==this.m_bEnableTEMEx&&(1==this.curTemLinesInfo.stDrawLinesArray[l].dwSubIntelFlag&&1==this.m_bEnableTEMBox||2==this.curTemLinesInfo.stDrawLinesArray[l].dwSubIntelFlag&&1==this.m_bEnableTEMLine||4==this.curTemLinesInfo.stDrawLinesArray[l].dwSubIntelFlag&&1==this.m_bEnableTEMPoint)){o[f]={},o[f].nPointNum=this.curTemLinesInfo.stDrawLinesArray[l].vertex_num,o[f].nLineWidth=this.curTemLinesInfo.stDrawLinesArray[l].lineWidth,this.curTemLinesInfo.stDrawLinesArray[l].bFill,o[f].bLoop=this.curTemLinesInfo.stDrawLinesArray[l].bLoop,o[f].pstColor={},o[f].pstColor.fR=this.curTemLinesInfo.stDrawLinesArray[l].color.R,o[f].pstColor.fG=this.curTemLinesInfo.stDrawLinesArray[l].color.G,o[f].pstColor.fB=this.curTemLinesInfo.stDrawLinesArray[l].color.B,o[f].pstColor.fA=this.curTemLinesInfo.stDrawLinesArray[l].color.A,o[f].pstPoints=[];for(var _=0;_<o[f].nPointNum;_++)o[f].pstPoints[_]={},o[f].pstPoints[_].fX=this.curTemLinesInfo.stDrawLinesArray[l].stPoint[_].x,o[f].pstPoints[_].fY=this.curTemLinesInfo.stDrawLinesArray[l].stPoint[_].y;this.DrawlinesParamArray.push(o[f]),this.DrawlinesParamArrayAllPointNum+=o[f].nPointNum,o[f].nPointNum,++f}if(null!=this.curTargetLinesInfo)for(var h=[],c=0,u=0;u<this.curTargetLinesInfo.linesNum;u++)if(1==this.m_bEnableIVSEx){h[c]={},h[c].nPointNum=this.curTargetLinesInfo.stDrawLinesArray[u].vertex_num,h[c].nLineWidth=this.curTargetLinesInfo.stDrawLinesArray[u].lineWidth,this.curTargetLinesInfo.stDrawLinesArray[u].bFill,h[c].bLoop=this.curTargetLinesInfo.stDrawLinesArray[u].bLoop,h[c].pstColor={},h[c].pstColor.fR=this.curTargetLinesInfo.stDrawLinesArray[u].color.R,h[c].pstColor.fG=this.curTargetLinesInfo.stDrawLinesArray[u].color.G,h[c].pstColor.fB=this.curTargetLinesInfo.stDrawLinesArray[u].color.B,h[c].pstColor.fA=this.curTargetLinesInfo.stDrawLinesArray[u].color.A,h[c].pstPoints=[];for(var d=0;d<h[c].nPointNum;d++)h[c].pstPoints[d]={},h[c].pstPoints[d].fX=this.curTargetLinesInfo.stDrawLinesArray[u].stPoint[d].x,h[c].pstPoints[d].fY=this.curTargetLinesInfo.stDrawLinesArray[u].stPoint[d].y;h[c].dwFillPicID=this.curTargetLinesInfo.stDrawLinesArray[u].dwFillPicID,h[c].eventid=this.curTargetLinesInfo.stDrawLinesArray[u].eventid,this.DrawTargetlinesParamArray.push(h[c]),++c}if(null!=this.curMDLinesInfo)for(var p=[],m=0,S=0;S<this.curMDLinesInfo.linesNum;S++)if(1==this.m_bEnableMDEx){p[m]={},p[m].nPointNum=this.curMDLinesInfo.stDrawLinesArray[S].vertex_num,p[m].nLineWidth=this.curMDLinesInfo.stDrawLinesArray[S].lineWidth,this.curMDLinesInfo.stDrawLinesArray[S].bFill,p[m].bLoop=this.curMDLinesInfo.stDrawLinesArray[S].bLoop,p[m].pstColor={},p[m].pstColor.fR=this.curMDLinesInfo.stDrawLinesArray[S].color.R,p[m].pstColor.fG=this.curMDLinesInfo.stDrawLinesArray[S].color.G,p[m].pstColor.fB=this.curMDLinesInfo.stDrawLinesArray[S].color.B,p[m].pstColor.fA=this.curMDLinesInfo.stDrawLinesArray[S].color.A,p[m].pstPoints=[];for(var R=0;R<p[m].nPointNum;R++)p[m].pstPoints[R]={},p[m].pstPoints[R].fX=this.curMDLinesInfo.stDrawLinesArray[S].stPoint[R].x,p[m].pstPoints[R].fY=this.curMDLinesInfo.stDrawLinesArray[S].stPoint[R].y;this.DrawlinesParamArray.push(p[m]),this.DrawlinesParamArrayAllPointNum+=p[m].nPointNum,p[m].nPointNum,++m}if(null!=this.curExactLinesInfo)for(var P=[],y=0,b=0;b<this.curExactLinesInfo.linesNum;b++)if(1==this.curExactLinesInfo.stDrawLinesArray[b].dwIntelFlag&&1==this.m_bEnableIVSEx||9==this.curExactLinesInfo.stDrawLinesArray[b].dwIntelFlag&&1==this.m_bEnableTrackEx&&(1==this.curExactLinesInfo.stDrawLinesArray[b].dwSubIntelFlag&&1==this.m_bEnableTrackPeople||2==this.curExactLinesInfo.stDrawLinesArray[b].dwSubIntelFlag&&1==this.m_bEnableTrackVehicle)){P[y]={},P[y].nPointNum=this.curExactLinesInfo.stDrawLinesArray[b].vertex_num,P[y].nLineWidth=this.curExactLinesInfo.stDrawLinesArray[b].lineWidth,this.curExactLinesInfo.stDrawLinesArray[b].bFill,P[y].bLoop=this.curExactLinesInfo.stDrawLinesArray[b].bLoop,P[y].pstColor={},P[y].pstColor.fR=this.curExactLinesInfo.stDrawLinesArray[b].color.R,P[y].pstColor.fG=this.curExactLinesInfo.stDrawLinesArray[b].color.G,P[y].pstColor.fB=this.curExactLinesInfo.stDrawLinesArray[b].color.B,P[y].pstColor.fA=this.curExactLinesInfo.stDrawLinesArray[b].color.A,P[y].pstPoints=[];for(var E=0;E<P[y].nPointNum;E++)P[y].pstPoints[E]={},P[y].pstPoints[E].fX=this.curExactLinesInfo.stDrawLinesArray[b].stPoint[E].x,P[y].pstPoints[E].fY=this.curExactLinesInfo.stDrawLinesArray[b].stPoint[E].y;P[y].dwFillPicID=this.curExactLinesInfo.stDrawLinesArray[b].dwFillPicID,P[y].eventid=this.curExactLinesInfo.stDrawLinesArray[b].eventid,P[y].dwMosaictype=this.curExactLinesInfo.stDrawLinesArray[b].dwMosaictype,P[y].dwMosaictype?this.DrawMosaiclinesParamArray.push(P[y]):this.DrawTargetlinesParamArray.push(P[y]),++y}if(null!=this.curExactRuleLinesInfo)for(var g=[],F=0,C=0;C<this.curExactRuleLinesInfo.linesNum;C++)if(1==this.m_bEnableIVSEx){g[F]={},g[F].nPointNum=this.curExactRuleLinesInfo.stDrawLinesArray[C].vertex_num,g[F].nLineWidth=this.curExactRuleLinesInfo.stDrawLinesArray[C].lineWidth,this.curExactRuleLinesInfo.stDrawLinesArray[C].bFill,g[F].bLoop=this.curExactRuleLinesInfo.stDrawLinesArray[C].bLoop,g[F].pstColor={},g[F].pstColor.fR=this.curExactRuleLinesInfo.stDrawLinesArray[C].color.R,g[F].pstColor.fG=this.curExactRuleLinesInfo.stDrawLinesArray[C].color.G,g[F].pstColor.fB=this.curExactRuleLinesInfo.stDrawLinesArray[C].color.B,g[F].pstColor.fA=this.curExactRuleLinesInfo.stDrawLinesArray[C].color.A,g[F].pstPoints=[];for(var v=0;v<g[F].nPointNum;v++)g[F].pstPoints[v]={},g[F].pstPoints[v].fX=this.curExactRuleLinesInfo.stDrawLinesArray[C].stPoint[v].x,g[F].pstPoints[v].fY=this.curExactRuleLinesInfo.stDrawLinesArray[C].stPoint[v].y;this.DrawlinesParamArray.push(g[F]),this.DrawlinesParamArrayAllPointNum+=g[F].nPointNum,g[F].nPointNum,++F}}},{key:"CheckFontsInfo",value:function(){if(this.DrawFontParamArray.splice(0,this.DrawFontParamArray.length),this.DrawPOSFontsParamArray.splice(0,this.DrawPOSFontsParamArray.length),null!=this.curNormalFontsInfo)for(var t=[],e=0,a=0;a<this.curNormalFontsInfo.nFontsNum;a++)7==this.curNormalFontsInfo.stDrawFontsArray[a].dwIntelFlag&&1==this.m_bEnableFIREEx&&(1==this.curNormalFontsInfo.stDrawFontsArray[a].dwSubIntelFlag&&1==this.m_bEnableFireDis||8==this.curNormalFontsInfo.stDrawFontsArray[a].dwSubIntelFlag&&1==this.m_bEnableFireDistance)&&(t[e]={},t[e].pString=this.curNormalFontsInfo.stDrawFontsArray[a].fontString,t[e].nFontWidth=this.curNormalFontsInfo.stDrawFontsArray[a].nFontSizeW,t[e].nFontHeight=this.curNormalFontsInfo.stDrawFontsArray[a].nFontSizeH,t[e].pstStartPos={},t[e].pstStartPos.fX=this.curNormalFontsInfo.stDrawFontsArray[a].stPoint.x,t[e].pstStartPos.fY=this.curNormalFontsInfo.stDrawFontsArray[a].stPoint.y,t[e].pstFontColor={},t[e].pstFontColor.fR=this.curNormalFontsInfo.stDrawFontsArray[a].color.R,t[e].pstFontColor.fG=this.curNormalFontsInfo.stDrawFontsArray[a].color.G,t[e].pstFontColor.fB=this.curNormalFontsInfo.stDrawFontsArray[a].color.B,t[e].pstFontColor.fA=this.curNormalFontsInfo.stDrawFontsArray[a].color.A,t[e].bBackGround=!1,t[e].pstBGColor=null,t[e].fRotateAngle=0,t[e].pFontFamily="sans-serif",this.DrawFontParamArray.push(t[e]),++e);if(null!=this.curNormalPOSFontsInfo)for(var r=[],i=0,n=0;n<this.curNormalPOSFontsInfo.nFontsNum;n++)1==this.m_bDisPos&&(r[i]={},r[i].pString=this.curNormalPOSFontsInfo.stDrawFontsArray[n].fontString,r[i].nFontWidth=this.curNormalPOSFontsInfo.stDrawFontsArray[n].nFontSizeW,r[i].nFontHeight=this.curNormalPOSFontsInfo.stDrawFontsArray[n].nFontSizeH,r[i].pstStartPos={},r[i].pstStartPos.fX=this.curNormalPOSFontsInfo.stDrawFontsArray[n].stPoint.x,r[i].pstStartPos.fY=this.curNormalPOSFontsInfo.stDrawFontsArray[n].stPoint.y,r[i].pstFontColor={},r[i].pstFontColor.fR=this.curNormalPOSFontsInfo.stDrawFontsArray[n].color.R,r[i].pstFontColor.fG=this.curNormalPOSFontsInfo.stDrawFontsArray[n].color.G,r[i].pstFontColor.fB=this.curNormalPOSFontsInfo.stDrawFontsArray[n].color.B,r[i].pstFontColor.fA=this.curNormalPOSFontsInfo.stDrawFontsArray[n].color.A,r[i].bBackGround=this.curNormalPOSFontsInfo.stDrawFontsArray[n].bBackGround,r[i].pstBGColor={},r[i].pstBGColor.fR=this.curNormalPOSFontsInfo.stDrawFontsArray[n].BGcolor.R,r[i].pstBGColor.fG=this.curNormalPOSFontsInfo.stDrawFontsArray[n].BGcolor.G,r[i].pstBGColor.fB=this.curNormalPOSFontsInfo.stDrawFontsArray[n].BGcolor.B,r[i].pstBGColor.fA=this.curNormalPOSFontsInfo.stDrawFontsArray[n].BGcolor.A,r[i].fRotateAngle=0,r[i].pFontFamily="sans-serif",r[i].EventID=this.curNormalPOSFontsInfo.stDrawFontsArray[n].EventID,this.DrawPOSFontsParamArray.push(r[i]),++i);if(null!=this.curTemFontsInfo)for(var s=[],x=0,o=0;o<this.curTemFontsInfo.nFontsNum;o++)1==this.m_bEnableTEMEx&&(1==this.curTemFontsInfo.stDrawFontsArray[o].dwSubIntelFlag&&1==this.m_bEnableTEMBox||2==this.curTemFontsInfo.stDrawFontsArray[o].dwSubIntelFlag&&1==this.m_bEnableTEMLine||4==this.curTemFontsInfo.stDrawFontsArray[o].dwSubIntelFlag&&1==this.m_bEnableTEMPoint)&&(s[x]={},s[x].pString=this.curTemFontsInfo.stDrawFontsArray[o].fontString,s[x].nFontWidth=this.curTemFontsInfo.stDrawFontsArray[o].nFontSizeW,s[x].nFontHeight=this.curTemFontsInfo.stDrawFontsArray[o].nFontSizeH,s[x].pstStartPos={},s[x].pstStartPos.fX=this.curTemFontsInfo.stDrawFontsArray[o].stPoint.x,s[x].pstStartPos.fY=this.curTemFontsInfo.stDrawFontsArray[o].stPoint.y,s[x].pstFontColor={},s[x].pstFontColor.fR=this.curTemFontsInfo.stDrawFontsArray[o].color.R,s[x].pstFontColor.fG=this.curTemFontsInfo.stDrawFontsArray[o].color.G,s[x].pstFontColor.fB=this.curTemFontsInfo.stDrawFontsArray[o].color.B,s[x].pstFontColor.fA=this.curTemFontsInfo.stDrawFontsArray[o].color.A,s[x].bBackGround=!1,s[x].pstBGColor=null,s[x].fRotateAngle=0,s[x].pFontFamily="sans-serif",this.DrawFontParamArray.push(s[x]),++x);if(null!=this.curTargetFontsInfo)for(var f=[],l=0,_=0;_<this.curTargetFontsInfo.nFontsNum;_++)1==this.m_bEnableIVSEx&&(f[l]={},f[l].pString=this.curTargetFontsInfo.stDrawFontsArray[_].fontString,f[l].nFontWidth=this.curTargetFontsInfo.stDrawFontsArray[_].nFontSizeW,f[l].nFontHeight=this.curTargetFontsInfo.stDrawFontsArray[_].nFontSizeH,f[l].pstStartPos={},f[l].pstStartPos.fX=this.curTargetFontsInfo.stDrawFontsArray[_].stPoint.x,f[l].pstStartPos.fY=this.curTargetFontsInfo.stDrawFontsArray[_].stPoint.y,f[l].pstFontColor={},f[l].pstFontColor.fR=this.curTargetFontsInfo.stDrawFontsArray[_].color.R,f[l].pstFontColor.fG=this.curTargetFontsInfo.stDrawFontsArray[_].color.G,f[l].pstFontColor.fB=this.curTargetFontsInfo.stDrawFontsArray[_].color.B,f[l].pstFontColor.fA=this.curTargetFontsInfo.stDrawFontsArray[_].color.A,f[l].bBackGround=this.curTargetFontsInfo.stDrawFontsArray[_].bBackGround,f[l].pstBGColor={},f[l].pstBGColor.fR=this.curTargetFontsInfo.stDrawFontsArray[_].BGcolor.R,f[l].pstBGColor.fG=this.curTargetFontsInfo.stDrawFontsArray[_].BGcolor.G,f[l].pstBGColor.fB=this.curTargetFontsInfo.stDrawFontsArray[_].BGcolor.B,f[l].pstBGColor.fA=this.curTargetFontsInfo.stDrawFontsArray[_].BGcolor.A,f[l].fRotateAngle=0,f[l].pFontFamily="sans-serif",this.DrawFontParamArray.push(f[l]),++l);if(null!=this.curExactFontsInfo)for(var h=[],c=0,u=0;u<this.curExactFontsInfo.nFontsNum;u++)1==this.curExactFontsInfo.stDrawFontsArray[u].dwIntelFlag&&1==this.m_bEnableIVSEx&&(h[c]={},h[c].pString=this.curExactFontsInfo.stDrawFontsArray[u].fontString,h[c].nFontWidth=this.curExactFontsInfo.stDrawFontsArray[u].nFontSizeW,h[c].nFontHeight=this.curExactFontsInfo.stDrawFontsArray[u].nFontSizeH,h[c].pstStartPos={},h[c].pstStartPos.fX=this.curExactFontsInfo.stDrawFontsArray[u].stPoint.x,h[c].pstStartPos.fY=this.curExactFontsInfo.stDrawFontsArray[u].stPoint.y,h[c].pstFontColor={},h[c].pstFontColor.fR=this.curExactFontsInfo.stDrawFontsArray[u].color.R,h[c].pstFontColor.fG=this.curExactFontsInfo.stDrawFontsArray[u].color.G,h[c].pstFontColor.fB=this.curExactFontsInfo.stDrawFontsArray[u].color.B,h[c].pstFontColor.fA=this.curExactFontsInfo.stDrawFontsArray[u].color.A,h[c].bBackGround=this.curExactFontsInfo.stDrawFontsArray[u].bBackGround,h[c].pstBGColor={},h[c].pstBGColor.fR=this.curExactFontsInfo.stDrawFontsArray[u].BGcolor.R,h[c].pstBGColor.fG=this.curExactFontsInfo.stDrawFontsArray[u].BGcolor.G,h[c].pstBGColor.fB=this.curExactFontsInfo.stDrawFontsArray[u].BGcolor.B,h[c].pstBGColor.fA=this.curExactFontsInfo.stDrawFontsArray[u].BGcolor.A,h[c].fRotateAngle=0,h[c].pFontFamily="sans-serif",this.DrawFontParamArray.push(h[c]),++c);if(null!=this.curExactPOSFontsInfo)for(var d=[],p=0,m=0;m<this.curExactPOSFontsInfo.nFontsNum;m++)3==this.curExactPOSFontsInfo.stDrawFontsArray[m].dwIntelFlag&&1==this.m_bDisPos&&(d[p]={},d[p].pString=this.curExactPOSFontsInfo.stDrawFontsArray[m].fontString,d[p].nFontWidth=this.curExactPOSFontsInfo.stDrawFontsArray[m].nFontSizeW,d[p].nFontHeight=this.curExactPOSFontsInfo.stDrawFontsArray[m].nFontSizeH,d[p].pstStartPos={},d[p].pstStartPos.fX=this.curExactPOSFontsInfo.stDrawFontsArray[m].stPoint.x,d[p].pstStartPos.fY=this.curExactPOSFontsInfo.stDrawFontsArray[m].stPoint.y,d[p].pstFontColor={},d[p].pstFontColor.fR=this.curExactPOSFontsInfo.stDrawFontsArray[m].color.R,d[p].pstFontColor.fG=this.curExactPOSFontsInfo.stDrawFontsArray[m].color.G,d[p].pstFontColor.fB=this.curExactPOSFontsInfo.stDrawFontsArray[m].color.B,d[p].pstFontColor.fA=this.curExactPOSFontsInfo.stDrawFontsArray[m].color.A,d[p].bBackGround=this.curExactPOSFontsInfo.stDrawFontsArray[m].bBackGround,d[p].pstBGColor={},d[p].pstBGColor.fR=this.curExactPOSFontsInfo.stDrawFontsArray[m].BGcolor.R,d[p].pstBGColor.fG=this.curExactPOSFontsInfo.stDrawFontsArray[m].BGcolor.G,d[p].pstBGColor.fB=this.curExactPOSFontsInfo.stDrawFontsArray[m].BGcolor.B,d[p].pstBGColor.fA=this.curExactPOSFontsInfo.stDrawFontsArray[m].BGcolor.A,d[p].fRotateAngle=0,d[p].pFontFamily="sans-serif",d[p].EventID=this.curExactPOSFontsInfo.stDrawFontsArray[m].EventID,this.DrawPOSFontsParamArray.push(d[p]),++p)}},{key:"WebGLDisplaySubCallBack",value:function(t){null!=t.handle&&0!=t.nUser.pstWaterFontParamArray[t.nSubPort]&&null!=t.nUser.pstWaterFontParam&&t.handle.SR_DrawFontEx(t.nUser.pstWaterFontParamArray[t.nSubPort],t.nUser.pstWaterFontParamArray[t.nSubPort].length,1,t.nUser.textCanvas)}},{key:"WebGLDisplayCallBack",value:function(t){0!=t.DrawlinesParamArray.length&&t.oVideoHandle.SR_DrawLinesEx(t.DrawlinesParamArray,t.DrawlinesParamArray.length,t.DrawlinesParamArrayAllPointNum,t.bDrawlinesParamArrayFill);for(var e=0;e<t.DrawMosaiclinesParamArray.length;e++){var a=t.DrawMosaiclinesParamArray[e].dwMosaictype,r=0,i={};i.fR=t.DrawMosaiclinesParamArray[e].pstColor.fR,i.fG=t.DrawMosaiclinesParamArray[e].pstColor.fG,i.fB=t.DrawMosaiclinesParamArray[e].pstColor.fB,i.fA=t.DrawMosaiclinesParamArray[e].pstColor.fA,0!=t.MosaicType&&(a=t.MosaicType,r=t.MosaicSize,i.fR=t.MosaicColorR,i.fG=t.MosaicColorG,i.fB=t.MosaicColorB,i.fA=t.MosaicColorA),r=0==r?50:r,5==(a=0==a?1:a)?t.oVideoHandle.SR_DrawLines(t.DrawMosaiclinesParamArray[e].pstPoints,t.DrawMosaiclinesParamArray[e].nPointNum,1,t.DrawMosaiclinesParamArray[e].pstColor,t.DrawMosaiclinesParamArray[e].nLineWidth,0):3==a?t.oVideoHandle.SR_DrawLines(t.DrawMosaiclinesParamArray[e].pstPoints,t.DrawMosaiclinesParamArray[e].nPointNum,1,i,t.DrawMosaiclinesParamArray[e].nLineWidth,1):t.oVideoHandle.SR_DrawMosaic(t.DrawMosaiclinesParamArray[e].pstPoints[0].fX,t.DrawMosaiclinesParamArray[e].pstPoints[2].fX,t.DrawMosaiclinesParamArray[e].pstPoints[0].fY,t.DrawMosaiclinesParamArray[e].pstPoints[2].fY,r)}for(var n=0;n<t.DrawTargetlinesParamArray.length;n++)if(t.privatePNGImageInfo.length>0&&-1!=t.DrawTargetlinesParamArray[n].dwFillPicID){for(var s=-1,x=0,o=0;o<t.privatePNGImageInfo.length;o++)if(t.DrawTargetlinesParamArray[n].dwFillPicID==t.privatePNGImageInfo[o].PicID){if(s=o,t.DrawTargetEventIDList.length>0){for(var f=0;f<t.DrawTargetEventIDList.length;f++)if(t.DrawTargetEventIDList[f].nID==t.DrawTargetlinesParamArray[n].eventid){x=1;break}}else x=1;break}-1!=s&&1==x&&(t.privatePNGImageInfo[s].pstRectPos.fTop=t.DrawTargetlinesParamArray[n].pstPoints[0].fY,t.privatePNGImageInfo[s].pstRectPos.fBottom=t.DrawTargetlinesParamArray[n].pstPoints[2].fY,t.privatePNGImageInfo[s].pstRectPos.fLeft=t.DrawTargetlinesParamArray[n].pstPoints[0].fX,t.privatePNGImageInfo[s].pstRectPos.fRight=t.DrawTargetlinesParamArray[n].pstPoints[2].fX,t.oVideoHandle.SR_DrawImage(t.privatePNGImageInfo[s].videoStream,t.privatePNGImageInfo[s].nImageWidth,t.privatePNGImageInfo[s].nImageHeight,t.privatePNGImageInfo[s].pstRectPos,Xt.SRPIXELFORMAT.SR_PF_SURFACE,t.privatePNGImageInfo[s].fAlpha))}else t.oVideoHandle.SR_DrawLines(t.DrawTargetlinesParamArray[n].pstPoints,t.DrawTargetlinesParamArray[n].nPointNum,t.DrawTargetlinesParamArray[n].bLoop,t.DrawTargetlinesParamArray[n].pstColor,t.DrawTargetlinesParamArray[n].nLineWidth,t.DrawTargetlinesParamArray[n].bFill);0!=t.DrawFontParamArray.length&&t.oVideoHandle.SR_DrawFontEx(t.DrawFontParamArray,t.DrawFontParamArray.length,0,t.textCanvas);for(var l=t.DrawPOSFontsParamArray.length-1;l>=0;l--){var _=0;if(-1!=t.DrawPOSFontsParamArray[l].EventID&&t.DrawTargetEventIDList.length>0){for(var h=0;h<t.DrawTargetEventIDList.length;h++)if(t.DrawTargetEventIDList[h].nID==t.DrawPOSFontsParamArray[l].EventID){_=1;break}}else _=1;1!=_&&t.DrawPOSFontsParamArray.splice(l,1)}if(0!=t.DrawPOSFontsParamArray.length&&t.oVideoHandle.SR_DrawFontEx(t.DrawPOSFontsParamArray,t.DrawPOSFontsParamArray.length,0,t.textCanvas),null!=t.curImagesInfo&&0!=t.curImagesInfo.nWidth&&0!=t.curImagesInfo.nHeight&&1==t.m_bEnablePICEx){var c=null;null!=t.curImagesInfo&&null!=t.curImagesInfo&&null!=t.curImagesInfo.picImageData&&null!=t.curImagesInfo.picImageData&&(c=new Uint16Array(t.curImagesInfo.picImageData.buffer)),null!=t.curImagesInfo&&t.curImagesInfo.nPixelFormat>0&&t.oVideoHandle.SR_DrawImage(c,t.curImagesInfo.nWidth,t.curImagesInfo.nHeight,t.curImagesInfo.pstRect,t.curImagesInfo.nPixelFormat,t.curImagesInfo.fAlpha)}if(0!==t.pstWaterFontParamArray[0].length&&null!=t.pstWaterFontParam&&t.oVideoHandle.SR_DrawFontEx(t.pstWaterFontParamArray[0],t.pstWaterFontParamArray[0].length,1,t.textCanvas),0!==t.pWaterImageParam.length&&t.finishDecodeImage){t.baseWaterMarkImageTime<=0&&(t.baseWaterMarkImageTime=t.curTimestamp);var u=t.curTimestamp-t.baseWaterMarkImageTime;u<0&&(t.baseWaterMarkImageTime=t.curTimestamp,u=0,t.waterMarkImageIndex=0),u>=t.pWaterImageParam[t.waterMarkImageIndex].timeStamp-t.pWaterImageParam[0].timeStamp&&t.waterMarkImageIndex++,t.waterMarkImageIndex>=t.waterMarkImageMax&&(t.waterMarkImageIndex=0,t.baseWaterMarkImageTime=t.curTimestamp);var d=t.waterMarkImageIndex;t.oVideoHandle.SR_DrawImage(t.pWaterImageParam[d].videoStream,t.pWaterImageParam[d].nImageWidth,t.pWaterImageParam[d].nImageHeight,t.pWaterImageParam[d].pstRectPos,Xt.SRPIXELFORMAT.SR_PF_SURFACE,t.pWaterImageParam[d].fAlpha)}}},{key:"SetPanoramaDisplayEffect",value:function(t){if("2d"===this.renderEngine||"2D"===this.renderEngine)return 0;if(null!=this.oVideoHandle){if(t!=this.panoramaDisplayEffect){this.panoramaDisplayEffect=t,this.oVideoHandle.SR_DelSubPort(this.mainVaildSubPort),this.oVideoHandle.SR_Destroy(),this.oVideoHandle=null,this.oVideoHandle=new Gt,null==this.pFishParamManager&&(this.pFishParamManager=new Yt),this.oVideoHandle.SR_SetFishParamManager(this.pFishParamManager),this.hasSetFECParamManager=!0;var e=Xt.SRDISPLAYEFFECT.SR_DE_NULL;if(e=1==this.panoramaDisplayEffect?Xt.SRDISPLAYEFFECT.SR_DE_PANORAMA_SPHERE:3==this.panoramaDisplayEffect?Xt.SRDISPLAYEFFECT.SR_DE_PANORAMA_PLANET:Xt.SRDISPLAYEFFECT.SR_DE_NULL,this.oVideoHandle.SR_Init(this.mainCanvasID,this.enPixelFormat),this.mainVaildSubPort=this.oVideoHandle.SR_AddSubPort(e),-1==this.mainVaildSubPort)return console.info("%c InitDisplay SR_AddSubPort error subport:%d","color: red",this.mainVaildSubPort),0}}else this.panoramaDisplayEffect=t;return 1}},{key:"SetPanoramaSphereViewParam",value:function(t,e){return"2d"===this.renderEngine||"2D"===this.renderEngine||null==e||null==e||t<1||t>3?0:(this.viewParamType=t,this.viewParamValue=e,null!=this.oVideoHandle?(1!=this.panoramaDisplayEffect&&this.panoramaDisplayEffect,this.oVideoHandle.SR_SetViewParam(t,e)!=Xt.ERRCODE.SR_OK?0:1):0)}},{key:"GetPanoramaSphereViewParam",value:function(t,e){return"2d"===this.renderEngine||"2D"===this.renderEngine||null==e||null==e||t<1||t>3?0:null!=this.oVideoHandle?(1!=this.panoramaDisplayEffect&&this.panoramaDisplayEffect,e.fValue=-1,this.oVideoHandle.SR_GetViewParam(t,e)!=Xt.ERRCODE.SR_OK?0:1):0}}]),a}(),qt=function(){function a(e,r){t(this,a),this.EncoderObj=null,this.FirstFrame=!0,this.frameRate=25,this.EncoderCurStatus=2,this.frameCounter=0,this.frameNum=0,this.stopEncodflag=!1,this.encodeFrameGlobalTime=[],this.oPlayCtrlHandle=null,null!=e&&(this.oPlayCtrlHandle=e),this.player=null,null!=r&&(this.player=r),this.output=this.output.bind(this),this.reportError=this.reportError.bind(this),this.userAgent=0,this.bWriteData=!1,this.aTotalBuffer=[],this.iFrameNum=0}return e(a,[{key:"initEncoder",value:function(t,e,a){if(this.codecString=t,this.encodeWidth=e.encodeWidth,this.encodeHeight=e.encodeHeight,this.bitrate=e.bitrate,this.frameRate=e.frameRate,0==e.bitrateMode?this.bitrateMode="variable":this.bitrateMode="constant",0==e.latencyMode?this.latencyMode="realtime":this.latencyMode="quality",this.rawDataCB=a,this.FirstFrame=!0,this.EncoderCurStatus=2,this.frameCounter=0,this.frameNum=0,this.stopEncodflag=!1,null==this.EncoderObj){var r={output:this.output,error:this.reportError};this.EncoderObj=new VideoEncoder(r)}this.format="annexb";var i=navigator.userAgent||navigator.vendor||window.opera;i.indexOf("Windows NT")>-1?this.userAgent=0:i.indexOf("Linux")>-1?this.userAgent=1:i.indexOf("Mac OS X")>-1?(this.userAgent=2,this.format="avc"):/Android/.test(i)?this.userAgent=3:/like Mac OS X/.test(i)?this.userAgent=4:this.userAgent=0;var n={codec:t,width:this.encodeWidth,height:this.encodeHeight,displayWidth:this.encodeWidth,displayHeight:this.encodeHeight,bitrate:this.bitrate,framerate:this.frameRate,bitrateMode:this.bitrateMode,latencyMode:this.latencyMode,avc:{format:this.format}};console.log("1videoEncode config width:"+this.encodeWidth+",height:"+this.encodeHeight+",bitrate:"+this.bitrate+",framerate:"+this.frameRate+",bitrateMode:"+this.bitrateMode+",latencMode:"+this.latencyMode),this.EncoderObj.configure(n)}},{key:"inputData",value:function(t,e){null==this.EncoderObj||this.stopEncodflag||("configured"==this.EncoderObj.state||this.FirstFrame)&&this.EncodeProcess(t,e)}},{key:"EncodeProcess",value:function(t,e){if(4!=this.EncoderCurStatus&&null!=this.EncoderObj&&"configured"==this.EncoderObj.state&&this.EncoderObj.encodeQueueSize<10){var a=this.frameCounter%50==0;1==a&&this.encodeFrameGlobalTime.push(e),this.EncoderObj.encode(t,{keyFrame:a}),this.frameCounter++}}},{key:"output",value:function(t,e){if("configured"==this.EncoderObj.state){e.decoderConfig,e.svc,e.alphaSideData,t.type;var a=t.timestamp;if(t.byteLength,!this.stopEncodflag){var r=new Uint8Array(t.byteLength);t.copyTo(r);var i={dataType:1};if(i.width=this.encodeWidth,i.height=this.encodeHeight,i.frameRate=this.frameRate,i.timeStamp=a/1e3,i.frameNum=this.frameNum,i.bitrate=0,i.globalTime={},"key"==t.type){var n=this.encodeFrameGlobalTime.shift();"year"in n?(i.globalTime.year=n.year,i.globalTime.month=n.month,i.globalTime.day=n.day,i.globalTime.hour=n.hour,i.globalTime.minute=n.minute,i.globalTime.second=n.second,i.globalTime.milliseconds=n.milliseconds):(i.globalTime.year=2024,i.globalTime.month=0,i.globalTime.day=0,i.globalTime.hour=0,i.globalTime.minute=0,i.globalTime.second=0,i.globalTime.milliseconds=0)}var s=null,x=new Uint8Array(4);x[0]=0,x[1]=0,x[2]=0,x[3]=1;var o=null,f=0,l=null,_=0,h=null,c=null,u=0,d=0,p=0;if("key"==t.type){if("decoderConfig"in e&&"description"in e.decoderConfig&&(c=new Uint8Array(e.decoderConfig.description)),2==this.userAgent){for(null!=c&&(f=256*(o=c.slice(6,c.length))[0]+o[1],l=o.slice(2,2+f),_=256*o[3+f]+o[4+f],h=o.slice(5+f,5+f+_),f+=4,_+=4);d<r.length;)p=256*r[d]*256*256+256*r[d+1]*256+256*r[d+2]+r[d+3],r[d]=0,r[d+1]=0,r[d+2]=0,r[d+3]=1,d=d+4+p;u=f+_+r.length,s=new Uint8Array(u);var m=0;null!=l&&(s.set(x,0),s.set(l,x.length),m=x.length+l.length),null!=h&&(s.set(x,m),s.set(h,m+x.length),m=x.length+l.length+x.length+h.length),s.set(r,m),i.rawData=s}else{for(var S=r.slice(6,r.length),R=0;R<S.length&&(0!=S[R]||0!=S[R+1]||1!=S[R+2]||110!=S[R+3]);R++);o=S.slice(0,R);for(var P=S.slice(R,S.length),y=0;y<P.length&&(0!=P[y]||0!=P[y+1]||1!=P[y+2]||101!=P[y+3]);y++);var b=P.slice(y-1,P.length);b[0]=0,u=o.length+b.length,(s=new Uint8Array(u)).set(o,0),s.set(b,o.length),S=null,P=null,b=null}i.rawData=s,this.player?this.rawDataCB&&this.rawDataCB(i):postMessage({function:"VideoRecoderInfo",videoInfo:i},[i.rawData.buffer])}else{if(2==this.userAgent){for(;d<r.length;)p=256*r[d]*256*256+256*r[d+1]*256+256*r[d+2]+r[d+3],r[d]=0,r[d+1]=0,r[d+2]=0,r[d+3]=1,d=d+4+p;i.rawData=r}else i.rawData=r;this.player?this.rawDataCB&&this.rawDataCB(i):postMessage({function:"VideoRecoderInfo",videoInfo:i},[i.rawData.buffer])}r=null,s=null,x=null,o=null,l=null,h=null,c=null,this.frameNum++}}}},{key:"_downloadFile",value:function(t,e){var a=t;i(t,Blob)||i(t,File)||(a=new Blob([t]));var r=window.URL.createObjectURL(a),n=window.document.createElement("a");n.href=r,n.download=e;var s=document.createEvent("MouseEvents");s.initEvent("click",!0,!0),n.dispatchEvent(s)}},{key:"downloadData",value:function(t){if(this.bWriteData){for(var e=t,a=this.aTotalBuffer.length,r=0,i=e.length;r<i;r++)this.aTotalBuffer[a+r]=e[r];this.iFrameNum++,e=null,console.log("downloadEncodedata iFrameNum:"+this.iFrameNum)}if(this.bWriteData&&(this.iFrameNum>=600||this.stopEncodflag)){console.log("download600encodeData");var n=new Uint8Array(this.aTotalBuffer);this._downloadFile(n,"Encode600.data"),this.aTotalBuffer.splice(0,this.aTotalBuffer.length),this.bWriteData=!1,this.iFrameNum=0,n=null}}},{key:"stopEncode",value:function(){if(this.EncoderCurStatus=4,this.frameCounter=0,this.frameNum=0,this.stopEncodflag=!0,this.destroyEncoder(),this.bWriteData&&this.stopEncodflag){console.log("download600encodeData");var t=new Uint8Array(this.aTotalBuffer);this._downloadFile(t,"Encode600.data"),this.aTotalBuffer.splice(0,this.aTotalBuffer.length),this.bWriteData=!1,this.iFrameNum=0,t=null}}},{key:"reportError",value:function(t){console.log("hardEncode reportError:"+t.message+",state:"+this.EncoderObj.state+",frameRate:"+this.frameRate)}},{key:"destroyEncoder",value:function(){var t=this;return new Promise((function(e,a){t.clearEncoderObjBuffer().then((function(){null!=t.EncoderObj&&("closed"!=t.EncoderObj.state&&t.EncoderObj.close(),console.log(">>>JS 11 destroy VideoEncoderObj"),t.EncoderObj=null),t.EncoderCurStatus=4,t.FirstFrame=!0,e()}),(function(){a()}))}))}},{key:"resetEncoder",value:function(){var t=this;return new Promise((function(e,a){t.destroyEncoder().then((function(){var a={encodeWidth:t.encodeWidth,encodeHeight:t.encodeHeight,bitrate:t.bitrate,frameRate:t.frameRate,bitrateMode:t.bitrateMode,latencyMode:t.latencyMode};t.initEncoder(t.codecString,a,t.rawDataCB),console.log("%c reset hard Encoder","color:red"),e()}),(function(){a()}))}))}},{key:"clearEncoderObjBuffer",value:function(){var t=this;return new Promise((function(e,a){null!=t.EncoderObj&&"configured"==t.EncoderObj.state&&t.EncoderObj.reset(),e()}))}}]),a}(),Qt=function(){function a(e,r){t(this,a),this.AudioEncoderObj=null,this.FirstFrame=!0,this.EncoderCurStatus=2,this.stopEncodflag=!1,this.aTimeStamp=0,this.oPlayCtrlHandle=null,null!=e&&(this.oPlayCtrlHandle=e),this.player=null,null!=r&&(this.player=r),this.output=this.output.bind(this),this.reportError=this.reportError.bind(this)}var r;return e(a,[{key:"initEncoder",value:(r=f(nt().mark((function t(e,a,r){var i,n;return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.codecString=e,this.sampleRate=a.sampleRate,this.numberOfChannels=a.numberOfChannels,this.bitrate=a.bitrate,this.AudioDataCB=r,this.FirstFrame=!0,this.EncoderCurStatus=2,this.stopEncodflag=!1,this.aTimeStamp=0,null==this.AudioEncoderObj&&(i={output:this.output,error:this.reportError},this.AudioEncoderObj=new AudioEncoder(i)),this.format="adts",n={codec:e,sampleRate:this.sampleRate,numberOfChannels:this.numberOfChannels,bitrate:this.bitrate,aac:{format:this.format}},console.log("2audioEncode config sampleRate:"+this.sampleRate+",numberOfChannels:"+this.numberOfChannels+",bitrate:"+this.bitrate),this.AudioEncoderObj.configure(n);case 14:case"end":return t.stop()}}),t,this)}))),function(t,e,a){return r.apply(this,arguments)})},{key:"inputData",value:function(t){null!=this.AudioEncoderObj&&("configured"==this.AudioEncoderObj.state||this.FirstFrame)&&this.EncodeProcess(t),this.FirstFrame&&(1==this.oPlayCtrlHandle.recoderBaseTimestampMode?this.audioBaseTimeStamp=t.timestamp:0==this.oPlayCtrlHandle.recoderBaseTimestampMode&&(this.audioBaseTimeStamp=0),this.FirstFrame=!1)}},{key:"EncodeProcess",value:function(t){4!=this.EncoderCurStatus&&null!=this.AudioEncoderObj&&"configured"==this.AudioEncoderObj.state&&this.AudioEncoderObj.encode(t)}},{key:"output",value:function(t,e){if("configured"==this.AudioEncoderObj.state&&(t.type,t.timestamp,t.byteLength,!this.stopEncodflag)){this.aTimeStamp+=t.duration/1e3;var a={dataType:2,width:1,height:16,frameRate:48e3};a.timeStamp=this.aTimeStamp+this.audioBaseTimeStamp,a.frameNum=0,a.bitrate=128e3,a.globalTime={};var r=new Uint8Array(t.byteLength);t.copyTo(r),a.rawData=r,this.player?null!=this.AudioDataCB&&this.AudioDataCB(a):postMessage({function:"AudioRecoderInfo",audioInfo:a},[a.rawData.buffer]),r=null}}},{key:"stopEncode",value:function(){this.stopEncodflag=!0,this.destroyEncoder()}},{key:"reportError",value:function(t){console.log("hardEncode reportError:"+t.message+",state:"+this.AudioEncoderObj.state)}},{key:"destroyEncoder",value:function(){var t=this;return new Promise((function(e,a){t.clearEncoderObjBuffer().then((function(){null!=t.AudioEncoderObj&&("closed"!=t.AudioEncoderObj.state&&t.AudioEncoderObj.close(),console.log(">>>JS 12 destroy AudioEncoderObj"),t.AudioEncoderObj=null),t.EncoderCurStatus=4,t.FirstFrame=!0,e()}),(function(){a()}))}))}},{key:"resetEncoder",value:function(){var t=this;return new Promise((function(e,a){t.destroyEncoder().then((function(){var a={sampleRate:t.sampleRate,numberOfChannels:t.numberOfChannels,bitrate:t.bitrate};t.initEncoder(t.codecString,a,t.AudioDataCB),console.log("%c reset hard Encoder","color:red"),e()}),(function(){a()}))}))}},{key:"clearEncoderObjBuffer",value:function(){var t=this;return new Promise((function(e,a){null!=t.AudioEncoderObj&&"configured"==t.AudioEncoderObj.state&&t.AudioEncoderObj.reset(),e()}))}}]),a}(),$t=function(){function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t(this,a),this.canvas=null,this.streamOpenMode=0,this.context=null,this.oVideoDecoder=null,this.frameBuffers=[],this.initTimer=!1,this.preTimeStamp=0,this.baseTimeStamp=0,this.resetTimer=!0,this.RenderFrame=this.RenderFrame.bind(this),this.renderCurStatus=2,this.renderLastStatus=2,this.playSpeed=1,this.nplaySpeed=1,this.displayBuf=14,this.needForward=!1,this.firstFrame=!0,this.LatcyTime=50,this.nFrameRate=0,this.needSaveFrameInfo=!1,this.displayFrameInfoCB=null,this.displayFrameInfo=[],this.curFrameInfo={},this.curFrameInfo.timeStamp=0,this.bResetdisplayFrameInfoCB=!0,this.sx=0,this.sy=0,this.sw=0,this.sh=0,this.displayRunning=!1,this.oRenderTimer=null,this.waitIFrameTimestamp=0,this.curFrame=null,this.player=null,null!=e&&(this.player=e),this.renderEngine="webgl",this.oVideoRender=null,this.FECCanvasID="",this.oVideoRender=new Kt(this),this.bSetStreamEnd=!1,this.printfFlag=0,this.oVideoEncoder=null,this.oAudioEncoder=null,this.startRecoderFlag=!1,this.stopRecoderFlag=!1,this.recoderFrameNum=0,this.vBaseTimeStamp=0,this.encodeVideoInfo={encodeVideoType:"avc",encodeWidth:1280,encodeHeight:720,bitrate:1e6,frameRate:25,bitrateMode:0,latencyMode:0},this.encodeAudioInfo={encodeAudioType:"aac",sampleRate:48e3,numberOfChannels:1,bitrate:128e3},this.recoderBaseTimestampMode=0,this.recoderGetOriginData=0,this.nstreamEndloopNum=0,this.runtimeCBFun=null,this.nTargetRelativePos=0,this.ProcessPositionflag=!1,this.nMPPlayMode=0,this.nMPPosType=0,this.VideoPrivateInfoMap=new Map,this.curPrivateInfo={},this.curPrivateInfo.linesInfo=[],this.curPrivateInfo.fontInfo=[],this.curPrivateInfo.imageInfo=[],this.StretchPlayTime=0,this.StretchPlayedTime=0,this.StretchPlaySpeed=1,this.StretchPlayFlag=!1,this.Prevideowidth=0,this.Prevideoheight=0,this.PrecodecType=0,this.PlayOrBackMode=1,this.pstRuntimeInfo={nRunTimeModule:0,nStrVersion:0,nFrameTimeStamp:0,nFrameNum:0,nErrorCode:0,nInputDataInterval:0,nFrameNumInterval:0,nAverageDecodeTime:0,nSystemFormat:0,nDetectRes:0,nMp4FileTime:0,nMp4TotalFrameNum:0,AbsTimeYear:0,AbsTimeMonth:0,AbsTimeDay:0,AbsTimeHour:0,AbsTimeMinute:0,AbsTimeSecond:0,AbsTimeMilliseconds:0},this.firstRenderBegin=!0,this.DecodeTypeFlagMap=new Map,this.RenderTypeFlagMap=new Map}var r,i;return e(a,[{key:"init",value:function(t,e,a,r,i){if(this.canvas=t,this.streamOpenMode=e,this.renderEngine=r,this.printfFlag=i,this.SetCurStatus(2),null==this.oVideoDecoder&&(this.oVideoDecoder=new lt(a,this,this.player,this.canvas),null!==this.oVideoDecoder&&this.oVideoDecoder.initDecoder(),null!=this.runtimeCBFun&&this.oVideoDecoder.SetRunTimeInfoCallBackFun(2,this.runtimeCBFun),this.DecodeTypeFlagMap.size>0)){var n,s=C(this.DecodeTypeFlagMap.keys());try{for(s.s();!(n=s.n()).done;){var x=n.value,o=this.DecodeTypeFlagMap.get(x);1==o&&this.oVideoDecoder.SetRunTimeInfoCallbackType(2,x,o)}}catch(t){s.e(t)}finally{s.f()}}""!=this.canvas&&null!=this.canvas&&(this.frameBuffers=this.oVideoDecoder.ready_frames,null!=this.oVideoRender&&this.oVideoRender.InitDisplay(this.canvas,this.renderEngine,256),null==this.oRenderTimer&&(this.oRenderTimer=new ft))}},{key:"HardDecodeError",value:function(){return this.player._switchHardToSoft(),1}},{key:"inputData",value:function(t,e){if(this.curPrivateInfo.linesInfo.length>0||this.curPrivateInfo.fontInfo.length>0||this.curPrivateInfo.imageInfo.length>0){var a=this.deepClone(this.curPrivateInfo);this.VideoPrivateInfoMap.set(e.timeStamp,a),this.curPrivateInfo.linesInfo.splice(0,this.curPrivateInfo.linesInfo.length),this.curPrivateInfo.fontInfo.splice(0,this.curPrivateInfo.fontInfo.length),this.curPrivateInfo.imageInfo.splice(0,this.curPrivateInfo.imageInfo.length)}if(0!=this.PrecodecType&&this.PrecodecType!=e.codecType&&(this.firstFrame=!0,this.oVideoDecoder.resetDecoderObj()),this.needSaveFrameInfo){var r=new Object;r.port=e.port,r.codecType=e.codecType,r.frameType=e.frameType,r.frameSize=e.frameSize,r.width=e.width,r.height=e.height,r.timeStamp=e.timeStamp,r.frameRate=e.frameRate,r.frameNum=e.frameNum,r.interlace=e.interlace,r.streamEnd=e.streamEnd,r.cropLeft=e.cropLeft,r.cropRight=e.cropRight,r.cropTop=e.cropTop,r.cropBottom=e.cropBottom,r.year=e.year,r.month=e.month,r.week=e.week,r.day=e.day,r.hour=e.hour,r.minute=e.minute,r.second=e.second,r.milliseconds=e.milliseconds,r.isKeyFrame=e.isKeyFrame,this.nFrameRate=r.frameRate,this.Prevideowidth=e.width,this.Prevideoheight=e.height,this.PrecodecType=e.codecType,this.displayFrameInfo.push(r),r=null}else this.displayFrameInfo.splice(0,this.displayFrameInfo.length);null!=this.oVideoDecoder&&this.oVideoDecoder.inputData(t,e)}},{key:"_resetDecoder",value:function(){var t=this;return new Promise((function(e,a){t.oVideoDecoder.resetDecoder().then((function(){t.displayFrameInfo.splice(0,t.displayFrameInfo.length),t.curFrameInfo={},t.oVideoRender.DeInitPrivateParam(),t.VideoPrivateInfoMap.clear(),t.curPrivateInfo.linesInfo.splice(0,t.curPrivateInfo.linesInfo.length),t.curPrivateInfo.fontInfo.splice(0,t.curPrivateInfo.fontInfo.length),t.curPrivateInfo.imageInfo.splice(0,t.curPrivateInfo.imageInfo.length),t.renderCurStatus=2,t.renderLastStatus=2,t.player?t.player.JSPlayM4_ResetEnd():postMessage({function:"resetEnd"}),e()}),(function(){a()}))}))}},{key:"_resetRenderTimer",value:function(){this.initTimer=!1,this.preTimeStamp=0,this.baseTimeStamp=0,this.resetTimer=!0,null!=this.oRenderTimer&&this.oRenderTimer.timerReset(),this.RenderFrame=this.RenderFrame.bind(this),this.renderCurStatus=2,this.renderLastStatus=2,this.curTimeStamp=0,this.getImageJPEG=!1,this.getImageBMP=!1,this.getCropImageJPEG=!1,this.getCropImageBMP=!1,1==this.bResetdisplayFrameInfoCB&&(this.displayFrameInfoCB=null),this.displayFrameInfo.splice(0,this.displayFrameInfo.length),this.VideoPrivateInfoMap.clear(),this.curPrivateInfo.linesInfo.splice(0,this.curPrivateInfo.linesInfo.length),this.curPrivateInfo.fontInfo.splice(0,this.curPrivateInfo.fontInfo.length),this.curPrivateInfo.imageInfo.splice(0,this.curPrivateInfo.imageInfo.length),this.curFrameInfo={},this.DecodeTypeFlagMap.clear(),this.RenderTypeFlagMap.clear()}},{key:"_destroyPlayCtrl",value:function(){var t=this;this.oVideoDecoder.destroyDecoder().then((function(){t.oVideoDecoder=null,null!=t.oVideoRender&&(t.oVideoRender.ReleaseDisplay(),t.oVideoRender=null),t._resetRenderTimer(),t.oRenderTimer=null,t.displayRunning=!1,t.runtimeCBFun=null,t.printfFlag>=0&&console.log(">>>JS 02 destroy oVideoDecoder/oVideoRender"),null!=t.oVideoEncoder&&(t.oVideoEncoder.destroyEncoder(),t.oVideoEncoder=null),null!=t.oAudioEncoder&&(t.oAudioEncoder.destroyEncoder(),t.oAudioEncoder=null)}),(function(){t.printfFlag>=0&&console.log("stop failed ")}))}},{key:"Sleep",value:(i=f(nt().mark((function t(e){var a;return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=(a=e>6e4?6e4:e)<0?0:a,t.abrupt("return",new Promise((function(t){setTimeout(t,a)})));case 3:case"end":return t.stop()}}),t)}))),function(t){return i.apply(this,arguments)})},{key:"RenderFrame",value:(r=f(nt().mark((function t(){var e,a=this;return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.renderCurStatus,null!=this.oVideoDecoder&&null!=this.oVideoDecoder.decoderObj&&(this.player?this.player.JSPlayM4_GetDecodeBufferSize(this.oVideoDecoder.decoderObj.decodeQueueSize,this.oVideoDecoder.ready_frames.length):postMessage({function:"GetDecodeBufferSize",rawSize:this.oVideoDecoder.decoderObj.decodeQueueSize,frameSize:this.oVideoDecoder.ready_frames.length}),this.oVideoDecoder.decoderObj.decodeQueueSize<=3&&this.oVideoDecoder.ready_frames.length<=3&&(this.player?this.player.JSPlayM4_GetRawData():postMessage({function:"GetRawData"})),this.printfFlag>0&&console.log("VideoPlayCtrl.js output1 cb decodeQueueSize:"+this.oVideoDecoder.decoderObj.decodeQueueSize+",length:"+this.oVideoDecoder.ready_frames.length)),t.t0=e,t.next=0===t.t0?5:2===t.t0||6===t.t0?8:3===t.t0?10:5===t.t0?13:4===t.t0?15:17;break;case 5:return this._resetRenderTimer(),this._resetDecoder().then((function(){requestAnimationFrame(a.RenderFrame)}),(function(){})),t.abrupt("break",18);case 8:return this.displayRunning?(this.printfFlag>0&&console.log("displayBuf:"+this.displayBuf+",this.streamOpenMode:"+this.streamOpenMode+",LatcyTime:"+this.LatcyTime),this.chooseFrame().then((function(t){if(a.curFrame=t,1==a.ProcessPositionflag)if(null!=a.curFrame){var r=0;if(1==a.nMPPosType&&(r=a.findFramebyTime(a.curFrame.timestamp,0).frameNum),0==a.nMPPosType&&a.curFrame.timestamp<a.nTargetRelativePos||1==a.nMPPosType&&r<a.nTargetRelativePos)requestAnimationFrame(a.RenderFrame);else{if(a.ProcessPositionflag=!1,a.player.needPlaySound&&a.player.JSPlayM4_PlaySound(),a.paint(a.curFrame),a.curTimeStamp=a.curFrame.timestamp,null!=a.player){var i={nRes:1};i.nRelativePos=a.nTargetRelativePos,null!=a.player.SetPlayPosCBFun?a.player.SetPlayPosCBFun(i):postMessage({function:"SetPlayPosCB",value:a.nTargetRelativePos})}1==a.nMPPlayMode&&a.SetCurStatus(3),a.RenderFrame()}}else requestAnimationFrame(a.RenderFrame);else if(-1==a.displayBuf||0==a.streamOpenMode&&0==a.LatcyTime)null!=a.curFrame&&(a.curTimeStamp=a.curFrame.timestamp,a.paint(a.curFrame)),requestAnimationFrame(a.RenderFrame);else if(null!=a.curFrame){a.initTimer&&!a.resetTimer||(a.oRenderTimer.Init(),a.initTimer=!0,a.resetTimer=!1,a.preTimeStamp=a.curFrame.timestamp,a.baseTimeStamp=a.curFrame.timestamp,1==a.streamOpenMode&&(a.LatcyTime=0)),a.curTimeStamp=a.curFrame.timestamp;var n=0,s=0;6==e?(n=a.preTimeStamp-a.curTimeStamp,s=a.baseTimeStamp-a.curTimeStamp):(n=a.curTimeStamp-a.preTimeStamp,s=a.curTimeStamp-a.baseTimeStamp);var x=a.oRenderTimer.GetTimerWalk();(n>5e3||n<0||s<0||x<=0)&&(a.oRenderTimer.Init(),a.preTimeStamp=a.curFrame.timestamp,a.baseTimeStamp=a.curTimeStamp,s=6==e?a.baseTimeStamp-a.curTimeStamp:a.curTimeStamp-a.baseTimeStamp,x=a.oRenderTimer.GetTimerWalk());var o;o=a.StretchPlayFlag?a.StretchPlaySpeed:a.playSpeed;var f=(s+a.LatcyTime)/o-x;a.printfFlag>0&&console.log("baseTimerWalk:"+x+",lDeta:"+f+",Date :"+(new Date).getFullYear()+"/"+((new Date).getMonth()+1)+"/"+(new Date).getDate()+" "+(new Date).getHours()+"-"+(new Date).getMinutes()+"-"+(new Date).getSeconds()+"-"+(new Date).getMilliseconds()),f<15&&f>-15||f<0?(a.StretchPlayFlag&&a.VideoStretchProcess(a.curTimeStamp),a.paint(a.curFrame),a.preTimeStamp=a.curTimeStamp,a.RenderFrame()):a.Sleep(f-5).then((function(){2!=a.renderCurStatus&&6!=a.renderCurStatus||(a.StretchPlayFlag&&a.VideoStretchProcess(a.curTimeStamp),a.paint(a.curFrame),a.preTimeStamp=a.curTimeStamp),a.RenderFrame()}))}else requestAnimationFrame(a.RenderFrame)}))):requestAnimationFrame(this.RenderFrame),t.abrupt("break",18);case 10:return this._refresh(),requestAnimationFrame(this.RenderFrame),t.abrupt("break",18);case 13:return this.needForward?this.chooseFrame().then((function(t){a.curFrame=t,null!=a.curFrame&&(a.curTimeStamp=a.curFrame.timestamp,a.paint(a.curFrame),a.needForward=!1),requestAnimationFrame(a.RenderFrame)})):(this._refresh(),requestAnimationFrame(this.RenderFrame)),t.abrupt("break",18);case 15:return this._destroyPlayCtrl(),t.abrupt("return");case 17:return t.abrupt("return");case 18:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"paint",value:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(r,i){if(4==e.renderCurStatus||null==t||null==e.oVideoRender||1==e.ProcessPositionflag||null==t.timestamp)r();else{e.waitIFrameTimestamp===t.timestamp&&(e.resetTimer=!0);var n,s={};n=null!=t.image&&null!=t.image?t.image:t,s.nCropLeft=0,s.nCropRight=0,s.nCropTop=0,s.nCropBottom=0,s.nCodeWidth=t.displayWidth,s.nCodeHeight=t.displayHeight;var x={x:0,y:0};if(x.width=t.displayWidth,x.height=t.displayHeight,e.RenderTypeFlagMap.size>0){var o,f=C(e.RenderTypeFlagMap.keys());try{for(f.s();!(o=f.n()).done;){var l=o.value;if(l==et&&1==e.RenderTypeFlagMap.get(l)&&null!=e.runtimeCBFun&&1==e.firstRenderBegin){if(e.pstRuntimeInfo.nRunTimeModule=3,e.pstRuntimeInfo.nStrVersion=1,e.pstRuntimeInfo.nFrameTimeStamp=t.timestamp,e.pstRuntimeInfo.nFrameNum=0,e.pstRuntimeInfo.nErrorCode=et,e.pstRuntimeInfo.nInputDataInterval=0,e.pstRuntimeInfo.nFrameNumInterval=0,e.pstRuntimeInfo.nAverageDecodeTime=0,1==a)e.pstRuntimeInfo.AbsTimeYear=e.curFrameInfo.year,e.pstRuntimeInfo.AbsTimeMonth=e.curFrameInfo.month,e.pstRuntimeInfo.AbsTimeDay=e.curFrameInfo.day,e.pstRuntimeInfo.AbsTimeHour=e.curFrameInfo.hour,e.pstRuntimeInfo.AbsTimeMinute=e.curFrameInfo.minute,e.pstRuntimeInfo.AbsTimeSecond=e.curFrameInfo.second,e.pstRuntimeInfo.AbsTimeMilliseconds=e.curFrameInfo.milliseconds;else{var _=new Object;_=e.findFramebyTime(t.timestamp,0),e.pstRuntimeInfo.AbsTimeYear=_.year,e.pstRuntimeInfo.AbsTimeMonth=_.month,e.pstRuntimeInfo.AbsTimeDay=_.day,e.pstRuntimeInfo.AbsTimeHour=_.hour,e.pstRuntimeInfo.AbsTimeMinute=_.minute,e.pstRuntimeInfo.AbsTimeSecond=_.second,e.pstRuntimeInfo.AbsTimeMilliseconds=_.milliseconds}e.runtimeCBFun(e.pstRuntimeInfo),e.firstRenderBegin=!1}}}catch(t){f.e(t)}finally{f.f()}}e.oVideoRender.DisplayFrame(n,t.displayWidth,t.displayHeight,t.timestamp,s,null,e.nFrameRate,a).then((function(t){var a=t.timestamp,i=t.DrawRet;if(e.RenderTypeFlagMap.size>0&&1!=i){var n,s=C(e.RenderTypeFlagMap.keys());try{for(s.s();!(n=s.n()).done;){var x=n.value;x==rt&&1==e.RenderTypeFlagMap.get(x)&&null!=e.runtimeCBFun&&(e.pstRuntimeInfo.nRunTimeModule=3,e.pstRuntimeInfo.nStrVersion=1,e.pstRuntimeInfo.nFrameTimeStamp=a,e.pstRuntimeInfo.nFrameNum=0,e.pstRuntimeInfo.nErrorCode=rt,e.runtimeCBFun(e.pstRuntimeInfo))}}catch(t){s.e(t)}finally{s.f()}}if(null!==e.displayFrameInfoCB&&e.respondFrameInfoCB(a),e.RenderTypeFlagMap.size>0){var o,f=C(e.RenderTypeFlagMap.keys());try{for(f.s();!(o=f.n()).done;){var l=o.value;l==at&&1==e.RenderTypeFlagMap.get(l)&&null!=e.runtimeCBFun&&(e.pstRuntimeInfo.nRunTimeModule=3,e.pstRuntimeInfo.nStrVersion=1,e.pstRuntimeInfo.nFrameTimeStamp=a,e.pstRuntimeInfo.nFrameNum=0,e.pstRuntimeInfo.nErrorCode=at,e.pstRuntimeInfo.nInputDataInterval=0,e.pstRuntimeInfo.nFrameNumInterval=0,e.pstRuntimeInfo.nAverageDecodeTime=0,e.pstRuntimeInfo.AbsTimeYear=e.curFrameInfo.year,e.pstRuntimeInfo.AbsTimeMonth=e.curFrameInfo.month,e.pstRuntimeInfo.AbsTimeDay=e.curFrameInfo.day,e.pstRuntimeInfo.AbsTimeHour=e.curFrameInfo.hour,e.pstRuntimeInfo.AbsTimeMinute=e.curFrameInfo.minute,e.pstRuntimeInfo.AbsTimeSecond=e.curFrameInfo.second,e.pstRuntimeInfo.AbsTimeMilliseconds=e.curFrameInfo.milliseconds,e.runtimeCBFun(e.pstRuntimeInfo))}}catch(t){f.e(t)}finally{f.f()}}if(e.firstFrame){e.firstFrame=!1;var _=e;e.oVideoRender.GetCanvasData((function(t,e,a){if(null!=t){var r=_.checkColorAnomaly(t,e,a);console.log("checkColorAnomaly resC:"+r),r&&_.HardDecodeError()}})),null!=e.player?null!=e.player.FFCallBackFun&&e.player.FFCallBackFun({decodeEngine:1}):postMessage({function:"firstFrameCB",value:!0})}e.startRecoderFlag&&0==e.stopRecoderFlag&&e.oVideoRender.GetCanvasData((function(t,i,n){if(null!=t){if(0==e.recoderBaseTimestampMode){0==e.vBaseTimeStamp&&(e.vBaseTimeStamp=60*(new Date).getHours()*60*1e3+60*(new Date).getMinutes()*1e3+1e3*(new Date).getSeconds()+(new Date).getMilliseconds());var s=60*(new Date).getHours()*60*1e3+60*(new Date).getMinutes()*1e3+1e3*(new Date).getSeconds()+(new Date).getMilliseconds();e.recoderFrameTimeStamp=s-e.vBaseTimeStamp}else 1==e.recoderBaseTimestampMode||(e.recoderBaseTimestampMode=1),e.recoderFrameTimeStamp=a;var x={timestamp:1e3*e.recoderFrameTimeStamp,codedWidth:e.encodeVideoInfo.encodeWidth,codedHeight:e.encodeVideoInfo.encodeHeight,format:"RGBA"},o=new VideoFrame(t,x),f={};f.year=e.curFrameInfo.year,f.month=e.curFrameInfo.month,f.day=e.curFrameInfo.day,f.hour=e.curFrameInfo.hour,f.minute=e.curFrameInfo.minute,f.second=e.curFrameInfo.second,f.milliseconds=e.curFrameInfo.milliseconds,e.oVideoEncoder.inputData(o,f),o.close(),t=null,e.recoderFrameNum++}r()}),e.encodeVideoInfo.encodeWidth,e.encodeVideoInfo.encodeHeight,e.recoderGetOriginData)}))}}))}},{key:"checkColorAnomaly",value:function(t,e,a){for(var r=0,i=e*a,n=0;n<t.length;n+=4){var s=t[n],x=t[n+1],o=t[n+2];x>1.5*s&&x>1.5*o&&r++}return r/i>.05}},{key:"respondFrameInfoCB",value:function(t){if(0!=this.displayFrameInfo.length&&(this.curFrameInfo.timeStamp!==t||0==t&&0==this.curFrameInfo.timeStamp)){var e=this.findFramebyTime(t,1);this.curFrameInfo.port=e.port,this.curFrameInfo.codecType=e.codecType,this.curFrameInfo.frameType=e.frameType,this.curFrameInfo.frameSize=e.frameSize,this.curFrameInfo.width=e.width-(2*e.cropLeft+2*e.cropRight),this.curFrameInfo.height=e.height-(2*e.cropTop+2*e.cropBottom),this.curFrameInfo.timeStamp=e.timeStamp,this.curFrameInfo.frameRate=e.frameRate,this.curFrameInfo.frameNum=e.frameNum,this.curFrameInfo.interlace=e.interlace,this.curFrameInfo.streamEnd=e.streamEnd,this.curFrameInfo.cropLeft=e.cropLeft,this.curFrameInfo.cropRight=e.cropRight,this.curFrameInfo.cropTop=e.cropTop,this.curFrameInfo.cropBottom=e.cropBottom,this.curFrameInfo.year=e.year,this.curFrameInfo.month=e.month,this.curFrameInfo.week=e.week,this.curFrameInfo.day=e.day,this.curFrameInfo.hour=e.hour,this.curFrameInfo.minute=e.minute,this.curFrameInfo.second=e.second,this.curFrameInfo.milliseconds=e.milliseconds,e=null,null!=this.displayFrameInfoCB&&this.displayFrameInfoCB(this.curFrameInfo)}}},{key:"findFramebyTime",value:function(t,e){var a=new Object;if(a=this.displayFrameInfo.find((function(e){return e.timeStamp==t})),1==e){var r=this.displayFrameInfo.findIndex((function(e){return e.timeStamp==t}));this.displayFrameInfo.splice(r,1)}return a}},{key:"chooseFrame",value:function(){var t=this;return new Promise((function(e,a){if(null==t.oVideoRender||null==t.oVideoDecoder)e(null);else if(t.oVideoDecoder.decoderObjNeedReset)t.oVideoDecoder.resetDecoder().then((function(){t.oVideoDecoder.decoderObjNeedReset=!1,e(null)}),(function(){a()}));else{var r=t.oVideoDecoder.GetFrameBufferLength();if(-1!=t.displayBuf)if(r<3){if(1==t.bSetStreamEnd&&(t.nstreamEndloopNum++,t.nstreamEndloopNum>=50&&null!=t.player&&null!=t.player.runtimeCBFun)){t.player.runtimeCBFun({nRunTimeModule:0,nStrVersion:0,nFrameTimeStamp:0,nFrameNum:0,nErrorCode:9}),t.bSetStreamEnd=!1,t.nstreamEndloopNum=0}e(null)}else 1==t.bSetStreamEnd&&(t.nstreamEndloopNum=0),t.oVideoDecoder.GetFrame().then((function(t){e(t)}),(function(){}));else if(0==r){if(1==t.bSetStreamEnd&&(t.nstreamEndloopNum++,t.nstreamEndloopNum>=50&&null!=t.player&&null!=t.player.runtimeCBFun)){t.player.runtimeCBFun({nRunTimeModule:0,nStrVersion:0,nFrameTimeStamp:0,nFrameNum:0,nErrorCode:9}),t.bSetStreamEnd=!1,t.nstreamEndloopNum=0}e(null)}else 1==t.bSetStreamEnd&&(t.nstreamEndloopNum=0),t.oVideoDecoder.GetFrame().then((function(t){e(t)}),(function(){}))}}))}},{key:"SetDisplayRegion",value:function(t,e,a,r){return null==this.oVideoRender?0:(this.sx=t,this.sy=e,this.sw=a,this.sh=r,this.oVideoRender.SetDisplayRect(t,e,a,r))}},{key:"SetCurStatus",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.bResetdisplayFrameInfoCB=e,this.renderCurStatus=t,1}},{key:"fast",value:function(){var t=this._GetFastSpeed(this.nplaySpeed);return this._SetPlaySpeed(t)}},{key:"slow",value:function(){var t=this._GetSlowSpeed(this.nplaySpeed);return this._SetPlaySpeed(t)}},{key:"Pause",value:function(t){if(t)2!=this.renderCurStatus&&6!=this.renderCurStatus||(this.renderLastStatus=this.renderCurStatus),this.SetCurStatus(3);else{if(3!==this.renderCurStatus)return 0;2===this.renderLastStatus?this.SetCurStatus(2):6===this.renderLastStatus&&this.SetCurStatus(6),this.resetTimer=!0}return 1}},{key:"NotifyBackPlay",value:function(t){if(t?this.SetCurStatus(6):this.SetCurStatus(2),null!=this.oVideoDecoder)if(2==this.PlayOrBackMode)this.oVideoDecoder.NotifyBackPlay(t,this.preTimeStamp,0);else{var e=1==t?2:1;this.oVideoDecoder.NotifyBackPlay(t,this.preTimeStamp,e)}return this.resetTimer=!0,1}},{key:"SetPlayOrBackSwitchMode",value:function(t){return this.PlayOrBackMode=t,1}},{key:"SetStretchPlay",value:function(t,e){return 2!=this.renderCurStatus||this.playSpeed>1.1||this.playSpeed<.9?0:(this.StretchPlayTime=t,this.StretchPlayedTime=0,this.StretchPlaySpeed=e,this.StretchPlayFlag=!0,this.resetTimer=!0,1)}},{key:"VideoStretchProcess",value:function(t){return this.StretchPlayFlag&&(this.printfFlag>0&&console.log("StretchPlayedTime:"+this.StretchPlayedTime+",StretchPlayTime:"+this.StretchPlayTime),this.StretchPlayedTime<this.StretchPlayTime?this.StretchPlayedTime+=t-this.preTimeStamp:(this.StretchPlayedTime=0,this.StretchPlayFlag=!1,this.resetTimer=!0)),1}},{key:"_refresh",value:function(){0!=this.frameBuffers.length&&this.paint(this.frameBuffers[0],!0)}},{key:"OneByOne",value:function(t){if(t)2!=this.renderCurStatus&&6!=this.renderCurStatus||(this.renderLastStatus=this.renderCurStatus),this.SetCurStatus(5),this.needForward=!0;else{if(5!==this.renderCurStatus)return-1;2===this.renderLastStatus?this.SetCurStatus(2):6===this.renderLastStatus&&this.SetCurStatus(6),this.resetTimer=!0,this.needForward=!1,this._SetPlaySpeed(1)}return 1}},{key:"SetCanvasSize",value:function(t,e,a){return null!=this.oVideoRender?this.oVideoRender.SetCanvasSize(t,e,a):0}},{key:"GetCanvasSize",value:function(){return null!=this.oVideoRender?this.oVideoRender.GetCanvasSize():0}},{key:"GetPlayedTime",value:function(){return this.curTimeStamp}},{key:"SetTargetRelativePos",value:function(t,e,a){this.nTargetRelativePos=t,this.nMPPlayMode=a,this.nMPPosType=e,this.ProcessPositionflag=!0}},{key:"_SetPlaySpeed",value:function(t){switch(t){case-16:case-8:case-4:case-2:case 1:case 2:case 4:case 8:case 16:case 32:case 64:break;default:return-1}return t===this.nplaySpeed||(this.nplaySpeed=t,this.playSpeed=t>0?t:-1/t,console.log("playSpeed:"+this.playSpeed),this.resetTimer=!0,this.needForward=!1,2!=this.renderCurStatus&&6!=this.renderCurStatus&&(2===this.renderLastStatus?this.SetCurStatus(2):6===this.renderLastStatus&&this.SetCurStatus(6))),1}},{key:"_GetFastSpeed",value:function(t){var e=0;switch(t){case-16:e=-8;break;case-8:e=-4;break;case-4:e=-2;break;case-2:e=1;break;case 1:e=2;break;case 2:e=4;break;case 4:e=8;break;case 8:e=16;break;case 16:e=32;break;case 32:e=64;break;default:e=0}return e}},{key:"_GetSlowSpeed",value:function(t){var e=0;switch(t){case-8:e=-16;break;case-4:e=-8;break;case-2:e=-4;break;case 1:e=-2;break;case 2:e=1;break;case 4:e=2;break;case 8:e=4;break;case 16:e=8;break;case 32:e=16;break;case 64:e=32;break;default:e=0}return e}},{key:"SetDisplayBuf",value:function(t){return this.displayBuf=t,this.LatcyTime=1==t?0:15==t?700:45==t?1900:t>6&&t<45?40*t+100:-1==t?0:50,1}},{key:"GetJPEG",value:function(){var t=this;null!=this.oVideoDecoder&&this.oVideoDecoder.GetImageYUV("jpeg",0,0,0,0).then((function(e){var a=e.yuvFrameBuffer,r=e.yuvLength,i=e.displayWidth,n=e.displayHeight,s=e.yuvType;-1!=a&&(t.player?t.player._GetImage2(a,r,i,n,"jpeg",s,0,0,0,0):postMessage({function:"imageYUV",value:a.buffer,size:r,width:i,height:n,type:"jpeg",yuvType:s,sx:0,sy:0,sw:0,sh:0},[a.buffer]))}),(function(){}))}},{key:"GetBMP",value:function(){var t=this;null!=this.oVideoDecoder&&this.oVideoDecoder.GetImageYUV("bmp",0,0,0,0).then((function(e){var a=e.yuvFrameBuffer,r=e.yuvLength,i=e.displayWidth,n=e.displayHeight,s=e.yuvType;-1!=a&&(t.player?t.player._GetImage2(a,r,i,n,"bmp",s,0,0,0,0):postMessage({function:"imageYUV",value:a.buffer,size:r,width:i,height:n,type:"bmp",yuvType:s,sx:0,sy:0,sw:0,sh:0},[a.buffer]))}),(function(){}))}},{key:"GetCropJPEG",value:function(){var t=this;null!=this.oVideoDecoder&&this.oVideoDecoder.GetImageYUV("jpeg",this.sx,this.sy,this.sw,this.sh).then((function(e){var a=e.yuvFrameBuffer,r=e.yuvLength,i=e.displayWidth,n=e.displayHeight,s=e.yuvType;-1!=a&&(t.player?t.player._GetImage2(a,r,i,n,"jpeg",s,t.sx,t.sy,t.sw,t.sh):postMessage({function:"imageYUV",value:a.buffer,size:r,width:i,height:n,type:"jpeg",yuvType:s,sx:t.sx,sy:t.sy,sw:t.sw,sh:t.sh},[a.buffer]))}),(function(){}))}},{key:"GetCropBMP",value:function(){var t=this;null!=this.oVideoDecoder&&this.oVideoDecoder.GetImageYUV("bmp",this.sx,this.sy,this.sw,this.sh).then((function(e){var a=e.yuvFrameBuffer,r=e.yuvLength,i=e.displayWidth,n=e.displayHeight,s=e.yuvType;-1!=a&&(t.player?t.player._GetImage2(a,r,i,n,"bmp",s,t.sx,t.sy,t.sw,t.sh):postMessage({function:"imageYUV",value:a.buffer,size:r,width:i,height:n,type:"bmp",yuvType:s,sx:t.sx,sy:t.sy,sw:t.sw,sh:t.sh},[a.buffer]))}),(function(){}))}},{key:"GetCanvasCapture",value:function(t,e,a){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support GetCanvasCapture","color:red"),0):(this.oVideoRender.GetCanvasData(t,e,a),1)}},{key:"SetDecodeFrameType",value:function(t){return this.waitIFrameTimestamp=t,1}},{key:"SetStreamEnd",value:function(t){return this.bSetStreamEnd=t,this.oVideoDecoder.SetStreamEnd(),1}},{key:"SetAntialias",value:function(t){return null!=this.oVideoRender?this.oVideoRender.SetAntialias(t):0}},{key:"SetFrameInfoCallBack",value:function(t,e){return e?(this.needSaveFrameInfo=!0,this.displayFrameInfoCB=t):(this.needSaveFrameInfo=!1,this.displayFrameInfoCB=null),1}},{key:"FEC_SetCanvasID",value:function(t){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support FEC correct","color:red"),0):null!=this.oVideoRender?this.oVideoRender.FEC_SetCanvasID(t):(this.FECCanvasID=t,0)}},{key:"FEC_ResetCorrectType",value:function(t,e,a){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support FEC correct","color:red"),0):null!=this.oVideoRender?this.oVideoRender.FEC_ResetCorrectType(t,e,a):0}},{key:"FEC_GetPort",value:function(t,e){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support FEC correct","color:red"),-1):null!=this.oVideoRender?this.oVideoRender.FEC_GetPort(t,e):-1}},{key:"FEC_Enable",value:function(t){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support FEC correct","color:red"),0):null!=this.oVideoRender?this.oVideoRender.FEC_Enable(t):0}},{key:"FEC_SetParam",value:function(t,e){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support FEC correct","color:red"),0):null!=this.oVideoRender?this.oVideoRender.FEC_SetParam(t,e):0}},{key:"FEC_GetParam",value:function(t,e){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support FEC correct","color:red"),0):null!=this.oVideoRender?this.oVideoRender.FEC_GetParam(t,e):0}},{key:"FEC_SetViewParam",value:function(t,e,a){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support FEC correct","color:red"),0):null!=this.oVideoRender?this.oVideoRender.FEC_SetViewParam(t,e,a):0}},{key:"FEC_GetViewParam",value:function(t,e,a){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support FEC correct","color:red"),0):null!=this.oVideoRender?this.oVideoRender.FEC_GetViewParam(t,e,a):0}},{key:"FEC_SetWnd",value:function(t,e){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support FEC correct","color:red"),0):null!=this.oVideoRender?this.oVideoRender.FEC_SetWnd(t,e):0}},{key:"FEC_Disable",value:function(t,e,a){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support FEC correct","color:red"),0):null!=this.oVideoRender?this.oVideoRender.FEC_Disable(t,e,a):0}},{key:"FEC_DelPort",value:function(t){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support FEC correct","color:red"),0):null!=this.oVideoRender?this.oVideoRender.FEC_DelPort(t):0}},{key:"FEC_SetDisplayRegion",value:function(t,e,a,r,i,n,s){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support FEC correct","color:red"),0):null!=this.oVideoRender?this.oVideoRender.FEC_SetDisplayRegion(t,e,a,r,i,n,s):0}},{key:"FEC_SetBackCilling",value:function(t,e){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support FEC correct","color:red"),0):null!=this.oVideoRender?this.oVideoRender.FEC_SetBackCilling(t,e):0}},{key:"FEC_GetPTZPort",value:function(t,e,a){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support FEC correct","color:red"),-1):null!=this.oVideoRender?this.oVideoRender.FEC_GetPTZPort(t,e,a):-1}},{key:"FEC_SetPTZDisplayMode",value:function(t){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support FEC correct","color:red"),0):null!=this.oVideoRender?this.oVideoRender.FEC_SetPTZDisplayMode(t):0}},{key:"FEC_Capture",value:function(t,e){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support FEC_Capture","color:red"),0):this.oVideoRender.FEC_Capture(t,e)}},{key:"InputPrivateInfo",value:function(t,e,a){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support PrivateInfo","color:red"),0):((null!=t&&t.linesNum>0||null!=e&&e.nFontsNum>0)&&0==this.firstFrame&&(this.LatcyTime=100),this.curPrivateInfo.linesInfo.push(t),this.curPrivateInfo.fontInfo.push(e),this.curPrivateInfo.imageInfo.push(a),1)}},{key:"deepClone",value:function(t){if(null===t||"object"!==ot(t))return t;if(Array.isArray(t)){for(var e=[],a=0;a<t.length;a++)e[a]=this.deepClone(t[a]);return e}if(ArrayBuffer.isView(t)){var r=new Uint8Array(t.length);return r.set(t),r}var i={};for(var n in t)t.hasOwnProperty(n)&&(i[n]=this.deepClone(t[n]));return i}},{key:"RenderPrivateData",value:function(t,e){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support PrivateInfo","color:red"),0):null!=this.oVideoRender?this.oVideoRender.RenderPrivateData(t,e):0}},{key:"RenderPrivateDataEx",value:function(t,e,a){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support PrivateInfo","color:red"),0):null!=this.oVideoRender?this.oVideoRender.RenderPrivateDataEx(t,e,a):0}},{key:"SetWaterMarkFont",value:function(t){return"2d"===this.renderEngine||"2D"===this.renderEngine||null==this.oVideoRender?(console.log("%c param error this.renderEngine:%d,this.oVideoRender:%d","color:red",this.renderEngine,this.oVideoRender),0):null!=this.oVideoRender?this.oVideoRender.SetWaterMarkFont(t):0}},{key:"SetWaterMarkImage",value:function(t){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support SetWaterMarkImage","color:red"),0):null!=this.oVideoRender?this.oVideoRender.SetWaterMarkImage(t):0}},{key:"SetMosaicType",value:function(t){return"2d"===this.renderEngine||"2D"===this.renderEngine||null==this.oVideoRender?(console.log("%c 2D render not support SetMosaicType","color:red"),0):null!=this.oVideoRender?this.oVideoRender.SetMosaicType(t):0}},{key:"SelectIntelInfoFeatureToDraw",value:function(t){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support SelectIntelInfoFeatureToDraw","color:red"),0):null!=this.oVideoRender?this.oVideoRender.SelectIntelInfoFeatureToDraw(t):0}},{key:"SetD3DPostProcess",value:function(t,e){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support SetD3DPostProcess","color:red"),0):null!=this.oVideoRender?this.oVideoRender.SetD3DPostProcess(t,e):0}},{key:"SetTextCanvas",value:function(t){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support SetD3DPostProcess","color:red"),0):null!=this.oVideoRender?this.oVideoRender.SetTextCanvas(t):0}},{key:"SetPrintLogFlag",value:function(t){return this.printfFlag=t,null!=this.oVideoDecoder&&this.oVideoDecoder.SetPrintLogFlag(t),null!=this.oVideoRender&&this.oVideoRender.SetPrintLogFlag(t),1}},{key:"SetRotateAngle",value:function(t){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support SetRotateAngle","color:red"),0):null!=this.oVideoRender?this.oVideoRender.SetRotateAngle(t):0}},{key:"InitEncoder",value:function(t,e){return t.encodeWidth>0||t.encodeHeight>0?(this.encodeVideoInfo.encodeWidth=t.encodeWidth,this.encodeVideoInfo.encodeHeight=t.encodeHeight):null!=this.curFrameInfo.width&&this.curFrameInfo.width>0&&this.curFrameInfo.width<=1400&&null!=this.curFrameInfo.height&&this.curFrameInfo.height>0&&this.curFrameInfo.height<=800?(this.encodeVideoInfo.encodeWidth=this.curFrameInfo.width,this.encodeVideoInfo.encodeHeight=this.curFrameInfo.height):(this.encodeVideoInfo.encodeWidth=1280,this.encodeVideoInfo.encodeHeight=720),t.bitrate>0?this.encodeVideoInfo.bitrate=t.bitrate:this.encodeVideoInfo.encodeWidth>1580?this.encodeVideoInfo.bitrate=4e6:this.encodeVideoInfo.encodeWidth>800?this.encodeVideoInfo.bitrate=2e6:this.encodeVideoInfo.bitrate=1e6,t.frameRate>0?this.encodeVideoInfo.frameRate=t.frameRate:"frameRate"in this.curFrameInfo&&(this.encodeVideoInfo.frameRate=this.curFrameInfo.frameRate),t.bitrateMode>0?this.encodeVideoInfo.bitrateMode=t.bitrateMode:this.encodeVideoInfo.bitrateMode=0,t.latencyMode>0?this.encodeVideoInfo.latencyMode=t.latencyMode:this.encodeVideoInfo.latencyMode=0,0==t.encodeType&&(this.encodeVideoInfo.encodeVideoType="avc"),this.recoderBaseTimestampMode=t.baseTimeStampMode,this.recoderGetOriginData=t.getOriginData,null==this.oVideoEncoder&&(this.oVideoEncoder=new qt(this,this.player)),e.sampleRate>0?this.encodeAudioInfo.sampleRate=e.sampleRate:this.encodeAudioInfo.sampleRate=48e3,e.numberOfChannels>0?this.encodeAudioInfo.numberOfChannels=e.numberOfChannels:this.encodeAudioInfo.numberOfChannels=1,e.bitrate>0?this.encodeAudioInfo.bitrate=e.bitrate:this.encodeAudioInfo.bitrate=128e3,0==e.encodeType&&(this.encodeAudioInfo.encodeAudioType="aac"),null==this.oAudioEncoder&&(this.oAudioEncoder=new Qt(this,this.player)),1}},{key:"StartVideoEncode",value:function(t){return null!=this.oVideoEncoder&&(this.oVideoEncoder.initEncoder("avc1.4d4032",this.encodeVideoInfo,t),this.startRecoderFlag=!0,this.stopRecoderFlag=!1),1}},{key:"StartAudioEncode",value:function(t){return null!=this.oAudioEncoder&&this.oAudioEncoder.initEncoder("mp4a.40.2",this.encodeAudioInfo,t),1}},{key:"InputPCMToEncode",value:function(t,e){if(null!=this.oAudioEncoder&&0==this.stopRecoderFlag){var a={format:"s16",sampleRate:this.encodeAudioInfo.sampleRate,numberOfFrames:t.length/2,numberOfChannels:1,timestamp:e,data:t},r=new AudioData(a);this.oAudioEncoder.inputData(r),r.close()}return 1}},{key:"StopEncode",value:function(){return this.startRecoderFlag=!1,this.stopRecoderFlag=!0,this.recoderFrameNum=0,null!=this.oAudioEncoder&&(this.oAudioEncoder.stopEncode(),this.oAudioEncoder=null),null!=this.oVideoEncoder&&(this.oVideoEncoder.stopEncode(),this.oVideoEncoder=null),this.recoderBaseTimestampMode=0,this.recoderGetOriginData=0,1}},{key:"SetRunTimeInfoCallBack",value:function(t,e){return this.runtimeCBFun=e,null!=this.oVideoDecoder&&this.oVideoDecoder.SetRunTimeInfoCallBackFun(t,e),1}},{key:"SetRunTimeInfoCallbackType",value:function(t,e,a){return 2==t?a?this.DecodeTypeFlagMap.set(e,1):this.DecodeTypeFlagMap.delete(e):3==t&&(a?this.RenderTypeFlagMap.set(e,1):this.RenderTypeFlagMap.delete(e)),null!=this.oVideoDecoder&&2==t&&this.oVideoDecoder.SetRunTimeInfoCallbackType(t,e,a),1}},{key:"IsVisible",value:function(t){return null!=this.oVideoDecoder&&this.oVideoDecoder.IsVisible(t),1}},{key:"SetPanoramaDisplayEffect",value:function(t){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support SetPanoramaDisplayEffect","color:red"),0):null!=this.oVideoRender?this.oVideoRender.SetPanoramaDisplayEffect(t):0}},{key:"SetPanoramaSphereViewParam",value:function(t,e){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support SetPanoramaSphereViewParam","color:red"),0):null!=this.oVideoRender?this.oVideoRender.SetPanoramaSphereViewParam(t,e):0}},{key:"GetPanoramaSphereViewParam",value:function(t,e){return"2d"===this.renderEngine||"2D"===this.renderEngine?(console.log("%c 2D render not support GetPanoramaSphereViewParam","color:red"),0):null!=this.oVideoRender?this.oVideoRender.GetPanoramaSphereViewParam(t,e):0}},{key:"ResetBuffer",value:function(){return this.resetTimer=!0,this.oVideoDecoder.clearDecoderObjBuffer(),1}}]),a}(),te=function(){function a(e){t(this,a),this.player=e,this.oVideoPlayCtrl=new $t(e)}return e(a,[{key:"init",value:function(t,e,a,r){if(null===this.oVideoPlayCtrl)return 0;this.oVideoPlayCtrl.init(t,e,a,r)}},{key:"inputData",value:function(t,e){null!=this.oVideoPlayCtrl&&this.oVideoPlayCtrl.inputData(t,e)}},{key:"SetDisplayRegion",value:function(t,e,a,r){if(null===this.oVideoPlayCtrl)return 0;this.oVideoPlayCtrl.SetDisplayRegion(t,e,a,r)}},{key:"stop",value:function(){if(null===this.oVideoPlayCtrl)return 0;this.oVideoPlayCtrl.SetCurStatus(4),this.oVideoPlayCtrl=null,window.g_printfFlag>=0&&console.log(">>>JS 03 destroy oVideoPlayCtrl")}},{key:"fast",value:function(){return null===this.oVideoPlayCtrl||1!==this.oVideoPlayCtrl.fast()?0:void 0}},{key:"slow",value:function(){return null===this.oVideoPlayCtrl||1!==this.oVideoPlayCtrl.slow()?0:void 0}},{key:"SetDisplayBuf",value:function(t){return null===this.oVideoPlayCtrl||1!==this.oVideoPlayCtrl.SetDisplayBuf(t)?0:void 0}},{key:"Pause",value:function(t){return null===this.oVideoPlayCtrl||1!==this.oVideoPlayCtrl.Pause(t)?0:void 0}},{key:"OneByOne",value:function(t){return null===this.oVideoPlayCtrl||1!==this.oVideoPlayCtrl.OneByOne(t)?0:void 0}},{key:"NotifyBackPlay",value:function(t){return null===this.oVideoPlayCtrl||1!==this.oVideoPlayCtrl.NotifyBackPlay(t)?0:void 0}},{key:"SetPlayOrBackSwitchMode",value:function(t){return null===this.oVideoPlayCtrl||1!==this.oVideoPlayCtrl.SetPlayOrBackSwitchMode(t)?0:void 0}},{key:"SetStretchPlay",value:function(t,e){return null===this.oVideoPlayCtrl||1!==this.oVideoPlayCtrl.SetStretchPlay(t,e)?0:void 0}},{key:"SetCanvasSize",value:function(t,e,a){return null===this.oVideoPlayCtrl||1!==this.oVideoPlayCtrl.SetCanvasSize(t,e,a)?0:void 0}},{key:"GetCanvasSize",value:function(){return null===this.oVideoPlayCtrl||1!==this.oVideoPlayCtrl.GetCanvasSize()?0:void 0}},{key:"GetPlayedTime",value:function(){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.GetPlayedTime()}},{key:"SetTargetRelativePos",value:function(t,e,a){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.SetTargetRelativePos(t,e,a)}},{key:"needReset",value:function(t){if(null===this.oVideoPlayCtrl)return 0;this.oVideoPlayCtrl.SetCurStatus(0,t)}},{key:"GetJPEG",value:function(){if(null===this.oVideoPlayCtrl)return 0;this.oVideoPlayCtrl.GetJPEG()}},{key:"GetBMP",value:function(){if(null===this.oVideoPlayCtrl)return 0;this.oVideoPlayCtrl.GetBMP()}},{key:"GetCropJPEG",value:function(){if(null===this.oVideoPlayCtrl)return 0;this.oVideoPlayCtrl.GetCropJPEG()}},{key:"GetCropBMP",value:function(){if(null===this.oVideoPlayCtrl)return 0;this.oVideoPlayCtrl.GetCropBMP()}},{key:"GetCanvasCapture",value:function(t,e,a){if(null===this.oVideoPlayCtrl)return 0;this.oVideoPlayCtrl.GetCanvasCapture(t,e,a)}},{key:"SetDecodeFrameType",value:function(t){if(null===this.oVideoPlayCtrl)return 0;this.oVideoPlayCtrl.SetDecodeFrameType(t)}},{key:"SetStreamEnd",value:function(t){if(null===this.oVideoPlayCtrl)return 0;this.oVideoPlayCtrl.SetStreamEnd(t)}},{key:"SetAntialias",value:function(t){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.SetAntialias(t)}},{key:"SetFrameInfoCallBack",value:function(t,e){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.SetFrameInfoCallBack(t,e)}},{key:"FEC_SetCanvasID",value:function(t){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.FEC_SetCanvasID(t)}},{key:"FEC_ResetCorrectType",value:function(t,e,a){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.FEC_ResetCorrectType(t,e,a)}},{key:"FEC_GetPort",value:function(t,e){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.FEC_GetPort(t,e)}},{key:"FEC_Enable",value:function(t){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.FEC_Enable(t)}},{key:"FEC_SetParam",value:function(t,e){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.FEC_SetParam(t,e)}},{key:"FEC_GetParam",value:function(t,e){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.FEC_GetParam(t,e)}},{key:"FEC_SetViewParam",value:function(t,e,a){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.FEC_SetViewParam(t,e,a)}},{key:"FEC_GetViewParam",value:function(t,e,a){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.FEC_GetViewParam(t,e,a)}},{key:"FEC_SetWnd",value:function(t,e){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.FEC_SetWnd(t,e)}},{key:"FEC_Disable",value:function(t,e,a){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.FEC_Disable(t,e,a)}},{key:"FEC_DelPort",value:function(t){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.FEC_DelPort(t)}},{key:"FEC_SetDisplayRegion",value:function(t,e,a,r,i,n,s){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.FEC_SetDisplayRegion(t,e,a,r,i,n,s)}},{key:"FEC_SetBackCilling",value:function(t,e){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.FEC_SetBackCilling(t,e)}},{key:"FEC_GetPTZPort",value:function(t,e,a){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.FEC_GetPTZPort(t,e,a)}},{key:"FEC_SetPTZDisplayMode",value:function(t){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.FEC_SetPTZDisplayMode(t)}},{key:"FEC_Capture",value:function(t,e){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.FEC_Capture(t,e)}},{key:"InputPrivateInfo",value:function(t,e,a){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.InputPrivateInfo(t,e,a)}},{key:"RenderPrivateData",value:function(t,e){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.RenderPrivateData(t,e)}},{key:"RenderPrivateDataEx",value:function(t,e,a){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.RenderPrivateDataEx(t,e,a)}},{key:"SetWaterMarkFont",value:function(t){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.SetWaterMarkFont(t)}},{key:"SetWaterMarkImage",value:function(t){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.SetWaterMarkImage(t)}},{key:"SetMosaicType",value:function(t){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.SetMosaicType(t)}},{key:"SelectIntelInfoFeatureToDraw",value:function(t){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.SelectIntelInfoFeatureToDraw(t)}},{key:"SetD3DPostProcess",value:function(t,e){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.SetD3DPostProcess(t,e)}},{key:"SetTextCanvas",value:function(t){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.SetTextCanvas(t)}},{key:"SetPrintLogFlag",value:function(t){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.SetPrintLogFlag(t)}},{key:"SetRotateAngle",value:function(t){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.SetRotateAngle(t)}},{key:"InitEncoder",value:function(t,e){return null===this.oVideoPlayCtrl?0:(this.oVideoPlayCtrl.InitEncoder(t,e),1)}},{key:"StartVideoEncode",value:function(t){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.StartVideoEncode(t)}},{key:"StartAudioEncode",value:function(t){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.StartAudioEncode(t)}},{key:"InputPCMToEncode",value:function(t,e){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.InputPCMToEncode(t,e)}},{key:"StopEncode",value:function(){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.StopEncode()}},{key:"SetRunTimeInfoCallBack",value:function(t,e){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.SetRunTimeInfoCallBack(t,e)}},{key:"SetRunTimeInfoCallbackType",value:function(t,e,a){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.SetRunTimeInfoCallbackType(t,e,a)}},{key:"IsVisible",value:function(t){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.IsVisible(t)}},{key:"SetPanoramaDisplayEffect",value:function(t){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.SetPanoramaDisplayEffect(t)}},{key:"SetPanoramaSphereViewParam",value:function(t,e){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.SetPanoramaSphereViewParam(t,e)}},{key:"GetPanoramaSphereViewParam",value:function(t,e){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.GetPanoramaSphereViewParam(t,e)}},{key:"ResetBuffer",value:function(){return null===this.oVideoPlayCtrl?0:this.oVideoPlayCtrl.ResetBuffer()}}]),a}(),ee=[];!function(){for(var t=0;t<8;t++){ee[t]=[];for(var e=0;e<64;e++)ee[t][e]=null}}();var ae=null,re=!1,ie=!1,ne=1,se=1,xe={bSupHardOrSoft:!0,bSupHardDecAVC:!0,bSupHardDecHEVC:!0,cmd:"unloaded",errorCode:0,status:0},oe=-1;window.JSPlayM4_RawDataCallBack=function(t,e,a,r){null!=ee[r][t]&&ee[r][t].__proto__.hasOwnProperty("JSPlayM4_InputRawData")&&ee[r][t].JSPlayM4_InputRawData(t,e,a)},window.JSPlayM4_PrivateInfoCallBack=function(t,e,a,r,i){null!=ee[i][t]&&ee[i][t].__proto__.hasOwnProperty("JSPlayM4_InputPrivateInfo")&&ee[i][t].JSPlayM4_InputPrivateInfo(e,a,r)};var fe=function(){function a(e,r,i){var n=this,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,x=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"webgl",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1;if(t(this,a),this.printfFlag=window.g_printfFlag,this.jsplayer=e,this.szBasePath=r,this.fn=i,this.nUser=s,this.renderEngine=x,this.hasWebWorker=o,this.setHasThread=f,this.oJSPlayerObj=this,this.port=-1,this.pcVideoManager=null,this.decodeWorker=null,this.offscreen=null,this.canvasID="",this.canvasCnv=null,this.rtpType=0,this.decodeEngine=1,this.FirstFrameCallBackflag=!1,this.inputDataBuffer=null,this.inputDataBufferSize=204800,this.canvasIDData=null,this._decoderLoaded=!1,this.streamOpenMode=0,this.width=0,this.height=0,this.rawDataFrameInfoBuffer=null,this.rawDataFrameInfo={},this.displayFrameInfo={},this.startTimeStamp=0,this.decodeFrameType=0,this.switchDecodeFrame=!1,this.displayBuf=0,this.needSetDisplayBuf=!1,this.FirstFrame=!0,this.codecType=0,this.curStatus=0,this.lastStatus=0,this.playSpeed=1,this.needWaitIFrame=!1,this.sysType=0,this.SetDisRegionBottom=0,this.SetDisRegionLeft=0,this.SetDisRegionRight=0,this.SetDisRegionTop=0,this.cropBottom=0,this.cropLeft=0,this.cropRight=0,this.cropTop=0,this.canvasWidth=960,this.canvasHeight=480,this.enableCanvas=!0,this.needResetCanvasSize=!1,this.hasThread=0,this.aTotalBuffer=[],this.iFrameNum=0,this.bWriteData=!0,this.downloadFlag=!1,this.bWriteAudioPCMData=!0,this.audioPCMBuffer=[],this.iAudioPCMFrameNum=0,this.pBmpData=null,this.nBmpDataSize=0,this.pBmpSizeData=null,this.bmpDataCallback=null,this.bmpDownloadFlag=!1,this.pJpegData=null,this.nJpegDataSize=0,this.pJPEGSizeData=null,this.jpegDataCallback=null,this.jpegDownloadFlag=!1,this.CropjpegDataCallback=null,this.CropjpegDownloadFlag=!1,this.CropbmpDataCallback=null,this.CropbmpDownloadFlag=!1,this.imageCB=null,this.pFontParam=null,this.pWaterMarkFontData=null,this.nWaterMarkFontLen=0,this.textCanvas=null,this.setTextCanvasFlag=!1,this.rgbDataBuffer=null,this.recoderVideoDataCBFun=null,this.recoderAudioDataCBFun=null,this.recoderAudioAnyWhere=!1,this.pMosaicParam=null,this.stDisplayRect={top:0,left:0,right:0,bottom:0},this.iZoomNum=0,this.iRatio_x=1,this.iRatio_y=1,this.pFECTotalCanvasIDData=null,this.iFECCanvasIDLen=0,this.iFECZoomNum=0,this.iFECRatio_x=1,this.iFECRatio_y=1,this.stFECDisplayRect={top:0,left:0,right:0,bottom:0},this.FECcanvasIDArray=[],this.FECGetPortCB=null,this.FECGetPTZPortCB=null,this.FECParamCB=null,this.FECViewParamCB=null,this.GetPanoramaSphereViewParamCB=null,this.FECImageCB=null,this.FECRgbDataBuffer=null,this.FFCallBackFun=null,this.addtionCallBackFun=null,this.additionDataBuffer=null,this.additionDataBufferSize=0,this.displayCallBackFun=null,this.decCallBackFun=null,this.getPlayTimeCallBackFun=null,this.runtimeCBFun=null,this.callbackFlag=!1,this.runTimeModule=0,this.needSetRunTimeInfoCB=!1,this.decodeQueueSize=0,this.decodeFrameSize=0,this.streamInfoCBFun=null,this.streamInfoType=0,this.ResamplePCMCallBack=null,this.PostMpStreamOffsetCBFun=null,this.SetPlayPosCBFun=null,this.HardDecToJpegCBFun=null,this.HardDecToJpegQuality=1,this.HardDecToJpegInterval=2,this.HardToJpegZoomWidth=100,this.HardToJpegZoomHeight=100,this.HardToJpegZoomResolutionFlag=0,this.pstRuntimeInfo={nRunTimeModule:0,nStrVersion:0,nFrameTimeStamp:0,nFrameNum:0,nErrorCode:0,nInputDataInterval:0,nFrameNumInterval:0,nAverageDecodeTime:0,nSystemFormat:0,nDetectRes:0,nMp4FileTime:0,nMp4TotalFrameNum:0,AbsTimeYear:0,AbsTimeMonth:0,AbsTimeDay:0,AbsTimeHour:0,AbsTimeMinute:0,AbsTimeSecond:0,AbsTimeMilliseconds:0},this.needSetSecretKey=!1,this.SecretKeyData=null,this.keyType=1,this.pKeyDataLen=128,this.needPlaySound=!1,this.decInterval=-1,this.volumeValue=-1,this.renderPrivateInfo=new Map,this.renderIntelSubEx=new Map,this.renderIntelFlagEx=new Map,this.reversePlay=!1,this.decodeThreadNum=0,this.antialiasFlag=-1,this.decodeERCLevel=0,this.d3dPostProcessType=0,this.d3dPostProcessValue=0,this.needSetD3DPostProcess=!1,this.resetBufferType=-1,this.playOrBackSwitchMode=0,this.setStretchPlayTime=0,this.setStretchPlaySpeed=0,this.autoSmoothPlayModel=-1,this.keepPlaySpeed=-1,this.FECCanvasID="",this.FECPlaceType=0,this.FECCorrectType=0,this.anrParamFlag=!1,this.anrParamLevel=-1,this.resampleFlag=!1,this.resampleRate=48e3,this.globalBaseTime=null,this.needSetSkipErrorData=!1,this.skipErrorData=-1,this.needSetDemuxModel=!1,this.setDemuxModelType=-1,this.setDemuxModelFlag=!1,this.setAudioThreadModel=-1,this.syncToAudio=-1,this.twodRotateAngle=0,this.needSetRotateAngle=!1,this.additionDataType=0,this.additionFlag=0,this.addCBFun=null,this.needSetAdditionDataCB=!1,this.needPlaySoundShare=!1,this.needSetRunTimeInfoCBType=!1,this.HIK40Head=[],this.HIKHeadSize=40,this.HIKPoolSize=2097152,this.SDPInfoData=null,this.SDPInfoLen=0,this.SDPInfoPoolSize=4194304,this.SDPInfoProtocolType=1,this.SDPInfoSessionInfoType=1,this.wasmMemory=null,this.initialMemory=8192,this.maximumMemory=16368,this.OpenStreamMode=0,xe.cmd="unloaded",xe.errorCode=0,xe.status=0,this.supportWebCodecs=_getFSupportWebCodecs(),this.supportSab=!!window.SharedArrayBuffer,this.offscreen=!!window.OffscreenCanvas,this.supportOffscreen=!1,this.offscreen){var l=new OffscreenCanvas(1,1),_=l.getContext("webgl");_&&(this.supportOffscreen=!0,_.getExtension("WEBGL_lose_context").loseContext()),l=null,_=null}if(null!=ae||re)xe.cmd="loaded",new Promise((function(t,e){t()})).then((function(){if(null!==ae&&ie)n.fn(xe);else var t=setInterval((function(){null!==ae&&ie&&(clearInterval(t),t=null,n.fn(xe))}),10)}));else if(re=!0,oe=_getFExplore(),this.supportWebCodecs?(xe.bSupHardOrSoft=!0,xe.bSupHardDecAVC=!0,xe.bSupHardDecHEVC=!0):(this.printfFlag>=0&&console.info("%c1>your browser does not support hard Decoder ","color: red"),se=0,ne=0,xe.bSupHardDecAVC=!1,xe.bSupHardDecHEVC=!1,this.supportSab&&this.supportOffscreen?xe.bSupHardOrSoft=!0:xe.bSupHardOrSoft=!1),this.getwasmMemory(),xe.bSupHardOrSoft){this.printfFlag>=0&&console.log("%cstart load Decoder.js time:"+(new Date).getMinutes()+":"+(new Date).getSeconds()+"."+(new Date).getMilliseconds(),"color: blue");var h=this.szBasePath,c=document.createElement("script");c.type="text/javascript",c.src=h,this.printfFlag>=0&&console.info("%c>>>>The Decoder.js path:%s","color: green",h),this.supportSab&&this.supportOffscreen?this.wasmMemory=new WebAssembly.Memory({initial:this.initialMemory,maximum:this.maximumMemory,shared:!0}):this.wasmMemory=new WebAssembly.Memory({initial:this.initialMemory,maximum:this.maximumMemory}),console.log("create wasmMemory this.initialMemory:"+this.initialMemory+",this.maximumMemory:"+this.maximumMemory),c.onload=function(){window.JSPlayerModule({wasmMemory:n.wasmMemory}).then((function(t){ae=t,n._decoderLoaded=!0,xe.cmd="loaded";var e=ae._JSPlayM4_GetSDKVersion(),a=ae._JSPlayM4_GetBuildDate();n.printfFlag>=0&&console.log("%cEnd load Decoder.js time:"+(new Date).getMinutes()+":"+(new Date).getSeconds()+"."+(new Date).getMilliseconds()+",version:"+e.toString(16)+",buildDate:"+a.toString(16),"color: blue"),ae._JSPlayM4_SetPrintLogFlag(-1,n.printfFlag),n.supportWebCodecs?VideoDecoder.isConfigSupported({codec:"avc1.42001f",hardwareAcceleration:"prefer-hardware"}).then((function(t){"prefer-hardware"==t.config.hardwareAcceleration&&t.supported?(se=1,xe.bSupHardDecAVC=!0,n.printfFlag>=0&&console.info("%c1>your browser support 264 hard Decoder","color: green"),oe>97||-1===oe?VideoDecoder.isConfigSupported({codec:"hvc1.1.6.L123.00",hardwareAcceleration:"prefer-hardware"}).then((function(t){console.log("%c hevcConfigInfo.config.hardwareAcceleration:"+t.config.hardwareAcceleration,"color:red"),"prefer-hardware"==t.config.hardwareAcceleration&&t.supported?(ne=1,xe.bSupHardDecHEVC=!0,n.printfFlag>=0&&console.info("%c2>your browser support 265 hard Decoder","color: green")):(ne=0,xe.bSupHardDecHEVC=!1,n.printfFlag>=0&&console.info("%c2>your browser not support 265 hard Decoder","color: red")),n.callbackFlag||(n.callbackFlag=!0,n.fn(xe),ie=!0)})):(ne=0,xe.bSupHardDecHEVC=!1,n.printfFlag>=0&&console.info("%c2>your browser not support 265 hard Decoder chromeVersion:"+oe,"color: red"),n.callbackFlag||(n.callbackFlag=!0,n.fn(xe),ie=!0))):(se=0,xe.bSupHardDecAVC=!1,ne=0,xe.bSupHardDecHEVC=!1,n.printfFlag>=0&&console.info("%c1>your browser not support 264/265 hard Decoder","color: red"),n.supportSab&&n.supportOffscreen?xe.bSupHardOrSoft=!0:xe.bSupHardOrSoft=!1,n.callbackFlag||(n.callbackFlag=!0,n.fn(xe),ie=!0))})).catch((function(){n.supportSab&&n.supportOffscreen?xe.bSupHardOrSoft=!0:xe.bSupHardOrSoft=!1,se=0,xe.bSupHardDecAVC=!1,ne=0,xe.bSupHardDecHEVC=!1,n.printfFlag>=0&&console.log("%c2>hard decode supported error","color: red"),n.callbackFlag||(n.callbackFlag=!0,n.fn(xe),ie=!0)})):(n.supportSab&&n.supportOffscreen?xe.bSupHardOrSoft=!0:xe.bSupHardOrSoft=!1,n.callbackFlag||(n.callbackFlag=!0,n.fn(xe),ie=!0))}))},document.body.appendChild(c)}else this.printfFlag>=0&&console.log("%c not support hard or soft","color:red"),new Promise((function(t,e){t()})).then((function(){n.callbackFlag||(n.callbackFlag=!0,n.fn(xe),ie=!0)}))}return e(a,[{key:"startWorker",value:function(t){function e(e,a){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){if(window.Worker){if(null==e.decodeWorker){if(e.decodeWorker=new l,null==e.decodeWorker)return 0;this.printfFlag>=0&&console.log("decodeWorker create success!")}e.canvasCnv=document.getElementById(t),e.offscreen=e.canvasCnv.transferControlToOffscreen(),e.decodeWorker.postMessage({command:"init",streamOpenMode:e.streamOpenMode,canvas:e.offscreen,sab:e.supportSab,renderEngine:e.renderEngine,printfLog:e.printfFlag},[e.offscreen]),0!=e.displayBuf&&e.decodeWorker.postMessage({command:"SetDisplayBuf",value:e.displayBuf}),""!=e.FECCanvasID&&e.decodeWorker.postMessage({command:"SetCanvasID",canvasID:e.FECCanvasID}),e.decodeWorker.onmessage=function(t){var a=t.data;switch(a.function){case"error":startWorker(e.canvasID,e);break;case"GetFrameData":var r=new Uint8Array(a.data);e.downloadRTPData(r);break;case"GetRawData":e.JSPlayM4_GetRawData();break;case"OrderError":console.log(">>>JS OrderError");break;case"GetPlayedTime":var i=a.value;e.getPlayTimeCallBackFun&&e.getPlayTimeCallBackFun(i-e.startTimeStamp);break;case"resetEnd":e.JSPlayM4_ResetEnd();break;case"bitmap":var n=a.value,s=a.type,x=a.sx,o=a.sy,f=a.sw,l=a.sh,_=a.framenum;e._GetImage(n,s,x,o,f,l,_);break;case"imageYUV":var h=new Uint8Array(a.value),c=a.size,u=new Uint8Array(h),d=a.type,p=a.width,m=a.height,S=a.yuvType,R=a.sx,P=a.sy,y=a.sw,b=a.sh;e._GetImage2(u,c,p,m,d,S,R,P,y,b),h=null,u=null,a.value=null;break;case"stop":e.decodeWorker=null,e.printfFlag>=0&&console.log("HardWorker is null");break;case"firstFrameCB":null!=e.FFCallBackFun&&e.FFCallBackFun({decodeEngine:1});break;case"SetPlayPosCB":var E={nRes:1};E.nRelativePos=a.value,null!=e.SetPlayPosCBFun&&e.SetPlayPosCBFun(E);break;case"SetFrameInfoCallBack":e.displayFrameInfo.port=a.curFrameInfo.port,e.displayFrameInfo.codecType=a.curFrameInfo.codecType,e.displayFrameInfo.frameType=a.curFrameInfo.frameType,e.displayFrameInfo.frameSize=a.curFrameInfo.frameSize,e.displayFrameInfo.width=a.curFrameInfo.width,e.displayFrameInfo.height=a.curFrameInfo.height,e.displayFrameInfo.timeStamp=a.curFrameInfo.timeStamp,e.displayFrameInfo.frameRate=a.curFrameInfo.frameRate,e.displayFrameInfo.frameNum=a.curFrameInfo.frameNum,e.displayFrameInfo.interlace=a.curFrameInfo.interlace,e.displayFrameInfo.streamEnd=a.curFrameInfo.streamEnd,e.displayFrameInfo.cropLeft=a.curFrameInfo.cropLeft,e.displayFrameInfo.cropRight=a.curFrameInfo.cropRight,e.displayFrameInfo.cropTop=a.curFrameInfo.cropTop,e.displayFrameInfo.cropBottom=a.curFrameInfo.cropBottom,e.displayFrameInfo.year=a.curFrameInfo.year,e.displayFrameInfo.month=a.curFrameInfo.month,e.displayFrameInfo.week=a.curFrameInfo.week,e.displayFrameInfo.day=a.curFrameInfo.day,e.displayFrameInfo.hour=a.curFrameInfo.hour,e.displayFrameInfo.minute=a.curFrameInfo.minute,e.displayFrameInfo.second=a.curFrameInfo.second,e.displayFrameInfo.milliseconds=a.curFrameInfo.milliseconds;break;case"FECGetViewParam":null!=e.FECViewParamCB&&e.FECViewParamCB(a.Param3D);break;case"GetPanoramaSphereViewParam":null!=e.GetPanoramaSphereViewParamCB&&e.GetPanoramaSphereViewParamCB(a.ParamVR);break;case"FECGetParam":null!=e.FECParamCB&&e.FECParamCB(a.param2d);break;case"FECGetPort":null!=e.FECGetPortCB&&e.FECGetPortCB(a.fishSubPort);break;case"FECGetPTZPort":null!=e.FECGetPTZPortCB&&e.FECGetPTZPortCB(a.fishSubPort);break;case"GetDecodeBufferSize":null!=a.rawSize&&null!=a.frameSize&&(e.decodeQueueSize=a.rawSize,e.decodeFrameSize=a.frameSize);break;case"GetCanvasCapture":if(0!=a.width&&0!=a.height){var g=new Uint8Array(a.frameData);e.imageCB(g,a.width,a.height)}break;case"FECCapture":if(0!=a.width&&0!=a.height){var F=new Uint8Array(a.frameData);e.FECImageCB(F,a.width,a.height,a.fishSubPort)}break;case"VideoRecoderInfo":var C=new Uint8Array(a.videoInfo.rawData),v=a.videoInfo;v.rawData=C,null!=e.recoderVideoDataCBFun&&e.recoderVideoDataCBFun(v),C=null;break;case"AudioRecoderInfo":var T=new Uint8Array(a.audioInfo.rawData),D=a.audioInfo;D.rawData=T,null!=e.recoderAudioDataCBFun&&e.recoderAudioDataCBFun(D),T=null;break;case"runtimeInfo":null!=e.runtimeCBFun&&e.runtimeCBFun(a.pstRuntimeInfo)}},e.decodeWorker.addEventListener("error",(function(t){console.error(t)}))}}))},{key:"JSPlayM4_GetDecodeBufferSize",value:function(t,e){return null!=t&&null!=e&&(this.decodeQueueSize=t,this.decodeFrameSize=e),1}},{key:"JSPlayM4_SetStreamEnd",value:function(t){if(1===this.decodeEngine)if(this.hasWebWorker){if(null==this.decodeWorker)return 0;this.decodeWorker.postMessage({command:"SetStreamEnd",bTrue:t})}else null!=this.pcVideoManager&&this.pcVideoManager.SetStreamEnd(t)}},{key:"JSPlayM4_GetPort",value:function(){return this.printfFlag>0&&console.log(">>>>>yff>>> JSPlayM4_GetPort 1 "),null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_GetPort","color: red"),0):(this.port=ae._JSPlayM4_GetPort(),ee[this.nUser][this.port]=this.oJSPlayerObj,this.printfFlag>0&&console.log(">>>>>yff>>> JSPlayM4_GetPort 2 this.port:"+this.port),1)}},{key:"JSPlayM4_SetStreamOpenMode",value:function(t){return this.printfFlag>0&&console.log(">>>>>yff>>>>> JSPlayM4_SetStreamOpenMode 1 mode:"+t),null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetStreamOpenMode","color: red"),0):(this.streamOpenMode=t,this.printfFlag>0&&console.log(">>>>>yff>>>>> JSPlayM4_SetStreamOpenMode 2  mode:"+t),null==this.pcVideoManager&&(this.pcVideoManager=new te(this)),ae._JSPlayM4_SetStreamOpenMode(this.port,t))}},{key:"JSPlayM4_OpenStream",value:function(t,e,a){if(this.printfFlag>0&&console.log(">>>>>yff>>>>> JSPlayM4_OpenStream 1 :"+t+",this.port:"+this.port),null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_OpenStream","color: red"),0;var r=ae._malloc(e);if(null===r)return console.log("hikHeadBuffer malloc failed"),0;var i=new Uint8Array(t.buffer);if(5==t[10]&&0==t[11]){if(this.codecType=5,!xe.bSupHardDecHEVC&&!this.supportSab)return console.info("%c3>The codecType is VIDEO_AVC265,not support SharedArrayBuffer","color: red"),w}else 1==t[10]&&0==t[11]?this.codecType=1:0==t[10]&&1==t[11]?this.codecType=256:4==t[10]&&0==t[11]?this.codecType=4:this.codecType=0;ae.writeArrayToMemory(i,r);var n=ae._JSPlayM4_OpenStream(this.port,r,e,a);return null!==r&&(ae._free(r),r=null),i=null,this.HIK40Head=new Uint8Array(t),this.HIKHeadSize=e,this.HIKPoolSize=a,this.OpenStreamMode=0,n}},{key:"JSPlayM4_OpenStreamAdvanced",value:function(t,e,a,r,i){if(this.printfFlag>0&&console.log(">>>>>yff>>>>> JSPlayM4_OpenStreamAdvanced 1 :"+r+",this.port:"+this.port),null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_OpenStreamAdvanced","color: red"),0;var n=this._stringToBytes(r),s=ae._malloc(a);if(null!==s){var x=ae.HEAPU8.subarray(s,s+a),o=new Uint8Array(a);x.set(o,0),x.set(new Uint8Array(n)),x=null,o=null;var f=ae._JSPlayM4_OpenStreamAdvanced(this.port,t,e,a,s,i);return null!==s&&(ae._free(s),s=null),this.SDPInfoData=r,this.SDPInfoLen=a,this.SDPInfoPoolSize=i,this.SDPInfoProtocolType=t,this.SDPInfoSessionInfoType=e,this.OpenStreamMode=1,f}}},{key:"JSPlayM4_SetDecodeEngine",value:function(t){return this.printfFlag>0&&console.log(">>>>>yff>>>>> JSPlayM4_SetDecodeEngine 1:"+t),0!=t&&1!=t?(console.log("0 is softDecode, 1 is hardDecoder,decodeEngine:"+t),0):0!==t||this.supportSab&&this.supportOffscreen?(this.decodeEngine=t,1):(this.jsplayer._switchV3ToV1(this.streamOpenMode,this.HIK40Head,this.HIKHeadSize,this.HIKPoolSize,!0),0)}},{key:"_switchHardToSoft",value:function(){return this.JSPlayM4_Stop(!0),this.JSPlayM4_CloseStream(),this.JSPlayM4_FreePort(),this.supportSab&&this.supportOffscreen?(this.JSPlayM4_SetDecodeEngine(0)&&(console.log("V3 switchHardToSoft this.szBasePath:"+this.szBasePath),this.JSPlayM4_GetPort(),this.JSPlayM4_SetStreamOpenMode(this.streamOpenMode),0==this.OpenStreamMode?this.JSPlayM4_OpenStream(this.HIK40Head,this.HIKHeadSize,this.HIKPoolSize):this.JSPlayM4_OpenStreamAdvanced(this.SDPInfoProtocolType,this.SDPInfoSessionInfoType,this.SDPInfoLen,this.SDPInfoData,this.SDPInfoPoolSize),this.JSPlayM4_Play(null,!0),null!=this.runtimeCBFun&&(this.pstRuntimeInfo.nRunTimeModule=2,this.pstRuntimeInfo.nStrVersion=1,this.pstRuntimeInfo.nFrameTimeStamp=0,this.pstRuntimeInfo.nFrameNum=0,this.pstRuntimeInfo.nErrorCode=3,this.pstRuntimeInfo.nInputDataInterval=0,this.pstRuntimeInfo.nFrameNumInterval=0,this.pstRuntimeInfo.nAverageDecodeTime=0,this.pstRuntimeInfo.nSystemFormat=this.sysType,this.runtimeCBFun(this.pstRuntimeInfo))),1):(this.jsplayer._switchV3ToV1(this.streamOpenMode,this.HIK40Head,this.HIKHeadSize,this.HIKPoolSize,!0),0)}},{key:"_HardToSoftNeedResetParam",value:function(){if(null!=this.FFCallBackFun&&ae._JSPlayM4_SetFirstFrameCallBack(this.port,this.FirstFrameCallBackflag,this.nUser),this.needSetSecretKey&&this.JSPlayM4_SetSecretKey(this.keyType,this.SecretKeyData,this.pKeyDataLen),null!=this.globalBaseTime&&this.globalBaseTime.month>0&&this.globalBaseTime.month<13&&this.JSPlayM4_SetGlobalBaseTime(this.globalBaseTime.year,this.globalBaseTime.month,this.globalBaseTime.day,this.globalBaseTime.hour,this.globalBaseTime.min,this.globalBaseTime.sec,this.globalBaseTime.ms),this.needSetSkipErrorData&&this.JSPlayM4_SkipErrorData(this.skipErrorData),this.needSetDemuxModel&&this.JSPlayM4_SetDemuxModel(this.setDemuxModelType,this.setDemuxModelFlag),this.needSetAdditionDataCB&&this.JSPlayM4_SetAdditionDataCallBack(this.additionDataType,this.additionFlag,this.addCBFun),this.JSPlayM4_SetDecodeFrameType(this.decodeFrameType),-1!=this.decInterval&&ae._JSPlayM4_SetIFrameDecInterval(this.port,nInterval),0!=this.decodeThreadNum&&ae._JSPlayM4_SetDecodeThreadNum(this.port,this.decodeThreadNum),0!=this.decodeERCLevel&&ae._JSPlayM4_SetDecodeERC(this.port,this.decodeERCLevel),-1!=this.resetBufferType&&ae._JSPlayM4_ResetBuffer(this.port,this.resetBufferType),this.needPlaySound&&this.JSPlayM4_PlaySound(),this.needPlaySoundShare&&this.JSPlayM4_PlaySoundShare(),-1!=this.setAudioThreadModel&&this.JSPlayM4_SetAudioThreadModel(this.setAudioThreadModel),-1!=this.syncToAudio&&this.JSPlayM4_SyncToAudio(this.syncToAudio),this.anrParamFlag&&-1!=this.anrParamLevel&&this.JSPlayM4_SetANRParam(this.anrParamFlag,this.anrParamLevel),this.resampleFlag&&this.JSPlayM4_SetResampleValue(this.resampleFlag,this.resampleRate),-1!=this.volumeValue&&this.JSPlayM4_SetVolume(this.volumeValue),this.needSetRunTimeInfoCB&&ae._JSPlayM4_SetRunTimeInfoCallBackEx(this.port,this.runTimeModule,this.nUser),this.needSetRunTimeInfoCBType){if(this.jsplayer.SourceTypeFlagMap.size>0){var t,e=T(this.jsplayer.SourceTypeFlagMap.keys());try{for(e.s();!(t=e.n()).done;){var a=t.value,r=this.jsplayer.SourceTypeFlagMap.get(a);1==r&&ae._JSPlayM4_SetRunTimeInfoCallbackType(this.port,0,a,r)}}catch(t){e.e(t)}finally{e.f()}}if(this.jsplayer.SplitterTypeFlagMap.size>0){var i,n=T(this.jsplayer.SplitterTypeFlagMap.keys());try{for(n.s();!(i=n.n()).done;){var s=i.value,x=this.jsplayer.SplitterTypeFlagMap.get(s);1==x&&ae._JSPlayM4_SetRunTimeInfoCallbackType(this.port,1,s,x)}}catch(t){n.e(t)}finally{n.f()}}if(this.jsplayer.DecodeTypeFlagMap.size>0){var o,f=T(this.jsplayer.DecodeTypeFlagMap.keys());try{for(f.s();!(o=f.n()).done;){var l=o.value,_=this.jsplayer.DecodeTypeFlagMap.get(l);1==_&&ae._JSPlayM4_SetRunTimeInfoCallbackType(this.port,2,l,_)}}catch(t){f.e(t)}finally{f.f()}}if(this.jsplayer.RenderTypeFlagMap.size>0){var h,c=T(this.jsplayer.RenderTypeFlagMap.keys());try{for(c.s();!(h=c.n()).done;){var u=h.value,d=this.jsplayer.RenderTypeFlagMap.get(u);1==d&&ae._JSPlayM4_SetRunTimeInfoCallbackType(this.port,3,u,d)}}catch(t){c.e(t)}finally{c.f()}}if(this.jsplayer.ManagerTypeFlagMap.size>0){var p,m=T(this.jsplayer.ManagerTypeFlagMap.keys());try{for(m.s();!(p=m.n()).done;){var S=p.value,R=this.jsplayer.ManagerTypeFlagMap.get(S);1==R&&ae._JSPlayM4_SetRunTimeInfoCallbackType(this.port,4,S,R)}}catch(t){m.e(t)}finally{m.f()}}}null!=this.streamInfoCBFun&&ae._JSPlayM4_SetStreamInfoCallBack(this.port,this.streamInfoType,this.nUser),null!=this.PostMpStreamOffsetCBFun&&ae._JSPlayM4_SetPostMpStreamOffsetCallBack(this.port,this.nUser),0!=this.playOrBackSwitchMode&&ae._JSPlayM4_SetPlayOrBackSwitchMode(this.port,this.playOrBackSwitchMode);var P,y=T(this.renderPrivateInfo.keys());try{for(y.s();!(P=y.n()).done;){var b=P.value,E=this.renderPrivateInfo.get(b);ae._JSPlayM4_RenderPrivateData(this.port,b,E)}}catch(t){y.e(t)}finally{y.f()}var g,F=T(this.renderIntelSubEx.keys());try{for(F.s();!(g=F.n()).done;){var C=g.value,v=this.renderIntelSubEx.get(C),D=this.renderIntelFlagEx.get(C);ae._JSPlayM4_RenderPrivateDataEx(this.port,C,v,D)}}catch(t){F.e(t)}finally{F.f()}return this.needSetDisplayBuf&&ae._JSPlayM4_SetDisplayBuf(this.port,this.displayBuf),-1!=this.antialiasFlag&&ae._JSPlayM4_SetAntialias(this.port,this.antialiasFlag),this.needSetD3DPostProcess&&ae._JSPlayM4_SetD3DPostProcess(this.port,this.d3dPostProcessType,this.d3dPostProcessValue),null!=this.pFontParam&&this.JSPlayM4_SetWaterMarkFont(this.pFontParam),null!=this.pMosaicParam&&this.JSPlayM4_SetMosaicType(this.pMosaicParam),0!=this.setStretchPlaySpeed&&ae._JSPlayM4_SetStretchPlay(this.port,this.setStretchPlayTime,this.setStretchPlaySpeed),-1!=this.autoSmoothPlayModel&&ae._JSPlayM4_SetAutoSmoothPlay(this.port,this.autoSmoothPlayModel),-1!=this.keepPlaySpeed&&ae._JSPlayM4_KeepPlaySpeed(this.port,this.keepPlaySpeed),this.printfFlag>0&&this.JSPlayM4_SetPrintLogFlag(this.printfFlag),this.needSetRotateAngle&&ae._JSPlayM4_SetRotateAngle(this.port,this.twodRotateAngle),""!=this.FECCanvasID&&this.JSPlayM4_FEC_SetCanvasID(this.FECCanvasID,!0),0!=this.FECPlaceType&&ae._JSPlayM4_FEC_ResetCorrectType(this.port,0,this.FECPlaceType,this.FECCorrectType),1}},{key:"JSPlayM4_DownloadRawData",value:function(){return this.downloadFlag=!0,1}},{key:"JSPlayM4_InputRawData",value:function(t,e,a){if(this.rawDataFrameInfoBuffer=a,this.rawDataFrameInfo.port=t,this.rawDataFrameInfo.codecType=ae.HEAP32[this.rawDataFrameInfoBuffer+4>>2],this.rawDataFrameInfo.frameType=ae.HEAP32[this.rawDataFrameInfoBuffer+12>>2],this.rawDataFrameInfo.frameSize=ae.HEAP32[this.rawDataFrameInfoBuffer+16>>2],this.rawDataFrameInfo.width=ae.HEAP32[this.rawDataFrameInfoBuffer+20>>2],this.rawDataFrameInfo.height=ae.HEAP32[this.rawDataFrameInfoBuffer+24>>2],this.rawDataFrameInfo.timeStamp=ae.HEAP32[this.rawDataFrameInfoBuffer+28>>2],this.rawDataFrameInfo.frameRate=ae.HEAP32[this.rawDataFrameInfoBuffer+32>>2],this.rawDataFrameInfo.frameNum=ae.HEAP32[this.rawDataFrameInfoBuffer+36>>2],this.rawDataFrameInfo.isKeyFrame=ae.HEAP32[this.rawDataFrameInfoBuffer+40>>2],this.rawDataFrameInfo.interlace=ae.HEAP32[this.rawDataFrameInfoBuffer+44>>2],this.rawDataFrameInfo.streamEnd=ae.HEAP32[this.rawDataFrameInfoBuffer+48>>2],this.rawDataFrameInfo.cropLeft=ae.HEAP32[this.rawDataFrameInfoBuffer+52>>2],this.rawDataFrameInfo.cropRight=ae.HEAP32[this.rawDataFrameInfoBuffer+56>>2],this.rawDataFrameInfo.cropTop=ae.HEAP32[this.rawDataFrameInfoBuffer+60>>2],this.rawDataFrameInfo.cropBottom=ae.HEAP32[this.rawDataFrameInfoBuffer+64>>2],this.rawDataFrameInfo.year=ae.HEAP16[this.rawDataFrameInfoBuffer+68>>1],this.rawDataFrameInfo.month=ae.HEAP16[this.rawDataFrameInfoBuffer+70>>1],this.rawDataFrameInfo.week=ae.HEAP16[this.rawDataFrameInfoBuffer+72>>1],this.rawDataFrameInfo.day=ae.HEAP16[this.rawDataFrameInfoBuffer+74>>1],this.rawDataFrameInfo.hour=ae.HEAP16[this.rawDataFrameInfoBuffer+76>>1],this.rawDataFrameInfo.minute=ae.HEAP16[this.rawDataFrameInfoBuffer+78>>1],this.rawDataFrameInfo.second=ae.HEAP16[this.rawDataFrameInfoBuffer+80>>1],this.rawDataFrameInfo.milliseconds=ae.HEAP16[this.rawDataFrameInfoBuffer+82>>1],this.sysType=ae.HEAP32[this.rawDataFrameInfoBuffer+84>>2],this.rawDataFrameInfo.needSetPreSoft=!1,(this.rawDataFrameInfo.frameRate<1||1==this.rawDataFrameInfo.interlace)&&(this.rawDataFrameInfo.needSetPreSoft=!0),0!=this.width&&0!=this.height||(this.width=this.rawDataFrameInfo.width,this.height=this.rawDataFrameInfo.height,this.startTimeStamp=this.rawDataFrameInfo.timeStamp,this.FirstFrame=!1),0==this.rawDataFrameInfo.cropLeft&&0==this.rawDataFrameInfo.cropRight&&0==this.rawDataFrameInfo.cropTop&&0==this.rawDataFrameInfo.cropBottom||(this.cropBottom=this.rawDataFrameInfo.cropBottom,this.cropLeft=this.rawDataFrameInfo.cropLeft,this.cropRight=this.rawDataFrameInfo.cropRight,this.cropTop=this.rawDataFrameInfo.cropTop),1==this.decodeFrameType){if(1!==this.rawDataFrameInfo.isKeyFrame)return 1;this.needWaitIFrame&&(this.hasWebWorker?this.decodeWorker.postMessage({command:"SetDecodeFrameType",timestamp:this.rawDataFrameInfo.timeStamp}):this.pcVideoManager.SetDecodeFrameType(this.rawDataFrameInfo.timeStamp),this.needWaitIFrame=!1)}if(0==this.decodeFrameType&&1==this.switchDecodeFrame){if(1!==this.rawDataFrameInfo.isKeyFrame)return 1;this.switchDecodeFrame=!1}var r=new Uint8Array(this.rawDataFrameInfo.frameSize);if(r.set(ae.HEAPU8.subarray(ae.HEAP32[this.rawDataFrameInfoBuffer>>2],ae.HEAP32[this.rawDataFrameInfoBuffer>>2]+this.rawDataFrameInfo.frameSize)),this.downloadFlag&&this.downloadRTPData(r),this.hasWebWorker){if(null===this.decodeWorker)return r=null,0;this.decodeWorker.postMessage({command:"inputData",rawData:r.buffer,rawDataFrameInfo:this.rawDataFrameInfo},[r.buffer])}else null!==this.pcVideoManager&&this.pcVideoManager.inputData(r,this.rawDataFrameInfo);r=null}},{key:"JSPlayM4_GetRawData",value:function(){if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_GetRawData","color: red"),0;ae._JSPlayM4_SetHardQueueSize(this.port,this.decodeQueueSize,this.decodeFrameSize),ae._JSPlayM4_GetRawData(this.port)}},{key:"JSPlayM4_ResetEnd",value:function(){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_ResetEnd","color: red"),0):ae._JSPlayM4_ResetEnd(this.port)}},{key:"JSPlayM4_NeedReset",value:function(t,e,a){return this.hasWebWorker?null!=ee[a][t].decodeWorker&&ee[a][t].decodeWorker.postMessage({command:"needReset",bTrue:!0}):this.pcVideoManager.needReset(!0),1}},{key:"JSPlayM4_SetAudioDisplayBuf",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetAudioDisplayBuf","color: red"),0):ae._JSPlayM4_SetAudioDisplayBuf(this.port,t)}},{key:"JSPlayM4_Play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.printfFlag>0&&console.log(">>>>>yff>>>>> JSPlayM4_Play 1 this.canvasID:"+this.canvasID+",this.supportSab:"+this.supportSab),null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_Play","color: red"),0;if(this.printfFlag>0&&console.log(">>>>>yff>>>>> JSPlayM4_Play 2:"+this.decodeEngine),6==this.curStatus){if(1==this.decodeEngine){if(this.hasWebWorker){if(null===this.decodeWorker)return 0;this.decodeWorker.postMessage({command:"NotifyBackPlay",flag:0})}else null!=this.pcVideoManager&&this.pcVideoManager.NotifyBackPlay(0);ae._JSPlayM4_ResetBuffer(this.port,1),this.needPlaySound&&ae._JSPlayM4_PlaySound(this.port),this.needPlaySoundShare&&ae._JSPlayM4_PlaySoundShare(this.port)}else ae._JSPlayM4_Play(this.port,this.canvasIDData);return this.curStatus=2,1}if(null!=t&&(this.canvasID=t,this.canvasWidth=document.getElementById(this.canvasID).width,this.canvasHeight=document.getElementById(this.canvasID).height),0===ne&&5===this.codecType?(this.decodeEngine=0,console.info("%c2>there will decode 265 by softDecoder","color: green")):0!==se||256!==this.codecType&&1!==this.codecType?4==this.codecType&&(this.decodeEngine=0,console.info("%c2>there will decode MJPEG by softDecoder(only V3-soft support MJPEG)","color: green")):(this.decodeEngine=0,console.info("%c2>there will decode 264 by softDecoder","color: green")),0==se&&0==ne&&(this.decodeEngine=0),!(this.supportSab&&this.supportOffscreen||0!==this.decodeEngine))return console.info("%c3>SharedArrayBuffer or Offscreen Error , does not support Soft Decdoe!!!!!","color: red"),this.jsplayer._switchV3ToV1(this.streamOpenMode,this.HIK40Head,this.HIKHeadSize,this.HIKPoolSize,!0),1;if(-1!=this.setHasThread&&(this.hasThread=this.setHasThread),ae._JSPlayM4_SetDecodeEngine(this.port,this.decodeEngine,this.hasThread),this.printfFlag>=0&&console.log("%cThe final decodeEngine is %d (0 is soft,1 is hard),codecType:%d","color: green",this.decodeEngine,this.codecType),0===this.decodeEngine&&e&&null!=this.canvasID){var a=document.getElementById(this.canvasID);a&&(this.clonedCanvas=a.cloneNode(!0),this.clonedCanvasParentNode=a.parentNode,this.clonedCanvasParentNode.replaceChild(this.clonedCanvas,a))}this.printfFlag>0&&console.log(">>>>>yff>>>>> JSPlayM4_Play 2 this.canvasID:"+this.canvasID+",this.supportSab:"+this.supportSab+",this.decodeEngine:"+this.decodeEngine);var r=1;if(1===this.decodeEngine){this.hasWebWorker?this.startWorker(this.canvasID,this):(this.canvasCnv=document.getElementById(this.canvasID),this.pcVideoManager.init(this.canvasCnv,this.streamOpenMode,this.supportSab,this.renderEngine),this.needSetDisplayBuf&&this.pcVideoManager.SetDisplayBuf(this.displayBuf)),ae._JSPlayM4_SetVideoRawDataCallBack(this.port,this.nUser);var i=ae.addFunction(this.JSPlayM4_NeedReset,"viii");ae._JSPlayM4_SetResetCallBack(this.port,i,this.nUser),ae._JSPlayM4_SetPrivateInfoCallBack(this.port,this.nUser),this.JSPlayM4_SetCanvasSize(this.canvasWidth,this.canvasHeight),1==(r=ae._JSPlayM4_Play(this.port,null))&&(this.curStatus=2)}else if(0===this.decodeEngine){if(""!=this.canvasID&&null!=this.canvasID){var n=this._stringToBytes("#"+this.canvasID),s=2*(this.canvasID.length+1);if(this.canvasIDData=ae._malloc(s),null===this.canvasIDData)return 0;var x=ae.HEAPU8.subarray(this.canvasIDData,this.canvasIDData+s),o=new Uint8Array(s);x.set(o,0),x.set(new Uint8Array(n)),x=null,o=null}this._HardToSoftNeedResetParam(),1==(r=ae._JSPlayM4_Play(this.port,this.canvasIDData))&&(this.curStatus=2)}if(this.JSPlayM4_SetFrameInfoCallBack(1),1===this.decodeEngine)if(this.hasWebWorker){if(null===this.decodeWorker)return 0;this.decodeWorker.postMessage({command:"SetPrintLogFlag",printfFlag:this.printfFlag})}else null!=this.pcVideoManager&&this.pcVideoManager.SetPrintLogFlag(this.printfFlag);return r}},{key:"JSPlayM4_InputData",value:function(t,e){if(this.inputDataBufferSize<e&&(null!==this.inputDataBuffer&&(ae._free(this.inputDataBuffer),this.inputDataBuffer=null),this.inputDataBufferSize=e),null===this.inputDataBuffer&&(this.inputDataBuffer=ae._malloc(this.inputDataBufferSize)),null===this.inputDataBuffer)return console.log("inputdata malloc failed!!!"),0;if(1==this.needResetCanvasSize&&(this.JSPlayM4_SetCanvasSize(this.canvasWidth,this.canvasHeight+1),this.needResetCanvasSize=!1),this.enableCanvas){var a=this.JSPlayM4_GetFrameInfo(),r=a.width,i=a.height;r&&i&&(this.JSPlayM4_SetCanvasSize(this.canvasWidth,this.canvasHeight-1),this.enableCanvas=!1,this.needResetCanvasSize=!0)}var n=new Uint8Array(t.buffer);ae.writeArrayToMemory(n,this.inputDataBuffer);var s=ae._JSPlayM4_InputData(this.port,this.inputDataBuffer,e,this.decodeQueueSize,this.decodeFrameSize);return this.printfFlag>0&&console.log(">>>>>yff>>>>> JSPlayM4_InputData 2 res:"+s+",inputSize:"+e),n=null,1!=s&&ae._JSPlayM4_GetLastError(this.port)==w&&this._switchHardToSoft(),s}},{key:"JSPlayM4_Stop",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_Stop","color: red"),0;if(this.JSPlayM4_StopEncode(),this.hasWebWorker?null!=this.decodeWorker&&this.decodeWorker.postMessage({command:"stop"}):null!=this.pcVideoManager&&this.pcVideoManager.stop(),this.bWriteData&&this.iFrameNum>0){console.log("download"+this.iFrameNum+"Psdata");var e=new Uint8Array(this.aTotalBuffer);this._downloadFile(e,"RTPRaw.data"),this.aTotalBuffer.splice(0,this.aTotalBuffer.length),this.bWriteData=!1,this.iFrameNum=0,e=null}var a=1;if((2==this.curStatus||5==this.curStatus||6==this.curStatus)&&(1==(a=ae._JSPlayM4_Stop(this.port))&&(this.curStatus=4),1==a&&t)){var r=document.getElementById(this.canvasID);if(r&&(this.clonedCanvas=r.cloneNode(!0),this.clonedCanvasParentNode=r.parentNode,this.clonedCanvasParentNode.replaceChild(this.clonedCanvas,r)),0!=this.FECcanvasIDArray.length)for(var i=0;i<this.FECcanvasIDArray.length;i++){var n=document.getElementById(this.FECcanvasIDArray[i]);n&&(this.clonedCanvas=n.cloneNode(!0),this.clonedCanvasParentNode=n.parentNode,this.clonedCanvasParentNode.replaceChild(this.clonedCanvas,n))}}return a}},{key:"JSPlayM4_CloseStream",value:function(){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_CloseStream","color: red"),0):null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_FreePort","color: red"),0):(null!==this.inputDataBuffer&&(ae._free(this.inputDataBuffer),this.inputDataBuffer=null),null!==this.additionDataBuffer&&(ae._free(this.additionDataBuffer),this.additionDataBuffer=null),null!==this.canvasIDData&&(ae._free(this.canvasIDData),this.canvasIDData=null,this.FirstFrame=!0),null!=this.pFECTotalCanvasIDData&&(ae._free(this.pFECTotalCanvasIDData),this.pFECTotalCanvasIDData=null),null!=this.pBmpData&&(ae._free(this.pBmpData),this.pBmpData=null),null!=this.pBmpSizeData&&(ae._free(this.pBmpSizeData),this.pBmpSizeData=null),null!=this.pJpegData&&(ae._free(this.pJpegData),this.pJpegData=null),null!=this.pJPEGSizeData&&(ae._free(this.pJPEGSizeData),this.pJPEGSizeData=null),null!==this.pWaterMarkFontData&&(ae._free(this.pWaterMarkFontData),this.pWaterMarkFontData=null),null!=this.textCanvas&&(this.textCanvas.remove(),this.textCanvas=null),this.bmpDataCallback=null,this.jpegDataCallback=null,this.CropjpegDataCallback=null,this.CropbmpDataCallback=null,this.aTotalBuffer.splice(0,this.aTotalBuffer.length),this.audioPCMBuffer.splice(0,this.audioPCMBuffer.length),this.width=0,this.height=0,this.curStatus=1,this.iZoomNum=0,this.decodeQueueSize=0,this.decodeFrameSize=0,this.rawDataFrameInfoBuffer=null,this.displayFrameInfo={},this.rawDataFrameInfo={},this.pcVideoManager=null,this.setTextCanvasFlag=!1,ae._JSPlayM4_CloseStream(this.port))}},{key:"JSPlayM4_FreePort",value:function(){return ae._JSPlayM4_FreePort(this.port)}},{key:"JSPlayM4_SetDecodeFrameType",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetDecodeFrameType","color: red"),0):(this.decodeFrameType=t,1===this.decodeEngine?(0==t&&1==this.decodeFrameType&&(this.switchDecodeFrame=!0),1==t&&(this.needWaitIFrame=!0),1):ae._JSPlayM4_SetDecodeFrameType(this.port,t))}},{key:"JSPlayM4_PlaySound",value:function(){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_PlaySound","color: red"),0):(this.needPlaySound=!0,ae._JSPlayM4_PlaySound(this.port))}},{key:"JSPlayM4_PlaySoundShare",value:function(){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_PlaySoundShare","color: red"),0):(this.needPlaySoundShare=!0,ae._JSPlayM4_PlaySoundShare(this.port))}},{key:"JSPlayM4_StopSoundShare",value:function(){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_StopSoundShare","color: red"),0):(this.needPlaySoundShare=!1,ae._JSPlayM4_StopSoundShare(this.port))}},{key:"resizedataURL",value:function(t,e,a){return new Promise((r=f(nt().mark((function r(i,n){var s;return nt().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:(s=document.createElement("img")).onload=function(){var t=document.createElement("canvas"),r=t.getContext("2d");t.width=e,t.height=a,r.drawImage(this,0,0,e,a);var n=t.toDataURL();i(n)},s.src=t;case 3:case"end":return r.stop()}}),r)}))),function(t,e){return r.apply(this,arguments)}));var r}},{key:"_GetImage",value:function(t,e,a,r,i,n,s){var x=this;if(1===this.decodeEngine&&t.width&&t.height){var o="image/"+e,f=document.createElement("canvas"),l=f.getContext("2d"),_=1,h=1;null!=this.HardDecToJpegCBFun&&1==this.HardToJpegZoomResolutionFlag?(_=this.HardToJpegZoomWidth>i?i:this.HardToJpegZoomWidth,h=this.HardToJpegZoomHeight>n?n:this.HardToJpegZoomHeight):(_=i,h=n),f.width=_,f.height=h,l.drawImage(t,a,r,i,n,0,0,_,h),0==this.jpegDownloadFlag&&0==this.bmpDownloadFlag&&null==this.jpegDataCallback&&null==this.bmpDataCallback&&null==this.HardDecToJpegCBFun||f.toBlob((function(a){if(x.jpegDataCallback||x.bmpDataCallback||x.HardDecToJpegCBFun){var r=new FileReader;r.onload=function(){if(null!=this.jpegDataCallback&&(this.jpegDataCallback(new Uint8Array(r.result),r.result.byteLength),this.jpegDataCallback=null),null!=this.bmpDataCallback&&(this.bmpDataCallback(new Uint8Array(r.result),r.result.byteLength),this.bmpDataCallback=null),null!=this.HardDecToJpegCBFun){var t={};t.jpegData=new Uint8Array(r.result),t.jpegDataSize=r.result.byteLength,t.frameNum=s,this.HardDecToJpegCBFun(t)}}.bind(x),r.readAsArrayBuffer(a)}if(x.jpegDownloadFlag||x.bmpDownloadFlag){var i=window.URL.createObjectURL(a),n=document.createElement("a");n.download=(new Date).getTime()+"."+e,n.href=i,n.dataset.downloadurl=[o,n.download,n.href].join(":"),document.body.appendChild(n),n.click(),document.body.removeChild(n),t.close(),l=null,x.jpegDownloadFlag&&(x.jpegDownloadFlag=!1),x.bmpDownloadFlag&&(x.bmpDownloadFlag=!1)}}),o,this.HardDecToJpegQuality)}}},{key:"_GetImage2",value:function(t,e,a,r,i,n,s,x,o,f){var l=this;setTimeout((function(){if(0!=a&&0!=r){var _=ae._malloc(e);if(null===_)return;ae.writeArrayToMemory(new Uint8Array(t,0,e),_);var h;h=704!=a||288!=r&&240!=r?a*r*4+60:a*r*8+60;var c=ae._malloc(h),u=ae._malloc(4);if(null===c||null===u)return ae._free(_),_=null,null!=c&&(ae._free(c),c=null),void(null!=u&&(ae._free(u),u=null));ae.setValue(u,h,"i32");var d=2;"nv12"===n?d=2:"I420"===n&&(d=3),"jpeg"==i?ae._JSPlayM4_VideoDataToJpeg(l.port,_,e,c,u,a,r,d,s,x,o,f):"bmp"==i&&ae._JSPlayM4_VideoDataToBMP(l.port,_,e,c,u,a,r,d,s,x,o,f);var p=ae.getValue(u,"i32"),m=new Uint8Array(p);m.set(ae.HEAPU8.subarray(c,c+p)),0==s&&0==x&&0==o&&0==f?"jpeg"==i?(null!=l.jpegDataCallback&&l.jpegDataCallback(m,p),l.jpegDownloadFlag&&l._downloadFile(m,"GetImage."+i),l.jpegDataCallback=null,l.jpegDownloadFlag=!1):"bmp"==i&&(null!=l.bmpDataCallback&&l.bmpDataCallback(m,p),l.bmpDownloadFlag&&l._downloadFile(m,"GetImage."+i),l.bmpDataCallback=null,l.bmpDownloadFlag=!1):"jpeg"==i?(null!=l.CropjpegDataCallback&&l.CropjpegDataCallback(m,p),l.CropjpegDownloadFlag&&l._downloadFile(m,"GetCropImage."+i),l.CropjpegDataCallback=null,l.CropjpegDownloadFlag=!1):"bmp"==i&&(null!=l.CropbmpDataCallback&&l.CropbmpDataCallback(m,p),l.CropbmpDownloadFlag&&l._downloadFile(m,"GetCropImage."+i),l.CropbmpDataCallback=null,l.CropbmpDownloadFlag=!1),m=null,null!=c&&(ae._free(c),c=null),null!=u&&(ae._free(u),u=null)}}),0)}},{key:"JSPlayM4_GetJPEG",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.jpegDataCallback=t,this.jpegDownloadFlag=e,1===this.decodeEngine)return this.hasWebWorker?this.decodeWorker.postMessage({command:"GetJPEG"}):null!=this.pcVideoManager&&this.pcVideoManager.GetJPEG(),1;if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_GetJPEG","color: red"),0;var a=ae._JSPlayM4_GetFrameInfo(this.port);if(this.width=ae.HEAP32[a+12>>2],this.height=ae.HEAP32[a+16>>2],0!=this.width&&0!=this.height){var r=this.width*this.height*4+60;if((null==this.pJpegData||this.nJPEGDataSize<r)&&(null!=this.pJpegData&&(ae._free(this.pJpegData),this.pJpegData=null),this.nJPEGDataSize=r,this.pJpegData=ae._malloc(this.nJPEGDataSize),null===this.pJpegData))return;null==this.pJPEGSizeData&&(this.pJPEGSizeData=ae._malloc(4));var i=ae._JSPlayM4_GetJPEG(this.port,this.pJpegData,this.nJPEGDataSize,this.pJPEGSizeData);if(1!=i){var n=ae._JSPlayM4_GetLastError(this.port);console.log("errorcode:"+n)}if(1==i){var s=ae.getValue(this.pJPEGSizeData,"i32"),x=new Uint8Array(s);x.set(ae.HEAPU8.subarray(this.pJpegData,this.pJpegData+s)),null!=t&&t(x,s),e&&this._downloadFile(x,"GetJPEG.jpeg"),x=null,this.jpegDataCallback=null,this.jpegDownloadFlag=!1}return i}return 0}},{key:"JSPlayM4_GetBMP",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.bmpDataCallback=t,this.bmpDownloadFlag=e,1===this.decodeEngine)return this.hasWebWorker?this.decodeWorker.postMessage({command:"GetBMP"}):null!=this.pcVideoManager&&this.pcVideoManager.GetBMP(),1;if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_GetBMP","color: red"),0;var a=ae._JSPlayM4_GetFrameInfo(this.port);if(this.width=ae.HEAP32[a+12>>2],this.height=ae.HEAP32[a+16>>2],0==this.width||0==this.height)return 0;var r;if(r=704!=this.width||288!=this.height&&240!=this.height?this.width*this.height*4+60:this.width*this.height*8+60,!(null==this.pBmpData||this.nBmpDataSize<r)||(null!=this.pBmpData&&(ae._free(this.pBmpData),this.pBmpData=null),this.nBmpDataSize=r,this.pBmpData=ae._malloc(this.nBmpDataSize),null!==this.pBmpData)){null==this.pBmpSizeData&&(this.pBmpSizeData=ae._malloc(4));var i=ae._JSPlayM4_GetBMP(this.port,this.pBmpData,this.nBmpDataSize,this.pBmpSizeData);if(1!=i){var n=ae._JSPlayM4_GetLastError(this.port);console.log("errorcode:"+n)}if(1==i){var s=ae.getValue(this.pBmpSizeData,"i32"),x=new Uint8Array(s);x.set(ae.HEAPU8.subarray(this.pBmpData,this.pBmpData+s)),null!=t&&t(x,s),e&&this._downloadFile(x,"GetBmp.bmp"),x=null,this.bmpDataCallback=null,this.bmpDownloadFlag=!1}return 1}}},{key:"JSPlayM4_GetCropJPEG",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.CropjpegDataCallback=t,this.CropjpegDownloadFlag=e,1===this.decodeEngine)return this.hasWebWorker?this.decodeWorker.postMessage({command:"GetCropJPEG"}):null!=this.pcVideoManager&&this.pcVideoManager.GetCropJPEG(),1;if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_GetCropJPEG","color: red"),0;var a=ae._JSPlayM4_GetFrameInfo(this.port);if(this.width=ae.HEAP32[a+12>>2],this.height=ae.HEAP32[a+16>>2],0!=this.width&&0!=this.height){var r=this.width*this.height*4+60,i=ae._malloc(r),n=ae._malloc(4),s=this.SetDisRegionBottom,x=this.SetDisRegionLeft,o=this.SetDisRegionRight,f=this.SetDisRegionTop;if(null===i)return;var l=ae._JSPlayM4_GetCropJPEG(this.port,i,r,n,0,0,x,f,o,s);if(1!=l){var _=ae._JSPlayM4_GetLastError(this.port);console.log("errorcode:"+_)}if(1==l){var h=ae.getValue(n,"i32"),c=new Uint8Array(h);c.set(ae.HEAPU8.subarray(i,i+h)),null!=t&&t(c,h),e&&this._downloadFile(c,"GetCropJPEG.jpeg"),c=null,this.CropjpegDataCallback=null,this.CropjpegDownloadFlag=!1}return null!=i&&(ae._free(i),i=null),null!=n&&(ae._free(n),n=null),l}return 0}},{key:"JSPlayM4_GetCropBMP",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.CropbmpDataCallback=t,this.CropbmpDownloadFlag=e,1===this.decodeEngine)return this.hasWebWorker?this.decodeWorker.postMessage({command:"GetCropBMP"}):null!=this.pcVideoManager&&this.pcVideoManager.GetCropBMP(),1;if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_GetCropBMP","color: red"),0;var a=ae._JSPlayM4_GetFrameInfo(this.port);if(this.width=ae.HEAP32[a+12>>2],this.height=ae.HEAP32[a+16>>2],0==this.width||0==this.height)return 0;var r=this.width*this.height*4+60,i=ae._malloc(r),n=ae._malloc(4),s=this.SetDisRegionBottom,x=this.SetDisRegionLeft,o=this.SetDisRegionRight,f=this.SetDisRegionTop;if(null!==i){var l=ae._JSPlayM4_GetCropBMP(this.port,i,r,n,0,0,x,f,o,s);if(1!=l){var _=ae._JSPlayM4_GetLastError(this.port);console.log("errorcode:"+_)}if(1==l){var h=ae.getValue(n,"i32"),c=new Uint8Array(h);c.set(ae.HEAPU8.subarray(i,i+h)),null!=t&&t(c,h),e&&this._downloadFile(c,"GetCropBmp.bmp"),c=null,this.CropbmpDataCallback=null,this.CropbmpDownloadFlag=!1}return null!=i&&(ae._free(i),i=null),null!=n&&(ae._free(n),n=null),1}}},{key:"JSPlayM4_GetCanvasCapture",value:function(t,e,a){if(this.imageCB=t,1===this.decodeEngine)return this.hasWebWorker?this.decodeWorker.postMessage({command:"GetCanvasCapture",capWidth:e,capHeight:a}):null!=this.pcVideoManager&&this.pcVideoManager.GetCanvasCapture(t,e,a),1;var r;return r=0==e||0==a?0:1,ae._JSPlayM4_GetD3DCapture(this.port,r,e,a),1}},{key:"JSPlayM4_StopSound",value:function(){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_StopSound","color: red"),0):(this.needPlaySound=!1,ae._JSPlayM4_StopSound())}},{key:"JSPlayM4_GetSDKVersion",value:function(){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_GetSDKVersion","color: red"),0):ae._JSPlayM4_GetSDKVersion()}},{key:"JSPlayM4_GetBuildDate",value:function(){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_GetBuildDate","color: red"),0):ae._JSPlayM4_GetBuildDate()}},{key:"JSPlayM4_GetLastError",value:function(){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_GetLastError","color: red"),0):ae._JSPlayM4_GetLastError(this.port)}},{key:"JSPlayM4_Fast",value:function(){if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_Fast","color: red"),0;if(0===this.streamOpenMode)return 1;if(1===this.decodeEngine)if(this.hasWebWorker){if(null===this.decodeWorker)return 0;this.decodeWorker.postMessage({command:"fast"})}else null!=this.pcVideoManager&&this.pcVideoManager.fast();var t=ae._JSPlayM4_Fast(this.port);return 1==t&&(this.playSpeed=2*this.playSpeed),t}},{key:"JSPlayM4_Slow",value:function(){if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_Slow","color: red"),0;if(0===this.streamOpenMode)return 1;if(1===this.decodeEngine)if(this.hasWebWorker){if(null===this.decodeWorker)return 0;this.decodeWorker.postMessage({command:"slow"})}else null!=this.pcVideoManager&&this.pcVideoManager.slow();var t=ae._JSPlayM4_Slow(this.port);return 1==t&&(this.playSpeed=this.playSpeed/2),console.log("this.playSpeed:"+this.playSpeed),t}},{key:"JSPlayM4_SetIFrameDecInterval",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetIFrameDecInterval","color: red"),0):1===this.decodeEngine?1:(this.decInterval=t,ae._JSPlayM4_SetIFrameDecInterval(this.port,t))}},{key:"JSPlayM4_Pause",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_Pause","color: red"),0):0===this.streamOpenMode?1:(1===this.decodeEngine&&(this.hasWebWorker?this.decodeWorker.postMessage({command:"Pause",value:t}):null!=this.pcVideoManager&&this.pcVideoManager.Pause(t)),ae._JSPlayM4_Pause(this.port,t))}},{key:"JSPlayM4_OneByOne",value:function(){if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_OneByOne","color: red"),0;if(0===this.streamOpenMode)return 0;xe.cmd="onebyone";var t=ae._JSPlayM4_GetSourceBufferRemain(this.port),e=ae._JSPlayM4_GetLastError(this.port);return t<1e3||31==e?(xe.errorCode=31,xe.status=!0,this.fn(xe)):(t>this.HIKPoolSize-1e3||11==e)&&(xe.errorCode=0,xe.status=!1,this.fn(xe)),2!=this.curStatus&&6!=this.curStatus||(this.lastStatus=this.curStatus),this.curStatus=5,1===this.decodeEngine&&(this.hasWebWorker?this.decodeWorker.postMessage({command:"OneByOne",value:1}):null!=this.pcVideoManager&&this.pcVideoManager.OneByOne(1)),ae._JSPlayM4_OneByOne(this.port,this.decodeQueueSize,this.decodeFrameSize)}},{key:"JSPlayM4_OneByOneResume",value:function(){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_OneByOneResume","color: red"),0):(xe.cmd="play",0===this.streamOpenMode?1:(2===this.lastStatus?this.curStatus=2:6===this.lastStatus&&(this.curStatus=6),1===this.decodeEngine&&(this.hasWebWorker?this.decodeWorker.postMessage({command:"OneByOne",value:0}):null!=this.pcVideoManager&&this.pcVideoManager.OneByOne(0)),ae._JSPlayM4_Play(this.port,this.canvasIDData)))}},{key:"JSPlayM4_SetVolume",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetVolume","color: red"),0):(this.volumeValue=t,ae._JSPlayM4_SetVolume(this.port,t))}},{key:"JSPlayM4_GetVolume",value:function(){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_GetVolume","color: red"),0):ae._JSPlayM4_GetVolume(this.port)}},{key:"JSPlayM4_SetDisplayRegion",value:function(t,e,a,r,i){var n=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetDisplayRegion","color: red"),0;var x=1,o=e,f=r,l=a,_=i;if(n?(o=0,l=this.canvasWidth,f=0,_=this.canvasHeight,this.iZoomNum=0,this.iRatio_x=1,this.iRatio_y=1):s&&0!==this.iZoomNum&&(o=Math.round(o/this.iRatio_x)+this.stDisplayRect.left,f=Math.round(f/this.iRatio_y)+this.stDisplayRect.top,l=Math.round(l/this.iRatio_x)+this.stDisplayRect.left,_=Math.round(_/this.iRatio_y)+this.stDisplayRect.top),this.stDisplayRect={top:f,left:o,right:l,bottom:_},1===this.decodeEngine)if(this.SetDisRegionBottom=_/this.canvasHeight*this.height,this.SetDisRegionLeft=o/this.canvasWidth*this.width,this.SetDisRegionRight=l/this.canvasWidth*this.width,this.SetDisRegionTop=f/this.canvasHeight*this.height,this.hasWebWorker){if(null===this.decodeWorker)return 0;this.decodeWorker.postMessage({command:"SetDisplayRegion",sx:this.SetDisRegionLeft,sy:this.SetDisRegionTop,sw:this.SetDisRegionRight-this.SetDisRegionLeft,sh:this.SetDisRegionBottom-this.SetDisRegionTop})}else null!=this.pcVideoManager&&this.pcVideoManager.SetDisplayRegion(this.SetDisRegionLeft,this.SetDisRegionTop,this.SetDisRegionRight-this.SetDisRegionLeft,this.SetDisRegionBottom-this.SetDisRegionTop);else{var h=ae._JSPlayM4_GetFrameInfo(this.port);this.width=ae.HEAP32[h+12>>2],this.height=ae.HEAP32[h+16>>2],this.SetDisRegionBottom=_/this.canvasHeight*this.height,this.SetDisRegionLeft=o/this.canvasWidth*this.width,this.SetDisRegionRight=l/this.canvasWidth*this.width,this.SetDisRegionTop=f/this.canvasHeight*this.height,x=ae._JSPlayM4_SetDisplayRegion(this.port,this.canvasID,this.SetDisRegionLeft,this.SetDisRegionRight,this.SetDisRegionTop,this.SetDisRegionBottom)}return s&&(this.iRatio_x=this.canvasWidth/(l-o),this.iRatio_y=this.canvasHeight/(_-f),this.iZoomNum++),x}},{key:"JSPlayM4_SetPrintLogFlag",value:function(t){if(this.printfFlag=Number(t),null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetPrintLogFlag","color: red"),0;if(1===this.decodeEngine)if(this.hasWebWorker){if(null===this.decodeWorker)return 0;this.decodeWorker.postMessage({command:"SetPrintLogFlag",printfFlag:this.printfFlag})}else null!=this.pcVideoManager&&this.pcVideoManager.SetPrintLogFlag(this.printfFlag);return ae._JSPlayM4_SetPrintLogFlag(this.port,t)}},{key:"JSPlayM4_RenderPrivateData",value:function(t,e){var a=1;if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_RenderPrivateData","color: red"),0;if(this.renderPrivateInfo.set(t,e),1===this.decodeEngine){if(this.hasWebWorker){if(null===this.decodeWorker)return 0;this.decodeWorker.postMessage({command:"RenderPrivateData",intelType:t,bTrue:e})}else null!=this.pcVideoManager&&(a=this.pcVideoManager.RenderPrivateData(t,e));e&&(a=ae._JSPlayM4_RenderPrivateData(this.port,t,e))}else a=ae._JSPlayM4_RenderPrivateData(this.port,t,e);return a}},{key:"JSPlayM4_RenderPrivateDataEx",value:function(t,e,a){if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_RenderPrivateDataEx","color: red"),0;if(this.renderIntelSubEx.set(t,e),this.renderIntelFlagEx.set(t,a),1===this.decodeEngine)if(this.hasWebWorker){if(null===this.decodeWorker)return 0;this.decodeWorker.postMessage({command:"RenderPrivateDataEx",intelType:t,subType:e,bTrue:a})}else null!=this.pcVideoManager&&this.pcVideoManager.RenderPrivateDataEx(t,e,a);return ae._JSPlayM4_RenderPrivateDataEx(this.port,t,e,a)}},{key:"JSPlayM4_SetCanvasSize",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetCanvasSize","color: red"),0;if(t<16||e<16||null===this.canvasID)return 0;if(this.canvasWidth=t,this.canvasHeight=e,1===this.decodeEngine)if(this.hasWebWorker){if(null==this.decodeWorker)return 0;this.decodeWorker.postMessage({command:"SetCanvasSize",width:t,height:e,FECSubPort:a})}else null!=this.pcVideoManager&&this.pcVideoManager.SetCanvasSize(t,e,a);return ae._JSPlayM4_SetCanvasSize(this.port,t,e,a)}},{key:"JSPlayM4_SetDisplayBuf",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetDisplayBuf","color: red"),0):(this.displayBuf=t,this.needSetDisplayBuf=!0,1===this.decodeEngine&&(this.hasWebWorker?null===this.decodeWorker||this.decodeWorker.postMessage({command:"SetDisplayBuf",value:t}):null!=this.pcVideoManager&&this.pcVideoManager.SetDisplayBuf(t)),ae._JSPlayM4_SetDisplayBuf(this.port,t))}},{key:"JSPlayM4_GetSourceBufferRemain",value:function(){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_GetSourceBufferRemain","color: red"),0):ae._JSPlayM4_GetSourceBufferRemain(this.port)}},{key:"JSPlayM4_GetBufferValue",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_GetBufferValue","color: red"),0):ae._JSPlayM4_GetBufferValue(this.port,t)}},{key:"JSPlayM4_ReversePlay",value:function(){if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_ReversePlay","color: red"),0;if(0===this.streamOpenMode)return 1;if(this.reversePlay=!0,1===this.decodeEngine){if(6==this.curStatus)return 1;if(this.hasWebWorker){if(null===this.decodeWorker)return 0;this.decodeWorker.postMessage({command:"NotifyBackPlay",flag:1})}else null!=this.pcVideoManager&&this.pcVideoManager.NotifyBackPlay(1);return ae._JSPlayM4_ResetBuffer(this.port,1),this.needPlaySound&&ae._JSPlayM4_StopSound(),this.needPlaySoundShare&&ae._JSPlayM4_StopSoundShare(this.port),this.curStatus=6,1}var t=ae._JSPlayM4_ReversePlay(this.port);return 1==t&&(this.curStatus=6),t}},{key:"JSPlayM4_SetDecodeThreadNum",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetDecodeThreadNum","color: red"),0):(this.decodeThreadNum=t,ae._JSPlayM4_SetDecodeThreadNum(this.port,t))}},{key:"JSPlayM4_GetCanvasSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_GetCanvasSize","color: red"),0):1===this.decodeEngine?(this.hasWebWorker?this.decodeWorker.postMessage({command:"GetCanvasSize"}):null!=this.pcVideoManager&&this.pcVideoManager.GetCanvasSize(),1):ae._JSPlayM4_GetCanvasSize(this.port,t)}},{key:"JSPlayM4_DisplayLostFrames",value:function(t,e,a){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_DisplayLostFrames","color: red"),0):ae._JSPlayM4_DisplayLostFrames(this.port,t,e,a)}},{key:"JSPlayM4_SetIVSContraBandDrawMode",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetIVSContraBandDrawMode","color: red"),0):ae._JSPlayM4_SetIVSContraBandDrawMode(this.port,t)}},{key:"JSPlayM4_SetANRParam",value:function(t,e){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetANRParam","color: red"),0):(this.anrParamFlag=t,this.anrParamLevel=e,ae._JSPlayM4_SetANRParam(this.port,t,e))}},{key:"JSPlayM4_SetResampleValue",value:function(t,e){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetResampleValue","color: red"),0):(this.resampleFlag=t,this.resampleRate=e,ae._JSPlayM4_SetResampleValue(this.port,t,e))}},{key:"JSPlayM4_SetAntialias",value:function(t){if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetAntialias","color: red"),0;var e=1;return this.antialiasFlag=t,1===this.decodeEngine?this.hasWebWorker?null!=this.decodeWorker&&this.decodeWorker.postMessage({command:"SetAntialias",value:t}):null!=this.pcVideoManager&&(e=this.pcVideoManager.SetAntialias(t)):e=ae._JSPlayM4_SetAntialias(this.port,t),e}},{key:"JSPlayM4_SyncToAudio",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SyncToAudio","color: red"),0):(this.syncToAudio=SyncToAudio,ae._JSPlayM4_SyncToAudio(this.port,t))}},{key:"JSPlayM4_SetAudioThreadModel",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetAudioThreadModel","color: red"),0):(this.setAudioThreadModel=t,ae._JSPlayM4_SetAudioThreadModel(this.port,t))}},{key:"JSPlayM4_SetDecodeERC",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetDecodeERC","color: red"),0):(this.decodeERCLevel=t,ae._JSPlayM4_SetDecodeERC(this.port,t))}},{key:"JSPlayM4_SkipErrorData",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SkipErrorData","color: red"),0):(this.needSetSkipErrorData=!0,this.skipErrorData=t,ae._JSPlayM4_SkipErrorData(this.port,t))}},{key:"JSPlayM4_SetDemuxModel",value:function(t,e){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetDemuxModel","color: red"),0):(this.needSetDemuxModel=!0,this.setDemuxModelType=t,this.setDemuxModelFlag=e,ae._JSPlayM4_SetDemuxModel(this.port,t,e))}},{key:"JSPlayM4_SetD3DPostProcess",value:function(t,e){if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetD3DPostProcess","color: red"),0;var a=1;return this.d3dPostProcessType=t,this.d3dPostProcessValue=e,this.needSetD3DPostProcess=!0,1===this.decodeEngine?this.hasWebWorker?null!=this.decodeWorker&&this.decodeWorker.postMessage({command:"SetD3DPostProcess",ProcessType:t,ProcessValue:e}):null!=this.pcVideoManager&&(a=this.pcVideoManager.SetD3DPostProcess(t,e)):a=ae._JSPlayM4_SetD3DPostProcess(this.port,t,e),a}},{key:"JSPlayM4_SetFirstFrameCallBack",value:function(t,e){if(!(e&&"function"==typeof e||null===e))return 0;if(this.FFCallBackFun=e,this.FirstFrameCallBackflag=t,null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetFirstFrameCallBack","color: red"),0;var a=1;return 0===this.decodeEngine&&(a=ae._JSPlayM4_SetFirstFrameCallBack(this.port,t,this.nUser)),a}},{key:"JSPlayM4_SetDecCallBack",value:function(t,e){return e&&"function"==typeof e||null===e?(this.decCallBackFun=e,null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetDecCallBack","color: red"),0):ae._JSPlayM4_SetDecCallBack(this.port,t,this.nUser)):0}},{key:"JSPlayM4_SetHardDecToJepgCallBack",value:function(t,e){return e&&"function"==typeof e||null===e?(this.HardDecToJpegQuality=t.nHardToJpegQuality,this.HardDecToJpegInterval=t.nHardToJpegInterval,this.HardToJpegZoomWidth=t.nHardToJpegZoomWidth,this.HardToJpegZoomHeight=t.nHardToJpegZoomHeight,this.HardToJpegZoomResolutionFlag=t.nZoomResolutionFlag,this.HardDecToJpegCBFun=e,1):0}},{key:"JSPlayM4_SetDisplayCallBack",value:function(t,e){return e&&"function"==typeof e||null===e?(this.displayCallBackFun=e,null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetDisplayCallBack","color: red"),0):(this.JSPlayM4_SetDecCBStream(1),ae._JSPlayM4_SetDisplayCallBack(this.port,t,this.nUser))):0}},{key:"JSPlayM4_SetFrameInfoCallBack",value:function(t){var e=this,a=1;if(1===this.decodeEngine)this.hasWebWorker?null!=this.decodeWorker&&this.decodeWorker.postMessage({command:"SetFrameInfoCallBack",value:t}):null!=this.pcVideoManager&&(a=this.pcVideoManager.SetFrameInfoCallBack((function(t){e.displayFrameInfo.port=t.port,e.displayFrameInfo.codecType=t.codecType,e.displayFrameInfo.frameType=t.frameType,e.displayFrameInfo.frameSize=t.frameSize,e.displayFrameInfo.width=t.width,e.displayFrameInfo.height=t.height,e.displayFrameInfo.timeStamp=t.timeStamp,e.displayFrameInfo.frameRate=t.frameRate,e.displayFrameInfo.frameNum=t.frameNum,e.displayFrameInfo.interlace=t.interlace,e.displayFrameInfo.streamEnd=t.streamEnd,e.displayFrameInfo.cropLeft=t.cropLeft,e.displayFrameInfo.cropRight=t.cropRight,e.displayFrameInfo.cropTop=t.cropTop,e.displayFrameInfo.cropBottom=t.cropBottom,e.displayFrameInfo.year=t.year,e.displayFrameInfo.month=t.month,e.displayFrameInfo.week=t.week,e.displayFrameInfo.day=t.day,e.displayFrameInfo.hour=t.hour,e.displayFrameInfo.minute=t.minute,e.displayFrameInfo.second=t.second,e.displayFrameInfo.milliseconds=t.milliseconds}),t));else{if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetFrameInfoCallBack","color: red"),0;a=ae._JSPlayM4_SetFrameInfoCallBack(this.port,t)}return a}},{key:"JSPlayM4_SetDecCBStream",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetDecCBStream","color: red"),0):ae._JSPlayM4_SetDecCBStream(this.port,t)}},{key:"JSPlayM4_GetFrameInfo",value:function(){if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_GetFrameInfo","color: red"),0;var t={};if(0==this.decodeEngine){var e=ae._JSPlayM4_GetFrameInfo(this.port);t.port=ae.HEAP32[e>>2],t.frameType=ae.HEAP32[e+4>>2],t.frameSize=ae.HEAP32[e+8>>2],t.width=ae.HEAP32[e+12>>2],t.height=ae.HEAP32[e+16>>2],t.timeStamp=ae.HEAP32[e+20>>2],t.frameRate=ae.HEAP32[e+24>>2],t.bitPerSample=ae.HEAP32[e+28>>2],t.samplesPerSec=ae.HEAP32[e+32>>2],t.channel=ae.HEAP32[e+36>>2],t.frameNum=ae.HEAP32[e+40>>2],t.cropLeft=ae.HEAP32[e+44>>2],t.cropRight=ae.HEAP32[e+48>>2],t.cropTop=ae.HEAP32[e+52>>2],t.cropBottom=ae.HEAP32[e+56>>2],t.year=ae.HEAP16[e+60>>1],t.month=ae.HEAP16[e+62>>1],t.week=ae.HEAP16[e+64>>1],t.day=ae.HEAP16[e+66>>1],t.hour=ae.HEAP16[e+68>>1],t.minute=ae.HEAP16[e+70>>1],t.second=ae.HEAP16[e+72>>1],t.milliseconds=ae.HEAP16[e+74>>1],this.width=t.width,this.height=t.height}else t=this.displayFrameInfo;return t}},{key:"JSPlayM4_GetAdditionData",value:function(){if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_GetAdditionData","color: red"),0;var t=null,e=ae._JSPlayM4_GetAdditionData(this.port);return t.dataType=ae.HEAP32[e>>2],t.dataStrVersion=ae.HEAP32[e+4>>2],t.dataTimeStamp=ae.HEAP32[e+8>>2],t.dataLength=ae.HEAP32[e+12>>2],t.pData=ae.HEAP32[e+16>>2],t.additionDataBuffer=new Uint8Array(dataLength),additionDataBuffer.set(ae.HEAPU8.subarray(pData,pData+dataLength)),t}},{key:"JSPlayM4_SetAdditionDataCallBack",value:function(t,e,a){return this.additionDataType=t,this.additionFlag=e,this.addCBFun=a,this.needSetAdditionDataCB=!0,null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetAdditionDataCallBack","color: red"),0):a&&"function"==typeof a||null===a?(this.addtionCallBackFun=a,ae._JSPlayM4_SetAdditionDataCallBack(this.port,t,e,this.nUser)):0}},{key:"JSPlayM4_GetPlayedTimeEx",value:function(t){if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_GetPlayedTimeEx","color: red"),0;if(!(t&&"function"==typeof t||null===t))return 0;if(this.getPlayTimeCallBackFun=t,1===this.decodeEngine){if(this.hasWebWorker)this.decodeWorker.postMessage({command:"GetPlayedTime"});else if(null!=this.pcVideoManager){var e=this.pcVideoManager.GetPlayedTime();this.getPlayTimeCallBackFun&&this.getPlayTimeCallBackFun(e-this.startTimeStamp)}}else{var a=ae._JSPlayM4_GetPlayedTimeEx(this.port);this.getPlayTimeCallBackFun(a)}}},{key:"JSPlayM4_GetFileTime",value:function(){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_GetFileTime","color: red"),0):ae._JSPlayM4_GetFileTime(this.port)}},{key:"JSPlayM4_GetMpOffset",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_GetMpOffset","color: red"),0;if(!(r&&"function"==typeof r||null===r))return 0;if((this.SetPlayPosCBFun=r,0==e)&&t>1e3*this.JSPlayM4_GetFileTime())return-1;1===this.decodeEngine&&(this.hasWebWorker?(this.decodeWorker.postMessage({command:"needReset",bTrue:!1}),this.decodeWorker.postMessage({command:"SetTargetRelativePos",nRelativePos:t,nPosType:e,nPlayMode:a})):null!=this.pcVideoManager&&(this.pcVideoManager.needReset(!1),this.pcVideoManager.SetTargetRelativePos(t,e,a)));var i=0;return null!=r&&(i=1),ae._JSPlayM4_GetMpOffset(this.port,t,e,a,i,this.nUser)}},{key:"JSPlayM4_ResetBuffer",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_ResetBuffer","color: red"),0):(this.resetBufferType=t,1!==this.decodeEngine||1!=t&&3!=t&&7!=t&&8!=t||(this.hasWebWorker?this.decodeWorker.postMessage({command:"ResetBuffer"}):null!=this.pcVideoManager&&this.pcVideoManager.ResetBuffer()),ae._JSPlayM4_ResetBuffer(this.port,t))}},{key:"JSPlayM4_SetGlobalBaseTime",value:function(t,e,a,r,i,n,s){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetGlobalBaseTime","color: red"),0):(this.globalBaseTime={year:t,month:e,day:a,hour:r,min:i,sec:n,ms:s},ae._JSPlayM4_SetGlobalBaseTime(this.port,t,e,a,r,i,n,s))}},{key:"JSPlayM4_SetSecretKey",value:function(t,e,a){if(this.needSetSecretKey=!0,this.SecretKeyData=e,this.keyType=t,this.pKeyDataLen=a,null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetSecretKey","color: red"),0;this.printfFlag>0&&console.log(">>>>>yff>>> JSPlayM4_SetSecretKey keyType:"+t+",keyData:"+e+",this.port:"+this.port);var r=1;if(null==e||void 0===e||""===e)return 0;if(null!=e){var i=this._stringToBytes(e),n=ae._malloc(a);if(null===n)return;var s=ae.HEAPU8.subarray(n,n+a),x=new Uint8Array(a);s.set(x,0),s.set(new Uint8Array(i)),s=null,x=null,r=ae._JSPlayM4_SetSecretKey(this.port,t,n,a),null!==n&&(ae._free(n),n=null)}return r}},{key:"JSPlayM4_SetRunTimeInfoCallBackEx",value:function(t,e){return e&&"function"==typeof e||null===e?(this.runtimeCBFun=e,this.runTimeModule=t,this.needSetRunTimeInfoCB=!0,null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetRunTimeInfoCallBackEx","color: red"),0):(1===this.decodeEngine&&(this.hasWebWorker?this.decodeWorker.postMessage({command:"SetRunTimeInfoCallBack",module:t}):null!=this.pcVideoManager&&this.pcVideoManager.SetRunTimeInfoCallBack(t,e)),ae._JSPlayM4_SetRunTimeInfoCallBackEx(this.port,t,this.nUser))):0}},{key:"JSPlayM4_SetRunTimeInfoCallbackType",value:function(t,e,a){return this.needSetRunTimeInfoCBType=!0,null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetRunTimeInfoCallbackType","color: red"),0):(1===this.decodeEngine&&(this.hasWebWorker?this.decodeWorker.postMessage({command:"SetRunTimeInfoCallbackType",module:t,type:e,flag:a}):null!=this.pcVideoManager&&this.pcVideoManager.SetRunTimeInfoCallbackType(t,e,a)),ae._JSPlayM4_SetRunTimeInfoCallbackType(this.port,t,e,a))}},{key:"JSPlayM4_SetStreamInfoCallBack",value:function(t,e){return e&&"function"==typeof e||null===e?(this.streamInfoCBFun=e,this.streamInfoType=t,null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetStreamInfoCallBack","color: red"),0):ae._JSPlayM4_SetStreamInfoCallBack(this.port,t,this.nUser)):0}},{key:"JSPlayM4_SetPostMpStreamOffsetCallBack",value:function(t){return this.PostMpStreamOffsetCBFun=t,null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetPostMpStreamOffsetCallBack","color: red"),0):ae._JSPlayM4_SetPostMpStreamOffsetCallBack(this.port,this.nUser)}},{key:"JSPlayM4_SetPlayOrBackSwitchMode",value:function(t){if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetPlayOrBackSwitchMode","color: red"),0;if(this.playOrBackSwitchMode=t,0==this.decodeEngine)return ae._JSPlayM4_SetPlayOrBackSwitchMode(this.port,t);if(this.hasWebWorker){if(null===this.decodeWorker)return 0;this.decodeWorker.postMessage({command:"SetPlayOrBackSwitchMode",PlayOrBackMode:t})}else{if(null==this.pcVideoManager)return 0;this.pcVideoManager.SetPlayOrBackSwitchMode(t)}return 1}},{key:"JSPlayM4_SetStretchPlay",value:function(t,e){if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetStretchPlay","color: red"),0;if(e<1||e>16)return 0;if(this.setStretchPlayTime=t,this.setStretchPlaySpeed=e,1==this.decodeEngine)if(this.hasWebWorker){if(null===this.decodeWorker)return 0;this.decodeWorker.postMessage({command:"SetStretchPlay",Stretchtime:t,Stretchspeed:e})}else null!=this.pcVideoManager&&this.pcVideoManager.SetStretchPlay(t,e);return ae._JSPlayM4_SetStretchPlay(this.port,t,e)}},{key:"JSPlayM4_SetAutoSmoothPlay",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetAutoSmoothPlay","color: red"),0):(this.autoSmoothPlayModel=t,0==this.decodeEngine?ae._JSPlayM4_SetAutoSmoothPlay(this.port,t):0)}},{key:"JSPlayM4_KeepPlaySpeed",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_KeepPlaySpeed","color: red"),0):(this.keepPlaySpeed=t,0==this.decodeEngine?ae._JSPlayM4_KeepPlaySpeed(this.port,t):0)}},{key:"JSPlayM4_IgnoreHeaderAudioDefine",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_IgnoreHeaderAudioDefine","color: red"),0):ae._JSPlayM4_IgnoreHeaderAudioDefine(this.port,t)}},{key:"JSPlayM4_SetSycGroup",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetSycGroup","color: red"),0):ae._JSPlayM4_SetSycGroup(this.port,t)}},{key:"JSPlayM4_SetRotateAngle",value:function(t){if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetRotateAngle","color: red"),0;var e=1;return this.twodRotateAngle=t,this.needSetRotateAngle=!0,1===this.decodeEngine?this.hasWebWorker?null!=this.decodeWorker&&this.decodeWorker.postMessage({command:"SetRotateAngle",rotateValue:t}):null!=this.pcVideoManager&&(e=this.pcVideoManager.SetRotateAngle(t)):e=ae._JSPlayM4_SetRotateAngle(this.port,t),e}},{key:"JSPlayM4_SetPanoramaDisplayEffect",value:function(t){var e=1;return 1!==this.decodeEngine?(console.info("%c softDecode not support JSPlayM4_SetPanoramaDisplayEffect","color: red"),0):(this.hasWebWorker?null!=this.decodeWorker?this.decodeWorker.postMessage({command:"SetPanoramaDisplayEffect",DisplayEffect:t}):e=0:e=null!=this.pcVideoManager?this.pcVideoManager.SetPanoramaDisplayEffect(t):0,e)}},{key:"JSPlayM4_SetPanoramaSphereViewParam",value:function(t,e){var a=1;return 1!==this.decodeEngine?(console.info("%c softDecode not support JSPlayM4_SetPanoramaSphereViewParam","color: red"),0):(this.hasWebWorker?null!=this.decodeWorker?this.decodeWorker.postMessage({command:"SetPanoramaSphereViewParam",ViewParamType:t,fValue:e}):a=0:a=null!=this.pcVideoManager?this.pcVideoManager.SetPanoramaSphereViewParam(t,e):0,a)}},{key:"JSPlayM4_GetPanoramaSphereViewParam",value:function(t,e){var a=1;this.GetPanoramaSphereViewParamCB=e;var r={fValue:-1};return 1!==this.decodeEngine?(console.info("%c softDecode not support JSPlayM4_GetPanoramaSphereViewParam","color: red"),0):(this.hasWebWorker?null!=this.decodeWorker?this.decodeWorker.postMessage({command:"GetPanoramaSphereViewParam",ViewParamType:t}):a=0:null!=this.pcVideoManager?(a=this.pcVideoManager.GetPanoramaSphereViewParam(t,r),null!=this.GetPanoramaSphereViewParamCB&&this.GetPanoramaSphereViewParamCB(r)):a=0,a)}},{key:"JSPlayM4_FEC_SetCanvasID",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(console.log(" JSPlayM4_FEC_SetCanvasID canvasID :"+t),null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_FEC_SetCanvasID","color: red"),0;this.FECCanvasID=t;var a=1;if(null!=t&&""!=t)if(this.FECcanvasIDArray=t.split(","),1===this.decodeEngine)this.hasWebWorker?null!=this.decodeWorker&&this.decodeWorker.postMessage({command:"SetCanvasID",canvasID:t}):null!=this.pcVideoManager?a=this.pcVideoManager.FEC_SetCanvasID(t):console.info("%c JSPlayM4_FEC_SetCanvasID this.pcVideoManager is null","color: red");else{for(var r="",i=0;i<this.FECcanvasIDArray.length;i++)i==this.FECcanvasIDArray.length-1?r+="#"+this.FECcanvasIDArray[i]:r+="#"+this.FECcanvasIDArray[i]+",";if(0!=this.FECcanvasIDArray.length&&e)for(var n=0;n<this.FECcanvasIDArray.length;n++){var s=document.getElementById(this.FECcanvasIDArray[n]);if(s){var x=s.cloneNode(!0);s.parentNode.replaceChild(x,s)}}var o=this._stringToBytes(r),f=2*r.length;if(this.pFECTotalCanvasIDData=ae._malloc(f),null===this.pFECTotalCanvasIDData)return 0;var l=ae.HEAPU8.subarray(this.pFECTotalCanvasIDData,this.pFECTotalCanvasIDData+f),_=new Uint8Array(f);l.set(_,0),l.set(new Uint8Array(o)),l=null,_=null,a=ae._JSPlayM4_FEC_SetCanvasID(this.port,this.pFECTotalCanvasIDData)}else console.log(" JSPlayM4_FEC_SetCanvasID canvasID is null :"+t),a=0;return a}},{key:"JSPlayM4_FEC_ResetCorrectType",value:function(t,e,a){if(this.printfFlag>0&&console.log("JSPlayM4_FEC_ResetCorrectType 1 decodeEngine:"+this.decodeEngine+",hasWebWorker:"+this.hasWebWorker+",fishSubPort:"+t+",placeType:"+e+",correctType:"+a),null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_FEC_ResetCorrectType","color: red"),0;this.FECPlaceType=e,this.FECCorrectType=a;var r=1;return 1===this.decodeEngine?this.hasWebWorker?null!=this.decodeWorker?this.decodeWorker.postMessage({command:"FECResetCorrectType",fishSubPort:t,placeType:e,correctType:a}):r=0:r=null!=this.pcVideoManager?this.pcVideoManager.FEC_ResetCorrectType(t,e,a):0:r=ae._JSPlayM4_FEC_ResetCorrectType(this.port,t,e,a),r}},{key:"JSPlayM4_FEC_GetPort",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.printfFlag>0&&console.log(">>>JS JSPlayM4_FEC_GetPort this.decodeEngine："+this.decodeEngine+",placeType:"+t+",correctType:"+e),null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_FEC_GetPort","color: red"),0;var r=-1;return this.FECGetPortCB=a,1===this.decodeEngine?this.hasWebWorker?null!=this.decodeWorker?this.decodeWorker.postMessage({command:"FECGetPort",placeType:t,correctType:e}):r=-1:(null!=this.pcVideoManager?((r=this.pcVideoManager.FEC_GetPort(t,e))<1||r>16||null==r)&&(r=-1):r=-1,null!=this.FECGetPortCB&&this.FECGetPortCB(r)):(((r=ae._JSPlayM4_FEC_GetPort(this.port,t,e))<1||r>16||null==r)&&(r=-1),""!=self.FECCanvasID&&r>3&&oe>70&&(console.info("%cJSPlayM4_FEC_GetPort fishport max is 4","color: red"),r=-1),null!=this.FECGetPortCB&&this.FECGetPortCB(r)),r}},{key:"JSPlayM4_FEC_Enable",value:function(t){if(this.printfFlag>0&&console.log(">>>JS JSPlayM4_FEC_Enable this.decodeEngine："+this.decodeEngine+",fishSubPort:"+t),null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_FEC_Enable","color: red"),0;var e=1;return 0==t?console.log("fishPort is 0 ,main canvas doesn't need call FEC_Enable"):1===this.decodeEngine?this.hasWebWorker?null!=this.decodeWorker?this.decodeWorker.postMessage({command:"FECEnable",fishSubPort:t}):e=0:e=null!=this.pcVideoManager?this.pcVideoManager.FEC_Enable(t):0:e=ae._JSPlayM4_FEC_Enable(this.port,t),e}},{key:"JSPlayM4_FEC_SetParam",value:function(t,e){if(this.printfFlag>0&&console.log(">>>JS JSPlayM4_FEC_SetParam 1 this.decodeEngine："+this.decodeEngine+",fishSubPort:"+t+",upDateType:"+e.upDateType+",param2d.fPTZParam.fPTZPositionX:"+e.fPTZParam.fPTZPositionX+",param2d.fPTZParam.fPTZPositionY:"+e.fPTZParam.fPTZPositionY),null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_FEC_SetParam","color: red"),0;var a=1;if(1===this.decodeEngine)this.hasWebWorker?null!=this.decodeWorker?this.decodeWorker.postMessage({command:"FECSetParam",fishSubPort:t,param2d:e}):a=0:a=null!=this.pcVideoManager?this.pcVideoManager.FEC_SetParam(t,e):0;else{var r=ae._JSPlayM4_GetFishEye2DParam();null!=e.upDateType&&(ae.HEAP32[r>>2]=e.upDateType),null!=e.fPTZParam&&null!=e.fPTZParam.fPTZPositionX&&null!=e.fPTZParam.fPTZPositionY&&(ae.HEAPF32[r+8>>2]=e.fPTZParam.fPTZPositionX,ae.HEAPF32[r+12>>2]=e.fPTZParam.fPTZPositionY),null!=e.fPTZParam&&(ae.HEAPF32[r+32>>2]=e.fPTZZoom),null!=e.fValue&&(ae.HEAPF32[r+36>>2]=e.fValue),null!=e.stPTZColor&&(null!=e.stPTZColor.nR&&(ae.HEAP8[r+40>>1]=e.stPTZColor.nR),null!=e.stPTZColor.nG&&(ae.HEAP8[r+41>>1]=e.stPTZColor.nG),null!=e.stPTZColor.nB&&(ae.HEAP8[r+42>>1]=e.stPTZColor.nB),null!=e.stPTZColor.nAlpha&&(ae.HEAP8[r+43>>1]=e.stPTZColor.nAlpha)),a=ae._JSPlayM4_FEC_SetParam(this.port,t)}return a}},{key:"JSPlayM4_FEC_GetParam",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_FEC_GetParam","color: red"),0;var a={fRXLeft:0,fRXRight:0,fRYTop:0,fRYBottom:0,bBlack:0,bCut:0,nFishParamType:0,fAngle:0,fZoom:0,fPTZX:0,fPTZY:0,emCorrectType:0};if(this.FECParamCB=e,1===this.decodeEngine)this.hasWebWorker?null!=this.decodeWorker&&this.decodeWorker.postMessage({command:"FECGetParam",fishSubPort:t}):null!=this.pcVideoManager&&(this.pcVideoManager.FEC_GetParam(t,a),null!=this.FECParamCB&&this.FECParamCB(a));else{var r=ae._JSPlayM4_FEC_GetParam(this.port,t);a.bBlack=0,a.fPTZX=ae.HEAPF32[r+8>>2],a.fPTZY=ae.HEAPF32[r+12>>2],a.fRXLeft=ae.HEAPF32[r+16>>2],a.fRXRight=ae.HEAPF32[r+20>>2],a.fRYTop=ae.HEAPF32[r+24>>2],a.fRYBottom=ae.HEAPF32[r+28>>2],a.fZoom=ae.HEAPF32[r+32>>2],a.fAngle=ae.HEAPF32[r+36>>2],a.bCut=ae.HEAPF32[r+63>>2],a.nFishParamType=ae.HEAPF32[r+67>>2],null!=this.FECParamCB&&this.FECParamCB(a)}return 1}},{key:"JSPlayM4_FEC_SetViewParam",value:function(t,e,a){if(this.printfFlag>0&&console.log(">>>JS JSPlayM4_FEC_SetViewParam this.decodeEngine："+this.decodeEngine+",fishSubPort:"+t+",upDateType:"+e+",fValue:"+a),null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_FEC_SetViewParam","color: red"),0;var r=1;return 1===this.decodeEngine?this.hasWebWorker?null!=this.decodeWorker?this.decodeWorker.postMessage({command:"FECSetViewParam",fishSubPort:t,upDateType:e,fValue:a}):r=0:r=null!=this.pcVideoManager?this.pcVideoManager.FEC_SetViewParam(t,e,a):0:r=ae._JSPlayM4_FEC_SetViewParam(this.port,t,e,a),r}},{key:"JSPlayM4_FEC_GetViewParam",value:function(t,e,a){if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_FEC_GetViewParam","color: red"),0;var r=1;this.FECViewParamCB=a;var i={fValue:-1};if(1===this.decodeEngine)this.hasWebWorker?null!=this.decodeWorker?this.decodeWorker.postMessage({command:"FECGetViewParam",fishSubPort:t,upDateType:e}):r=0:null!=this.pcVideoManager?(r=this.pcVideoManager.FEC_GetViewParam(t,e,i),null!=this.FECViewParamCB&&this.FECViewParamCB(i)):r=0;else{var n=ae._JSPlayM4_GetViewParam(this.port,t,e);i.fValue=n,null!=this.FECViewParamCB&&this.FECViewParamCB(i)}return r}},{key:"JSPlayM4_FEC_SetWnd",value:function(t,e){if(this.printfFlag>0&&console.log(">>>JS JSPlayM4_FEC_SetWnd this.decodeEngine："+this.decodeEngine+",fishSubPort:"+t+",hWnd:"+e),null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_FEC_SetWnd","color: red"),0;var a=1;if(0==t)console.log("fishPort is 0 ,main canvas doesn't need call FEC_SetWnd");else if(null!=e)if(1===this.decodeEngine){var r=document.getElementById(e);if(this.hasWebWorker){var i=r.transferControlToOffscreen();null!=this.decodeWorker?this.decodeWorker.postMessage({command:"FECSetWnd",fishSubPort:t,offscrrenCnv:i},[i]):a=0}else a=null!=this.pcVideoManager?this.pcVideoManager.FEC_SetWnd(t,r):0}else{var n=null;if(null!=e){var s=this._stringToBytes("#"+e),x=2*(e.length+1);n=ae._malloc(x);var o=ae.HEAPU8.subarray(n,n+x),f=new Uint8Array(x);o.set(f,0),o.set(new Uint8Array(s)),o=null,f=null}a=ae._JSPlayM4_FEC_SetWnd(this.port,t,n),null!=n&&(ae._free(n),n=null)}else console.log(">>>JS JSPlayM4_FEC_SetWnd hwnd error this.decodeEngine："+this.decodeEngine+",fishSubPort:"+t+",hWnd:"+e),a=0;return a}},{key:"JSPlayM4_FEC_Disable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=1;return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_FEC_Disable","color: red"),0):(0==t?console.log("fishPort is 0 ,main canvas doesn't need call FEC_Disable"):1===this.decodeEngine?this.hasWebWorker?null!=this.decodeWorker?this.decodeWorker.postMessage({command:"FECDisable",fishSubPort:t,clearFECCanvas:e,clearContext:a}):r=0:r=null!=this.pcVideoManager?this.pcVideoManager.FEC_Disable(t,e,a):0:r=ae._JSPlayM4_FEC_Disable(this.port,t,e,a),r)}},{key:"JSPlayM4_FEC_DelPort",value:function(t){if(this.printfFlag>0&&console.log(">>>JS JSPlayM4_FEC_DelPort this.decodeEngine："+this.decodeEngine+",fishSubPort:"+t),null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_FEC_DelPort","color: red"),0;var e=1;return 1===this.decodeEngine?this.hasWebWorker?null!=this.decodeWorker?this.decodeWorker.postMessage({command:"FECDelPort",fishSubPort:t}):e=0:e=null!=this.pcVideoManager?this.pcVideoManager.FEC_DelPort(t):0:e=ae._JSPlayM4_FEC_DelPort(this.port,t),e}},{key:"JSPlayM4_FEC_SetDisplayRegion",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,n=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0;if(this.printfFlag>0&&console.log(">>>JS JSPlayM4_FEC_SetDisplayRegion this.decodeEngine："+this.decodeEngine+",fishSubPort:"+t+",left:"+r.left+",right:"+r.right+",top:"+r.top+",bottom:"+r.bottom),null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_FEC_SetDisplayRegion","color: red"),0;var x=1,o=r.left,f=r.right,l=r.top,_=r.bottom;if("number"!=typeof o||"number"!=typeof f||"number"!=typeof _||"number"!=typeof l)return console.log("param is not number"),0;if(n){if(o<0||f<0||l<0||_<0)return 0;if(f-o<16||_-l<16||f-o>this.canvasWidth||_-l>this.canvasHeight)return 0;s&&0!==this.iFECZoomNum&&(o=Math.round(o/this.iFECRatio_x)+this.stFECDisplayRect.left,l=Math.round(l/this.iFECRatio_y)+this.stFECDisplayRect.top,f=Math.round(f/this.iFECRatio_x)+this.stFECDisplayRect.left,_=Math.round(_/this.iFECRatio_y)+this.stFECDisplayRect.top)}else o=0,f=this.canvasWidth,l=0,_=this.canvasHeight,this.iFECZoomNum=0,this.iFECRatio_x=1,this.iFECRatio_y=1;if(this.stFECDisplayRect={top:l,left:o,right:f,bottom:_},1===this.decodeEngine){var h=o/this.canvasWidth*this.width,c=f/this.canvasWidth*this.width,u=l/this.canvasHeight*this.height,d=_/this.canvasHeight*this.height;this.hasWebWorker?null!=this.decodeWorker?this.decodeWorker.postMessage({command:"FECSetDisplayRegion",fishSubPort:t,type:e,regionNum:a,sx:h,sy:u,sw:c-h,sh:d-u}):x=0:x=null!=this.pcVideoManager?this.pcVideoManager.FEC_SetDisplayRegion(t,e,a,h,u,c-h,d-u):0}else if(null!==ae){var p=o/this.canvasWidth*1e3,m=f/this.canvasWidth*1e3,S=l/this.canvasHeight*1e3,R=_/this.canvasHeight*1e3;x=n?ae._JSPlayM4_FEC_SetDisplayRegion(this.port,t,e,a,p,m,S,R,i,n):ae._JSPlayM4_FEC_SetDisplayRegion(this.port,t,0,0,0,0,0,0,null,n)}else x=0;return s&&(this.iFECRatio_x=this.canvasWidth/(f-o),this.iFECRatio_y=this.canvasHeight/(_-l),this.iFECZoomNum++),x}},{key:"JSPlayM4_FEC_SetBackCilling",value:function(t,e){var a=1;return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_FEC_SetBackCilling","color: red"),0):(1===this.decodeEngine?this.hasWebWorker?null!=this.decodeWorker?this.decodeWorker.postMessage({command:"FECSetBackCilling",fishSubPort:t,bValue:e}):a=0:a=null!=this.pcVideoManager?this.pcVideoManager.FEC_SetBackCilling(t,e):0:a=ae._JSPlayM4_FEC_SetBackCilling(this.port,t,e),a)}},{key:"JSPlayM4_FEC_GetPTZPort",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_FEC_GetPTZPort","color: red"),0;var r=-1;return this.FECGetPTZPortCB=a,1===this.decodeEngine?this.hasWebWorker?null!=this.decodeWorker?this.decodeWorker.postMessage({command:"FECGetPTZPort",subport:0,fPositionX:t,fPositionY:e}):r=0:null!=this.pcVideoManager?(((r=this.pcVideoManager.FEC_GetPTZPort(0,t,e))<0||r>31||null==r)&&(r=-1),null!=this.FECGetPTZPortCB&&this.FECGetPTZPortCB(r)):r=-1:console.info("%c softDecoder not support JSPlayM4_FEC_GetPTZPort","color: red"),r}},{key:"JSPlayM4_FEC_SetPTZDisplayMode",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_FEC_SetPTZDisplayMode","color: red"),0):(1===this.decodeEngine&&(this.hasWebWorker?null!=this.decodeWorker&&this.decodeWorker.postMessage({command:"FECSetPTZDisplayMode",ptzMode:t}):null!=this.pcVideoManager&&this.pcVideoManager.FEC_SetPTZDisplayMode(t)),1)}},{key:"JSPlayM4_FEC_Capture",value:function(t,e){return this.FECImageCB=e,1===this.decodeEngine?(this.hasWebWorker?this.decodeWorker.postMessage({command:"FECCapture",subport:t}):null!=this.pcVideoManager&&this.pcVideoManager.FEC_Capture(t,e),1):(ae._JSPlayM4_FEC_Capture(this.port,t),1)}},{key:"JSPlayM4_FEC_PTZ2Window",value:function(t,e,a,r){return 1}},{key:"JSPlayM4_FEC_PTZ2Window2",value:function(t,e,a){return 1}},{key:"_SetTextCanvas",value:function(){if(1===this.decodeEngine){if(null!=this.textCanvas&&(this.textCanvas.remove(),this.textCanvas=null),null==this.textCanvas&&(this.textCanvas=document.createElement("canvas")),this.hasWebWorker){var t=this.textCanvas.transferControlToOffscreen();this.decodeWorker.postMessage({command:"SetTextCanvas",textoffscreenCanvas:t},[t])}else null!=this.pcVideoManager&&this.pcVideoManager.SetTextCanvas(this.textCanvas);this.setTextCanvasFlag=!0}return 1}},{key:"JSPlayM4_InputPrivateInfo",value:function(t,e,a){this.setTextCanvasFlag||this._SetTextCanvas();var r={};r.linesNum=ae.HEAP32[t>>2],r.absTimeStamp=ae.HEAP32[t+4>>2],r.stDrawLinesArray=[];for(var i=0;i<r.linesNum;i++){r.stDrawLinesArray[i]={},r.stDrawLinesArray[i].vertex_num=ae.HEAP32[t+8+136*i>>2],r.stDrawLinesArray[i].lineWidth=ae.HEAP32[t+12+136*i>>2],r.stDrawLinesArray[i].bFill=ae.HEAP32[t+16+136*i>>2],r.stDrawLinesArray[i].bLoop=ae.HEAP32[t+20+136*i>>2],r.stDrawLinesArray[i].dwMatchType=ae.HEAP32[t+24+136*i>>2],r.stDrawLinesArray[i].dwIntelFlag=ae.HEAP32[t+28+136*i>>2],r.stDrawLinesArray[i].dwSubIntelFlag=ae.HEAP32[t+32+136*i>>2],r.stDrawLinesArray[i].color={},r.stDrawLinesArray[i].color.R=ae.HEAPF32[t+36+136*i>>2],r.stDrawLinesArray[i].color.G=ae.HEAPF32[t+40+136*i>>2],r.stDrawLinesArray[i].color.B=ae.HEAPF32[t+44+136*i>>2],r.stDrawLinesArray[i].color.A=ae.HEAPF32[t+48+136*i>>2],r.stDrawLinesArray[i].stPoint=[];for(var n=0;n<r.stDrawLinesArray[i].vertex_num;n++)r.stDrawLinesArray[i].stPoint[n]={},r.stDrawLinesArray[i].stPoint[n].x=ae.HEAPF32[t+52+136*i+8*n>>2],r.stDrawLinesArray[i].stPoint[n].y=ae.HEAPF32[t+56+136*i+8*n>>2];r.stDrawLinesArray[i].dwFillPicID=ae.HEAP32[t+132+136*i>>2],r.stDrawLinesArray[i].dwEventID=ae.HEAP32[t+136+136*i>>2],r.stDrawLinesArray[i].dwMosaictype=ae.HEAP32[t+140+136*i>>2]}var s={};s.nFontsNum=ae.HEAP32[e>>2],s.absTimeStamp=ae.HEAP32[e+4>>2],s.stDrawFontsArray=[];for(var x=0;x<s.nFontsNum;x++){s.stDrawFontsArray[x]={},s.stDrawFontsArray[x].nFontSizeW=ae.HEAP32[e+8+80*x>>2],s.stDrawFontsArray[x].nFontSizeH=ae.HEAP32[e+12+80*x>>2],s.stDrawFontsArray[x].dwMatchType=ae.HEAP32[e+16+80*x>>2],s.stDrawFontsArray[x].dwIntelFlag=ae.HEAP32[e+20+80*x>>2],s.stDrawFontsArray[x].dwSubIntelFlag=ae.HEAP32[e+24+80*x>>2],s.stDrawFontsArray[x].color={},s.stDrawFontsArray[x].color.R=ae.HEAPF32[e+28+80*x>>2],s.stDrawFontsArray[x].color.G=ae.HEAPF32[e+32+80*x>>2],s.stDrawFontsArray[x].color.B=ae.HEAPF32[e+36+80*x>>2],s.stDrawFontsArray[x].color.A=ae.HEAPF32[e+40+80*x>>2],s.stDrawFontsArray[x].stPoint={},s.stDrawFontsArray[x].stPoint.x=ae.HEAPF32[e+44+80*x>>2],s.stDrawFontsArray[x].stPoint.y=ae.HEAPF32[e+48+80*x>>2],s.stDrawFontsArray[x].NeedClearNormalPos=ae.HEAP32[e+60+80*x>>2],s.stDrawFontsArray[x].bBackGround=ae.HEAP32[e+64+80*x>>2],s.stDrawFontsArray[x].BGcolor={},s.stDrawFontsArray[x].BGcolor.R=ae.HEAPF32[e+68+80*x>>2],s.stDrawFontsArray[x].BGcolor.G=ae.HEAPF32[e+72+80*x>>2],s.stDrawFontsArray[x].BGcolor.B=ae.HEAPF32[e+76+80*x>>2],s.stDrawFontsArray[x].BGcolor.A=ae.HEAPF32[e+80+80*x>>2],s.stDrawFontsArray[x].dwEventID=ae.HEAP32[e+84+80*x>>2];var o=ae.HEAP32[e+52+80*x>>2],f=ae.HEAP32[e+56+80*x>>2],l=new Uint8Array(4*f);l.set(ae.HEAP8.subarray(o,o+4*f));for(var _=new Uint32Array(f),h=0;h<f;h++)_[h]=l[4*h]|l[4*h+1]<<8|l[4*h+2]<<16|l[4*h+3]<<24;for(var c="",u=0;u<_.length;u++)0!==_[u]&&(c+=String.fromCharCode(_[u]));s.stDrawFontsArray[x].fontString=c}var d={};d.absTimeStamp=ae.HEAP32[a>>2],d.nWidth=ae.HEAP32[a+4>>2],d.nHeight=ae.HEAP32[a+8>>2],d.pstRect={},d.pstRect.fTop=ae.HEAPF32[a+12>>2],d.pstRect.fBottom=ae.HEAPF32[a+16>>2],d.pstRect.fLeft=ae.HEAPF32[a+20>>2],d.pstRect.fRight=ae.HEAPF32[a+24>>2],d.nPixelFormat=ae.HEAP32[a+28>>2],d.fAlpha=ae.HEAPF32[a+32>>2],d.nPixelFormat;var p=ae.HEAP32[a+36>>2],m=ae.HEAP32[a+40>>2],S=new Uint8Array(m);return S.set(ae.HEAPU8.subarray(p,p+m)),d.picImageData=S,d.PicID=ae.HEAP32[a+44>>2],1===this.decodeEngine&&(this.hasWebWorker?this.decodeWorker.postMessage({command:"InputPrivateInfo",linesInfo:r,fontInfo:s,ImageInfo:d}):null!=this.pcVideoManager&&this.pcVideoManager.InputPrivateInfo(r,s,d)),1}},{key:"JSPlayM4_SelectIntelInfoFeatureToDraw",value:function(t){if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_SelectIntelInfoFeatureToDraw","color: red"),0;if(null==t)return 0;var e=1;if(2==t.nMode){if(1!==this.decodeEngine)return 0;this.hasWebWorker?this.decodeWorker.postMessage({command:"SelectIntelInfoFeatureToDraw",IntelInfoParam:t}):null!=this.pcVideoManager&&this.pcVideoManager.SelectIntelInfoFeatureToDraw(t)}else{var a=ae._JSPlayM4_GetNeedDrawIntelInfoStruct();ae.HEAP32[a+3840>>2]=t.NodeNumber;for(var r=0;r<t.NodeNumber;r++)ae.HEAPU32[a+24*r>>2]=t.pIntelInfoNode[r].nID,ae.HEAPU8[a+4+24*r]=t.pIntelInfoNode[r].nType;e=ae._JSPlayM4_SelectIntelInfoFeatureToDraw(this.port,t.bTrue,t.nMode)}return e}},{key:"JSPlayM4_SetMosaicType",value:function(t){if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetMosaicType","color: red"),0;var e=1;if(this.pMosaicParam=t,1===this.decodeEngine)this.hasWebWorker?this.decodeWorker.postMessage({command:"SetMosaicType",MosaicParam:t}):null!=this.pcVideoManager&&this.pcVideoManager.SetMosaicType(t);else{var a=ae._JSPlayM4_GetMosaicTypeConfigStruct();ae.HEAPU8[a]=t.nMosaicType,ae.HEAPU8[a+1]=t.pstMosaicColor.fMosaicColorR,ae.HEAPU8[a+2]=t.pstMosaicColor.fMosaicColorG,ae.HEAPU8[a+3]=t.pstMosaicColor.fMosaicColorB,ae.HEAPU8[a+4]=t.pstMosaicColor.fMosaicColorA,ae.HEAPU8[a+5]=t.nMosaicSize,e=ae._JSPlayM4_SetMosaicType(this.port)}return e}},{key:"JSPlayM4_SetWaterMarkFont",value:function(t){if(null===ae)return console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetWaterMarkFont","color: red"),0;if(this.printfFlag>0){console.log("%cJSPlayerInterfaceV3.js JSPlayM4_SetWaterMarkFont: port:"+this.port+",string:"+t.pFontString+",fontcolr,fR:"+t.pstFontColor.fR+",fG:"+t.pstFontColor.fG+",fB:"+t.pstFontColor.fB+",fA:"+t.pstFontColor.fA+",fontSizeWidth:"+t.pstFontSize.nFontWidth+",fontSizeHeight:"+t.pstFontSize.nFontHeight+",rotateAngle:"+t.pstFontRotate.fRotateAngle+",fontFamily:"+t.pFontFamily,"color:red");var e=document.getElementById(this.canvasID).width,a=document.getElementById(this.canvasID).height;console.log("canvasWidht:"+e+",canvasHeight:"+a),console.log("fullScreen:"+t.pstFontRotate.fFillFullScreen+",rowNum:"+t.pstFontNumber.nRowNumber+",colNum:"+t.pstFontNumber.nColNumber+",space:"+t.pSpace+",fontAlign:"+t.nFontAlign+",colorAdapt:"+t.nColorAdapt),console.log("adaptMode:"+t.pstCanvasAdapt.nCanvasAdaptMode+",baseWidth:"+t.pstCanvasAdapt.nBaseCanvasWidth+",baseHeight:"+t.pstCanvasAdapt.nBaseCanvasHeight+",rowSpace:"+t.pstCanvasAdapt.nRowSpace+",colSpace:"+t.pstCanvasAdapt.nColSpace+",ntotalColSpace:"+t.pstCanvasAdapt.ntotalColSpace+",ntotalRowSpace:"+t.pstCanvasAdapt.ntotalRowSpace)}var r=1;if(this.pFontParam=t,1===this.decodeEngine)this.setTextCanvasFlag||this._SetTextCanvas(),this.hasWebWorker?this.decodeWorker.postMessage({command:"SetWaterMarkFont",fontParam:t}):null!=this.pcVideoManager&&this.pcVideoManager.SetWaterMarkFont(t);else if(null==t){var i=ae._JSPlayM4_GetWaterMarkFontStruct();ae.HEAP32[i+1800-4+44>>2]=0,ae.HEAP32[i+1800-4+48>>2]=0,ae._JSPlayM4_SetWaterMarkFontString(0,null),r=ae._JSPlayM4_SetWaterMarkFont(this.port)}else{for(var n=0;n<t.pFontString.length;n++){var s=this._stringToBytes(t.pFontString[n]),x=2*t.pFontString[n].length;if(0==x&&(x=1),(null==this.pWaterMarkFontData||x>this.nWaterMarkFontLen)&&(null!==this.pWaterMarkFontData&&(ae._free(this.pWaterMarkFontData),this.pWaterMarkFontData=null),this.pWaterMarkFontData=ae._malloc(x),this.nWaterMarkFontLen=x),null===this.pWaterMarkFontData)return;var o=ae.HEAPU8.subarray(this.pWaterMarkFontData,this.pWaterMarkFontData+x),f=new Uint8Array(x);o.set(f,0),o.set(new Uint8Array(s)),o=null,f=null,ae._JSPlayM4_SetWaterMarkFontString(n,this.pWaterMarkFontData)}var l=ae._JSPlayM4_GetWaterMarkFontStruct();ae.HEAPF32[l+1800-4+4>>2]=t.pSpace,ae.HEAPU32[l+1800-4+8>>2]=t.pFontString.length,ae.HEAPU32[l+1800-4+12>>2]=t.nFontAlign,ae.HEAPU32[l+1800-4+16>>2]=t.nColorAdapt,ae.HEAPF32[l+1800-4+20>>2]=t.pstStartPos.fX,ae.HEAPF32[l+1800-4+24>>2]=t.pstStartPos.fY,ae.HEAPF32[l+1800-4+28>>2]=t.pstFontColor.fR,ae.HEAPF32[l+1800-4+32>>2]=t.pstFontColor.fG,ae.HEAPF32[l+1800-4+36>>2]=t.pstFontColor.fB,ae.HEAPF32[l+1800-4+40>>2]=t.pstFontColor.fA,ae.HEAP32[l+1800-4+44>>2]=t.pstFontSize.nFontWidth,ae.HEAP32[l+1800-4+48>>2]=t.pstFontSize.nFontHeight,ae.HEAPF32[l+1800-4+52>>2]=t.pstFontRotate.fRotateAngle,ae.HEAP32[l+1800-4+56>>2]=t.pstFontRotate.fFillFullScreen,ae.HEAP32[l+1800-4+60>>2]=t.pstFontNumber.nRowNumber,ae.HEAP32[l+1800-4+64>>2]=t.pstFontNumber.nColNumber,ae.HEAP32[l+1800-4+68>>2]=t.pstCanvasAdapt.nCanvasAdaptMode,ae.HEAP32[l+1800-4+72>>2]=t.pstCanvasAdapt.nRowSpace,ae.HEAP32[l+1800-4+76>>2]=t.pstCanvasAdapt.nColSpace,ae.HEAP32[l+1800-4+80>>2]=t.pstCanvasAdapt.nBaseCanvasWidth,ae.HEAP32[l+1800-4+84>>2]=t.pstCanvasAdapt.nBaseCanvasHeight,r=ae._JSPlayM4_SetWaterMarkFont(this.port)}return r}},{key:"JSPlayM4_SetWaterMarkImage",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_SetWaterMarkImage","color: red"),0):(1===this.decodeEngine?this.hasWebWorker?this.decodeWorker.postMessage({command:"SetWaterMarkImage",pImageData:t.pImageData,pImageType:t.pImageType,pstRectPos:t.pstRectPos,fAlpha:t.fAlpha},[t.pImageData]):null!=this.pcVideoManager&&this.pcVideoManager.SetWaterMarkImage(t):console.log("%c1>soft decode not support SetWaterMarkImage,","color: red"),1)}},{key:"JSPlayM4_InitEncoder",value:function(t,e){if(1!==this.decodeEngine)return console.log("%conly hard decoder support recoder,soft decoder not support (20240801)","color: red"),0;if(e.recoderAudioAnyWhere?(this.recoderAudioAnyWhere=!0,ae._JSPlayM4_SetRecoderAudio(this.port,1)):ae._JSPlayM4_SetRecoderAudio(this.port,0),this.needPlaySound||this.recoderAudioAnyWhere){var a=48e3;44100==e.sampleRate&&(a=e.sampleRate),this.JSPlayM4_SetResampleValue(!0,a)}return this.hasWebWorker?this.decodeWorker.postMessage({command:"InitEncoder",videoInfo:t,audioInfo:e}):null!=this.pcVideoManager&&this.pcVideoManager.InitEncoder(t,e),1}},{key:"JSPlayM4_StartEncode",value:function(t,e){var a=this;return 1!==this.decodeEngine?(console.log("%conly hard decoder support recoder,soft decoder not support (20240801)","color: red"),0):(this.recoderVideoDataCBFun=t,this.recoderAudioDataCBFun=e,"undefined"==typeof VideoEncoder?(console.log("%cbrowser or Graphics car not support videoEncode ","color: red"),0):(this.hasWebWorker?this.decodeWorker.postMessage({command:"StartVideoEncode"}):null!=this.pcVideoManager&&this.pcVideoManager.StartVideoEncode(t),(this.needPlaySound||this.recoderAudioAnyWhere)&&("undefined"==typeof AudioEncoder?console.log("%cbrowser or Graphics car not support audioEncode ","color: red"):(this.JSPlayM4_SetDecCBStream(2),ae._JSPlayM4_SetDecOrDisplayCallbackType(this.port,2,1),ae._JSPlayM4_SetDisplayCallBack(this.port,1,this.nUser),this.hasWebWorker?this.decodeWorker.postMessage({command:"StartAudioEncode"}):null!=this.pcVideoManager&&this.pcVideoManager.StartAudioEncode(e),this.ResamplePCMCallBack=function(t){101==t.type&&(a.hasWebWorker?a.decodeWorker.postMessage({command:"InputPCMToEncode",PCMData:t.yuvData,timeStamp:t.timeStamp},[t.yuvData.buffer]):null!=a.pcVideoManager&&a.pcVideoManager.InputPCMToEncode(t.yuvData,t.timeStamp))})),1))}},{key:"JSPlayM4_StopEncode",value:function(){return 1!==this.decodeEngine?(console.log("%conly hard decoder support recoder,soft decoder not support (20240801)","color: red"),0):(this.recoderVideoDataCBFun=null,this.recoderAudioDataCBFun=null,this.ResamplePCMCallBack=null,this.recoderAudioAnyWhere=!1,ae._JSPlayM4_SetRecoderAudio(this.port,0),ae._JSPlayM4_SetDisplayCallBack(this.port,0,this.nUser),this.hasWebWorker?this.decodeWorker.postMessage({command:"StopEncode"}):null!=this.pcVideoManager&&this.pcVideoManager.StopEncode(),1)}},{key:"JSPlayM4_IsVisible",value:function(t){return null===ae?(console.info("%coJSPlayerWasm is null,can't JSPlayM4_IsVisible","color: red"),0):(1===this.decodeEngine?this.hasWebWorker?this.decodeWorker.postMessage({command:"IsVisible",visibility:t}):null!=this.pcVideoManager&&this.pcVideoManager.IsVisible(t):ae._JSPlayM4_IsVisible(this.port,t),1)}},{key:"_stringToBytes",value:function(t){if("string"!=typeof t||null==t)return console.log("%c_stringToBytes str:"+t,"color: red"),0;for(var e,a,r=[],i=0;i<t.length;i++){e=t.charCodeAt(i),a=[];do{a.push(255&e),e>>=8}while(e);r=r.concat(a.reverse())}return r}},{key:"_downloadFile",value:function(t,e){var a=t;i(t,Blob)||i(t,File)||(a=new Blob([t]));var r=window.URL.createObjectURL(a),n=window.document.createElement("a");n.href=r,n.download=e;var s=document.createEvent("MouseEvents");s.initEvent("click",!0,!0),n.dispatchEvent(s)}},{key:"downloadRTPData",value:function(t){if(this.bWriteData){var e=t,a=this.aTotalBuffer.length;console.log("totalLength:"+a);for(var r=0,i=e.length;r<i;r++)this.aTotalBuffer[a+r]=e[r];this.iFrameNum++,e=null,console.log("downloadRTPdata iFrameNum:"+this.iFrameNum)}if(this.bWriteData&&this.iFrameNum>=600){console.log("download600RawData");var n=new Uint8Array(this.aTotalBuffer);this._downloadFile(n,"Raw600.data"),this.aTotalBuffer.splice(0,this.aTotalBuffer.length),this.bWriteData=!1,this.iFrameNum=0,n=null}}},{key:"downloadAudioPCMData",value:function(t){if(this.bWriteAudioPCMData){for(var e=t,a=this.audioPCMBuffer.length,r=0,i=e.length;r<i;r++)this.audioPCMBuffer[a+r]=e[r];this.iAudioPCMFrameNum++,e=null,console.log("download ANR Decode AudioData FrameNum:"+this.iAudioPCMFrameNum)}if(this.bWriteAudioPCMData&&this.iAudioPCMFrameNum>=WRITE_PCM_NUM){console.log("download"+WRITE_PCM_NUM+"this.audioPCMBuffer");var n=new Uint8Array(this.audioPCMBuffer);this._downloadFile(n,"AudioANR.data"),this.audioPCMBuffer.splice(0,this.audioPCMBuffer.length),this.bWriteAudioPCMData=!1,this.iAudioPCMFrameNum=0,n=null}}},{key:"IsChromeVersion64Bit",value:function(){var t=navigator.userAgent;if(t.indexOf("Chrome")>-1){var e=t.match(/Chrome\/(\d+)/);if(e&&e[1]){var a=e[1];return t.indexOf("Mac")>-1?t.indexOf("Intel")>-1||a>61:t.indexOf("Windows")>-1?t.indexOf("Win64")>-1||t.indexOf("x64")>-1||(t.indexOf("x86"),!1):t.indexOf("Linux")>-1&&(t.indexOf("x86_64")>-1||t.indexOf("x64")>-1||(t.indexOf("i686")>-1||t.indexOf("x86"),!1))}return!1}return!1}},{key:"getwasmMemory",value:function(){var t,e={},a=navigator.userAgent.toLowerCase();if((t=a.match(/rv:([\d.]+)\) like gecko/))||(t=a.match(/msie ([\d\.]+)/))?e.ie=t[1]:(t=a.match(/edge\/([\d\.]+)/))?e.edge=t[1]:(t=a.match(/firefox\/([\d\.]+)/))?e.firefox=t[1]:(t=a.match(/(?:opera|opr).([\d\.]+)/))?e.opera=t[1]:(t=a.match(/chrome\/([\d\.]+)/))?e.chrome=t[1]:(t=a.match(/version\/([\d\.]+).*safari/))&&(e.safari=t[1]),this.initialMemory=8192,e.chrome){var r=this.IsChromeVersion64Bit();this.maximumMemory=1==r?32768:16368}else if(e.safari){var i=e.safari,n=i.indexOf(".");Number(i.substring(0,n)),this.maximumMemory=16368,console.info("%c1>your safaribrowserbit  maximumMemory:%d","color: green",64*this.maximumMemory/1024)}else this.maximumMemory=16368,console.info("%c1>your browserbit is 32 and maximumMemory:%d","color: green",64*this.maximumMemory/1024);return this.isMobileDevice()&&(this.initialMemory=2048,this.maximumMemory=4096,console.info("%c1>your browser is mobileDevice maximumMemory:%d","color: green",64*this.maximumMemory/1024)),-1}},{key:"isMobileDevice",value:function(){var t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t),a=window.innerWidth<=768,r="ontouchstart"in window||navigator.maxTouchPoints>0;return e||a&&r}}]),a}();window.JSPlayM4_AdditionDataCBFun=function(t,e,a){if(null!=ee[a][t]){var r={};r.dataType=ae.HEAP32[e>>2],r.dataStrVersion=ae.HEAP32[e+4>>2],r.dataTimeStamp=ae.HEAP32[e+8>>2],r.dataLength=ae.HEAP32[e+12>>2],r.pData=ae.HEAP32[e+16>>2],ee[a][t].additionDataBufferSize<r.dataLength&&(null!==ee[a][t].additionDataBuffer&&(ae._free(ee[a][t].additionDataBuffer),ee[a][t].additionDataBuffer=null),ee[a][t].additionDataBufferSize=r.dataLength),null===ee[a][t].additionDataBuffer&&(ee[a][t].additionDataBuffer=ae._malloc(ee[a][t].additionDataBufferSize));var i=new Uint8Array(r.dataLength);i.set(ae.HEAPU8.subarray(r.pData,r.pData+r.dataLength)),ae.writeArrayToMemory(i,ee[a][t].additionDataBuffer),r.additionDataBuffer=new Uint8Array(ae.HEAPU8.buffer,ee[a][t].additionDataBuffer,ee[a][t].additionDataBufferSize),ee[a][t].hasOwnProperty("addtionCallBackFun")&&null!=ee[a][t].addtionCallBackFun&&null!=ee[a][t].addtionCallBackFun&&(ee[a][t].addtionCallBackFun(r),i=null,r.additionDataBuffer=null)}},window.JSPlayM4_DisplayCallBack=function(t,e,a,r,i,n,s,x,o){if(null!=ee[o][t]){var f={};f.yuvData=new Uint8Array(a),f.yuvData.set(ae.HEAPU8.subarray(e,e+a)),f.isize=a,f.timeStamp=s,f.width=r,f.height=i,f.frameRate=n,f.type=x,ee[o][t].hasOwnProperty("displayCallBackFun")&&(null!=ee[o][t].displayCallBackFun&&(ee[o][t].displayCallBackFun(f),f.yuvData=null),null!=ee[o][t].ResamplePCMCallBack&&(44100==f.frameRate||48e3==f.frameRate?ee[o][t].ResamplePCMCallBack(f):console.log("%cAudio encode only support 44.1k and 48k.ResamplePCMCallBack sampleRate:"+f.frameRate,"color: red")))}},window.JSPlayM4_DecCallBack=function(t,e,a,r,i,n,s,x,o){if(null!=ee[o][t]){var f={};f.port=t,f.Data=new Uint8Array(a),f.Data.set(ae.HEAPU8.subarray(e,e+a)),f.isize=a,f.iDataType=r,f.SampleRate=i,f.width=n,f.height=s,f.stampTime=x,ee[o][t].hasOwnProperty("decCallBackFun")&&null!=ee[o][t].decCallBackFun&&(ee[o][t].decCallBackFun(f),f.Data=null)}},window.JSPlayM4_RunTimeInfoCallBack=function(t,e,a,r){if(null!=ee[r][t]){var i={nRunTimeModule:0,nStrVersion:0,nFrameTimeStamp:0,nFrameNum:0,nErrorCode:0,nInputDataInterval:0,nFrameNumInterval:0};if(i.nRunTimeModule=ae.HEAP32[e>>2],i.nStrVersion=ae.HEAP32[e+4>>2],i.nFrameTimeStamp=ae.HEAP32[e+8>>2],i.nFrameNum=ae.HEAP32[e+12>>2],i.nErrorCode=a,a==$){var n=ae.HEAP32[e+20>>2];i.nInputDataInterval=n}if(1024==a){var s=ae.HEAP32[e+20>>2];i.nFrameNumInterval=s}if(a==tt){var x=ae.HEAPF64[e+20>>3];i.nAverageDecodeTime=x}if(687865857==a){var o=ae.HEAPU8[e+20],f=ae.HEAPU8[e+21];i.nSystemFormat=f,i.nDetectRes=o,i.nMp4FileTime=i.nFrameTimeStamp,i.nMp4TotalFrameNum=i.nFrameNum}if(a==et||a==at){var l=ae.HEAPU8[e+21],_=ae.HEAPU8[e+22]<<8|l,h=ae.HEAPU8[e+23],c=ae.HEAPU8[e+24],u=ae.HEAPU8[e+25],d=ae.HEAPU8[e+26],p=ae.HEAPU8[e+27],m=ae.HEAPU8[e+28],S=ae.HEAPU8[e+29]<<8|m;i.AbsTimeYear=_,i.AbsTimeMonth=h,i.AbsTimeDay=c,i.AbsTimeHour=u,i.AbsTimeMinute=d,i.AbsTimeSecond=p,i.AbsTimeMilliseconds=S}if(9==a&&1==ee[r][t].decodeEngine)return void ee[r][t].JSPlayM4_SetStreamEnd(!0);ee[r][t].hasOwnProperty("runtimeCBFun")&&null!=ee[r][t].runtimeCBFun&&ee[r][t].runtimeCBFun(i)}},window.JSPlayM4_StreamInfoCallBack=function(t,e,a){if(null!=ee[a][t]){var r={};r.nSystemformat=ae.HEAP16[e>>1],r.nVideoformat=ae.HEAP16[e+2>>1],r.nAudioformat=ae.HEAP16[e+4>>1],r.nAudiochannels=ae.HEAP16[e+6>>1],r.nAudiobitspersample=ae.HEAP32[e+8>>2],r.nAudiosamplesrate=ae.HEAP32[e+12>>2],r.nAudiobitrate=ae.HEAP32[e+16>>2],r.nWidth=ae.HEAP32[e+20>>2],r.nHeight=ae.HEAP32[e+24>>2],r.fFrameRate=ae.HEAPF32[e+28>>2],r.nIntervalOfIFrame=ae.HEAP32[e+32>>2],ee[a][t].hasOwnProperty("streamInfoCBFun")&&null!=ee[a][t].streamInfoCBFun&&ee[a][t].streamInfoCBFun(r)}},window.JSPlayM4_PostMpStreamOffsetCBFun=function(t,e,a){if(null!=ee[a][t]){var r={};r.nStreamOffset=e,ee[a][t].hasOwnProperty("streamInfoCBFun")&&null!=ee[a][t].PostMpStreamOffsetCBFun&&ee[a][t].PostMpStreamOffsetCBFun(r)}},window.JSPlayM4_FirstFrameCallBack=function(t,e){null!=ee[e][t]&&ee[e][t].hasOwnProperty("FFCallBackFun")&&null!=ee[e][t].FFCallBackFun&&null!=ee[e][t].FFCallBackFun&&ee[e][t].FFCallBackFun({decodeEngine:0})},window.JSPlayM4_AudioPCMCallBack=function(t,e,a,r){null!=ee[r][t]&&ee[r][t].__proto__.hasOwnProperty("downloadAudioPCMData")&&ee[r][t].downloadAudioPCMData(e)},window.JSPlayM4_RTPRawDataCallBack=function(t,e,a){null!=ee[a][port]&&ee[a][port].__proto__.hasOwnProperty("downloadRTPData")&&ee[a][port].downloadRTPData(t)},window.JSPlayM4_CaptrueRGBDataCallBack=function(t,e,a,r,i,n){null!=ee[n][t]&&ee[n][t].hasOwnProperty("imageCB")&&null!=ee[n][t].imageCB&&(null==ee[n][t].rgbDataBuffer&&(ee[n][t].rgbDataBuffer=new Uint8Array(i)),ee[n][t].rgbDataBuffer.set(ae.HEAPU8.subarray(e,e+i)),ee[n][t].imageCB(ee[n][t].rgbDataBuffer,a,r),ee[n][t].rgbDataBuffer=null)},window.JSPlayM4_SetPlayPosSucCallBack=function(t,e,a){if(null!=ee[a][t]){var r={nRes:1};r.nRelativePos=e,ee[a][t].hasOwnProperty("SetPlayPosCBFun")&&null!=ee[a][t].SetPlayPosCBFun&&ee[a][t].SetPlayPosCBFun(r)}},window.JSPlayM4_FishCaptrueRGBDataCallBack=function(t,e,a,r,i,n,s){null!=ee[s][t]&&ee[s][t].hasOwnProperty("FECImageCB")&&null!=ee[s][t].FECImageCB&&(null==ee[s][t].FECRgbDataBuffer&&(ee[s][t].FECRgbDataBuffer=new Uint8Array(n)),ee[s][t].FECRgbDataBuffer.set(ae.HEAPU8.subarray(a,a+n)),ee[s][t].FECImageCB(ee[s][t].FECRgbDataBuffer,r,i,e),ee[s][t].FECRgbDataBuffer=null)};var le,_e=function(){function t(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,a,r){return a&&t(e.prototype,a),r&&t(e,r),e}}(),he=(le=void 0,function(t){return t&&(le=t),le}),ce=function(){function t(){if(function(t,e){if(!i(t,e))throw new TypeError("Cannot call a class as a function")}(this,t),he())return he();if(void 0!==t.unique)return t.unique;t.unique=this,this.oAudioContext=null,this.currentVolume=80,this.bSetVolume=!1,this.gainNode=null,this.iWndNum=-1,this.mVolumes=new Map;var e=window.AudioContext||window.webkitAudioContext;this.oAudioContext=new e,this.writeString=function(t,e,a){for(var r=0;r<a.length;r++)t.setUint8(e+r,a.charCodeAt(r))},this.setBufferToDataview=function(t,e,a){for(var r=0;r<a.length;r++,e++)t.setUint8(e,a[r])},he(this)}return _e(t,[{key:"Play",value:function(t,e,a){var r=new ArrayBuffer(44+e),i=new DataView(r),n=a.samplesPerSec,s=a.channels,x=a.bitsPerSample;this.writeString(i,0,"RIFF"),i.setUint32(4,32+2*e,!0),this.writeString(i,8,"WAVE"),this.writeString(i,12,"fmt "),i.setUint32(16,16,!0),i.setUint16(20,1,!0),i.setUint16(22,s,!0),i.setUint32(24,n,!0),i.setUint32(28,2*n,!0),i.setUint16(32,s*x/8,!0),i.setUint16(34,x,!0),this.writeString(i,36,"data"),i.setUint32(40,e,!0),this.setBufferToDataview(i,44,t);var o=this;return this.oAudioContext.decodeAudioData(i.buffer,(function(t){var e=o.oAudioContext.createBufferSource();if(null==e)return-1;e.buffer=t,e.start(0),(null==o.gainNode||o.bSetVolume)&&(o.gainNode=o.oAudioContext.createGain(),o.bSetVolume=!1),o.gainNode.gain.value=o.currentVolume/100,o.gainNode.connect(o.oAudioContext.destination),e.connect(o.gainNode)}),(function(t){return console.log("decode error"),-1})),0}},{key:"Stop",value:function(){return null!=this.gainNode&&(this.gainNode.disconnect(),this.gainNode=null),!0}},{key:"SetVolume",value:function(t){return this.bSetVolume=!0,this.currentVolume=t,this.mVolumes.set(this.iWndNum,this.currentVolume),!0}},{key:"SetWndNum",value:function(t){this.iWndNum=t;var e=this.mVolumes.get(t);return null==e&&(e=80),this.currentVolume=e,!0}},{key:"GetVolume",value:function(){var t=this.mVolumes.get(this.iWndNum);return null==t&&(t=80),t}}]),t}(),ue=16,de=31,pe=25,me=20480,Se={width:0,height:0,frameNum:0,yuvData:null},Re={width:0,height:0,frameNum:0,yuvData:null},Pe={sampleRate:0,channel:0,bitsPerSample:0,length:0,pcmData:null},ye={id:null,cmd:null,data:null,errorCode:0,status:null},be=function(){function a(e,r,i,n){if(t(this,a),this.jsplayer=e,null==r||void 0===r||"string"!=typeof r)return 0;if(this.szBasePath=r,!i||"function"!=typeof i)return 0;this.fnCallBack=i,this.decodeWorker=null,this.streamOpenMode=null,this.bOpenStream=!1,this.SystemFormat=-1,this.bFileHeadAudioFormat=!0,this.bHIKHeadValue=!0,this.audioRenderer=null,this.aAudioBuffer=[],this.iAudioBufferSize=0,this.Volume=0,this.oSuperRender=null,this.aVideoFrameBuffer=[],this.YUVBufferSize=1,this.szOSDTime=null,this.bJSPrintLog=window.g_printfFlag,this.bWriteYUVData=!1,this.iYUV10size=0,this.aVideoYUVBuffer=[],this.bWritePCMData=!1,this.iAudioBuffer500Size=0,this.aAudioPCMBuffer=[],this.bWriteRawData=!1,this.iRawDataSize=0,this.aRawDataBuffer=[],this.bWriteRTPData=!0,this.iRTPDataSize=0,this.aRTPDataBuffer=[],this.downloadRTP=!1,this.rtpNum=0,this.jpegDownloadFlag=!1,this.bmpDownloadFlag=!1,this.bPlaySound=!1,this.bPlay=!1,this.bPause=!1,this.bOnebyOne=!1,this.bPlayRateChange=!1,this.audioNum=0,this.videoNum=0,this.nCurStatus=2,this.FrameForwardLen=1,this.bOnlyPlaySound=!1,this.bVideoCropInfo=!1,this.dataCallBackFun=null,this.YUVBufSizeCBFun=null,this.DecCallBackFun=null,this.DisplayCallBackFun=null,this.PCMCallBackFun=null,this.DecInfoYUV=Se,this.DisplayInfoYUV=Re,this.DecInfoPCM=Pe,this.displayFrameInfo={},this.frameInfoFlag=!0,this.startTimeStamp=0,this.GetFileTimeCBFun=null,this.GetMpOffsetCBFun=null,this.nWidth=0,this.nHeight=0,this.nSPSCropLeft=0,this.nSPSCropRight=0,this.nSPSCropTop=0,this.nSPSCropBottom=0,this.decCBStream=0,this.sCanvasId=null,this.aDisplayBuf=null,this.bVisibility=!0,this.nDecFrameType=0,this.runtimeInfoCBFun=null,this.pstRuntimeInfo={nRunTimeModule:0,nStrVersion:0,nFrameTimeStamp:0,nFrameNum:0,nErrorCode:0,nInputDataInterval:0,nFrameNumInterval:0,nAverageDecodeTime:0,nSystemFormat:0,nDetectRes:0,nMp4FileTime:0,nMp4TotalFrameNum:0,AbsTimeYear:0,AbsTimeMonth:0,AbsTimeDay:0,AbsTimeHour:0,AbsTimeMinute:0,AbsTimeSecond:0,AbsTimeMilliseconds:0},this.firstRenderBegin=!0,this.firstFrameCB=null,this.needFirstFrameCB=!1,this.bstreamEnd=!1,this.nstreamEndloopNum=0,this.streamInfoCBFun=null,this.PostMpStreamOffsetCBFun=null,this.addtionCallBackFun=null,this.textCanvas=null,this.setTextCanvasFlag=!1,this.FECGetPortCB=null,this.FECViewParamCB=null,this.oInputTimer=null,this.nLastSourceTimeStamp=-1,this.nLastClockTimeStamp=-1,this.nGetTotalFrameNum=0,this.nAverageDecodeTime=0,this.oDecodeTimer=null,this.iCanvasWidth=0,this.iCanvasHeight=0,this.iZoomNum=0,this.iRatio_x=1,this.iRatio_y=1,this.stDisplayRect={top:0,left:0,right:0,bottom:0},this.bDisRect=!1,this.stYUVRect={top:0,left:0,right:0,bottom:0},this.nLostFrameFlag=1,this.nIgnoreHeaderAudioDefine=0,this.aInputDataLens=[],this.aInputDataBuffer=[],this.bIsGetYUV=!1,this.bIsFirstFrame=!0,this.iInputMaxBufSize=5242880,this.bIsInput=!1,this.bIsInputBufOver=!1,this.bIsInputBufWillOver=!1,this.iInputDataLen=me;var s=this;this.errorCode=1,this.loopNum=0,this.bJSPrintLog>=0&&console.info("%c1>there will play by V1","color: green"),this.needWaitMpOffset=!1,this.setCallBack=function(t,e,a,r,i){var s=ye;s.id=n,s.cmd=e,s.data=a,s.errorCode=r,s.status=i,t.errorCode=r,t.fnCallBack(s)},this.convertErrorCode=function(t){switch(t){case 1:return 1;case 98:return 0;default:return t}},this.arrayBufferCopy=function(t){var e=t.byteLength,a=new Uint8Array(e),r=new Uint8Array(t),i=0;for(i=0;i<e;i++)a[i]=r[i];return a},this.inputDataFun=function(){if(1==s.needWaitMpOffset)return 1;var t,e=0;if(s.bIsGetYUV=!1,s.bIsInputBufOver||s.bIsInputBufWillOver){t=new Uint8Array(1);var a={command:"InputData",data:new Uint8Array(t).buffer,dataSize:0};s.decodeWorker.postMessage(a,[a.data])}else if(s.bPlay&&(!s.bPause||s.bOnebyOne||6==s.nCurStatus)||this.bOnlyPlaySound){for(;s.aInputDataLens.length>0&&!((e+=s.aInputDataLens.shift())>s.iInputDataLen););t=s.aInputDataBuffer.splice(0,e);var r={command:"InputData",data:new Uint8Array(t).buffer,dataSize:e};s.decodeWorker.postMessage(r,[r.data])}t=null},this.getPic=function(t,e){if(null==this.decodeWorker||null==this.oSuperRender)return 2;if(!this.bPlay)return 2;if(!t||"function"!=typeof t)return 0;if(this.dataCallBackFun=t,0===this.iZoomNum)this.stYUVRect.left=0,this.stYUVRect.top=0,this.stYUVRect.right=0,this.stYUVRect.bottom=0;else{if(0===this.iCanvasWidth||0===this.iCanvasHeight)this.stYUVRect.left=0,this.stYUVRect.top=0,this.stYUVRect.right=0,this.stYUVRect.bottom=0;else{var a=this.nWidth/this.iCanvasWidth,r=this.nHeight/this.iCanvasHeight;this.stYUVRect.left=Math.round(this.stDisplayRect.left*a),this.stYUVRect.top=Math.round(this.stDisplayRect.top*r),this.stYUVRect.right=Math.round(this.stDisplayRect.right*a),this.stYUVRect.bottom=Math.round(this.stDisplayRect.bottom*r)}if(this.stYUVRect.right-this.stYUVRect.left<32||this.stYUVRect.bottom-this.stYUVRect.top<32)return 0}if(null==this.aDisplayBuf)return 2;var i={command:e,data:this.arrayBufferCopy(this.aDisplayBuf).buffer,width:this.nWidth,height:this.nHeight,rect:this.stYUVRect};return this.decodeWorker.postMessage(i,[i.data]),1},this.createWorker=function(t){if(window.Worker){if(null==t.decodeWorker){var e=new Blob([(r=t.szBasePath,"\n(function (event) {\n    const AUDIO_TYPE = 0;\t// 音频\n    const VIDEO_TYPE = 1;   // 视频\n    const PRIVT_TYPE = 2;  // 私有帧\n\n    const PLAYM4_AUDIO_FRAME = 100; // 音频帧\n    const PLAYM4_VIDEO_FRAME = 101; // 视频帧\n\n    const PLAYM4_OK = 1;\n    const PLAYM4_ORDER_ERROR = 2;\n    const PLAYM4_DECODE_ERROR = 44 \t// 解码失败\n    const PLAYM4_NOT_KEYFRAME = 48; \t// 非关键帧\n    const PLAYM4_NEED_MORE_DATA = 31;   // 需要更多数据才能解析\n    const PLAYM4_NEED_NEET_LOOP = 35; //丢帧需要下个循环\n    const PLAYM4_SYS_NOT_SUPPORT = 16; \t// 不支持\n\n    importScripts('".concat(r,'\');\n    Module.addOnPostRun(function () {\n        postMessage({ \'function\': "loaded" });\n    });\n\n    var iStreamMode = 0;  // 流模式\n\n    var bOpenMode = false;\n    var bOpenStream = false;\n\n    var funGetFrameData = null;\n    var funGetAudFrameData = null;\n\n    var bWorkerPrintLog = 0;//worker层log开关\n\n    var g_nPort = -1;\n    var pInputData = null;\n    var inputBufferSize = 40960;\n\n    const MP_RTINFO_SOURCE_DATA_INTERVAL = 0x40000;   ///<实时流送帧时间间隔\n    const MP_RTINFO_IDMX_RTP_HEADER_SEQ_ERROR = 0x400;///<RTP视频包序不连续 或PS帧号不连续\n\n    self.JSPlayM4_RunTimeInfoCallBack = function (nPort, pstRunTimeInfo, pUser) {\n        let port = nPort;\n        let user = pUser;\n        let runtimeInfo = {\n            nRunTimeModule: 0,\n            nStrVersion: 0,\n            nFrameTimeStamp: 0,\n            nFrameNum: 0,\n            nErrorCode: 0,\n            nInputDataInterval: 0,\n            nFrameNumInterval: 0\n        };\n        runtimeInfo.nRunTimeModule = Module.HEAP32[pstRunTimeInfo >> 2];\n        runtimeInfo.nStrVersion = Module.HEAP32[pstRunTimeInfo + 4 >> 2];\n        runtimeInfo.nFrameTimeStamp = Module.HEAP32[pstRunTimeInfo + 8 >> 2];\n        runtimeInfo.nFrameNum = Module.HEAP32[pstRunTimeInfo + 12 >> 2];\n        runtimeInfo.nErrorCode = Module.HEAP32[pstRunTimeInfo + 16 >> 2];\n        if (runtimeInfo.nErrorCode == MP_RTINFO_SOURCE_DATA_INTERVAL) {\n            let nTimeInterval = Module.HEAP32[pstRunTimeInfo + 20 >> 2]; //reserved[12]保留数组的前4字节 表示帧之间的送流延迟\n            runtimeInfo.nInputDataInterval = nTimeInterval; //送流间隔实时信息回调\n        }\n        if (runtimeInfo.nErrorCode == MP_RTINFO_IDMX_RTP_HEADER_SEQ_ERROR) {\n            let nFrameNumInterval = Module.HEAP32[pstRunTimeInfo + 20 >> 2]; //reserved[12]保留数组的前4字节 表示帧之间的送流延迟\n            runtimeInfo.nFrameNumInterval = nFrameNumInterval; //PS帧号不连续差值；RTP丢包为1\n        }\n        // console.log("nRunTimeModule:"+nRunTimeModule+",nFrameNum:"+nFrameNum+",nErrorCode:"+nErrorCode);\n        postMessage({ \'function\': "RunTimeInfoCallBack", \'runtimeInfo\': runtimeInfo});\n    }\n\tself.JSPlayM4_StreamInfoCallBack = function (nPort, pstStreamInfo, pUser)\n\t{\n\t\tlet port = nPort;\n        let user = pUser;\n        let nSystemformat = Module.HEAP16[pstStreamInfo >> 1]; //封装类型\n        let nVideoformat = Module.HEAP16[pstStreamInfo + 2 >> 1];//视频编码类型\n        let nAudioformat = Module.HEAP16[pstStreamInfo + 4 >> 1];//音频编码类型\n        let nAudiochannels = Module.HEAP16[pstStreamInfo + 6 >> 1]; //音频通道数\n        let nAudiobitspersample = Module.HEAP32[pstStreamInfo + 8 >> 2];//音频样位率\n        let nAudiosamplesrate = Module.HEAP32[pstStreamInfo + 12 >> 2];//音频采样率\n        let nAudiobitrate = Module.HEAP32[pstStreamInfo + 16 >> 2];//音频比特率,单位：bit\n\t\tlet nWidth = Module.HEAP32[pstStreamInfo + 20 >> 2];//视频宽\n        let nHeight = Module.HEAP32[pstStreamInfo + 24 >> 2];//视频高\n        let fFrameRate = Module.HEAPF32[pstStreamInfo + 28 >> 2];//视频帧率\n        let nIntervalOfIFrame = Module.HEAP32[pstStreamInfo + 32 >> 2];//视频GOP大小（统计最近5个GOP的平均大小）\n\t\t//console.log("nSystemformat:" + nSystemformat + ",nVideoformat:" + nVideoformat + ",nAudioformat:" + nAudioformat + ",nAudiochannels:" + nAudiochannels + ",nAudiobitspersample:" + nAudiobitspersample + ",nAudiosamplesrate:" + nAudiosamplesrate + ",nAudiobitrate:" + nAudiobitrate);\n        postMessage({ \'function\': "StreamInfoCallBack", \'nSystemformat\': nSystemformat, \'nVideoformat\': nVideoformat, \'nAudioformat\': nAudioformat, \'nAudiochannels\': nAudiochannels, \'nAudiobitspersample\': nAudiobitspersample, \'nAudiosamplesrate\': nAudiosamplesrate, \'nAudiobitrate\': nAudiobitrate\n        , \'nWidth\': nWidth, \'nHeight\': nHeight, \'fFrameRate\': fFrameRate, \'nIntervalOfIFrame\': nIntervalOfIFrame});\n    }\n    self.JSPlayM4_AdditionDataCBFun = function (port, addDataInfo, nUser) {\n        let dataType = Module.HEAP32[addDataInfo >> 2];\n        let dataStrVersion = Module.HEAP32[addDataInfo + 4 >> 2];\n        let dataTimeStamp = Module.HEAP32[addDataInfo + 8 >> 2];\n        let dataLength = Module.HEAP32[addDataInfo + 12 >> 2];\n        let pData = Module.HEAP32[addDataInfo + 16 >> 2];\n        let additionDataBuffer = new Uint8Array(dataLength);\n        additionDataBuffer.set(Module.HEAPU8.subarray(pData, pData + dataLength));\n        postMessage({ \'function\': "AdditionDataCallBack", \'dataType\': dataType, \'dataStrVersion\': dataStrVersion, \'dataTimeStamp\': dataTimeStamp, \'dataLength\': dataLength, \'pData\':pData,\'additionDataBuffer\': additionDataBuffer},[additionDataBuffer.buffer]);\n      }\n    self.JSPlayM4_PostMpStreamOffsetCallBack = function (nPort, pstPostMpStreamOffsetInfo, pUser)\n\t{\n\t\tlet port = nPort;\n        let user = pUser;\n        let nStreamOffset = Module.HEAP32[pstPostMpStreamOffsetInfo >> 2];\n\t\tpostMessage({ \'function\': "PostMpStreamOffsetCallBack", \'nStreamOffset\': nStreamOffset});\n    }\n\n    onmessage = function (event) {\n        var eventData = event.data;\n        var res = 0;\n        switch (eventData.command) {\n            case "printLog":\n                let downloadFlag = eventData.data;\n                bWorkerPrintLog = downloadFlag;\n                res = Module._SetPrintLogFlag(g_nPort, downloadFlag);\n                if (res !== PLAYM4_OK) {\n                    if(bWorkerPrintLog >= 0 ){\n                        console.log("DecodeWorker.js: PlayerSDK print log failed,res" + res);\n                    }\n                    postMessage({ \'function\': "printLog", \'errorCode\': res });\n                }\n                break;\n            case "SetPlayPosition":\n                let nFrameNumOrTime = eventData.data;\n                let enPosType = eventData.type;\n                // res = Module._SetPlayPosition(nFrameNumOrTime,enPosType);\n                // if (res !== PLAYM4_OK)\n                // {\n                //     postMessage({\'function\': "SetPlayPosition", \'errorCode\': res});\n                //     return;\n                // }\n                // //有没有buffer需要清除\n\n                break;\n            case "SetStreamOpenMode":\n                //获取版本信息\n                let version = Module._GetSDKVersion();\n                let buildDate = Module._GetBuildDate();\n                console.log("%cV1Decoder.js version:" + version.toString(16) + ",buildDate:" + buildDate.toString(16), \'color: blue\');\n                //获取端口号\n                g_nPort = Module._GetPort();\n                //设置流打开模式\n                iStreamMode = eventData.data;\n                res = Module._SetStreamOpenMode(g_nPort, iStreamMode);\n                if (res !== PLAYM4_OK) {\n                    postMessage({ \'function\': "SetStreamOpenMode", \'errorCode\': res });\n                    return;\n                }\n                bOpenMode = true;\n                break;\n\n            case "OpenStream":\n                // 接收到的数据\n                var iHeadLen = eventData.dataSize;\n                var pHead = Module._malloc(iHeadLen + 4);\n                if (pHead === null) {\n                    return;\n                }\n                var aHead = Module.HEAPU8.subarray(pHead, pHead + iHeadLen);\n                aHead.set(new Uint8Array(eventData.data));\n                res = Module._OpenStream(g_nPort, pHead, iHeadLen, eventData.bufPoolSize);\n                postMessage({ \'function\': "OpenStream", \'errorCode\': res });\n                if (res !== PLAYM4_OK) {\n                    //释放内存\n                    Module._free(pHead);\n                    pHead = null;\n                    return;\n                }\n                bOpenStream = true;\n                break;\n            case "Play":\n                let resP = Module._Play(g_nPort);\n                if (resP !== PLAYM4_OK) {\n                    return;\n                }\n                break;\n            case "InputData":\n                // 接收到的数据\n                var iLen = eventData.dataSize;\n                if (iLen > 0) {\n                    if (pInputData == null || iLen > inputBufferSize) {\n                        if (pInputData != null) {\n                            Module._free(pInputData);\n                            pInputData = null;\n                        }\n                        if (iLen > inputBufferSize) {\n                            inputBufferSize = iLen;\n                        }\n\n                        pInputData = Module._malloc(inputBufferSize);\n                        if (pInputData === null) {\n                            return;\n                        }\n                    }\n\n                    var inputData = new Uint8Array(eventData.data);\n                    // var aInputData = Module.HEAPU8.subarray(pInputData, pInputData + iLen);\n                    // aInputData.set(inputData);\n                    Module.writeArrayToMemory(inputData, pInputData);\n                    inputData = null;\n                    res = Module._InputData(g_nPort, pInputData, iLen);\n                    if (res !== PLAYM4_OK) {\n                        let errorCode = Module._GetLastError(g_nPort);\n                        let sourceRemain = Module._GetSourceBufferRemain(g_nPort);\n                        postMessage({ \'function\': "InputData", \'errorCode\': errorCode, "sourceRemain": sourceRemain });\n                    }\n                    //Module._free(pInputData);\n                    //pInputData = null;\n                } else {\n                    let sourceRemain = Module._GetSourceBufferRemain(g_nPort);\n                    if (sourceRemain == 0) {\n                        postMessage({ \'function\': "InputData", \'errorCode\': PLAYM4_NEED_MORE_DATA });\n                        return;\n                    }\n                }\n\n                /////////////////////\n                // if (funGetFrameData === null) {\n                //     funGetFrameData = Module.cwrap(\'GetFrameData\', \'number\');\n                // }\n\n                while (bOpenMode && bOpenStream) {\n\n                    var ret = getFrameData();\n                    // 直到获取视频帧或数据不足为止\n                    if (PLAYM4_VIDEO_FRAME === ret || PLAYM4_NEED_MORE_DATA === ret || PLAYM4_ORDER_ERROR === ret)//PLAYM4_VIDEO_FRAME === ret ||  || PLAYM4_NEED_NEET_LOOP === ret\n                    {\n                        break;\n                    }\n                }\n                break;\n\n            case "SetSecretKey":\n                var keyLen = eventData.nKeyLen;\n                var pKeyData = Module._malloc(keyLen);\n                if (pKeyData === null) {\n                    return;\n                }\n                var nKeySize = eventData.data.length\n                var bufData = stringToBytes(eventData.data);\n                var aKeyData = Module.HEAPU8.subarray(pKeyData, pKeyData + keyLen);\n                let u8array = new Uint8Array(keyLen);\n                aKeyData.set(u8array, 0);\n                aKeyData.set(new Uint8Array(bufData));\n                aKeyData = null;\n                u8array = null;\n\n                res = Module._SetSecretKey(g_nPort, eventData.nKeyType, pKeyData, keyLen);//, nKeySize\n                if (res !== PLAYM4_OK) {\n                    postMessage({ \'function\': "SetSecretKey", \'errorCode\': res });\n                    Module._free(pKeyData);\n                    pKeyData = null;\n                    return;\n                }\n\n                Module._free(pKeyData);\n                pKeyData = null;\n                break;\n\n            case "GetBMP":\n                var nBMPWidth = eventData.width;\n                var nBMPHeight = eventData.height;\n                var pYUVData = eventData.data;\n                var nYUVSize = nBMPWidth * nBMPHeight * 3 / 2;\n                var oBMPCropRect = eventData.rect;\n\n                var pDataYUV = Module._malloc(nYUVSize);\n                if (pDataYUV === null) {\n                    return;\n                }\n\n                Module.writeArrayToMemory(new Uint8Array(pYUVData, 0, nYUVSize), pDataYUV);\n\n                // 分配BMP空间\n                var nBmpSize = nBMPWidth * nBMPHeight * 4 + 60;\n                var pBmpData = Module._malloc(nBmpSize);\n                var pBmpSize = Module._malloc(4);\n                if (pBmpData === null || pBmpSize === null) {\n                    Module._free(pDataYUV);\n                    pDataYUV = null;\n\n                    if (pBmpData != null) {\n                        Module._free(pBmpData);\n                        pBmpData = null;\n                    }\n\n                    if (pBmpSize != null) {\n                        Module._free(pBmpSize);\n                        pBmpSize = null;\n                    }\n                    return;\n                }\n\n                //Module._memset(pBmpSize, nBmpSize, 4); // 防止bmp截图出现输入数据过大的错误码\n                Module.setValue(pBmpSize, nBmpSize, "i32");\n                res = Module._GetBMP(g_nPort, pDataYUV, nYUVSize, pBmpData, pBmpSize,\n                    oBMPCropRect.left, oBMPCropRect.top, oBMPCropRect.right, oBMPCropRect.bottom);\n                if (res !== PLAYM4_OK) {\n                    postMessage({ \'function\': "GetBMP", \'errorCode\': res });\n                    Module._free(pDataYUV);\n                    pDataYUV = null;\n                    Module._free(pBmpData);\n                    pBmpData = null;\n                    Module._free(pBmpSize);\n                    pBmpSize = null;\n                    return;\n                }\n\n                // 获取BMP图片大小\n                var nBmpDataSize = Module.getValue(pBmpSize, "i32");\n\n                // 获取BMP图片数据\n                var aBmpData = new Uint8Array(nBmpDataSize);\n                aBmpData.set(Module.HEAPU8.subarray(pBmpData, pBmpData + nBmpDataSize));\n\n                postMessage({ \'function\': "GetBMP", \'data\': aBmpData, \'errorCode\': res }, [aBmpData.buffer]);\n                aBmpData = null;\n                if (pDataYUV != null) {\n                    Module._free(pDataYUV);\n                    pDataYUV = null;\n                }\n                if (pBmpData != null) {\n                    Module._free(pBmpData);\n                    pBmpData = null;\n                }\n                if (pBmpSize != null) {\n                    Module._free(pBmpSize);\n                    pBmpSize = null;\n                }\n                break;\n\n            case "GetJPEG":\n                var nJpegWidth = eventData.width;\n                var nJpegHeight = eventData.height;\n                var pYUVData1 = eventData.data;\n                var nYUVSize1 = nJpegWidth * nJpegHeight * 3 / 2;\n                var oJpegCropRect = eventData.rect;\n\n                var pDataYUV1 = Module._malloc(nYUVSize1);\n                if (pDataYUV1 === null) {\n                    return;\n                }\n\n                Module.writeArrayToMemory(new Uint8Array(pYUVData1, 0, nYUVSize1), pDataYUV1);\n\n                // 分配JPEG空间\n                var pJpegData = Module._malloc(nYUVSize1);\n                var pJpegSize = Module._malloc(4);\n                if (pJpegData === null || pJpegSize === null) {\n                    if (pJpegData != null) {\n                        Module._free(pJpegData);\n                        pJpegData = null;\n                    }\n\n                    if (pJpegSize != null) {\n                        Module._free(pJpegSize);\n                        pJpegSize = null;\n                    }\n\n                    if (pDataYUV1 != null) {\n                        Module._free(pDataYUV1);\n                        pDataYUV1 = null;\n                    }\n                    return;\n                }\n\n                Module.setValue(pJpegSize, nJpegWidth * nJpegHeight * 2, "i32");    // JPEG抓图，输入缓冲长度不小于当前帧YUV大小\n\n                res = Module._GetJPEG(g_nPort, pDataYUV1, nYUVSize1, pJpegData, pJpegSize,\n                    oJpegCropRect.left, oJpegCropRect.top, oJpegCropRect.right, oJpegCropRect.bottom);\n                if (res !== PLAYM4_OK) {\n                    postMessage({ \'function\': "GetJPEG", \'errorCode\': res });\n                    if (pJpegData != null) {\n                        Module._free(pJpegData);\n                        pJpegData = null;\n                    }\n\n                    if (pJpegSize != null) {\n                        Module._free(pJpegSize);\n                        pJpegSize = null;\n                    }\n\n                    if (pDataYUV1 != null) {\n                        Module._free(pDataYUV1);\n                        pDataYUV1 = null;\n                    }\n                    return;\n                }\n\n                // 获取JPEG图片大小\n                var nJpegSize = Module.getValue(pJpegSize, "i32");\n\n                // 获取JPEG图片数据\n                var aJpegData = new Uint8Array(nJpegSize);\n                aJpegData.set(Module.HEAPU8.subarray(pJpegData, pJpegData + nJpegSize));\n\n                postMessage({ \'function\': "GetJPEG", \'data\': aJpegData, \'errorCode\': res }, [aJpegData.buffer]);\n\n                nJpegSize = null;\n                aJpegData = null;\n\n                if (pDataYUV1 != null) {\n                    Module._free(pDataYUV1);\n                    pDataYUV1 = null;\n                }\n                if (pJpegData != null) {\n                    Module._free(pJpegData);\n                    pJpegData = null;\n                }\n                if (pJpegSize != null) {\n                    Module._free(pJpegSize);\n                    pJpegSize = null;\n                }\n                break;\n\n            case "SetDecodeFrameType":\n                var nFrameType = eventData.data;\n                res = Module._SetDecodeFrameType(g_nPort, nFrameType);\n                if (res !== PLAYM4_OK) {\n                    postMessage({ \'function\': "SetDecodeFrameType", \'errorCode\': res });\n                    return;\n                }\n                break;\n            case "CloseStream":\n                //stop\n                let resS = Module._Stop(g_nPort);\n                if (resS !== PLAYM4_OK) {\n                    postMessage({ \'function\': "Stop", \'errorCode\': res });\n                    return;\n                }\n                //closeStream\n                res = Module._CloseStream(g_nPort);\n                if (res !== PLAYM4_OK) {\n                    postMessage({ \'function\': "CloseStream", \'errorCode\': res });\n                    return;\n                }\n                //freePort\n                let resF = Module._FreePort(g_nPort);\n                if (resF !== PLAYM4_OK) {\n                    postMessage({ \'function\': "FreePort", \'errorCode\': res });\n                    return;\n                }\n                if (pInputData != null) {\n                    Module._free(pInputData);\n                    pInputData = null;\n                }\n                break;\n            case "PlaySound":\n                let resPS = Module._PlaySound(g_nPort);\n                if (resPS !== PLAYM4_OK) {\n                    console.log("PlaySound failed");\n                    return;\n                }\n                break;\n            case "StopSound":\n                let resSS = Module._StopSound();\n                if (resSS !== PLAYM4_OK) {\n                    console.log("StopSound failed");\n                    return;\n                }\n                break;\n            case "SetVolume":\n                let resSV = Module._SetVolume(g_nPort, eventData.volume);\n                if (resSV !== PLAYM4_OK) {\n                    console.log("Audio SetVolume failed");\n                    return;\n                }\n                break;\n            case "GetVolume":\n                let volume = Module._GetVolume();\n                if (volume > 0) {\n                    postMessage({ \'function\': "GetVolume", \'volume\': volume });\n                }\n                else {\n                    console.log("Audio GetVolume failed");\n                    return;\n                }\n                break;\n            case "OnlyPlaySound":\n                let resOPS = Module._OnlyPlaySound(g_nPort);\n                if (resOPS !== PLAYM4_OK) {\n                    console.log("OnlyPlaySound failed");\n                    return;\n                }\n                break;\n            case "Pause":\n                let resPa = Module._Pause(g_nPort, eventData.bPlay);\n                if (resPa !== PLAYM4_OK) {\n                    console.log("Pause failed");\n                    return;\n                }\n            case "PlayRate":\n                Module._SetPlayRate(g_nPort, eventData.playRate);\n                break;\n            case "SetIFrameDecInterval":\n                Module._SetIFrameDecInterval(g_nPort, eventData.data);\n                break;\n            case "SetLostFrameMode":\n                Module._SetLostFrameMode(g_nPort, eventData.data, 0);\n                break;\n            case "SetDemuxModel":\n                let resSDM = Module._SetDemuxModel(g_nPort, eventData.nIdemuxType, eventData.bTrue);\n                break;\n            case "SkipErrorData":\n                Module._SkipErrorData(g_nPort, eventData.bSkip);\n                break;\n            case "SetDecodeERC":\n                Module._SetDecodeERC(g_nPort, eventData.nLevel);\n                break;\n            case "SetANRParam":\n                Module._SetANRParam(g_nPort, eventData.nEnable, eventData.nANRLevel);\n                break;\n            case "SetResampleValue":\n                Module._SetResampleValue(g_nPort, eventData.nEnable, eventData.resampleValue);\n                break;\n            case "GetLastError":\n                let errorCode = Module._GetLastError(g_nPort);\n                postMessage({ \'function\': "GetLastError", \'errorCode\': errorCode });\n                break;\n            case "SetGlobalBaseTime":\n                Module._SetGlobalBaseTime(g_nPort, eventData.year, eventData.month, eventData.day, eventData.hour, eventData.min, eventData.sec, eventData.ms);\n                break;\n            case "SetRunTimeInfoCB":\n                Module._SetRunTimeInfoCallBackEx(g_nPort, eventData.nModuleType, 0);\n                break;\n\t\t\tcase "SetStreamInfoCB":\n                Module._SetStreamInfoCallBack(g_nPort, eventData.nType, 0);\n                break;\n\t\t\tcase "GetFileTime":\n                let FileTime = Module._JSPlayM4_GetFileTime(g_nPort);\n\t\t\t\tpostMessage({ \'function\': "GetFileTime", \'FileTime\': FileTime });\n                break;\n\t\t\tcase "GetMpOffset":\n                let Offset = Module._JSPlayM4_GetMpOffset(g_nPort,eventData.FrameTime);\n\t\t\t\tpostMessage({ \'function\': "GetMpOffset", \'Offset\': Offset });\n                break;\n\t\t\tcase "ResetBuffer":\n                Module._JSPlayM4_ResetBuffer(g_nPort, eventData.type);\n                break;\n            case "SetAdditionDataCallBack":\n                Module._SetAdditionDataCallBack(g_nPort,eventData.additionDataType,eventData.nFlag,0);\n                break;\n            case "SetRunTimeInfoCallbackType":\n                Module._SetRunTimeInfoCallbackType(g_nPort,eventData.module,eventData.Type,eventData.Flag);\n                break;\n            case "SetPostMpStreamOffsetCB":\n                Module._SetPostMpStreamOffsetCallBack(g_nPort, 0);\n                break;\n            default:\n                break;\n        }\n    };\n\n    function getOSDTime(oFrameInfo) {\n        var iYear = oFrameInfo.year;\n        var iMonth = oFrameInfo.month;\n        var iDay = oFrameInfo.day;\n        var iHour = oFrameInfo.hour;\n        var iMinute = oFrameInfo.minute;\n        var iSecond = oFrameInfo.second;\n        var iMiSecond = oFrameInfo.misecond\n\n        if (iMonth < 10) {\n            iMonth = "0" + iMonth;\n        }\n        if (iDay < 10) {\n            iDay = "0" + iDay;\n        }\n        if (iHour < 10) {\n            iHour = "0" + iHour;\n        }\n        if (iMinute < 10) {\n            iMinute = "0" + iMinute;\n        }\n        if (iSecond < 10) {\n            iSecond = "0" + iSecond;\n        }\n        let osdTime = {};\n\n        osdTime.year = iYear;\n        osdTime.month = iMonth;\n        osdTime.week = 0;\n        osdTime.day = iDay;\n        osdTime.hour = iHour;\n        osdTime.minute = iMinute;\n        osdTime.second = iSecond;\n        osdTime.milliseconds = iMiSecond;\n        return osdTime;\n        //return iYear + "-" + iMonth + "-" + iDay + " " + iHour + ":" + iMinute + ":" + iSecond;\n    }\n    // 获取帧数据\n    function getFrameData() {\n        // function getFrameData() {\n        // 获取帧数据\n        var res = Module._GetFrameData();\n        //var res = fun();\n        if (res === PLAYM4_OK) {\n            var iFrameInfo = Module._GetFrameInfo();\n            let oFrameInfo = {};\n            oFrameInfo.frameType = Module.HEAP32[iFrameInfo >> 2];\n            oFrameInfo.frameSize = Module.HEAP32[iFrameInfo + 4 >> 2];\n            oFrameInfo.width = Module.HEAP32[iFrameInfo + 8 >> 2];\n            oFrameInfo.height = Module.HEAP32[iFrameInfo + 12 >> 2];\n            oFrameInfo.timeStamp = Module.HEAP32[iFrameInfo + 16 >> 2];\n            oFrameInfo.frameRate = Module.HEAP32[iFrameInfo + 20 >> 2];\n            oFrameInfo.bitsPerSample = Module.HEAP32[iFrameInfo + 24 >> 2];\n            oFrameInfo.samplesPerSec = Module.HEAP32[iFrameInfo + 28 >> 2];\n            oFrameInfo.channels = Module.HEAP32[iFrameInfo + 32 >> 2];\n            oFrameInfo.frameNum = Module.HEAP32[iFrameInfo + 36 >> 2];\n\n            oFrameInfo.cropLeft = Module.HEAP32[iFrameInfo + 40 >> 2];\n            oFrameInfo.cropRight = Module.HEAP32[iFrameInfo + 44 >> 2];\n            oFrameInfo.cropTop = Module.HEAP32[iFrameInfo + 48 >> 2];\n            oFrameInfo.cropBottom = Module.HEAP32[iFrameInfo + 52 >> 2];\n\t\t\toFrameInfo.relframeNum = Module.HEAP32[iFrameInfo + 56 >> 2];\n\t\t\toFrameInfo.relframeTime = Module.HEAP32[iFrameInfo + 60 >> 2];\n\n            oFrameInfo.year = Module.HEAP16[iFrameInfo + 64 >> 1];\n            oFrameInfo.month = Module.HEAP16[iFrameInfo + 66 >> 1];\n            oFrameInfo.day = Module.HEAP16[iFrameInfo + 68 >> 1];\n            oFrameInfo.hour = Module.HEAP16[iFrameInfo + 70 >> 1];\n            oFrameInfo.minute = Module.HEAP16[iFrameInfo + 72 >> 1];\n            oFrameInfo.second = Module.HEAP16[iFrameInfo + 74 >> 1];\n            oFrameInfo.misecond = Module.HEAP16[iFrameInfo + 76 >> 1];\n            switch (oFrameInfo.frameType) {\n                case AUDIO_TYPE:\n                    var iSize = oFrameInfo.frameSize;\n                    if (0 === iSize) {\n                        return -1;\n                    }\n                    var pPCM = Module._GetFrameBuffer();\n                    // var audioBuf = new ArrayBuffer(iSize);\n                    var aPCMData = new Uint8Array(iSize);\n                    aPCMData.set(Module.HEAPU8.subarray(pPCM, pPCM + iSize));\n                    if (bWorkerPrintLog > 0 ) {\n                        console.log("<<<Worker: audio media Info: nSise:" + oFrameInfo.frameSize + ",nSampleRate:" + oFrameInfo.samplesPerSec + \',channel:\' + oFrameInfo.channels + \',bitsPerSample:\' + oFrameInfo.bitsPerSample);\n                    }\n                    postMessage({\n                        \'function\': "GetFrameData", \'type\': "audioType", \'data\': aPCMData.buffer,\n                        \'frameInfo\': oFrameInfo, \'errorCode\': res\n                    }, [aPCMData.buffer]);\n\n                    oFrameInfo = null;\n                    pPCM = null;\n                    aPCMData = null;\n                    return PLAYM4_AUDIO_FRAME;\n\n                case VIDEO_TYPE:\n                    var szOSDTime = getOSDTime(oFrameInfo);\n\n                    var iWidth = oFrameInfo.width;\n                    var iHeight = oFrameInfo.height;\n\n                    var iYUVSize = iWidth * iHeight * 3 / 2;\n                    if (0 === iYUVSize) {\n                        return -1;\n                    }\n\n                    var pYUV = Module._GetFrameBuffer();\n\n                    // 图像数据渲染后压回，若从主码流切到子码流，存在数组大小与图像大小不匹配现象\n                    var aYUVData = new Uint8Array(iYUVSize);\n                    aYUVData.set(Module.HEAPU8.subarray(pYUV, pYUV + iYUVSize));\n                    if (bWorkerPrintLog > 0) {\n                        console.log("<<<Worker: video media Info: Width:" + oFrameInfo.width + ",Height:" + oFrameInfo.height + ",timeStamp:" + oFrameInfo.timeStamp);\n                    }\n\n                    postMessage({\n                        \'function\': "GetFrameData", \'type\': "videoType", \'data\': aYUVData.buffer,\n                        \'dataLen\': aYUVData.length, \'osd\': szOSDTime, \'frameInfo\': oFrameInfo, \'errorCode\': res\n                    }, [aYUVData.buffer]);\n\n                    oFrameInfo = null;\n                    pYUV = null;\n                    aYUVData = null;\n                    return PLAYM4_VIDEO_FRAME;\n\n                case PRIVT_TYPE:\n                    postMessage({\n                        \'function\': "GetFrameData", \'type\': "", \'data\': null,\n                        \'dataLen\': -1, \'osd\': 0, \'frameInfo\': null, \'errorCode\': PLAYM4_SYS_NOT_SUPPORT\n                    });\n                    return PLAYM4_SYS_NOT_SUPPORT;\n\n                default:\n                    postMessage({\n                        \'function\': "GetFrameData", \'type\': "", \'data\': null,\n                        \'dataLen\': -1, \'osd\': 0, \'frameInfo\': null, \'errorCode\': PLAYM4_SYS_NOT_SUPPORT\n                    });\n                    return PLAYM4_SYS_NOT_SUPPORT;\n            }\n        }\n        else {\n            let errorCode = Module._GetLastError(g_nPort);\n            //解码失败返回裸数据\n            if (PLAYM4_DECODE_ERROR === errorCode) {\n                var rawInfo = Module._GetRawDataInfo();\n                var pRawData = Module._GetRawDataBuffer();\n                var aRawData = new Uint8Array(rawInfo.isize);\n                aRawData.set(Module.HEAPU8.subarray(pRawData, pRawData + rawInfo.isize));\n                postMessage({\n                    \'function\': "GetRawData", \'type\': "", \'data\': aRawData.buffer,\n                    \'rawDataLen\': rawInfo.isize, \'osd\': 0, \'frameInfo\': null, \'errorCode\': errorCode\n                });\n                rawInfo = null;\n                pRawData = null;\n                aRawData = null;\n            }\n            //需要更多数据\n            if (PLAYM4_NEED_MORE_DATA === errorCode || PLAYM4_SYS_NOT_SUPPORT === errorCode || PLAYM4_NEED_NEET_LOOP === errorCode) {\n                postMessage({\n                    \'function\': "GetFrameData", \'type\': "", \'data\': null,\n                    \'dataLen\': -1, \'osd\': 0, \'frameInfo\': null, \'errorCode\': errorCode\n                });\n            }\n            return errorCode;\n        }\n    }\n\n    // 开始计算时间\n    function startTime() {\n        return new Date().getTime();\n    }\n\n    // 结束计算时间\n    function endTime() {\n        return new Date().getTime();\n    }\n\n    // 字母字符串转byte数组\n    function stringToBytes(str) {\n        var ch, st, re = [];\n        for (var i = 0; i < str.length; i++) {\n            ch = str.charCodeAt(i);  // get char\n            st = [];                 // set up "stack"\n            do {\n                st.push(ch & 0xFF);  // push byte to stack\n                ch = ch >> 8;          // shift value down by 1 byte\n            }\n            while (ch);\n            // add stack contents to result\n            // done because chars have "wrong" endianness\n            re = re.concat(st.reverse());\n        }\n        // return an array of bytes\n        return re;\n    }\n})();\n'))]),a=URL.createObjectURL(e);if(this.decodeWorker=new Worker(a),t.bJSPrintLog>0&&console.log(">>>JSPlayV1.1 createWorker success!"),null==t.decodeWorker)return 60}t.decodeWorker.onmessage=function(e){var a=null,r=e.data;switch(t.errorCode=r.errorCode,r.function){case"printLog":t.bJSPrintLog>=0&&console.log("print JSPlayerSDK log failed");break;case"loaded":a="loaded",t.decodeWorker.postMessage({command:"printLog",data:t.bJSPrintLog}),t.bJSPrintLog>=0&&console.log("V1 Decoder.js loaded path:"+t.szBasePath),t.setCallBack(t,"loaded",0,0,!0);break;case"SetStreamOpenMode":a="SetStreamOpenMode";break;case"OpenStream":if(a="OpenStream",1===r.errorCode)return s.bOpenStream=!0,void(s.nCurStatus=1);break;case"InputData":a="InputData",11===r.errorCode&&(s.bIsInputBufOver=!0,t.bJSPrintLog>=0&&console.log("yff inputBuffer over set key frame \n"),1!=s.nDecFrameType&&s.PlayM4_SetDecodeFrameType(1)),36===r.errorCode&&(s.bIsInputBufWillOver=!0),r.errorCode===de&&(s.bIsInputBufOver=!1,s.bIsInputBufWillOver=!1,s.aInputDataLens.length>0&&s.bIsInput?(s.inputDataFun(),s.bIsInput=!1):s.bIsGetYUV=!0);break;case"GetFrameData":if(a="GetFrameData",!s.bOnlyPlaySound){if(null!=r.data&&null!=r.frameInfo&&(r.frameInfo.width,r.frameInfo.height),!s.bPlay)return;if(s.errorCode=r.errorCode,!(s.bIsFirstFrame||r.errorCode!==de&&35!==r.errorCode)){r.errorCode===de&&(s.bIsInputBufOver=!1,s.bIsInputBufWillOver=!1),s.loopNum>5?(s.bIsGetYUV=!0,s.loopNum=0):(s.inputDataFun(),s.loopNum++);break}s.bIsInputBufOver||s.bIsInputBufWillOver?s.inputDataFun():"videoType"===r.type&&(s.aInputDataLens.length>0&&s.bIsInput?(s.inputDataFun(),s.bIsInput=!1):s.bIsGetYUV=!0,s.bIsFirstFrame=!1)}if(s.bVisibility&&1===r.errorCode)switch(r.type){case"videoType":if(null==r.data||null==r.frameInfo)return 0;null!=s.DecCallBackFun&&(s.DecInfoYUV.port=0,s.DecInfoYUV.iDataType=3,s.DecInfoYUV.height=r.frameInfo.height,s.DecInfoYUV.width=r.frameInfo.width,s.DecInfoYUV.isize=r.frameInfo.width*r.frameInfo.height*3/2,s.DecInfoYUV.Data=new Uint8Array(r.data),s.DecCallBackFun(s.DecInfoYUV)),s.bIsFirstFrame=!1,t.nWidth=r.frameInfo.width,t.nHeight=r.frameInfo.height,t.nSPSCropLeft=r.frameInfo.cropLeft,t.nSPSCropRight=r.frameInfo.cropRight,t.nSPSCropTop=r.frameInfo.cropTop,t.nSPSCropBottom=r.frameInfo.cropBottom,t.timeStamp=r.frameInfo.timeStamp;var i=new Object;if(i.data=r.data,i.osdTime=r.frameInfo,i.nWidth=r.frameInfo.width,i.nHeight=r.frameInfo.height,i.frameNum=r.frameInfo.frameNum,i.timeStamp=r.frameInfo.timeStamp,i.relframeNum=r.frameInfo.relframeNum,i.relframeTime=r.frameInfo.relframeTime,t.jsplayer.DecodeTypeFlagMap.size>0){var n,x=A(t.jsplayer.DecodeTypeFlagMap.keys());try{for(x.s();!(n=x.n()).done;){var o=n.value;if(o&tt&&1==t.jsplayer.DecodeTypeFlagMap.get(o)&&null!=t.runtimeInfoCBFun&&null!=t.oDecodeTimer){var f=t.oDecodeTimer.GetTimerWalk();f<=0||f>1e7||t.nGetTotalFrameNum>1e5?(t.nGetTotalFrameNum=0,t.oDecodeTimer.Init()):(t.nGetTotalFrameNum++,t.nAverageDecodeTime=f/t.nGetTotalFrameNum,null!=t.runtimeInfoCBFun&&(t.pstRuntimeInfo.nRunTimeModule=2,t.pstRuntimeInfo.nStrVersion=1,t.pstRuntimeInfo.nFrameTimeStamp=i.timeStamp,t.pstRuntimeInfo.nFrameNum=i.frameNum,t.pstRuntimeInfo.nErrorCode=tt,t.pstRuntimeInfo.nInputDataInterval=0,t.pstRuntimeInfo.nFrameNumInterval=0,t.pstRuntimeInfo.nAverageDecodeTime=t.nAverageDecodeTime,t.runtimeInfoCBFun(t.pstRuntimeInfo)))}}}catch(t){x.e(t)}finally{x.f()}}if(t.bWriteYUVData){for(var l=new Uint8Array(r.data),_=t.aVideoYUVBuffer.length,h=0,c=l.length;h<c;h++)t.aVideoYUVBuffer[_+h]=l[h];t.iYUV10size++,l=null}if(t.bWriteYUVData&&t.iYUV10size>=20){var u=new Uint8Array(t.aVideoYUVBuffer);t.downloadFile(u,"videoYUV.data"),t.aVideoYUVBuffer.splice(0,t.aVideoYUVBuffer.length),t.bWriteYUVData=!1,t.iYUV10size=0,u=null}if(t.aVideoFrameBuffer.push(i),i=null,t.aVideoFrameBuffer.length>5&&(t.bOnebyOne||6==t.nCurStatus||t.aVideoFrameBuffer.splice(0,2)),(t.bOnebyOne||6==t.nCurStatus)&&(t.aVideoFrameBuffer.length>=15||t.aInputDataBuffer.length>=.8*t.iInputMaxBufSize)){t.setCallBack(t,"OnebyOne",0,0,!1),t.bIsFirstFrame=!0;break}break;case"audioType":if(0==t.bHIKHeadValue&&(t.bFileHeadAudioFormat=!0),t.bPlaySound&&!t.bPlayRateChange||s.bOnlyPlaySound){null!=s.PCMCallBackFun&&(s.DecInfoPCM.port=0,s.DecInfoPCM.SampleRate=r.frameInfo.samplesPerSec,s.DecInfoPCM.channel=r.frameInfo.channels,s.DecInfoPCM.bitsPerSample=r.frameInfo.bitsPerSample,s.DecInfoPCM.iDataType=101,s.DecInfoPCM.Data=new Uint8Array(r.data),s.DecInfoPCM.isize=s.DecInfoPCM.Data.length,s.PCMCallBackFun(s.DecInfoPCM));for(var d=new Uint8Array(r.data),p=t.aAudioBuffer.length,m=0,S=d.length;m<S;m++)t.aAudioBuffer[p+m]=d[m];if(t.iAudioBufferSize++,d=null,t.bWritePCMData){for(var R=new Uint8Array(r.data),P=t.aAudioPCMBuffer.length,y=0,b=R.length;y<b;y++)t.aAudioPCMBuffer[P+y]=R[y];t.bJSPrintLog>=0&&console.log("audio_type num:"+t.iAudioBuffer500Size+", len:"+R.length),t.iAudioBuffer500Size++,R=null}if(t.bWritePCMData&&t.iAudioBuffer500Size>=100){var E=new Uint8Array(t.aAudioPCMBuffer);t.downloadFile(E,"audioPCM.data"),t.aAudioPCMBuffer.splice(0,t.aAudioPCMBuffer.length),t.bWritePCMData=!1,t.iAudioBuffer500Size=0,E=null}t.iAudioBufferSize>=pe&&(t.audioRenderer.Play(t.aAudioBuffer,t.aAudioBuffer.length,r.frameInfo),t.aAudioBuffer.splice(0,t.aAudioBuffer.length),t.aAudioBuffer.length=0,t.iAudioBufferSize=0)}}break;case"GetRawData":if(a="GetRawData",t.bWriteRawData){for(var g=new Uint8Array(r.data),F=t.aRawDataBuffer.length,C=0,v=g.length;C<v;C++)t.aRawDataBuffer[F+C]=g[C];t.iRawDataSize++,g=null}if(t.bWriteRawData&&t.iRawDataSize>=100){var T=new Uint8Array(t.aRawDataBuffer);t.downloadFile(T,"rawBuffer.data"),t.aRawDataBuffer.splice(0,t.aRawDataBuffer.length),t.bWriteRawData=!1,t.iRawDataSize=0,T=null}break;case"PlaySound":a="PlaySound";break;case"GetJPEG":if(a="GetJPEG",1!==r.errorCode)return void(t.bJSPrintLog>=0&&console.log("GetJPEG ErrorParam"));var D=r.data;t.jpegDownloadFlag&&(t.downloadFile(D,"GetJPEG.jpeg"),t.jpegDownloadFlag=!1),t.dataCallBackFun(D,D.length);break;case"GetBMP":if(a="GetBMP",1!==r.errorCode)return void(t.bJSPrintLog>=0&&console.log("GetBMP ErrorParam"));var I=r.data;t.bmpDownloadFlag&&(t.downloadFile(I,"GetBmp.bmp"),t.bmpDownloadFlag=!1),t.dataCallBackFun(I,I.length);break;case"RunTimeInfoCallBack":a="RunTimeInfoCallBack",null!=t.runtimeInfoCBFun&&(t.pstRuntimeInfo.nRunTimeModule=r.runtimeInfo.nRunTimeModule,t.pstRuntimeInfo.nStrVersion=r.runtimeInfo.nStrVersion,t.pstRuntimeInfo.nFrameTimeStamp=r.runtimeInfo.nFrameTimeStamp,t.pstRuntimeInfo.nFrameNum=r.runtimeInfo.nFrameNum,t.pstRuntimeInfo.nErrorCode=r.runtimeInfo.nErrorCode,t.pstRuntimeInfo.nInputDataInterval=r.runtimeInfo.nInputDataInterval,t.pstRuntimeInfo.nFrameNumInterval=r.runtimeInfo.nFrameNumInterval,t.runtimeInfoCBFun(t.pstRuntimeInfo));break;case"StreamInfoCallBack":a="StreamInfoCallBack";var M={};M.nSystemformat=r.nSystemformat,M.nVideoformat=r.nVideoformat,M.nAudioformat=r.nAudioformat,M.nAudiochannels=r.nAudiochannels,M.nAudiobitspersample=r.nAudiobitspersample,M.nAudiosamplesrate=r.nAudiosamplesrate,M.nAudiobitrate=r.nAudiobitrate,M.nWidth=r.nWidth,M.nHeight=r.nHeight,M.fFrameRate=r.fFrameRate,M.nIntervalOfIFrame=r.nIntervalOfIFrame,null!=t.streamInfoCBFun&&t.streamInfoCBFun(M);break;case"PostMpStreamOffsetCallBack":a="PostMpStreamOffsetCallBack";var L={};L.nStreamOffset=r.nStreamOffset,null!=t.PostMpStreamOffsetCBFun&&t.PostMpStreamOffsetCBFun(L);break;case"GetFileTime":a="GetFileTime";var w=r.FileTime;null!=t.GetFileTimeCBFun&&t.GetFileTimeCBFun(w);break;case"GetMpOffset":a="GetMpOffset";var O=r.Offset;null!=t.GetMpOffsetCBFun&&(t.GetMpOffsetCBFun(O),s.needWaitMpOffset=!1);break;case"AdditionDataCallBack":var B={};B.dataType=r.dataType,B.dataStrVersion=r.dataStrVersion,B.dataTimeStamp=r.dataTimeStamp,B.dataLength=r.dataLength,B.pData=r.pData,B.additionDataBuffer=new Uint8Array(r.additionDataBuffer),null!=t.addtionCallBackFun&&t.addtionCallBackFun(B)}"GetFrameData"!==a&&"loaded"!==a?t.setCallBack(t,a,0,t.convertErrorCode(r.errorCode),!0):ue!==r.errorCode&&101!==r.errorCode&&100!==r.errorCode&&48!==r.errorCode||t.setCallBack(t,a,0,t.convertErrorCode(r.errorCode),!0)}}var r},this.createWorker(s),this.draw=function(){if(s.bPlay){if(!s.bPause||s.bOnebyOne){requestAnimationFrame(s.draw);var t=s.aVideoFrameBuffer.length;if(null!=s.YUVBufSizeCBFun&&s.YUVBufSizeCBFun(t),s.bOnebyOne){if(t<=8&&s.setCallBack(s,"OnebyOne",0,de,!0),t<=s.FrameForwardLen+1)return void s.setCallBack(s,"OnebyOne",0,de,!0);for(var e=s.FrameForwardLen;e>1;)s.aVideoFrameBuffer.shift(),e--;s.bOnebyOne=!1}if(1==s.bstreamEnd&&(t<=0?(s.nstreamEndloopNum++,s.nstreamEndloopNum>=5&&(s.nstreamEndloopNum=0,s.bstreamEnd=!1,null!=s.runtimeInfoCBFun&&(s.pstRuntimeInfo.nRunTimeModule=0,s.pstRuntimeInfo.nStrVersion=0,s.pstRuntimeInfo.nFrameTimeStamp=0,s.pstRuntimeInfo.nFrameNum=0,s.pstRuntimeInfo.nErrorCode=9,s.pstRuntimeInfo.nInputDataInterval=0,s.pstRuntimeInfo.nFrameNumInterval=0,s.runtimeInfoCBFun(s.pstRuntimeInfo)))):s.nstreamEndloopNum=0),t>0){var a=s.aVideoFrameBuffer.shift(),r={};r.nCropLeft=s.nSPSCropLeft,r.nCropRight=s.nSPSCropRight,r.nCropTop=s.nSPSCropTop,r.nCropBottom=s.nSPSCropBottom,r.nCodeWidth=a.nWidth,r.nCodeHeight=a.nHeight,s.aDisplayBuf=a.data;var i=new Uint8Array(s.aDisplayBuf);if(s.jsplayer.RenderTypeFlagMap.size>0){var n,x=A(s.jsplayer.RenderTypeFlagMap.keys());try{for(x.s();!(n=x.n()).done;){var o=n.value;o==et&&1==s.jsplayer.RenderTypeFlagMap.get(o)&&null!=s.runtimeInfoCBFun&&1==s.firstRenderBegin&&(s.pstRuntimeInfo.nRunTimeModule=3,s.pstRuntimeInfo.nStrVersion=1,s.pstRuntimeInfo.nFrameTimeStamp=a.timeStamp,s.pstRuntimeInfo.nFrameNum=0,s.pstRuntimeInfo.nErrorCode=et,s.pstRuntimeInfo.nInputDataInterval=0,s.pstRuntimeInfo.nFrameNumInterval=0,s.pstRuntimeInfo.nAverageDecodeTime=0,s.pstRuntimeInfo.AbsTimeYear=a.osdTime.year,s.pstRuntimeInfo.AbsTimeMonth=a.osdTime.month,s.pstRuntimeInfo.AbsTimeDay=a.osdTime.day,s.pstRuntimeInfo.AbsTimeHour=a.osdTime.hour,s.pstRuntimeInfo.AbsTimeMinute=a.osdTime.minute,s.pstRuntimeInfo.AbsTimeSecond=a.osdTime.second,s.pstRuntimeInfo.AbsTimeMilliseconds=a.osdTime.misecond,s.runtimeInfoCBFun(s.pstRuntimeInfo),s.firstRenderBegin=!1)}}catch(t){x.e(t)}finally{x.f()}}if(s.bVideoCropInfo?s.oSuperRender.DisplayFrame(i,a.nWidth-s.nSPSCropLeft-s.nSPSCropRight,a.nHeight-s.nSPSCropTop-s.nSPSCropBottom,a.timeStamp,r,null).then((function(t){t.timestamp;var e=t.DrawRet;if(s.jsplayer.RenderTypeFlagMap.size>0&&1!=e){var r,i=A(s.jsplayer.RenderTypeFlagMap.keys());try{for(i.s();!(r=i.n()).done;){var n=r.value;n==rt&&1==s.jsplayer.RenderTypeFlagMap.get(n)&&null!=s.runtimeInfoCBFun&&(s.pstRuntimeInfo.nRunTimeModule=3,s.pstRuntimeInfo.nStrVersion=1,s.pstRuntimeInfo.nFrameTimeStamp=a.timeStamp,s.pstRuntimeInfo.nFrameNum=0,s.pstRuntimeInfo.nErrorCode=rt,s.runtimeInfoCBFun(s.pstRuntimeInfo))}}catch(t){i.e(t)}finally{i.f()}}})):s.oSuperRender.DisplayFrame(i,a.nWidth,a.nHeight,a.timeStamp,r,null).then((function(t){t.timestamp;var e=t.DrawRet;if(s.jsplayer.RenderTypeFlagMap.size>0&&1!=e){var r,i=A(s.jsplayer.RenderTypeFlagMap.keys());try{for(i.s();!(r=i.n()).done;){var n=r.value;n==rt&&1==s.jsplayer.RenderTypeFlagMap.get(n)&&null!=s.runtimeInfoCBFun&&(s.pstRuntimeInfo.nRunTimeModule=3,s.pstRuntimeInfo.nStrVersion=1,s.pstRuntimeInfo.nFrameTimeStamp=a.timeStamp,s.pstRuntimeInfo.nFrameNum=0,s.pstRuntimeInfo.nErrorCode=rt,s.runtimeInfoCBFun(s.pstRuntimeInfo))}}catch(t){i.e(t)}finally{i.f()}}})),s.jsplayer.RenderTypeFlagMap.size>0){var f,l=A(s.jsplayer.RenderTypeFlagMap.keys());try{for(l.s();!(f=l.n()).done;){var _=f.value;_==at&&1==s.jsplayer.RenderTypeFlagMap.get(_)&&null!=s.runtimeInfoCBFun&&(s.pstRuntimeInfo.nRunTimeModule=3,s.pstRuntimeInfo.nStrVersion=1,s.pstRuntimeInfo.nFrameTimeStamp=a.timeStamp,s.pstRuntimeInfo.nFrameNum=0,s.pstRuntimeInfo.nErrorCode=at,s.pstRuntimeInfo.nInputDataInterval=0,s.pstRuntimeInfo.nFrameNumInterval=0,s.pstRuntimeInfo.nAverageDecodeTime=0,s.pstRuntimeInfo.AbsTimeYear=a.osdTime.year,s.pstRuntimeInfo.AbsTimeMonth=a.osdTime.month,s.pstRuntimeInfo.AbsTimeDay=a.osdTime.day,s.pstRuntimeInfo.AbsTimeHour=a.osdTime.hour,s.pstRuntimeInfo.AbsTimeMinute=a.osdTime.minute,s.pstRuntimeInfo.AbsTimeSecond=a.osdTime.second,s.pstRuntimeInfo.AbsTimeMilliseconds=a.osdTime.misecond,s.runtimeInfoCBFun(s.pstRuntimeInfo))}}catch(t){l.e(t)}finally{l.f()}}null!=s.DisplayCallBackFun&&(s.DisplayInfoYUV.height=a.nHeight,s.DisplayInfoYUV.width=a.nWidth,s.DisplayInfoYUV.iSize=s.DisplayInfoYUV.height*s.DisplayInfoYUV.width*3/2,s.DisplayInfoYUV.frameNum=a.frameNum,s.DisplayInfoYUV.timeStamp=a.timeStamp,s.DisplayInfoYUV.yuvData=new Uint8Array(i),s.DisplayCallBackFun(s.DisplayInfoYUV)),s.frameInfoFlag&&(s.displayFrameInfo.codecType=0,s.displayFrameInfo.frameType=0,s.displayFrameInfo.frameSize=0,s.displayFrameInfo.width=a.nWidth-s.nSPSCropLeft-s.nSPSCropRight,s.displayFrameInfo.height=a.nHeight-s.nSPSCropTop-s.nSPSCropBottom,s.displayFrameInfo.timeStamp=a.timeStamp,s.displayFrameInfo.frameRate=0,s.displayFrameInfo.frameNum=a.frameNum,s.displayFrameInfo.interlace=0,s.displayFrameInfo.streamEnd=0,s.displayFrameInfo.cropLeft=s.nSPSCropLeft,s.displayFrameInfo.cropRight=s.nSPSCropRight,s.displayFrameInfo.cropTop=s.nSPSCropTop,s.displayFrameInfo.cropBottom=s.nSPSCropBottom,s.displayFrameInfo.year=a.osdTime.year,s.displayFrameInfo.month=a.osdTime.month,s.displayFrameInfo.week=0,s.displayFrameInfo.day=a.osdTime.day,s.displayFrameInfo.hour=a.osdTime.hour,s.displayFrameInfo.minute=a.osdTime.minute,s.displayFrameInfo.second=a.osdTime.second,s.displayFrameInfo.milliseconds=a.osdTime.misecond),0==s.startTimeStamp&&(s.startTimeStamp=a.timeStamp),i=null;var h=a.osdTime.year,c=a.osdTime.month,u=a.osdTime.day,d=a.osdTime.hour,p=a.osdTime.minute,m=a.osdTime.second;s.szOSDTime=h+"-"+c+"-"+u+" "+d+":"+p+":"+m,a=null,s.needFirstFrameCB&&null!=s.firstFrameCB&&(s.firstFrameCB({decodeEngine:2}),s.needFirstFrameCB=!1)}else s.setCallBack(s,"Play",0,de,!0)}}else s.bPlay||(s.aVideoFrameBuffer.splice(0,s.aVideoFrameBuffer.length),s.aAudioBuffer.splice(0,s.aAudioBuffer.length))}}return e(a,[{key:"PlayM4_SetCurrentFrameNum",value:function(t,e){return ue}},{key:"PlayM4_OpenPlayerSDKPrintLog",value:function(t){return this.bJSPrintLog=t,this.decodeWorker.postMessage({command:"printLog",data:t}),1}},{key:"PlayM4_DownloadYUVdata",value:function(){return this.bWriteYUVData=!0,1}},{key:"PlayM4_DownloadPCMdata",value:function(){return this.bWritePCMData=!0,1}},{key:"PlayM4_SetDecCallBack",value:function(t,e){return t?(1==this.decCBStream&&(this.DecCallBackFun=e),2==this.decCBStream&&(this.PCMCallBackFun=e),3==this.decCBStream&&(this.PCMCallBackFun=e,this.DecCallBackFun=e)):(1==this.decCBStream&&(this.DecCallBackFun=null),2==this.decCBStream&&(this.PCMCallBackFun=null),3==this.decCBStream&&(this.PCMCallBackFun=null,this.DecCallBackFun=null)),1}},{key:"PlayM4_SetDisplayCallBack",value:function(t){return t&&"function"==typeof t?(this.DisplayCallBackFun=t,1):0}},{key:"PlayM4_SetPCMCallBack",value:function(t){return t&&"function"==typeof t?(this.PCMCallBackFun=t,1):0}},{key:"PlayM4_SetStreamOpenMode",value:function(t){return null==t||void 0===t||0!==t&&1!==t?0:(this.streamOpenMode=t,1)}},{key:"PlayM4_DownloadRTPData",value:function(t){this.downloadRTP=t}},{key:"PlayM4_SetVideoCropInfo",value:function(t){return null==t||void 0===t||"boolean"!=typeof t?0:(this.bVideoCropInfo=t,1)}},{key:"PlayM4_OpenStream",value:function(t,e,a){return this.bJSPrintLog>0&&console.log(">>>JS PlayM4_OpenStream nSysTime:"+((new Date).getMonth()+1)+"-"+(new Date).getDate()+" "+(new Date).getHours()+":"+(new Date).getMinutes()+":"+(new Date).getSeconds()+"."+(new Date).getMilliseconds()),null==this.decodeWorker?2:null==t||e<=0||a<=0?0:(73==t[0]&&77==t[1]&&75==t[2]&&72==t[3]?this.bHIKHeadValue=!0:this.bHIKHeadValue=!1,0==t[12]&&0==t[13]?this.bFileHeadAudioFormat=!1:this.bFileHeadAudioFormat=!0,this.bPlay=!1,this.bPause=!1,this.bOnebyOne=!1,this.bIsFirstFrame=!0,this.bIsGetYUV=!1,this.bIsInput=!1,4===t[8]&&0===t[9]?this.streamOpenMode=0:this.streamOpenMode=1,this.SystemFormat=t[8]+(t[9]<<8),this.decodeWorker.postMessage({command:"SetStreamOpenMode",data:this.streamOpenMode}),this.decodeWorker.postMessage({command:"OpenStream",data:t,dataSize:e,bufPoolSize:a}),this.bOpenStream=!0,1)}},{key:"PlayM4_CloseStream",value:function(){return null===this.decodeWorker?1:null===this.decodeWorker||!1===this.bOpenStream?2:(this.bOnlyPlaySound=!1,this.decodeWorker.postMessage({command:"CloseStream"}),null!==this.oSuperRender&&(this.oSuperRender.ReleaseDisplay(),this.oSuperRender=null),null!==this.audioRenderer&&(this.audioRenderer.Stop(),this.audioRenderer=null),this.aAudioBuffer.splice(0,this.aAudioBuffer.length),this.aVideoFrameBuffer.splice(0,this.aVideoFrameBuffer.length),this.aInputDataBuffer.splice(0,this.aInputDataBuffer.length),this.aInputDataLens.splice(0,this.aInputDataLens.length),this.aVideoYUVBuffer.splice(0,this.aVideoYUVBuffer.length),this.aAudioPCMBuffer.splice(0,this.aAudioPCMBuffer.length),this.aRawDataBuffer.splice(0,this.aRawDataBuffer.length),this.bOpenStream=!1,this.iAudioBufferSize=0,this.szOSDTime=null,this.startTimeStamp,this.nCurStatus=2,null!=this.textCanvas&&(this.textCanvas.remove(),this.textCanvas=null),this.setTextCanvasFlag=!1,null!=this.oInputTimer&&(this.oInputTimer.timerReset(),this.oInputTimer=null),null!=this.oDecodeTimer&&(this.oDecodeTimer.timerReset(),this.oDecodeTimer=null),1)}},{key:"PlayM4_Destroy",value:function(){return null===this.decodeWorker||(this.PlayM4_CloseStream(),this.decodeWorker.terminate(),this.decodeWorker=null),1}},{key:"PlayM4_FreePort",value:function(){return this.decodeWorker.terminate(),this.decodeWorker=null,1}},{key:"PlayM4_InputData",value:function(t,e){var a=this.aInputDataBuffer.length;if(-1===e)return this.bIsFirstFrame||this.bIsGetYUV?this.inputDataFun():this.bIsInput=!0,this.bstreamEnd=!0,1;if(a+e>this.iInputMaxBufSize)return this.bJSPrintLog>=0&&console.log("input over"),this.bIsGetYUV?this.inputDataFun():this.bIsInput=!0,11;var r=null,i=e;switch(this.streamOpenMode){case 1:if(r=new Uint8Array(t.buffer),this.jsplayer.ManagerTypeFlagMap.size>0){var n,s=A(this.jsplayer.ManagerTypeFlagMap.keys());try{for(s.s();!(n=s.n()).done;){var x=n.value;if(x&$&&1==this.jsplayer.ManagerTypeFlagMap.get(x)&&null!=this.runtimeInfoCBFun&&(2==this.SystemFormat||3==this.SystemFormat||32769==this.SystemFormat)){var o=this.SearchPtsInPes(r,e);if(o>=0&&e-o>=14&&0==r[o+0]&&0==r[o+1]&&1==r[o+2]&&(224==r[o+3]||192==r[o+3]||189==r[o+3]||191==r[o+3])&&128==(192&r[o+6])&&128&r[o+7]&&(32==(240&r[o+9])||48==(240&r[o+9]))&&!(1&~r[o+9])&&!(1&~r[o+11])&&!(1&~r[o+13])){var f=(((14&r[o+9])<<28)+(r[o+10]<<21)+((254&r[o+11])<<13)+(r[o+12]<<6)+((252&r[o+13])>>2))/45;this.SourceDataInterval(f)}}}}catch(t){s.e(t)}finally{s.f()}}this.aInputDataLens.push(e);break;case 0:i=e+4;var l=new Uint32Array([e]),_=new Uint8Array(l.buffer);if((r=new Uint8Array(i)).set(_,0),r.set(t,4),this.jsplayer.ManagerTypeFlagMap.size>0){var h,c=A(this.jsplayer.ManagerTypeFlagMap.keys());try{for(c.s();!(h=c.n()).done;){var u=h.value;u&$&&1==this.jsplayer.ManagerTypeFlagMap.get(u)&&null!=this.runtimeInfoCBFun&&(4==this.SystemFormat||13==this.SystemFormat||260==this.SystemFormat)&&e>12&&(224==(255&r[5])||154==(255&r[5])||160==(255&r[5]))&&(f=((r[8]<<24)+(r[9]<<16)+(r[10]<<8)+r[11])/90,this.SourceDataInterval(f))}}catch(t){c.e(t)}finally{c.f()}}l=null,_=null,this.aInputDataLens.push(e+4);break;default:return ue}for(var d=0;d<i;d++)this.aInputDataBuffer[a+d]=r[d];return!this.bPlay&&!this.bOnlyPlaySound||null===this.decodeWorker||!1===this.bOpenStream||(r=null,this.bOnlyPlaySound||this.bIsFirstFrame||this.bIsGetYUV?this.inputDataFun():this.bIsInput=!0),1}},{key:"PlayM4_Play",value:function(t){if(null===this.decodeWorker)return 2;if(this.bJSPrintLog>0&&console.log(">>>JS PlayM4_Play canvasID: "+t),this.nCurStatus=3,this.decodeWorker.postMessage({command:"SetLostFrameMode",data:this.nLostFrameFlag}),null===t)this.bOnlyPlaySound=!0,this.decodeWorker.postMessage({command:"OnlyPlaySound"}),this.sCanvasId=null;else{if("string"!=typeof t)return 0;if(this.bOnebyOne&&(this.bPlayRateChange=!1,this.bOnebyOne=!1,this.bPause=!1,this.draw()),this.bPlay)return 1;if(null==this.oSuperRender&&(this.canvasCnv=document.getElementById(t),this.oSuperRender=new Kt(this),this.oSuperRender.InitDisplay(this.canvasCnv,"webgl",1),null==this.oSuperRender))return 61;this.sCanvasId=t,this.bPlay=!0,this.bPause=!1,this.bOnebyOne=!1,this.bPlayRateChange=!1,this.bOnlyPlaySound=!1,this.draw()}return null==this.audioRenderer&&(this.audioRenderer=new ce,null==this.audioRenderer)?61:(this.decodeWorker.postMessage({command:"Play"}),1)}},{key:"PlayM4_Stop",value:function(t){if(this.bJSPrintLog>0&&console.log(">>>>yff1020>>>>> V1 PlayM4_Stop"),null==this.decodeWorker||null==this.oSuperRender)return 2;if(!this.bPlay)return 2;this.bPlaySound&&(this.PlayM4_StopSound(),this.bPlaySound=!0),this.nCurStatus=5,this.bPlay=!1,this.bOnebyOne=!1,this.bPause=!1,this.oSuperRender.SetDisplayRect(0,0,this.nWidth,this.nHeight),this.iZoomNum=0,this.bDisRect=!1;var e={};e.nCropLeft=this.nSPSCropLeft,e.nCropRight=this.nSPSCropRight,e.nCropTop=this.nSPSCropTop,e.nCropBottom=this.nSPSCropBottom,e.nCodeWidth=this.nWidth,e.nCodeHeight=this.nHeight,this.bVideoCropInfo?this.oSuperRender.DisplayFrame(null,this.nWidth-this.nSPSCropLeft-this.nSPSCropRight,this.nHeight-this.nSPSCropTop-this.nSPSCropBottom,this.timeStamp,e,null):this.oSuperRender.DisplayFrame(null,this.nWidth,this.nHeight,this.timeStamp,e,null);var a=document.getElementById(this.sCanvasId);return a&&(this.clonedCanvas=a.cloneNode(!0),this.clonedCanvasParentNode=a.parentNode,this.clonedCanvasParentNode.replaceChild(this.clonedCanvas,a)),1}},{key:"PlayM4_PlayRate",value:function(t){return null==this.decodeWorker?2:(this.bPlayRateChange=1!==t,t<1&&(t=1),this.iInputDataLen=t*me,this.decodeWorker.postMessage({command:"PlayRate",playRate:t}),1)}},{key:"PlayM4_Pause",value:function(t){return null==this.decodeWorker||null==this.oSuperRender?2:this.bPlay?this.bOnebyOne||this.bPause==t?2:(this.bPause=t,this.bIsFirstFrame=!0,t?(this.bPlaySound&&(this.PlayM4_StopSound(),this.bPlaySound=!0),this.nCurStatus=4):(this.bPlaySound&&this.PlayM4_PlaySound(),this.nCurStatus=3,this.decodeWorker.postMessage({command:"SetLostFrameMode",data:this.nLostFrameFlag}),this.draw()),1):2}},{key:"PlayM4_OneByOne",value:function(t){return null==this.decodeWorker||null==this.oSuperRender?2:this.bPlay?t>10||t<=0?0:(t||(t=1),this.iInputDataLen=me,this.FrameForwardLen=t,this.bPause=!0,this.bOnebyOne=!0,this.bIsFirstFrame=!0,this.nCurStatus=6,this.draw(),this.decodeWorker.postMessage({command:"SetLostFrameMode",data:0}),1):2}},{key:"PlayM4_PlaySound",value:function(t){return null===this.decodeWorker||!1===this.bOpenStream?2:t<0||t>16?0:null==this.audioRenderer&&(this.audioRenderer=new ce,null==this.audioRenderer)?61:(this.decodeWorker.postMessage({command:"PlaySound"}),this.audioRenderer.SetWndNum(t),0!==this.Volume&&this.audioRenderer.SetVolume(this.Volume),this.audioRenderer.oAudioContext.resume(),0==this.nIgnoreHeaderAudioDefine&&0==this.bFileHeadAudioFormat?ue:(this.bPlaySound=!0,1))}},{key:"PlayM4_StopSound",value:function(){return null==this.decodeWorker||null==this.audioRenderer?2:this.bPlaySound?(this.decodeWorker.postMessage({command:"StopSound"}),this.bPlaySound=!1,1):2}},{key:"PlayM4_SetDisplayBuf",value:function(t){return null==this.decodeWorker?2:t<=0?0:(this.YUVBufferSize=t,1)}},{key:"PlayM4_SetSecretKey",value:function(t,e,a){if(null==this.decodeWorker||!1===this.bOpenStream)return 2;if(null==e)return 0;if(1===t){if(128!==a)return 0;if(null==e||void 0===e)return 0}else if(2===t){if(256!==a)return 0;if(null==e||void 0===e)return 0}else if(0!==t)return 0;return this.decodeWorker.postMessage({command:"SetSecretKey",data:e,nKeyType:t,nKeyLen:a}),1}},{key:"PlayM4_SetDecodeFrameType",value:function(t){return this.bJSPrintLog>0&&console.log("PlayM4_SetDecodeFrameType nFrameType:"+t),null==this.decodeWorker||null==this.oSuperRender?2:0!==t&&1!==t?0:(this.bJSPrintLog>0&&console.log(">>>JS PlayM4_SetDecodeFrameType :"+t),this.nDecFrameType=t,this.decodeWorker.postMessage({command:"SetDecodeFrameType",data:t}),1)}},{key:"PlayM4_SetIFrameDecInterval",value:function(t){return 1!==this.nDecFrameType?2:t<0?0:(this.decodeWorker.postMessage({command:"SetIFrameDecInterval",data:t}),1)}},{key:"PlayM4_SetLostFrameMode",value:function(t){return t<0||t>1?0:(this.nLostFrameFlag=t,this.decodeWorker.postMessage({command:"SetLostFrameMode",data:t}),1)}},{key:"PlayM4_SetDisplayRegion",value:function(t,e,a){if(this.bJSPrintLog>0&&console.log(">>>>yff1020>>>>> PlayM4_SetDisplayRegion left:"+t.left+",top:"+t.top+",right:"+t.right+",bottom:"+t.bottom),null===this.decodeWorker||!1===this.bPlay||null===this.oSuperRender)return 2;if(null===this.canvasId)return 2;if(!0===e){if(null==t)return 0;if("number"!=typeof t.left||"number"!=typeof t.top||"number"!=typeof t.right||"number"!=typeof t.bottom)return 0;var r=t.left,i=t.right,n=t.top,s=t.bottom,x=document.getElementById(this.sCanvasId).getBoundingClientRect();this.iCanvasWidth=x.width,this.iCanvasHeight=x.height,0!==this.iZoomNum&&(r=Math.round(r/this.iRatio_x)+this.stDisplayRect.left,n=Math.round(n/this.iRatio_y)+this.stDisplayRect.top,i=Math.round(i/this.iRatio_x)+this.stDisplayRect.left,s=Math.round(s/this.iRatio_y)+this.stDisplayRect.top),this.stDisplayRect={top:n,left:r,right:i,bottom:s};var o=s/this.iCanvasHeight*this.nHeight,f=r/this.iCanvasWidth*this.nWidth,l=i/this.iCanvasWidth*this.nWidth,_=n/this.iCanvasHeight*this.nHeight;this.oSuperRender.SetDisplayRect(f,_,l-f,o-_),this.bDisRect=!0;var h=i-r,c=s-n;this.iRatio_x=this.iCanvasWidth/h,this.iRatio_y=this.iCanvasHeight/c,a&&this.iZoomNum++}else this.oSuperRender.SetDisplayRect(0,0,this.nWidth,this.nHeight),this.iZoomNum=0,this.bDisRect=!1;if(this.bPause||this.bOnebyOne||this.bPlayRateChange){var u={};u.nCropLeft=this.nSPSCropLeft,u.nCropRight=this.nSPSCropRight,u.nCropTop=this.nSPSCropTop,u.nCropBottom=this.nSPSCropBottom,u.nCodeWidth=this.nWidth,u.nCodeHeight=this.nHeight,this.bVideoCropInfo?this.oSuperRender.DisplayFrame(new Uint8Array(this.aDisplayBuf),this.nWidth-this.nSPSCropLeft-this.nSPSCropRight,this.nHeight-this.nSPSCropTop-this.nSPSCropBottom,this.timeStamp,u,null):this.oSuperRender.DisplayFrame(new Uint8Array(this.aDisplayBuf),this.nWidth,this.nHeight,this.timeStamp,u,null)}return 1}},{key:"PlayM4_FEC_GetPort",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.printfFlag&&console.log(">>>JS PlayM4_FEC_GetPort placeType:"+t+",correctType:"+e+",fecGetPortCB:"+a),null===this.decodeWorker||!1===this.bPlay||null===this.oSuperRender)return 2;if(null===this.canvasId)return 2;if(1280!=e&&0!=e)return ue;var r;return this.FECGetPortCB=a,r=null!=this.oSuperRender?this.oSuperRender.FEC_GetPort(t,e):-1,null!=this.FECGetPortCB&&this.FECGetPortCB(r),r}},{key:"PlayM4_FEC_Enable",value:function(t){if(this.printfFlag&&console.log(">>>JS PlayM4_FEC_Enable fishSubPort:"+t),null===this.decodeWorker||!1===this.bPlay||null===this.oSuperRender)return 2;var e=1;return 0==t?console.log("fishPort is 0 ,main canvas doesn't need call FEC_Enable"):e=null!=this.oSuperRender?this.oSuperRender.FEC_Enable(t):0,e}},{key:"PlayM4_FEC_SetWnd",value:function(t,e){if(this.printfFlag&&console.log(">>>JS PlayM4_FEC_SetWnd fishSubPort:"+t+",hWnd:"+e),null===this.decodeWorker||!1===this.bPlay||null===this.oSuperRender)return 2;var a=1;if(0==t)console.log("fishPort is 0 ,main canvas doesn't need call FEC_SetWnd");else if(null!=e){var r=document.getElementById(e);if(null!=this.oSuperRender)return this.oSuperRender.FEC_SetWnd(t,r);a=0}else console.log(">>>JS PlayM4_FEC_SetWnd hwnd error fishSubPort:"+t+",hWnd:"+e),a=0;return a}},{key:"PlayM4_FEC_SetParam",value:function(t,e){return this.printfFlag&&console.log(">>>JS PlayM4_FEC_SetParam 1 this.fishSubPort:"+t+",upDateType:"+e.upDateType+",param2d.fPTZParam.fPTZPositionX:"+e.fPTZParam.fPTZPositionX+",param2d.fPTZParam.fPTZPositionY:"+e.fPTZParam.fPTZPositionY),null===this.decodeWorker||!1===this.bPlay||null===this.oSuperRender?2:null!=this.oSuperRender?this.oSuperRender.FEC_SetParam(t,e):0}},{key:"PlayM4_FEC_SetViewParam",value:function(t,e,a){return this.printfFlag&&console.log(">>>JS PlayM4_FEC_SetViewParam fishSubPort:"+t+",upDateType:"+e+",fValue:"+a),null===this.decodeWorker||!1===this.bPlay||null===this.oSuperRender?2:null!=this.oSuperRender?this.oSuperRender.FEC_SetViewParam(t,e,a):0}},{key:"PlayM4_FEC_GetViewParam",value:function(t,e,a){if(this.printfFlag&&console.log(">>>JS PlayM4_FEC_GetViewParam fishSubPort:"+t+",upDateType:"+e+",viewParamCB:"+a),null===this.decodeWorker||!1===this.bPlay||null===this.oSuperRender)return 2;var r=1;this.FECViewParamCB=a;var i={fValue:-1};return null!=this.oSuperRender?(r=this.oSuperRender.FEC_GetViewParam(t,e,i),null!=this.FECViewParamCB&&this.FECViewParamCB(i)):r=0,r}},{key:"PlayM4_FEC_ResetCorrectType",value:function(t,e,a){return this.printfFlag&&console.log("PlayM4_FEC_ResetCorrectType 1 fishSubPort:"+t+",placeType:"+e+",correctType:"+a),null===this.decodeWorker||!1===this.bPlay||null===this.oSuperRender?2:1280!=a&&0!=a?ue:null!=this.oSuperRender?this.oSuperRender.FEC_ResetCorrectType(t,e,a):0}},{key:"PlayM4_FEC_Capture",value:function(t,e){return this.printfFlag&&console.log("PlayM4_FEC_Capture 1 fishSubPort:"+t+",FECImageCB:"+e),null===this.decodeWorker||!1===this.bPlay||null===this.oSuperRender?2:null!=this.oSuperRender?this.oSuperRender.FEC_Capture(t,e):0}},{key:"PlayM4_FEC_SetBackCilling",value:function(t,e){return this.printfFlag&&console.log("PlayM4_FEC_SetBackCilling 1 fishSubPort:"+t+",bValue:"+e),null===this.decodeWorker||!1===this.bPlay||null===this.oSuperRender?2:null!=this.oSuperRender?this.oSuperRender.FEC_SetBackCilling(t,e):0}},{key:"PlayM4_GetBMP",value:function(t,e){return this.bmpDownloadFlag=e,this.getPic(t,"GetBMP")}},{key:"PlayM4_GetJPEG",value:function(t,e){return this.jpegDownloadFlag=e,this.getPic(t,"GetJPEG")}},{key:"PlayM4_SetVolume",value:function(t){return null==this.decodeWorker||null==this.audioRenderer?2:t<0||t>100||""===t?0:(this.Volume=t,this.audioRenderer.SetVolume(t),1)}},{key:"PlayM4_GetVolume",value:function(t){if(null==this.decodeWorker)return 2;if(null==this.audioRenderer)return 2;if(t&&"function"==typeof t){var e=this.audioRenderer.GetVolume();return null===e?63:(t(e),1)}return 0}},{key:"PlayM4_GetOSDTime",value:function(t){return null==this.decodeWorker?2:this.bPlay?t&&"function"==typeof t?(t(this.szOSDTime),1):0:2}},{key:"PlayM4_SetFrameInfoCallBack",value:function(t){return this.frameInfoFlag=!!t,1}},{key:"PlayM4_GetFrameInfo",value:function(){return this.displayFrameInfo}},{key:"PlayM4_IsVisible",value:function(t){return this.bVisibility=t,1}},{key:"PlayM4_GetSdkVersion",value:function(){return"07040007"}},{key:"PlayM4_GetBuildDate",value:function(){return"20231219"}},{key:"PlayM4_GetInputBufSize",value:function(){return this.aInputDataBuffer.length}},{key:"PlayM4_SetInputBufSize",value:function(t){return t>0?(this.iInputMaxBufSize=t,this.bJSPrintLog>0&&console.log(">>JSBufferSize SetInputBufSize:"+this.iInputMaxBufSize),1):0}},{key:"PlayM4_GetYUVBufSize",value:function(){return this.aVideoFrameBuffer.length}},{key:"PlayM4_GetFrameResolution",value:function(t){return null==this.decodeWorker?2:t&&"function"==typeof t?(t(this.nWidth,this.nHeight),1):0}},{key:"PlayM4_RegisterYUVBufSizeCB",value:function(t){return t&&"function"==typeof t?(this.YUVBufSizeCBFun=t,1):0}},{key:"PlayM4_GetFileTime",value:function(t){return t&&"function"==typeof t?(this.GetFileTimeCBFun=t,this.decodeWorker.postMessage({command:"GetFileTime"}),1):0}},{key:"PlayM4_GetMpOffset",value:function(t,e){return this.needWaitMpOffset=!0,t&&"function"==typeof t?(this.GetMpOffsetCBFun=t,this.decodeWorker.postMessage({command:"GetMpOffset",FrameTime:e}),1):0}},{key:"PlayM4_UnRegisterYUVBufSizeCB",value:function(){return null!=this.YUVBufSizeCBFun&&(this.YUVBufSizeCBFun=null),1}},{key:"PlayM4_ClearCanvas",value:function(){if(null==this.oSuperRender)return 2;var t={};return t.nCropLeft=this.nSPSCropLeft,t.nCropRight=this.nSPSCropRight,t.nCropTop=this.nSPSCropTop,t.nCropBottom=this.nSPSCropBottom,t.nCodeWidth=this.nWidth,t.nCodeHeight=this.nHeight,this.bVideoCropInfo?this.oSuperRender.DisplayFrame(null,this.nWidth-this.nSPSCropLeft-this.nSPSCropRight,this.nHeight-this.nSPSCropTop-this.nSPSCropBottom,this.timeStamp,t,null):this.oSuperRender.DisplayFrame(null,this.nWidth,this.nHeight,this.timeStamp,t,null),1}},{key:"PlayM4_ReleaseInputBuffer",value:function(){return null===this.aInputDataBuffer?2:(this.aInputDataBuffer.splice(0,this.aInputDataBuffer.length),this.aInputDataLens.splice(0,this.aInputDataLens.length),this.bIsGetYUV=!1,this.bIsFirstFrame=!0,this.bIsInput=!1,1)}},{key:"PlayM4_ResetBuffer",value:function(t){return null===this.aInputDataBuffer?2:(this.decodeWorker.postMessage({command:"ResetBuffer",type:t}),1)}},{key:"PlayM4_GetDecodeFrameType",value:function(){return this.nDecFrameType}},{key:"PlayM4_SetRunTimeInfoCallBackEx",value:function(t,e){return this.runtimeInfoCBFun=e,null==this.decodeWorker?2:(this.decodeWorker.postMessage({command:"SetRunTimeInfoCB",nModuleType:t}),1)}},{key:"PlayM4_SetRunTimeInfoCallbackType",value:function(t,e,a){return e==tt&&(this.nGetTotalFrameNum=0,a?null==this.oDecodeTimer&&(this.oDecodeTimer=new ft,this.oDecodeTimer.Init()):null!==this.oDecodeTimer&&(this.oDecodeTimer.timerReset(),this.oDecodeTimer=null)),null==this.decodeWorker?2:(this.decodeWorker.postMessage({command:"SetRunTimeInfoCallbackType",module:t,Type:e,Flag:a}),1)}},{key:"PlayM4_SetStreamInfoCallBack",value:function(t,e){return this.streamInfoCBFun=e,this.decodeWorker.postMessage({command:"SetStreamInfoCB",nType:t}),1}},{key:"PlayM4_SetPostMpStreamOffsetCallBack",value:function(t){return this.PostMpStreamOffsetCBFun=t,this.decodeWorker.postMessage({command:"SetPostMpStreamOffsetCB"}),1}},{key:"PlayM4_SetDemuxModel",value:function(t,e){return null==this.decodeWorker?2:(this.decodeWorker.postMessage({command:"SetDemuxModel",nIdemuxType:t,bTrue:e}),1)}},{key:"PlayM4_SkipErrorData",value:function(t){return null==this.decodeWorker?2:(this.decodeWorker.postMessage({command:"SkipErrorData",bSkip:t}),1)}},{key:"PlayM4_SetDecodeERC",value:function(t){return null==this.decodeWorker?2:(this.decodeWorker.postMessage({command:"SetDecodeERC",nLevel:t}),1)}},{key:"PlayM4_SetANRParam",value:function(t,e){return null==this.decodeWorker?2:(this.decodeWorker.postMessage({command:"SetANRParam",nEnable:t,nANRLevel:e}),1)}},{key:"PlayM4_SetResampleValue",value:function(t,e){return null==this.decodeWorker?2:(this.decodeWorker.postMessage({command:"SetResampleValue",nEnable:t,resampleValue:e}),1)}},{key:"PlayM4_SetGlobalBaseTime",value:function(t,e,a,r,i,n,s){return null==this.decodeWorker?2:t<2e3||t>3e3||e<1||e>12||t<0||e<0||a<0||r<0||i<0||n<0||s<0?ue:(this.decodeWorker.postMessage({command:"SetGlobalBaseTime",year:t,month:e,day:a,hour:r,min:i,sec:n,ms:s}),1)}},{key:"PlayM4_SetAudioDisplayBuf",value:function(t){return pe=t,1}},{key:"PlayM4_GetCanvasCapture",value:function(t,e,a){return null!=this.oSuperRender?this.oSuperRender.GetCanvasData(t,e,a):1}},{key:"PlayM4_SetFirstFrameCallBack",value:function(t,e){return null!=e&&"function"!=typeof e?0:(t&&(this.firstFrameCB=e),this.needFirstFrameCB=!0,1)}},{key:"PlayM4_SetDecCBStream",value:function(t){return this.decCBStream=t,1}},{key:"PlayM4_SetCanvasSize",value:function(t,e){return t<16||e<16?0:null!=this.oSuperRender&&this.oSuperRender.SetCanvasSize(t,e,0)}},{key:"PlayM4_GetCanvasSize",value:function(){return null!=this.oSuperRender&&this.oSuperRender.GetCanvasSize()}},{key:"PlayM4_GetBufferValue",value:function(){return this.iInputMaxBufSize}},{key:"PlayM4_GetLastError",value:function(){return this.errorCode}},{key:"PlayM4_GetPlayedTimeEx",value:function(t){t(this.timeStamp-this.startTimeStamp)}},{key:"PlayM4_SetAntialias",value:function(t){return null!=this.oSuperRender?this.oSuperRender.SetAntialias(t):0}},{key:"_SetTextCanvas",value:function(){return null!=this.textCanvas&&(this.textCanvas.remove(),this.textCanvas=null),null==this.textCanvas&&(this.textCanvas=document.createElement("canvas")),null!=this.oSuperRender&&this.oSuperRender.SetTextCanvas(this.textCanvas),this.setTextCanvasFlag=!0,1}},{key:"PlayM4_SetWaterMarkFont",value:function(t){return null!=this.oSuperRender?(this.setTextCanvasFlag||this._SetTextCanvas(),this.oSuperRender.SetWaterMarkFont(t)):0}},{key:"PlayM4_SetWaterMarkImage",value:function(t){return null!=this.oSuperRender?this.oSuperRender.SetWaterMarkImage(t):0}},{key:"PlayM4_SetD3DPostProcess",value:function(t,e){return null!=this.oSuperRender?this.oSuperRender.SetD3DPostProcess(t,e):0}},{key:"PlayM4_SetRotateAngle",value:function(t){return null!=this.oSuperRender?this.oSuperRender.SetRotateAngle(t):0}},{key:"PlayM4_IgnoreHeaderAudioDefine",value:function(t){return this.nIgnoreHeaderAudioDefine=t,1}},{key:"getScriptDirectory",value:function(){var t=self.location.href;return t.substr(0,t.lastIndexOf("/")+1)}},{key:"PlayM4_SetAdditionDataCallBack",value:function(t,e,a){return a&&"function"==typeof a||null===a?(this.addtionCallBackFun=a,this.decodeWorker.postMessage({command:"SetAdditionDataCallBack",additionDataType:t,nFlag:e}),1):0}},{key:"downloadFile",value:function(t,e){var a=t;i(t,Blob)||i(t,File)||(a=new Blob([t]));var r=window.URL.createObjectURL(a),n=window.document.createElement("a");n.href=r,n.download=e;var s=document.createEvent("MouseEvents");s.initEvent("click",!0,!0),n.dispatchEvent(s)}},{key:"SourceDataInterval",value:function(t){var e,a=0;return null==this.oInputTimer&&(this.oInputTimer=new ft,this.oInputTimer.Init()),-1==this.nLastSourceTimeStamp&&(this.nLastSourceTimeStamp=t),e=this.oInputTimer.GetTimerWalk(),-1==this.nLastClockTimeStamp?(this.nLastClockTimeStamp=e,1):e>=this.nLastClockTimeStamp?(a=e-this.nLastClockTimeStamp,t!=this.nLastSourceTimeStamp&&this.nLastSourceTimeStamp,null!=this.runtimeInfoCBFun&&(this.pstRuntimeInfo.nRunTimeModule=4,this.pstRuntimeInfo.nStrVersion=1,this.pstRuntimeInfo.nFrameTimeStamp=t,this.pstRuntimeInfo.nFrameNum=0,this.pstRuntimeInfo.nErrorCode=$,this.pstRuntimeInfo.nInputDataInterval=a,this.pstRuntimeInfo.nFrameNumInterval=0,this.runtimeInfoCBFun(this.pstRuntimeInfo)),this.nLastSourceTimeStamp=t,this.nLastClockTimeStamp=e,1):(null!=this.oInputTimer&&this.oInputTimer.Init(),this.nLastClockTimeStamp=-1,1)}},{key:"SearchPtsInPes",value:function(t,e){if(e<8)return-1;var a=new Uint8Array(t),r=0;for(r=0;r<e-7;r++){if(r+2>e)return-1;if(0==a[r]&&0==a[r+1]&&1==a[r+2]){if(r+3>e)return-1;switch(a[r+3]){case 189:case 191:if(r+5>e)return-1;var i=6+(a[r+4]<<8)+a[r+5];if(!(r+i<e))return-1;r+=i;break;case 224:if(r+7>e)return-1;if(128&a[r+7])return r}}}return-1}}]),a}(),Ee=r((function(){return s(this,(function(t){return[2,WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]))]}))})),ge={bSupHardOrSoft:!0,bSupHardDecAVC:!0,bSupHardDecHEVC:!0,cmd:null,errorCode:0,status:null};window.g_printfFlag=0,window.g_recorderFlag=0;var Fe=function(){function a(e,r,i){var n=this,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,x=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"webgl",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:-1;if(t(this,a),this.printfFlag=window.g_printfFlag,this.printfFlag>=0&&console.log("%c>>>JSPlayerInterface wasmPathV3:%s, wasmPathV1:%s, chromeVersion:%d,renderEngine:%s,webworker:%d,setHasThread:%d","color: red",e,r,_getFExplore(),x,o,f),this.szBasePathV3=e,this.szBasePathV1=r,this.fnCallBack=i,this.nUser=s,this.renderEngine=x,this.hasWebWorker=o,this.setHasThread=f,this.decodeEngine=1,this.streamOpenMode=0,this.canvasID="",this.FECcanvasIDArray=[],this.aTotalBuffer=[],this.iFrameNum=0,this.bWriteData=!0,this.downloadInputDataFlag=!1,this.rtpDataNeedAdd4Size=!1,this.aInputDataBuffer=[],this.iInputMaxBufSize=2097152,this.switchingV3toV1=!1,this.audioDisplayBufSize=0,this.decodeFrameType=0,this.decInterval=-1,this.volume=0,this.displayBuf=0,this.anrParamLevel=0,this.anrParamFlag=0,this.resampleRate=0,this.resampleFlag=0,this.decodeERCLevel=0,this.skipErrorData=0,this.demuxModelType=0,this.demuxModeFlag=0,this.needResetBuffer=0,this.globalBaseTime={},this.globalBaseTime.year=0,this.inputBufSize=0,this.needSetRotateAngle=!1,this.twodRotateAngle=0,this.frameInfoCBFlag=!1,this.waterFontParam=null,this.waterImageParam=null,this.waterCanvas=null,this.waterCanvasCtx=null,this.textCanvas=null,this.needSetFFCB=!1,this.FFCBFlag=0,this.firstFrameCB=null,this.needSetSecretKey=!1,this.keyData=null,this.keyType=1,this.runtimeModule=0,this.runtimeCBFun=null,this.streamInfoType=0,this.streamInfoCBFun=null,this.additionDataType=0,this.additionFlag=0,this.addCBFun=null,this.needSetRunTimeInfoCB=!1,this.needSetstreamInfoCB=!1,this.needPlaySound=!1,this.needSetAdditionDataCB=!1,this.needSetRunTimeInfoCBType=!1,this.PostMpStreamOffsetCBFun=null,this.needPostMpStreamOffsetCB=!1,this.CanvasSubPortMap=new Map,this.SourceTypeFlagMap=new Map,this.SplitterTypeFlagMap=new Map,this.DecodeTypeFlagMap=new Map,this.RenderTypeFlagMap=new Map,this.ManagerTypeFlagMap=new Map,this.oJSPlayerObj=null,this.supportWebCodecs=window._getFSupportWebCodecs(),this.supportSab=!!window.SharedArrayBuffer,this.offscreen=!!window.OffscreenCanvas,this.supportOffscreen=!1,this.offscreen){var l=new OffscreenCanvas(1,1),_=l.getContext("webgl");_&&(this.supportOffscreen=!0,_.getExtension("WEBGL_lose_context").loseContext()),l=null,_=null}var h=this.JSPlayM4_GetSDKVersion(),c=this.JSPlayM4_GetBuildDate();this.printfFlag>=0&&console.log("%c wasmplayer.min.js version:%s,buildDate:%s","color: blue",h,c),this.supportSIMD=!1,this.callBackParameter=ge,this.jsplayerVersion=3,this.supportWebCodecs?this.jsplayerVersion=3:this.supportSab&&this.supportOffscreen?this.jsplayerVersion=2:this.jsplayerVersion=1,this.jsplayerVersion<3&&(this.callBackParameter.bSupHardDecAVC=!1,this.callBackParameter.bSupHardDecHEVC=!1,this.callBackParameter.bSupHardOrSoft=!1),null===this.szBasePathV3&&null!=this.szBasePathV1?this.jsplayerVersion=1:null!=this.szBasePathV3&&null===this.szBasePathV1?(this.printfFlag>=0&&console.info("%c>>>> szBasePathV1 is null ","color: red"),this.jsplayerVersion=3):null===this.szBasePathV3&&null===this.szBasePathV1&&(this.printfFlag>=0&&console.info("%c>>>> szBasePathV3 and szBasePathV1 are null ","color: red"),this.fnCallBack(this.callBackParameter)),Ee().then(function(t){t?(this.supportSIMD=!0,this.printfFlag>=0&&console.log("%c>>>>your browser protocol is %s, hostname:%s, WebCodecs:%s,Sab:%s,Offscreen:%s,SIMD:%s,jsplayerVersion:%d","color: red",window.location.protocol,location.hostname,this.supportWebCodecs,this.supportSab,this.supportOffscreen,this.supportSIMD,this.jsplayerVersion)):(this.supportSIMD=!1,this.printfFlag>=0&&console.log("%c>>>>your browser protocol is %s, hostname:%s, WebCodecs:%s,Sab:%s,Offscreen:%s,SIMD:%s,jsplayerVersion:%d","color: red",window.location.protocol,location.hostname,this.supportWebCodecs,this.supportSab,this.supportOffscreen,this.supportSIMD,this.jsplayerVersion))}.bind(this)),this.wasmloaded=!1,this.jsplayerVersion>1?this.oJSPlayerObj=new fe(this,this.szBasePathV3,(function(t){var e=t.bSupHardOrSoft,a=t.bSupHardDecAVC,r=t.bSupHardDecHEVC,i=t.cmd,s=t.errorCode,x=t.status;e?(n.callBackParameter.bSupHardDecAVC=a,n.callBackParameter.bSupHardDecHEVC=r,n.callBackParameter.bSupHardOrSoft=e,n.callBackParameter.cmd=i,n.callBackParameter.errorCode=s,n.callBackParameter.status=x,n.wasmloaded=!0,n.fnCallBack(n.callBackParameter)):(n.printfFlag>=0&&console.log("%c5>not support V3hard and V3Soft ,switch V3 to V1 ","color: red"),n.jsplayerVersion=1,n.oJSPlayerObj=new be(n,n.szBasePathV1,(function(t){t.instance;var e=t.cmd,a=t.errorCode,r=t.status;n.callBackParameter.bSupHardDecAVC=!1,n.callBackParameter.bSupHardDecHEVC=!1,n.callBackParameter.bSupHardOrSoft=!1,n.callBackParameter.cmd=e,n.callBackParameter.errorCode=a,n.callBackParameter.status=r,n.wasmloaded=!0,n.fnCallBack(n.callBackParameter)}),0))}),this.nUser,this.renderEngine,this.hasWebWorker,this.setHasThread,this.jsplayerVersion):this.oJSPlayerObj=new be(this,this.szBasePathV1,(function(t){t.instance;var e=t.cmd,a=t.errorCode,r=t.status;n.callBackParameter.bSupHardDecAVC=!1,n.callBackParameter.bSupHardDecHEVC=!1,n.callBackParameter.bSupHardOrSoft=!1,n.callBackParameter.cmd=e,n.callBackParameter.errorCode=a,n.callBackParameter.status=r,n.wasmloaded=!0,n.fnCallBack(n.callBackParameter)}),0)}return e(a,[{key:"JSPlayM4_SetStreamEnd",value:function(){return 0}},{key:"JSPlayM4_GetPort",value:function(){return this.printfFlag>0&&console.log(">>>>>yff>>> JSPlayM4_GetPort 1"),this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_GetPort this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1&&this.oJSPlayerObj.JSPlayM4_GetPort(),1)}},{key:"JSPlayM4_SetStreamOpenMode",value:function(t){return this.printfFlag>0&&console.log(">>>>>yff20230817>>>>> JSPlayM4_SetStreamOpenMode 1 mode:"+t),this.streamOpenMode=t,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetStreamOpenMode this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetStreamOpenMode(t):this.oJSPlayerObj.PlayM4_SetStreamOpenMode(t),1)}},{key:"JSPlayM4_OpenStream",value:function(t,e,a){if(this.printfFlag>0&&console.log(">>>>>yff20230817>>>>> JSPlayM4_OpenStream 1 :"+t),40!==e&&console.info("%cJSPlayM4_OpenStream nSize is not 40","color: red"),4===t[8]&&0===t[9]&&(this.rtpDataNeedAdd4Size=!0),this.downloadInputDataFlag){var r=new Uint8Array(t.buffer);this.downloadRTPData(r),console.log("write 40 hik head")}if(this.HIK40Head=t,this.HIKHeadSize=e,this.HIKPoolSize=a,this.switchingV3toV1)return 1;var i=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_OpenStream this.oJSPlayerObj is null"),0):((i=this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_OpenStream(t,e,a):this.oJSPlayerObj.PlayM4_OpenStream(t,e,a))===w&&this._switchV3ToV1(this.streamOpenMode,t,e,a,this.needPlay),this.switchingV3toV1?1:i)}},{key:"JSPlayM4_OpenStreamAdvanced",value:function(t,e,a,r,i){if(this.printfFlag>0&&console.log(">>>>>yff20230817>>>>> JSPlayM4_OpenStreamAdvanced 1 :"+r),1!=t||1!=e||a<0||r.length<0||i<1048576)return console.log("%c JSPlayM4_OpenStreamAdvanced input param error nProtocolType:"+t+",nSessionInfoType:"+e+",nSessionInfoLen:"+a+",pSessionInfoData:"+r+",nBufPoolSize:"+i,"color: red"),0;if(this.downloadInputDataFlag){var n=new Uint8Array(r.buffer);this.downloadRTPData(n),console.log("write sdpinfo")}var s=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_OpenStreamAdvanced this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?s=this.oJSPlayerObj.JSPlayM4_OpenStreamAdvanced(t,e,a,r,i):console.log("20240223 V1 not support sdp openstream "),s)}},{key:"_switchV3ToV1",value:function(t,e,a,r,i){var n=this;console.log("%c5>switch V3 to V1","color: red"),this.switchingV3toV1=!0,this.jsplayerVersion=1,this.oJSPlayerObj.JSPlayM4_Stop(),this.oJSPlayerObj.JSPlayM4_CloseStream(),this.oJSPlayerObj.JSPlayM4_FreePort(),this.oJSPlayerObj=null;var s=new be(this,this.szBasePathV1,(function(x){x.instance;var o=x.cmd,f=x.errorCode,l=x.status;"loaded"===o&&(n.oJSPlayerObj=s,n.switchingV3toV1=!1,n.callBackParameter.cmd=o,n.callBackParameter.errorCode=f,n.callBackParameter.status=l,n.JSPlayM4_SetStreamOpenMode(t),n.JSPlayM4_OpenStream(e,a,r),(i||n.needPlay)&&n.JSPlayM4_Play(n.canvasID),n._switchV3ToV1ResetParam())}),0)}},{key:"_switchV3ToV1ResetParam",value:function(){if(this.needSetSecretKey&&this.JSPlayM4_SetSecretKey(this.keyData,this.keyType),this.needSetFFCB&&this.JSPlayM4_SetFirstFrameCallBack(this.FFCBFlag,this.firstFrameCB),this.needSetRunTimeInfoCB&&this.JSPlayM4_SetRunTimeInfoCallBackEx(this.runtimeModule,this.runtimeCBFun),this.needSetRunTimeInfoCBType){if(this.SourceTypeFlagMap.size>0){var t,e=M(this.SourceTypeFlagMap.keys());try{for(e.s();!(t=e.n()).done;){var a=t.value,r=this.SourceTypeFlagMap.get(a);1==r&&this.JSPlayM4_SetRunTimeInfoCallbackType(0,a,r)}}catch(t){e.e(t)}finally{e.f()}}if(this.SplitterTypeFlagMap.size>0){var i,n=M(this.SplitterTypeFlagMap.keys());try{for(n.s();!(i=n.n()).done;){var s=i.value,x=this.SplitterTypeFlagMap.get(s);1==x&&this.JSPlayM4_SetRunTimeInfoCallbackType(1,s,x)}}catch(t){n.e(t)}finally{n.f()}}if(this.DecodeTypeFlagMap.size>0){var o,f=M(this.DecodeTypeFlagMap.keys());try{for(f.s();!(o=f.n()).done;){var l=o.value,_=this.DecodeTypeFlagMap.get(l);1==_&&this.JSPlayM4_SetRunTimeInfoCallbackType(2,l,_)}}catch(t){f.e(t)}finally{f.f()}}if(this.RenderTypeFlagMap.size>0){var h,c=M(this.RenderTypeFlagMap.keys());try{for(c.s();!(h=c.n()).done;){var u=h.value,d=this.RenderTypeFlagMap.get(u);1==d&&this.JSPlayM4_SetRunTimeInfoCallbackType(3,u,d)}}catch(t){c.e(t)}finally{c.f()}}if(this.ManagerTypeFlagMap.size>0){var p,m=M(this.ManagerTypeFlagMap.keys());try{for(m.s();!(p=m.n()).done;){var S=p.value,R=this.ManagerTypeFlagMap.get(S);1==R&&this.JSPlayM4_SetRunTimeInfoCallbackType(4,S,R)}}catch(t){m.e(t)}finally{m.f()}}}return this.needSetAdditionDataCB&&this.JSPlayM4_SetAdditionDataCallBack(this.additionDataType,this.additionFlag,this.addCBFun),this.needSetstreamInfoCB&&this.JSPlayM4_SetStreamInfoCallBack(this.streamInfoType,this.streamInfoCBFun),this.needPostMpStreamOffsetCB&&this.JSPlayM4_SetPostMpStreamOffsetCallBack(this.PostMpStreamOffsetCBFun),this.needPlaySound&&this.JSPlayM4_PlaySound(),0!=this.skipErrorData&&this.oJSPlayerObj.PlayM4_SkipErrorData(this.skipErrorData),0!=this.demuxModeFlag&&this.oJSPlayerObj.PlayM4_SetDemuxModel(this.demuxModelType,this.demuxModeFlag),0!=this.globalBaseTime.year&&this.oJSPlayerObj.PlayM4_SetGlobalBaseTime(this.globalBaseTime.year,this.globalBaseTime.month,this.globalBaseTime.day,this.globalBaseTime.hour,this.globalBaseTime.min,this.globalBaseTime.sec,this.globalBaseTime.ms),-1!=this.decInterval&&this.oJSPlayerObj.PlayM4_SetIFrameDecInterval(this.decInterval),0!=this.decodeERCLevel&&this.oJSPlayerObj.PlayM4_SetDecodeERC(this.decodeERCLevel),0!=this.volume&&this.JSPlayM4_SetVolume(this.volume),0!=this.anrParamFlag&&this.oJSPlayerObj.PlayM4_SetANRParam(this.anrParamFlag,this.anrParamLevel),0!=this.resampleFlag&&this.oJSPlayerObj.PlayM4_SetResampleValue(this.resampleFlag,this.resampleRate),0!=this.displayBuf&&this.oJSPlayerObj.PlayM4_SetDisplayBuf(this.displayBuf),null!=this.waterFontParam&&this.oJSPlayerObj.PlayM4_SetWaterMarkFont(this.waterFontParam),null!=this.waterImageParam&&this.oJSPlayerObj.PlayM4_SetWaterMarkImage(this.waterImageParam),this.needSetRotateAngle&&oJSPlayerWasm._JSPlayM4_SetRotateAngle(this.port,this.twodRotateAngle),0!=this.audioDisplayBufSize&&this.oJSPlayerObj.PlayM4_SetAudioDisplayBuf(this.audioDisplayBufSize),0!=this.decodeFrameType&&this.JSPlayM4_SetDecodeFrameType(this.decodeFrameType),0!=this.needResetBuffer&&this.oJSPlayerObj.PlayM4_ReleaseInputBuffer(),0!=this.inputBufSize&&this.oJSPlayerObj.PlayM4_SetInputBufSize(this.inputBufSize),this.oJSPlayerObj.PlayM4_SetFrameInfoCallBack(this.frameInfoCBFlag),1}},{key:"JSPlayM4_SetDecodeEngine",value:function(t){if(this.printfFlag>0&&console.log(">>>>>yff20230817>>>>> JSPlayM4_SetDecodeEngine 1:"+t),0!=t&&1!=t)return console.log("0 is V3softDecode, 1 is V3hardDecoder,decodeEngine:"+t),0;this.decodeEngine=t;var e=1;if(this.jsplayerVersion>1){if(!this.supportSab&&0==t)return console.info("%c3>JSPlayM4_SetDecodeEngine(0 is soft,1 is hard):%d,SharedArrayBuffer Error , does not support Soft Decdoe!!!!!","color: red",t),0;e=this.oJSPlayerObj.JSPlayM4_SetDecodeEngine(this.decodeEngine)}return this.switchingV3toV1?1:e}},{key:"JSPlayM4_DownloadData",value:function(){return this.downloadInputDataFlag=!0,1}},{key:"JSPlayM4_SetAudioDisplayBuf",value:function(t){return this.audioDisplayBufSize=t,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetAudioDisplayBuf this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetAudioDisplayBuf(t):this.oJSPlayerObj.PlayM4_SetAudioDisplayBuf(t)}},{key:"JSPlayM4_Play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.canvasID=t;var e=1;return this.printfFlag>0&&console.log(">>>>>yff20230817>>>>> JSPlayM4_Play 1 this.supportSab:"+this.supportSab),this.needPlay=!0,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_Play this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?(e=this.oJSPlayerObj.JSPlayM4_Play(t),0!=this.aInputDataBuffer.length&&(this.oJSPlayerObj.JSPlayM4_InputData(new Uint8Array(this.aInputDataBuffer),this.aInputDataBuffer.length),this.aInputDataBuffer.splice(0,this.aInputDataBuffer.length))):(e=this.oJSPlayerObj.PlayM4_Play(t),0!=this.aInputDataBuffer.length&&(this.oJSPlayerObj.PlayM4_InputData(new Uint8Array(this.aInputDataBuffer),this.aInputDataBuffer.length),this.aInputDataBuffer.splice(0,this.aInputDataBuffer.length))),this.switchingV3toV1?1:e)}},{key:"JSPlayM4_InputData",value:function(t,e){var a;if(null===this.oJSPlayerObj||!this.wasmloaded||1==this.jsplayerVersion&&null==this.oJSPlayerObj.streamOpenMode){var r=this.aInputDataBuffer.length;if(r+e>this.iInputMaxBufSize)return console.log("WasmPlayer input over"),0;for(var i=0;i<e;i++)this.aInputDataBuffer[r+i]=t[i];return 1}if(a=this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_InputData(t,e):this.oJSPlayerObj.PlayM4_InputData(t,e),this.downloadInputDataFlag&&e>0)if(this.rtpDataNeedAdd4Size){var n=null,s=e+4,x=new Uint32Array([e]),o=new Uint8Array(x.buffer);(n=new Uint8Array(s)).set(o,0),n.set(t,4),this.downloadRTPData(n),x=null,o=null,n=null}else this.downloadRTPData(t);return a}},{key:"JSPlayM4_Stop",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(null===this.oJSPlayerObj)return console.log(">>>>>yff>>> JSPlayM4_Stop this.oJSPlayerObj is null"),0;if(this.bWriteData&&this.iFrameNum>0){console.log("download"+this.iFrameNum+"Psdata");var e=new Uint8Array(this.aTotalBuffer);this._downloadFile(e,"RTPRaw.data"),this.aTotalBuffer.splice(0,this.aTotalBuffer.length),this.bWriteData=!1,this.iFrameNum=0,e=null}return this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_Stop(t):this.oJSPlayerObj.PlayM4_Stop(t)}},{key:"JSPlayM4_CloseStream",value:function(){var t=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>>  JSPlayM4_CloseStream this.oJSPlayerObj is null"),0):(t=this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_CloseStream():this.oJSPlayerObj.PlayM4_CloseStream(),null!=this.waterCanvas&&(this.waterCanvas.remove(),this.waterCanvas=null),this.waterCanvasCtx=null,this.SourceTypeFlagMap.clear(),this.SplitterTypeFlagMap.clear(),this.DecodeTypeFlagMap.clear(),this.RenderTypeFlagMap.clear(),this.ManagerTypeFlagMap.clear(),t)}},{key:"JSPlayM4_FreePort",value:function(){var t=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_FreePort this.oJSPlayerObj is null"),0):(t=this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_FreePort():this.oJSPlayerObj.PlayM4_FreePort(),this.oJSPlayerObj=null,t)}},{key:"JSPlayM4_SetDecodeFrameType",value:function(t){var e=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetDecodeFrameType this.oJSPlayerObj is null"),0):(this.decodeFrameType=t,this.switchingV3toV1?1:(this.jsplayerVersion>1?e=this.oJSPlayerObj.JSPlayM4_SetDecodeFrameType(t):7==t?e=this.oJSPlayerObj.PlayM4_SetLostFrameMode(1):(e=this.oJSPlayerObj.PlayM4_SetLostFrameMode(0),e=this.oJSPlayerObj.PlayM4_SetDecodeFrameType(t)),e))}},{key:"JSPlayM4_PlaySound",value:function(){var t=1;return this.needPlaySound=!0,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_PlaySound this.oJSPlayerObj is null"),0):(this.SetDefaultSampleRate(),1!=(t=this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_PlaySound():this.oJSPlayerObj.PlayM4_PlaySound(0))&&(t=0),t)}},{key:"JSPlayM4_PlaySoundShare",value:function(){var t=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_PlaySoundShare this.oJSPlayerObj is null"),0):(this.SetDefaultSampleRate(),1!=(t=this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_PlaySoundShare():this.oJSPlayerObj.PlayM4_PlaySound(0))&&(t=0),t)}},{key:"SetDefaultSampleRate",value:function(){var t=1,e=new(window.AudioContext||window.webkitAudioContext),a=e.sampleRate;return e.close(),48e3!=a&&(console.log("浏览器默认采样率:",a+"Hz"),t=this.JSPlayM4_SetResampleValue(!0,a),console.log("JSPlayM4_SetResampleValue resSDSR:"+t)),t}},{key:"JSPlayM4_StopSoundShare",value:function(){var t=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_StopSoundShare this.oJSPlayerObj is null"),0):(1!=(t=this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_StopSoundShare():this.oJSPlayerObj.PlayM4_StopSound())&&(t=0),t)}},{key:"JSPlayM4_GetJPEG",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_GetJPEG this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_GetJPEG(t,e):this.oJSPlayerObj.PlayM4_GetJPEG(t,e)}},{key:"JSPlayM4_GetBMP",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_GetBMP this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_GetBMP(t,e):this.oJSPlayerObj.PlayM4_GetBMP(t,e)}},{key:"JSPlayM4_GetCropJPEG",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_GetCropJPEG this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?a=this.oJSPlayerObj.JSPlayM4_GetCropJPEG(t,e):console.log("%c1>JSPlayerV1.X does not support GetCropJPEG","color: red"),a)}},{key:"JSPlayM4_GetCropBMP",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_GetCropBMP this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?a=this.oJSPlayerObj.JSPlayM4_GetCropBMP(t,e):console.log("%c1>JSPlayerV1.X does not support GetCropBMP","color: red"),a)}},{key:"JSPlayM4_GetCanvasCapture",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_GetCanvasCapture this.oJSPlayerObj is null"),0):e<0||a<0?0:this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_GetCanvasCapture(t,e,a):this.oJSPlayerObj.PlayM4_GetCanvasCapture(t,e,a)}},{key:"JSPlayM4_StopSound",value:function(){var t=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_StopSound this.oJSPlayerObj is null"),0):(1!=(t=this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_StopSound():this.oJSPlayerObj.PlayM4_StopSound())&&(t=0),t)}},{key:"JSPlayM4_GetSDKVersion",value:function(){return"0801000B"}},{key:"JSPlayM4_GetBuildDate",value:function(){return"20251028"}},{key:"JSPlayM4_GetLastError",value:function(){return null===this.oJSPlayerObj?0:this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_GetLastError():this.oJSPlayerObj.PlayM4_GetLastError()}},{key:"JSPlayM4_Fast",value:function(){var t=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_Fast this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1&&(t=this.oJSPlayerObj.JSPlayM4_Fast()),t)}},{key:"JSPlayM4_Slow",value:function(){var t=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_Slow this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1&&(t=this.oJSPlayerObj.JSPlayM4_Slow()),t)}},{key:"JSPlayM4_SetIFrameDecInterval",value:function(t){return this.decInterval=t,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetIFrameDecInterval this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetIFrameDecInterval(t):this.oJSPlayerObj.PlayM4_SetIFrameDecInterval(t)}},{key:"JSPlayM4_Pause",value:function(t){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_Pause this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_Pause(t):this.oJSPlayerObj.PlayM4_Pause(t)}},{key:"JSPlayM4_OneByOne",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_OneByOne this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_OneByOne():this.oJSPlayerObj.PlayM4_OneByOne(t)}},{key:"JSPlayM4_OneByOneResume",value:function(){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_OneByOneResume this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_OneByOneResume():this.oJSPlayerObj.PlayM4_Pause(!1)}},{key:"JSPlayM4_SetVolume",value:function(t){var e=1;if(this.volume=t,this.switchingV3toV1)return 1;if(null===this.oJSPlayerObj)return console.log(">>>>>yff>>> JSPlayM4_SetVolume this.oJSPlayerObj is null"),0;if(this.jsplayerVersion>1)e=this.oJSPlayerObj.JSPlayM4_SetVolume(t);else{var a=t/65535*100;e=this.oJSPlayerObj.PlayM4_SetVolume(a)}return e}},{key:"JSPlayM4_GetVolume",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_GetVolume this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?(e=this.oJSPlayerObj.JSPlayM4_GetVolume(),null!=t&&t(e)):e=this.oJSPlayerObj.PlayM4_GetVolume((function(e){null!=t&&t(e/100*65535)})),e)}},{key:"JSPlayM4_SetDisplayRegion",value:function(t,e,a,r,i){var n=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],x=1;if(null===this.oJSPlayerObj)return console.log(">>>>>yff>>> JSPlayM4_SetDisplayRegion this.oJSPlayerObj is null"),0;if("number"!=typeof e||"number"!=typeof r||"number"!=typeof a||"number"!=typeof i)return console.log("param is not number"),0;if(0!=n&&1!=n&&0!=n&&1!=n)return 0;if(0!=s&&1!=s&&0!=s&&1!=s)return 0;if(!n){var o=document.getElementById(this.canvasID).width,f=document.getElementById(this.canvasID).height;if(e<0||a<0||r<0||i<0||e>o||a>o||r>f||i>f)return 0;if(a-e<16||i-r<16||a-e>o||i-r>f)return console.log(">>>JS left:"+e+",right:"+a+",top:"+r+",bottom:"+i+",bClose:"+n+",bZoomEnable:"+s+",canvasWidth:"+o+",canvasHeight:"+f),0}if(this.jsplayerVersion>1)x=this.oJSPlayerObj.JSPlayM4_SetDisplayRegion(t,e,a,r,i,n,s);else{var l={};l.left=e,l.right=a,l.top=r,l.bottom=i,x=this.oJSPlayerObj.PlayM4_SetDisplayRegion(l,!n,s)}return x}},{key:"JSPlayM4_SetPrintLogFlag",value:function(t){return this.printfFlag=t,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetPrintLogFlag this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetPrintLogFlag(t):this.oJSPlayerObj.PlayM4_OpenPlayerSDKPrintLog(t)}},{key:"JSPlayM4_RenderPrivateData",value:function(t,e){var a=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_RenderPrivateData this.oJSPlayerObj is null"),0):1!=t&&2!=t&&4!=t&&8!=t&&16!=t&&32!=t&&64!=t&&128!=t?(console.log(">>>>>yff>>> JSPlayM4_RenderPrivateDataEx intelType value error"),0):1!=e&&0!=e&&1!=e&&0!=e?(console.log(">>>>>yff>>> JSPlayM4_RenderPrivateDataEx bTrue value error"),0):(this.jsplayerVersion>1?a=this.oJSPlayerObj.JSPlayM4_RenderPrivateData(t,e):console.log("%c1>JSPlayerV1.X does not support RenderPrivateData","color: red"),a)}},{key:"JSPlayM4_RenderPrivateDataEx",value:function(t,e,a){var r=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_RenderPrivateDataEx this.oJSPlayerObj is null"),0):1!=t&&2!=t&&4!=t&&8!=t&&16!=t&&32!=t&&64!=t&&128!=t?(console.log(">>>>>yff>>> JSPlayM4_RenderPrivateDataEx intelType value error"),0):16==t&&(e<1||e>15)||32==t&&(e<1||e>7)||64==t&&(e<1||e>3)||128==t&&(e<1||e>7)?(console.log(">>>>>yff>>> JSPlayM4_RenderPrivateDataEx subType value error"),0):1!=a&&0!=a&&1!=a&&0!=a?(console.log(">>>>>yff>>> JSPlayM4_RenderPrivateDataEx bTrue value error"),0):(this.jsplayerVersion>1?r=this.oJSPlayerObj.JSPlayM4_RenderPrivateDataEx(t,e,a):console.log("%c1>JSPlayerV1.X does not support RenderPrivateDataEx","color: red"),r)}},{key:"JSPlayM4_SetCanvasSize",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetCanvasSize this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetCanvasSize(t,e,a):this.oJSPlayerObj.PlayM4_SetCanvasSize(t,e)}},{key:"JSPlayM4_SetDisplayBuf",value:function(t){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetDisplayBuf this.oJSPlayerObj is null"),0):(this.displayBuf=t,this.switchingV3toV1?1:this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetDisplayBuf(t):this.oJSPlayerObj.PlayM4_SetDisplayBuf(t))}},{key:"JSPlayM4_GetSourceBufferRemain",value:function(){return null===this.oJSPlayerObj?0:this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_GetSourceBufferRemain():this.oJSPlayerObj.PlayM4_GetInputBufSize()}},{key:"JSPlayM4_GetBufferValue",value:function(t){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_GetBufferValue this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_GetBufferValue(t):this.oJSPlayerObj.PlayM4_GetBufferValue(t)}},{key:"JSPlayM4_ReversePlay",value:function(){var t=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_ReversePlay this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?t=this.oJSPlayerObj.JSPlayM4_ReversePlay():console.log("%c1>JSPlayerV1.X does not support ReversePlay","color: red"),t)}},{key:"JSPlayM4_SetDecodeThreadNum",value:function(t){var e=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetDecodeThreadNum this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?e=this.oJSPlayerObj.JSPlayM4_SetDecodeThreadNum(t):console.log("%c1>JSPlayerV1.X does not support SetDecodeThreadNum, V1.X decocde only 1 thread","color: red"),e)}},{key:"JSPlayM4_GetCanvasSize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_GetCanvasSize this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_GetCanvasSize(t):this.oJSPlayerObj.PlayM4_GetCanvasSize()}},{key:"JSPlayM4_DisplayLostFrames",value:function(t,e,a){var r=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_DisplayLostFrames this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?r=this.oJSPlayerObj.JSPlayM4_DisplayLostFrames(t,e,a):console.log("%c1>JSPlayerV1.X does not support DisplayLostFrames","color: red"),r)}},{key:"JSPlayM4_SetIVSContraBandDrawMode",value:function(t){var e=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_DisplayLostFrames this.oJSPlayerObj is null"),0):0!=t&&1!=t?0:(this.jsplayerVersion>1?e=this.oJSPlayerObj.JSPlayM4_SetIVSContraBandDrawMode(t):console.log("%c1>JSPlayerV1.X does not support SetIVSContraBandDrawMode","color: red"),e)}},{key:"JSPlayM4_SetANRParam",value:function(t,e){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetANRParam this.oJSPlayerObj is null"),0):(this.anrParamLevel=e,this.anrParamFlag=t,this.switchingV3toV1?1:this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetANRParam(t,e):this.oJSPlayerObj.PlayM4_SetANRParam(t,e))}},{key:"JSPlayM4_SetResampleValue",value:function(t,e){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetResampleValue this.oJSPlayerObj is null"),0):(this.resampleRate=e,this.resampleFlag=t,this.switchingV3toV1?1:this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetResampleValue(t,e):this.oJSPlayerObj.PlayM4_SetResampleValue(t,e))}},{key:"JSPlayM4_SetAntialias",value:function(t){var e=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetAntialias this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?(e=this.oJSPlayerObj.JSPlayM4_SetAntialias(t),console.log("V3 JSPlayM4_SetAntialias resSA: ".concat(e))):(e=this.oJSPlayerObj.PlayM4_SetAntialias(t),console.log("V1 JSPlayM4_SetAntialias resSA: ".concat(e))),e)}},{key:"JSPlayM4_SyncToAudio",value:function(t){var e=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SyncToAudio this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?e=this.oJSPlayerObj.JSPlayM4_SyncToAudio(t):console.log("%c1>JSPlayerV1.X does not support SyncToAudio","color: red"),e)}},{key:"JSPlayM4_SetAudioThreadModel",value:function(t){var e=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetAudioThreadModel this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?e=this.oJSPlayerObj.JSPlayM4_SetAudioThreadModel(t):console.log("%c1>JSPlayerV1.X does not support SetAudioThreadModel","color: red"),e)}},{key:"JSPlayM4_SetDecodeERC",value:function(t){return this.decodeERCLevel=t,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetDecodeERC this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetDecodeERC(t):this.oJSPlayerObj.PlayM4_SetDecodeERC(t)}},{key:"JSPlayM4_SkipErrorData",value:function(t){return this.skipErrorData=t,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SkipErrorData this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SkipErrorData(t):this.oJSPlayerObj.PlayM4_SkipErrorData(t)}},{key:"JSPlayM4_SetDemuxModel",value:function(t,e){return this.demuxModelType=t,this.demuxModeFlag=e,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetDemuxModel this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetDemuxModel(t,e):this.oJSPlayerObj.PlayM4_SetDemuxModel(t,e)}},{key:"JSPlayM4_SetD3DPostProcess",value:function(t,e){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetD3DPostProcess this.oJSPlayerObj is null"),0):"number"!=typeof t||"number"!=typeof e?(console.log(">>>>>yff>>> JSPlayM4_SetD3DPostProcess nPostType or fValue is not number"),0):1!==t&&2!==t&&3!==t&&4!==t&&5!==t?(console.log(">>>>>yff>>> JSPlayM4_SetD3DPostProcess nPostType is 1~5"),0):1===t&&(e<-1||e>1)||2===t&&(e<0||e>1)||3===t&&(e<-1||e>1)||4===t&&(e<-1||e>1)||5===t&&(e<0||e>1)?(console.log(">>>>>yff>>> JSPlayM4_SetD3DPostProcess pFontParam f* is 0~1 or -1~1"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetD3DPostProcess(t,e):this.oJSPlayerObj.PlayM4_SetD3DPostProcess(t,e)}},{key:"JSPlayM4_SetFirstFrameCallBack",value:function(t,e){return this.needSetFFCB=!0,this.FFCBFlag=t,this.firstFrameCB=e,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetFirstFrameCallBack this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetFirstFrameCallBack(t,e):this.oJSPlayerObj.PlayM4_SetFirstFrameCallBack(t,e)}},{key:"JSPlayM4_SetDecCallBack",value:function(t,e){return null===this.oJSPlayerObj||"function"!=typeof e?(console.log(">>>>>yff>>> JSPlayM4_SetDecCallBack this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetDecCallBack(t,e):this.oJSPlayerObj.PlayM4_SetDecCallBack(t,e)}},{key:"JSPlayM4_SetHardDecToJepgCallBack",value:function(t,e){return null==t||null==t.nHardToJpegQuality||null==t.nHardToJpegInterval||null==t.nHardToJpegZoomWidth||null==t.nHardToJpegZoomHeight||null==t.nZoomResolutionFlag||t.nHardToJpegQuality<=0||t.nHardToJpegQuality>1||t.nHardToJpegInterval<1||t.nHardToJpegZoomWidth<1||t.nHardToJpegZoomHeight<1||0!=t.nZoomResolutionFlag&&1!=t.nZoomResolutionFlag?0:null===this.oJSPlayerObj||"function"!=typeof e?(console.log(">>>>>yff>>> JSPlayM4_SetHardDecToJepgCallBack this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetHardDecToJepgCallBack(t,e):(console.log("%c1>JSPlayerV1.X does not support SetHardDecToJepgCallBack","color: red"),0)}},{key:"JSPlayM4_SetDisplayCallBack",value:function(t,e){return null===this.oJSPlayerObj||"function"!=typeof e?(console.log(">>>>>yff>>> JSPlayM4_SetDisplayCallBack this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetDisplayCallBack(t,e):this.oJSPlayerObj.PlayM4_SetDisplayCallBack(e)}},{key:"JSPlayM4_SetFrameInfoCallBack",value:function(t){return this.frameInfoCBFlag=t,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetFrameInfoCallBack this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetFrameInfoCallBack(t):this.oJSPlayerObj.PlayM4_SetFrameInfoCallBack(t)}},{key:"JSPlayM4_SetDecCBStream",value:function(t){return null===this.oJSPlayerObj||t<1||t>3?(console.log(">>>>>yff>>> JSPlayM4_SetDecCBStream this.oJSPlayerObj is null stream:"+t),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetDecCBStream(t):this.oJSPlayerObj.PlayM4_SetDecCBStream(t)}},{key:"JSPlayM4_GetFrameInfo",value:function(){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_GetFrameInfo this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_GetFrameInfo():this.oJSPlayerObj.PlayM4_GetFrameInfo()}},{key:"JSPlayM4_GetAdditionData",value:function(){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_GetAdditionData this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_GetAdditionData():(console.log("%c1>JSPlayerV1.X does not support GetAdditionData","color: red"),0)}},{key:"JSPlayM4_SetAdditionDataCallBack",value:function(t,e,a){return this.additionDataType=t,this.additionFlag=e,this.addCBFun=a,this.needSetAdditionDataCB=!0,null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetAdditionDataCallBack this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetAdditionDataCallBack(t,e,a):this.oJSPlayerObj.PlayM4_SetAdditionDataCallBack(t,e,a)}},{key:"JSPlayM4_GetPlayedTimeEx",value:function(t){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_GetPlayedTimeEx this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_GetPlayedTimeEx(t):this.oJSPlayerObj.PlayM4_GetPlayedTimeEx(t)}},{key:"JSPlayM4_GetFileTime",value:function(t){var e=0;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_GetFileTime this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?(e=this.oJSPlayerObj.JSPlayM4_GetFileTime(),null!=t&&t(e)):e=this.oJSPlayerObj.PlayM4_GetFileTime(t),1e3*e)}},{key:"JSPlayM4_GetMpOffset",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,n=-1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_GetMpOffset this.oJSPlayerObj is null"),-1):(this.jsplayerVersion>1?(n=this.oJSPlayerObj.JSPlayM4_GetMpOffset(e,a,r,i),null!=t&&t(n)):n=this.oJSPlayerObj.PlayM4_GetMpOffset(t,e),n)}},{key:"JSPlayM4_ResetBuffer",value:function(t){var e=1;return this.needResetBuffer=!0,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_ResetBuffer this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?e=this.oJSPlayerObj.JSPlayM4_ResetBuffer(t):(e=this.oJSPlayerObj.PlayM4_ReleaseInputBuffer(),e=this.oJSPlayerObj.PlayM4_ResetBuffer(t)),e)}},{key:"JSPlayM4_SetGlobalBaseTime",value:function(t,e,a,r,i,n,s){return t<0||e<0||e>12||a<0||a>31||r<0||r>=24||i<0||i>=60||n<0||n>=60||s<0||s>=1e3?0:(this.globalBaseTime={year:t,month:e,day:a,hour:r,min:i,sec:n,ms:s},this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetGlobalBaseTime this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetGlobalBaseTime(t,e,a,r,i,n,s):this.oJSPlayerObj.PlayM4_SetGlobalBaseTime(t,e,a,r,i,n,s))}},{key:"JSPlayM4_SetSecretKey",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.needSetSecretKey=!0,this.keyData=t,this.keyType=e,this.switchingV3toV1)return 1;if(null===this.oJSPlayerObj)return console.log(">>>>>yff>>> JSPlayM4_SetSecretKey this.oJSPlayerObj is null"),0;if(1!=e&&2!=e)return 0;var a=0;return 1==e?a=128:2==e&&(a=256),this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetSecretKey(e,t,a):this.oJSPlayerObj.PlayM4_SetSecretKey(e,t,a)}},{key:"JSPlayM4_SetRunTimeInfoCallBackEx",value:function(t,e){return this.runtimeModule=t,this.runtimeCBFun=e,this.needSetRunTimeInfoCB=!0,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetRunTimeInfoCallBackEx this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetRunTimeInfoCallBackEx(t,e):this.oJSPlayerObj.PlayM4_SetRunTimeInfoCallBackEx(t,e)}},{key:"JSPlayM4_SetRunTimeInfoCallbackType",value:function(t,e,a){switch((t>4||t<0||e<0||0!=a&&1!=a)&&console.log(">>>>>yff>>> JSPlayM4_SetRunTimeInfoCallbackType param error nModule:"+t+",nType:"+e+",nFlag:"+a),t){case 0:a?this.SourceTypeFlagMap.set(e,1):this.SourceTypeFlagMap.delete(e);break;case 1:a?this.SplitterTypeFlagMap.set(e,1):this.SplitterTypeFlagMap.delete(e);break;case 2:a?this.DecodeTypeFlagMap.set(e,1):this.DecodeTypeFlagMap.delete(e);break;case 3:a?this.RenderTypeFlagMap.set(e,1):this.RenderTypeFlagMap.delete(e);break;case 4:a?this.ManagerTypeFlagMap.set(e,1):this.ManagerTypeFlagMap.delete(e);break;default:return 0}return this.needSetRunTimeInfoCBType=!0,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetRunTimeInfoCallbackType this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetRunTimeInfoCallbackType(t,e,a):this.oJSPlayerObj.PlayM4_SetRunTimeInfoCallbackType(t,e,a)}},{key:"JSPlayM4_SetStreamInfoCallBack",value:function(t,e){return this.streamInfoCBFun=e,this.streamInfoType=t,this.needSetstreamInfoCB=!0,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetStreamInfoCallBack this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetStreamInfoCallBack(t,e):this.oJSPlayerObj.PlayM4_SetStreamInfoCallBack(t,e)}},{key:"JSPlayM4_SetPostMpStreamOffsetCallBack",value:function(t){return t&&"function"==typeof t||null===t?(this.PostMpStreamOffsetCBFun=t,this.needPostMpStreamOffsetCB=!0,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetPostMpStreamOffsetCallBack this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetPostMpStreamOffsetCallBack(t):this.oJSPlayerObj.PlayM4_SetPostMpStreamOffsetCallBack(t)):0}},{key:"JSPlayM4_SetPlayOrBackSwitchMode",value:function(t){var e=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetPlayOrBackSwitchMode this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?e=this.oJSPlayerObj.JSPlayM4_SetPlayOrBackSwitchMode(t):console.log("%c1>JSPlayerV1.X does not support SetPlayOrBackSwitchMode","color: red"),e)}},{key:"JSPlayM4_SetStretchPlay",value:function(t,e){var a=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetStretchPlay this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?a=this.oJSPlayerObj.JSPlayM4_SetStretchPlay(t,e):console.log("%c1>JSPlayerV1.X does not support SetStretchPlay","color: red"),a)}},{key:"JSPlayM4_SetAutoSmoothPlay",value:function(t){var e=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetAutoSmoothPlay this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?e=this.oJSPlayerObj.JSPlayM4_SetAutoSmoothPlay(t):console.log("%c1>JSPlayerV1.X does not support SetAutoSmoothPlay","color: red"),e)}},{key:"JSPlayM4_KeepPlaySpeed",value:function(t){var e=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_KeepPlaySpeed this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?e=this.oJSPlayerObj.JSPlayM4_KeepPlaySpeed(t):console.log("%c1>JSPlayerV1.X does not support KeepPlaySpeed","color: red"),e)}},{key:"JSPlayM4_IgnoreHeaderAudioDefine",value:function(t){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_IgnoreHeaderAudioDefine this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_IgnoreHeaderAudioDefine(t):this.oJSPlayerObj.PlayM4_IgnoreHeaderAudioDefine(t)}},{key:"JSPlayM4_SetSycGroup",value:function(t){var e=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetSycGroup this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?e=this.oJSPlayerObj.JSPlayM4_SetSycGroup(t):console.log("%c1>JSPlayerV1.X does not support SetSycGroup","color: red"),e)}},{key:"JSPlayM4_SetRotateAngle",value:function(t){return"number"!=typeof t?(console.log(">>>>>yff>>> JSPlayM4_SetRotateAngle nValue is not number"),0):0!=t&&90!=t&&180!=t&&270!=t?(console.log(">>>>>yff>>> JSPlayM4_SetRotateAngle only support 0/90/180/270"),0):(this.needSetRotateAngle=!0,this.twodRotateAngle=t,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetRotateAngle this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetRotateAngle(t):this.oJSPlayerObj.PlayM4_SetRotateAngle(t))}},{key:"JSPlayM4_SetPanoramaDisplayEffect",value:function(t){return"number"!=typeof t?(console.log(">>>>>yff>>> JSPlayM4_SetPanoramaDisplayEffect eDisplayEffect is not number"),0):0!=t&&1!=t&&2!=t&&3!=t?(console.log(">>>>>yff>>> JSPlayM4_SetPanoramaDisplayEffect only support 0/1/2/3"),0):this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetPanoramaDisplayEffect this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetPanoramaDisplayEffect(t):(console.log("%c1>JSPlayerV1.X does not support SetPanoramaDisplayEffect 20250910","color: red"),0)}},{key:"JSPlayM4_SetPanoramaSphereViewParam",value:function(t,e){var a=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetPanoramaSphereViewParam this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?a=this.oJSPlayerObj.JSPlayM4_SetPanoramaSphereViewParam(t,e):console.log("%c1>JSPlayerV1.X does not support  JSPlayM4_SetPanoramaSphereViewParam 20250910","color: red"),a)}},{key:"JSPlayM4_GetPanoramaSphereViewParam",value:function(t,e){var a=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_GetPanoramaSphereViewParam this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?a=this.oJSPlayerObj.JSPlayM4_GetPanoramaSphereViewParam(t,e):console.log("%c1>JSPlayerV1.X does not support  JSPlayM4_GetPanoramaSphereViewParam 20250910","color: red"),a)}},{key:"JSPlayM4_FEC_SetCanvasID",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=1;return this.FECcanvasIDArray=t.split(","),null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_FEC_SetCanvasID this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?e=this.oJSPlayerObj.JSPlayM4_FEC_SetCanvasID(t):console.log("%c1>JSPlayerV1.X does not support FEC 20230922","color: red"),e)}},{key:"JSPlayM4_FEC_ResetCorrectType",value:function(t,e,a){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_FEC_ResetCorrectType this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_FEC_ResetCorrectType(t,e,a):this.oJSPlayerObj.PlayM4_FEC_ResetCorrectType(t,e,a)}},{key:"JSPlayM4_FEC_GetPort",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_FEC_GetPort this.oJSPlayerObj is null"),-1):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_FEC_GetPort(t,e,a):this.oJSPlayerObj.PlayM4_FEC_GetPort(t,e,a)}},{key:"JSPlayM4_FEC_Enable",value:function(t){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_FEC_Enable this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_FEC_Enable(t):this.oJSPlayerObj.PlayM4_FEC_Enable(t)}},{key:"JSPlayM4_FEC_SetParam",value:function(t,e){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_FEC_SetParam this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_FEC_SetParam(t,e):this.oJSPlayerObj.PlayM4_FEC_SetParam(t,e)}},{key:"JSPlayM4_FEC_GetParam",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_FEC_GetParam this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_FEC_GetParam(t,e):(console.log("%c1>JSPlayerV1.X does not support  FEC 20230922","color: red"),1)}},{key:"JSPlayM4_FEC_SetViewParam",value:function(t,e,a){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_FEC_SetViewParam this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_FEC_SetViewParam(t,e,a):this.oJSPlayerObj.PlayM4_FEC_SetViewParam(t,e,a)}},{key:"JSPlayM4_FEC_GetViewParam",value:function(t,e,a){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_FEC_GetViewParam this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_FEC_GetViewParam(t,e,a):this.oJSPlayerObj.PlayM4_FEC_GetViewParam(t,e,a)}},{key:"JSPlayM4_FEC_SetWnd",value:function(t,e){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_FEC_SetWnd this.oJSPlayerObj is null"),0):(this.CanvasSubPortMap.set(t,e),this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_FEC_SetWnd(t,e):this.oJSPlayerObj.PlayM4_FEC_SetWnd(t,e))}},{key:"JSPlayM4_FEC_Disable",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_FEC_Disable this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?r=this.oJSPlayerObj.JSPlayM4_FEC_Disable(t,e,a):console.log("%c1>JSPlayerV1.X does not support FEC 20230922","color: red"),r)}},{key:"JSPlayM4_FEC_DelPort",value:function(t){var e=1;if(null===this.oJSPlayerObj)return console.log(">>>>>yff>>> JSPlayM4_FEC_DelPort this.oJSPlayerObj is null"),0;var a=this.CanvasSubPortMap.get(t);this.jsplayerVersion>1?e=this.oJSPlayerObj.JSPlayM4_FEC_DelPort(t):console.log("%c1>JSPlayerV1.X does not support FEC 20230922","color: red");var r=document.getElementById(a);if(r){var i=r.cloneNode(!0);r.parentNode.replaceChild(i,r)}return this.CanvasSubPortMap.delete(t),e}},{key:"JSPlayM4_FEC_SetDisplayRegion",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,n=arguments.length>5?arguments[5]:void 0,s=arguments.length>6?arguments[6]:void 0,x=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_FEC_SetDisplayRegion this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?x=this.oJSPlayerObj.JSPlayM4_FEC_SetDisplayRegion(t,e,a,r,i,n,s):console.log("%c1>JSPlayerV1.X does not support FEC 20230922","color: red"),x)}},{key:"JSPlayM4_FEC_SetBackCilling",value:function(t,e){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_FEC_SetBackCilling this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_FEC_SetBackCilling(t,e):this.oJSPlayerObj.PlayM4_FEC_SetBackCilling(t,e)}},{key:"JSPlayM4_FEC_GetPTZPort",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=-1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_FEC_GetPTZPort this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?i=this.oJSPlayerObj.JSPlayM4_FEC_GetPTZPort(t,e,a,r):console.log("%c1>JSPlayerV1.X does not support FEC 20230922","color: red"),i)}},{key:"JSPlayM4_FEC_SetPTZDisplayMode",value:function(t){var e=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_FEC_SetPTZDisplayMode this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?e=this.oJSPlayerObj.JSPlayM4_FEC_SetPTZDisplayMode(t):console.log("%c1>JSPlayerV1.X does not support FEC 20230922","color: red"),e)}},{key:"JSPlayM4_FEC_Capture",value:function(t,e){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_FEC_Capture this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_FEC_Capture(t,e):this.oJSPlayerObj.PlayM4_FEC_Capture(t,e)}},{key:"JSPlayM4_SetVideoCropInfo",value:function(t){var e=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetVideoCropInfo this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?console.log("%c1>JSPlayerV3.X does not support SetVideoCropInfo,","color: red"):e=this.oJSPlayerObj.PlayM4_SetVideoCropInfo(t),e)}},{key:"JSPlayM4_IsVisible",value:function(t){return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_IsVisible this.oJSPlayerObj is null"),0):1!=t&&0!=t?0:this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_IsVisible(t):this.oJSPlayerObj.PlayM4_IsVisible(t)}},{key:"JSPlayM4_SetInputBufSize",value:function(t){var e=1;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetInputBufSize this.oJSPlayerObj is null"),0):(this.inputBufSize=t,this.jsplayerVersion>1?console.log("%c1>JSPlayerV3.X does not support SetInputBufSize,","color: red"):e=this.oJSPlayerObj.PlayM4_SetInputBufSize(t),e)}},{key:"JSPlayM4_GetYUVBufSize",value:function(){var t=0;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_GetYUVBufSize this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?console.log("%c1>JSPlayerV3.X does not support GetYUVBufSize,","color: red"):t=this.oJSPlayerObj.PlayM4_GetYUVBufSize(),t)}},{key:"JSPlayM4_ClearCanvas",value:function(){var t=0;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_ClearCanvas this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?console.log("%c1>JSPlayerV3.X does not support ClearCanvas,","color: red"):t=this.oJSPlayerObj.PlayM4_ClearCanvas(),t)}},{key:"JSPlayM4_ReleaseInputBuffer",value:function(){var t=0;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_ReleaseInputBuffer this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?console.log("%c1>JSPlayerV3.X does not support ReleaseInputBuffer,","color: red"):t=this.oJSPlayerObj.PlayM4_ReleaseInputBuffer(),t)}},{key:"JSPlayM4_GetDecodeFrameType",value:function(){var t=0;return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_GetDecodeFrameType this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?console.log("%c1>JSPlayerV3.X does not support GetDecodeFrameType,","color: red"):t=this.oJSPlayerObj.PlayM4_GetDecodeFrameType(),t)}},{key:"JSPlayM4_SetMosaicType",value:function(t){var e=0;return null==t||null==t||null==t.pstMosaicColor||null==t.pstMosaicColor.fMosaicColorR||null==t.pstMosaicColor.fMosaicColorG||null==t.pstMosaicColor.fMosaicColorB||null==t.pstMosaicColor.fMosaicColorA||null==t.nMosaicSize||null==t.nMosaicType||t.pstMosaicColor.fMosaicColorR<0||t.pstMosaicColor.fMosaicColorR>255||t.pstMosaicColor.fMosaicColorG<0||t.pstMosaicColor.fMosaicColorG>255||t.pstMosaicColor.fMosaicColorB<0||t.pstMosaicColor.fMosaicColorB>255||t.pstMosaicColor.fMosaicColorA<0||t.pstMosaicColor.fMosaicColorA>100||t.nMosaicSize<1||t.nMosaicSize>100||1!=t.nMosaicType&&3!=t.nMosaicType&&5!=t.nMosaicType?0:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetMosaicType this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?e=this.oJSPlayerObj.JSPlayM4_SetMosaicType(t):console.log("%c1>JSPlayerV1.X does not support SetMosaicType,","color: red"),e)}},{key:"JSPlayM4_SelectIntelInfoFeatureToDraw",value:function(t){var e=0;if(null==t||null==t)return 0;if(0!=t.bTrue&&1!=t.bTrue)return 0;if(0!=t.nMode&&1!=t.nMode&&2!=t.nMode)return 0;if(t.NodeNumber<0||t.NodeNumber>160)return 0;if(t.NodeNumber!=t.pIntelInfoNode.length)return 0;for(var a=0;a<t.NodeNumber;a++){if(t.pIntelInfoNode[a].nID<0)return 0;if(1!=t.pIntelInfoNode[a].nType&&2!=t.pIntelInfoNode[a].nType&&4!=t.pIntelInfoNode[a].nType&&8!=t.pIntelInfoNode[a].nType)return 0}return null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SelectIntelInfoFeatureToDraw this.oJSPlayerObj is null"),0):(this.jsplayerVersion>1?e=this.oJSPlayerObj.JSPlayM4_SelectIntelInfoFeatureToDraw(t):console.log("%cJSPlayM4_SelectIntelInfoFeatureToDraw V1 not support","color: red"),e)}},{key:"JSPlayM4_SetWaterMarkFont",value:function(t){if(null!=t){if(null!=t.nFontAlign&&null!=t.nFontAlign||(t.nFontAlign=0),null!=t.nColorAdapt&&null!=t.nColorAdapt||(t.nColorAdapt=0),null==t.pstCanvasAdapt&&(t.pstCanvasAdapt={},t.pstCanvasAdapt.nCanvasAdaptMode=0,t.pstCanvasAdapt.ntotalRowSpace=0,t.pstCanvasAdapt.ntotalColSpace=0,t.pstCanvasAdapt.nBaseCanvasWidth=0,t.pstCanvasAdapt.nBaseCanvasHeight=0),this.printfFlag>0){console.log("%cJSPlayerInterface.js JSPlayM4_SetWaterMarkFont:string:"+t.pFontString+",fontcolr,fR:"+t.pstFontColor.fR+",fG:"+t.pstFontColor.fG+",fB:"+t.pstFontColor.fB+",fA:"+t.pstFontColor.fA+",fontSizeWidth:"+t.pstFontSize.nFontWidth+",fontSizeHeight:"+t.pstFontSize.nFontHeight+",rotateAngle:"+t.pstFontRotate.fRotateAngle+",fontFamily:"+t.pFontFamily,"color:red");var e=document.getElementById(this.canvasID).width,a=document.getElementById(this.canvasID).height;console.log("canvasWidht:"+e+",canvasHeight:"+a),console.log("fullScreen:"+t.pstFontRotate.fFillFullScreen+",rowNum:"+t.pstFontNumber.nRowNumber+",colNum:"+t.pstFontNumber.nColNumber+",space:"+t.pSpace+",fontAlign:"+t.nFontAlign+",colorAdapt:"+t.nColorAdapt),console.log("adaptMode:"+t.pstCanvasAdapt.nCanvasAdaptMode+",baseWidth:"+t.pstCanvasAdapt.nBaseCanvasWidth+",baseHeight:"+t.pstCanvasAdapt.nBaseCanvasHeight+",rowSpace:"+t.pstCanvasAdapt.nRowSpace+",colSpace:"+t.pstCanvasAdapt.nColSpace)}if(void 0===t.pFontString||null==t.pstStartPos||null==t.pstFontColor||null==t.pstFontSize||null==t.pstFontRotate||null==t.pFontFamily||null==t.pstStartPos.fX||null==t.pstStartPos.fY||null==t.pstFontColor.fR||null==t.pstFontColor.fG||null==t.pstFontColor.fB||null==t.pstFontColor.fA||null==t.pstFontSize.nFontWidth||null==t.pstFontSize.nFontHeight||null==t.pstFontRotate.fRotateAngle||null==t.pstFontRotate.fFillFullScreen||null==t.pSpace)return console.log(">>>>>yff>>> JSPlayM4_SetWaterMarkFont pFontParam undefined"),0;if(t.pstStartPos.fX>1||t.pstStartPos.fX<0||t.pstStartPos.fY>1||t.pstStartPos.fY<0||t.pstFontColor.fR>1||t.pstFontColor.fR<0||t.pstFontColor.fG>1||t.pstFontColor.fG<0||t.pstFontColor.fB>1||t.pstFontColor.fB<0||t.pstFontColor.fA>1||t.pstFontColor.fA<0)return console.log(">>>>>yff>>> JSPlayM4_SetWaterMarkFont pFontParam f* is 0~1"),0;if(1!=t.pstFontRotate.fFillFullScreen&&0!=t.pstFontRotate.fFillFullScreen&&1!=t.pstFontRotate.fFillFullScreen&&0!=t.pstFontRotate.fFillFullScreen)return console.log(">>>>>yff>>> pFontParam.pstFontRotate.fFillFullScreen is true or false"),0;if(0==t.pstCanvasAdapt.nCanvasAdaptMode&&t.pstFontRotate.fFillFullScreen&&(t.pstFontNumber.nRowNumber<1||t.pstFontNumber.nColNumber<1||null==t.pstFontNumber.nRowNumber||null==t.pstFontNumber.nColNumber||t.pstFontNumber.nRowNumber>16||t.pstFontNumber.nColNumber>16))return console.log(">>>>>yff>>> pFontParam.pstFontNumber row/col num should be greater than 1 and les than 16"),0;if("string"!=typeof t.pFontFamily)return console.log(">>>>>yff>>> pFontParam.pFontFamily is not string"),0;if(!Array.isArray(t.pFontString)||t.pFontString.length>9)return console.log(">>>>>yff>>> pFontParam.pFontString is not array, pFontParam.pFontString.length:"+t.pFontString.length),0;if(0!=t.pstCanvasAdapt.nCanvasAdaptMode&&1!=t.pstCanvasAdapt.nCanvasAdaptMode&&2!=t.pstCanvasAdapt.nCanvasAdaptMode)return console.log(">>>>>yff>>> pFontParam.pstCanvasAdapt.nCanvasAdaptMode:(0,1,2)"+t.pstCanvasAdapt.nCanvasAdaptMode),0;if(1==t.pstCanvasAdapt.nCanvasAdaptMode&&(null==t.pstCanvasAdapt.nRowSpace||null==t.pstCanvasAdapt.nColSpace||t.pstCanvasAdapt.nRowSpace<0||t.pstCanvasAdapt.nColSpace<0))return console.log(">>>>>yff>>> nCanvasAdaptMode is 1, nRowSpace:"+t.pstCanvasAdapt.nRowSpace+",pFontParam.pstCanvasAdapt.nColSpace:"+t.pstCanvasAdapt.nColSpace),0;if(2==t.pstCanvasAdapt.nCanvasAdaptMode&&(null==t.pstCanvasAdapt.nBaseCanvasWidth||null==t.pstCanvasAdapt.nBaseCanvasHeight||t.pstCanvasAdapt.nBaseCanvasWidth<0||t.pstCanvasAdapt.nBaseCanvasHeight<0))return console.log(">>>>>yff>>> nCanvasAdaptMode is 2, nBaseCanvasWidth:"+t.pstCanvasAdapt.nBaseCanvasWidth+",pFontParam.pstCanvasAdapt.nBaseCanvasHeight:"+t.pstCanvasAdapt.nBaseCanvasHeight),0;if(0==t.pstCanvasAdapt.nCanvasAdaptMode&&(t.pstCanvasAdapt.ntotalColSpace=0,t.pstCanvasAdapt.ntotalRowSpace=0),1==t.pstCanvasAdapt.nCanvasAdaptMode){var r=t.pstFontRotate.fRotateAngle%360/360*2*Math.PI;if(null==this.waterCanvas&&(this.waterCanvas=document.createElement("canvas"),null!=this.waterCanvas&&(this.waterCanvasCtx=this.waterCanvas.getContext("2d"))),null!=this.waterCanvasCtx){var i=Math.min(t.pstFontSize.nFontHeight,t.pstFontSize.nFontWidth);this.waterCanvasCtx.font=i.toString()+"px "+t.pFontFamily;for(var n=0,s=0;s<t.pFontString.length;s++){var x=this.waterCanvasCtx.measureText(t.pFontString[s]).width;n=n>x?n:x}var o=t.pSpace*parseInt(this.waterCanvasCtx.font)*t.pFontString.length;t.pstCanvasAdapt.ntotalColSpace=t.pstCanvasAdapt.nColSpace+Math.abs(n*Math.cos(r))+Math.abs(o*Math.sin(r)),t.pstCanvasAdapt.ntotalRowSpace=t.pstCanvasAdapt.nRowSpace+Math.abs(o*Math.cos(r))+Math.abs(n*Math.sin(r)),(t.pstCanvasAdapt.ntotalColSpace<0||t.pstCanvasAdapt.ntotalRowSpace<0)&&(t.pstCanvasAdapt.nCanvasAdaptMode=0)}}2==t.pstCanvasAdapt.nCanvasAdaptMode&&(t.pstCanvasAdapt.ntotalRowSpace=0,t.pstCanvasAdapt.ntotalColSpace=0),(t.pstFontSize.nFontHeight<=0||t.pstFontSize.nFontWidth<=0)&&(t=null)}return this.waterFontParam=t,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetWaterMarkFont this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetWaterMarkFont(t):this.oJSPlayerObj.PlayM4_SetWaterMarkFont(t)}},{key:"JSPlayM4_SetWaterMarkImage",value:function(t){if(!("ImageDecoder"in window))return console.log(">>>>>yff>>> window not support ImageDecoder"),w;if(null!=t){if(void 0===t.pImageData)return console.log(">>>>>yff>>> JSPlayM4_SetWaterMarkImage pImageParam.pImageData undefined"),0;if(void 0===t.pImageType||"jpg"!=t.pImageType&&"jpeg"!=t.pImageType&&"png"!=t.pImageType&&"gif"!=t.pImageType&&"bmp"!=t.pImageType&&"webp"!=t.pImageType&&"avif"!=t.pImageType)return console.log(">>>>>yff>>> JSPlayM4_SetWaterMarkImage pImageParam.pImageType:"+t.pImageType+" error"),0;(void 0===t.pstRectPos||t.pstRectPos.fLeft<0||t.pstRectPos.fLeft>1||t.pstRectPos.fRight<0||t.pstRectPos.fRight>1||t.pstRectPos.fTop<0||t.pstRectPos.fTop>1||t.pstRectPos.fBottom<0||t.pstRectPos.fBottom>1)&&(t.pstRectPos={fLeft:0,fRight:.1,fTop:0,fBottom:.1}),(void 0===t.fAlpha||t.fAlpha<0||t.fAlpha>1)&&(t.fAlpha=1)}return this.waterImageParam=t,this.switchingV3toV1?1:null===this.oJSPlayerObj?(console.log(">>>>>yff>>> JSPlayM4_SetWaterMarkImage this.oJSPlayerObj is null"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_SetWaterMarkImage(t):this.oJSPlayerObj.PlayM4_SetWaterMarkImage(t)}},{key:"JSPlayM4_InitEncoder",value:function(t,e){return null==t||null==t?(console.log("%cJSPlayerInterface.js JSPlayM4_InitEncoder encodeVideoInfo:"+t+",encodeAudioInfo:"+e,"color:red"),0):0!==t.encodeType?(console.log("%cJSPlayerInterface.js JSPlayM4_InitEncoder encodeVideoInfo.encodeType(only support 0(H264)):"+t.encodeType,"color:red"),0):0!=t.baseTimeStampMode&&1!=t.baseTimeStampMode?(console.log("%cJSPlayerInterface.js JSPlayM4_InitEncoder encodeVideoInfo.baseTimeStampMode(only support 0(start from 0),1(old)):"+t.baseTimeStampMode,"color:red"),0):0!=t.encodeWidth&&(t.encodeWidth>1920||t.encodeWidth<32)?(console.log("%cJSPlayerInterface.js JSPlayM4_InitEncoder encodeVideoInfo.encodeWidth(32x32 to 1920x1088 pixels):"+t.encodeWidth,"color:red"),0):0!=t.encodeHeight&&(t.encodeHeight>1088||t.encodeHeight<32)?(console.log("%cJSPlayerInterface.js JSPlayM4_InitEncoder encodeVideoInfo.encodeWidth(32x32 to 1920x1088 pixels encodeVideoInfo.encodeHeight:"+t.encodeHeight,"color:red"),0):0!=t.bitrate&&t.bitrate<0?(console.log("%cJSPlayerInterface.js JSPlayM4_InitEncoder ncodeVideoInfo.bitrate( need largger than 0):"+t.bitrate,"color:red"),0):0!=t.framerate&&t.framerate<0?(console.log("%cJSPlayerInterface.js JSPlayM4_InitEncoder encodeVideoInfo.framerate( need largger than 0):"+t.framerate,"color:red"),0):0!=t.bitrateMode&&1!=t.bitrateMode?(console.log("%cJSPlayerInterface.js JSPlayM4_InitEncoder encodeVideoInfo.bitrateMode only support 0(variable) and 1(constant)","color:red"),0):0!=t.latencyMode&&1!=t.latencyMode?(console.log("%cJSPlayerInterface.js JSPlayM4_InitEncoder encodeVideoInfo.latencyMode only support 0(realtime) and 1(quality)","color:red"),0):(null==t.getOriginData&&(t.getOriginData=0),0!=t.getOriginData&&1!=t.getOriginData?(console.log("%cJSPlayerInterface.js JSPlayM4_InitEncoder encodeVideoInfo.getOriginData only support 0(crop) and 1(origin)","color:red"),0):null==e||null==e?(console.log("%cJSPlayerInterface.js JSPlayM4_InitEncoder encodeAudioInfo:"+e,"color:red"),0):0!=e.encodeType?(console.log("%cJSPlayerInterface.js JSPlayM4_InitEncoder encodeAudioInfo.encodeType(only support 0(aac)):"+e.encodeType,"color:red"),0):0!=e.sampleRate&&48e3!=e.sampleRate&&44100!=e.sampleRate?(console.log("%cJSPlayerInterface.js JSPlayM4_InitEncoder encodeAudioInfo.sampleRate(only support 48k and 44.1k):"+e.sampleRate,"color:red"),0):0!=e.numberOfChannels&&1!=e.numberOfChannels?(console.log("%cJSPlayerInterface.js JSPlayM4_InitEncoder encodeAudioInfo.numberOfChannels (only support single channel):"+e.numberOfChannels,"color:red"),0):0!=e.bitrate&&128e3!=e.bitrate?(console.log("%cJSPlayerInterface.js JSPlayM4_InitEncoder encodeAudioInfo.bitrate(only support 128000):"+e.bitrate,"color:red"),0):(null==e.recoderAudioAnyWhere&&(e.recoderAudioAnyWhere=0),0!=e.recoderAudioAnyWhere&&1!=e.recoderAudioAnyWhere?(console.log("%cJSPlayerInterface.js JSPlayM4_InitEncoder encodeAudioInfo.recoderAudioAnyWhere(only support 0 and 1):"+e.recoderAudioAnyWhere,"color:red"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_InitEncoder(t,e):(console.log("%conly hard decoder support recoder,V1 not support (20240801)","color: red"),0)))}},{key:"JSPlayM4_StartEncode",value:function(t,e){return 1===window.g_recorderFlag?(console.log("%conly support one recorder at the same time!","color: red"),0):(window.g_recorderFlag=1,"function"!=typeof t||"function"!=typeof e?(console.log("%cJSPlayM4_StartEncode param need CBfunction videoRawDataFunCB:"+t+",audioRawDataFunCB:"+e,"color: red"),0):this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_StartEncode(t,e):(console.log("%cJSPlayM4_StartEncode only hard decoder support recoder,V1 not support (20240801)","color: red"),0))}},{key:"JSPlayM4_StopEncode",value:function(){return window.g_recorderFlag=0,this.jsplayerVersion>1?this.oJSPlayerObj.JSPlayM4_StopEncode():(console.log("%c JSPlayM4_StopEncode only hard decoder support recoder,V1 not support (20240801)","color: red"),0)}},{key:"_downloadFile",value:function(t,e){var a=t;i(t,Blob)||i(t,File)||(a=new Blob([t]));var r=window.URL.createObjectURL(a),n=window.document.createElement("a");n.href=r,n.download=e;var s=document.createEvent("MouseEvents");s.initEvent("click",!0,!0),n.dispatchEvent(s)}},{key:"downloadRTPData",value:function(t){if(this.bWriteData){var e=t,a=this.aTotalBuffer.length;console.log("totalLength:"+a);for(var r=0,i=e.length;r<i;r++)this.aTotalBuffer[a+r]=e[r];this.iFrameNum++,e=null,console.log("download200RTPdata iFrameNum:"+this.iFrameNum)}}}]),a}();window._getFExplore=function(){var t,e={},a=navigator.userAgent.toLowerCase();if((t=a.match(/rv:([\d.]+)\) like gecko/))||(t=a.match(/msie ([\d\.]+)/))?e.ie=t[1]:(t=a.match(/edge\/([\d\.]+)/))?e.edge=t[1]:(t=a.match(/firefox\/([\d\.]+)/))?e.firefox=t[1]:(t=a.match(/(?:opera|opr).([\d\.]+)/))?e.opera=t[1]:(t=a.match(/chrome\/([\d\.]+)/))?e.chrome=t[1]:(t=a.match(/version\/([\d\.]+).*safari/))&&(e.safari=t[1]),e.chrome){var r=e.chrome,i=r.indexOf(".");return Number(r.substring(0,i))}return e.ie?console.log("%c1>your browser is IE ,it does not support play without plugin","color: red"):e.safari?console.log("%c1>your browser is safari ","color: red"):e.firefox?console.log("%c1>your browser is Firefox ","color: red"):console.log("%c1>your browser does not support play without plugin","color: red"),-1},window._getFSupportWebCodecs=function(){return"undefined"!=typeof VideoDecoder},window._getFSupportSIMD=function(){return new Promise((function(t,e){Ee().then((function(a){a?t():e()}))}))},window.gSetWasmPlayerPrintf=function(t){return window.g_printfFlag=t,!0}}(),x}()}))}(se,se.exports);var xe=se.exports.JSPlayCtrl;function oe(t,e,a){return oe=le()?Reflect.construct:function(t,e,a){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return a&&fe(i,a.prototype),i},oe.apply(null,arguments)}function fe(t,e){return fe=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},fe(t,e)}function le(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(le=function(){return!!t})()}function _e(t){var e,a,r,i,x;t.initializing=!0,t.emit(A.initializing);var o=n(null!=(x=null==(e=t._options.staticPath)?void 0:e.replace(/\/$/,""))?x:"")+"/PlayCtrlWasm",f=o+"/playCtrl3/hasWorker/HasSIMD/Decoder.js",l=o+"/playCtrl1/HasSIMD/Decoder.js";"iOS"===(null==$t||null==(a=$t.os)?void 0:a.name)&&"16.4"===(null==$t||null==(r=$t.os)?void 0:r.version)&&(l=o+"/playCtrl1/NoSIMD/Decoder.js"),window.SharedArrayBuffer||(f=o+"/playCtrl3/noWorker/Decoder.js");var _=function(){var t,e;return!(!($t&&$t.browser&&["Chrome","Electron"].includes($t.browser.name))||["120","118"].includes(null==(t=$t.browser)?void 0:t.major)&&"macOS"===(null==(e=$t.os)?void 0:e.name))}(),h=function(e,a,r,i){return void 0===e&&(e=0),void 0===a&&(a="webgl"),void 0===r&&(r=0),void 0===i&&(i=0),new Promise((function(n){var x=t._options.decoderType,o=[!s()&&_&&["auto","v3"].includes(x)?f:null,l];t.wasmplayer=oe(xe,[].concat(o,[function(e){if("loaded"===e.cmd)t.logger.log("init wasm cmd:",e.cmd),window.JSPlayerModuleLoaded=!0,t.initializing=!1,t.emit(A.initializing,F(e));t._decoderStatus=e,n(e)},e,a,r,i])),window["wasmplayer-"+t._options.id]=t.wasmplayer}))};return null==(i=window)?void 0:i._getFSupportSIMD().then((function(){return h()}),(function(){return f=o+"/playCtrl3/hasWorker/NoSIMD/Decoder.js",l=o+"/playCtrl1/NoSIMD/Decoder.js",h()}))}function he(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ce(t,e)}function ce(t,e){return ce=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},ce(t,e)}var ue=null,de=Symbol("CANVAS"),pe=Symbol("CONTEXT"),me=Symbol("SHAPES"),Se=Symbol("DRAWSTATUS"),Re=Symbol("SHAPETYPE"),Pe=Symbol("MAXSHAPENUMSUPPORT"),ye=Symbol("SHAPESTYLE"),be=Symbol("POLYGONDRAWING"),Ee=Symbol("CURRENTSHAPEINFO"),ge=Symbol("DRAWSHAPEMULTIONETIME"),Fe=Symbol("EVENTCALLBACK");function Ce(){ue[pe].clearRect(0,0,ue.m_iCanvasWidth,ue.m_iCanvasHeight);for(var t=0,e=ue[me].length;t<e;t++)ue[me][t].draw()}function ve(t){ue[me].length<ue[Pe]&&ue[me].push(t)}function Te(){var t,e,a,r,i,n,s,x=!1,o={},f=0,l=0,_=0,h=0,c=0,u=0,d="draw",p=null;function m(){for(var t=-1,e=0,a=ue[me].length;e<a;e++)if(ue[me][e].m_bChoosed){t=e;break}return t}ue[de].oncontextmenu=function(){return!1},ue[de].onselectstart=function(){return!1},De(),ue.ON_MOUSEDOWN=function(t){if(2===t.button)ue[be]&&p&&p.m_aPoint.length>=p.m_iMinClosed&&(p.m_bClosed=!0,ue[be]=!1,p.setPointInfo(p.m_aPoint),ve(p),Ce(),x=!1,ue[ge]||(ue[Se]=!1),null==window.onDrawShapeEvent||window.onDrawShapeEvent.call(window,p.m_szType,"onDrawEnd",p.m_szId));else if(0===t.button){if(x){if(Math.abs(t.offsetX-f)>2&&Math.abs(t.offsetY-l)>2&&(ve(p),ue[ge]||(ue[Se]=!1)),ue[Fe]){var e,a={startPos:[],endPos:[]};a.startPos=[f,l],a.endPos=[t.offsetX,t.offsetY],null==(e=ue[Fe])||e.call(ue,a),ue.clearAllShape()}return p=null,void(x=!1)}if(f=t.offsetX,l=t.offsetY,d="draw",!ue[be]){var r=m();if(-1!==r&&ue[me][r].inArc(t.offsetX,t.offsetY,5)&&(d="stretch"),"stretch"!==d)for(var i=0,n=ue[me].length;i<n;i++)ue[me][i].inShape(t.offsetX,t.offsetY)&&2!==ue[me][i].m_iEditType?(ue[me][i].m_bChoosed=!0,ue[me][i].getMouseDownPoints(t.offsetX,t.offsetY),d="drag",null==window.onDrawShapeEvent||window.onDrawShapeEvent.call(window,ue[me][i].m_szType,"onChoose",ue[me][i].m_szId)):ue[me][i].m_bChoosed=!1;ue[de].style.cursor="drag"===d?"move":"default","draw"===d&&1===ue[me].length&&1===ue[me][0].m_iRedrawMode&&(ue.deleteRepeatPolyonById(ue[me][0].m_szId),ue[Se]=!0),ue[Se]&&!ue[ge]&&(d="draw")}if("draw"===d&&ue[Se]){if(ue[Pe]<=ue[me].length&&"Grid"!==ue[Re]&&"Point"!==ue[Re])return;"Rect"===ue[Re]?(p=new Ie).m_szTips=ue[Ee].szTips||"":"Grid"===ue[Re]?0===ue[me].length&&ve(p=new Le):"Polygon"===ue[Re]?(ue[be]||(ue[be]=!0,(p=new Oe).m_szId=ue[Ee].szId||"",p.m_szTips=ue[Ee].szTips||"",p.m_iMinClosed=ue[Ee].iMinClosed||3,p.m_iMaxPointNum=ue[Ee].iMaxPointNum||11,p.m_iPolygonType=ue[Ee].iPolygonType,p.m_szDrawColor=ue[Ee].szDrawColor,p.m_szFillColor=ue[Ee].szFillColor,p.m_iTranslucent=ue[Ee].iTranslucent,p.m_iRedrawMode=ue[Ee].iRedrawMode),1===p.m_iPolygonType&&(p.addPoint(f,l),p.m_aPoint.length===p.m_iMaxPointNum&&(p.m_bClosed=!0,ue[be]=!1,ve(p),Ce(),x=!1,ue[ge]||(ue[Se]=!1),null==window.onDrawShapeEvent||window.onDrawShapeEvent.call(window,p.m_szType,"onDrawEnd",p.m_szId)))):"Point"===ue[Re]&&(ue.clearShapeByType("Point"),(p=new Be).m_szId=ue[Ee].szId||"",p.m_szDrawColor=ue[Ee].szDrawColor,p.setPointInfo([[f,l]]),ve(p),Ce())}x=!0}},null==(t=ue[de])||t.addEventListener("mousedown",ue.ON_MOUSEDOWN),ue.ON_MOUSEENTER=function(t){o={isIn:!0,offsetX:t.offsetX,offsetY:t.offsetY},ue[Se]&&x&&("Rect"===ue[Re]?p.move([[f,l],[t.offsetX,t.offsetY]]):"Grid"===ue[Re]&&ue[me][0].move(f,l,t.offsetX,t.offsetY))},null==(e=ue[de])||e.addEventListener("mouseenter",ue.ON_MOUSEENTER),ue.ON_MOUSELEAVE=function(t){o={isIn:!1,offsetX:t.offsetX,offsetY:t.offsetY}},null==(a=ue[de])||a.addEventListener("mouseleave",ue.ON_MOUSELEAVE),ue.ON_MOUSEMOVE=function(t){if(ue[be])ue[Se]&&x&&("Polygon"===ue[Re]&&0===p.m_iPolygonType&&(p.m_bClosed=!0),Ce(),p.move(t.offsetX,t.offsetY,f,l));else{var e=m();e>-1?x&&("drag"===d?(ue[me][e].drag(t.offsetX,t.offsetY),null==window.onDrawShapeEvent||window.onDrawShapeEvent.call(window,ue[me][e].m_szType,"onDrag",ue[me][e].m_szId)):"stretch"===d&&(ue[me][e].stretch(t.offsetX,t.offsetY),null==window.onDrawShapeEvent||window.onDrawShapeEvent.call(window,ue[me][e].m_szType,"onStretch",ue[me][e].m_szId))):ue[Se]&&x&&o.isIn&&("Rect"===ue[Re]?p.move([[f,l],[t.offsetX,t.offsetY]]):"Grid"===ue[Re]&&ue[me][0].move(f,l,t.offsetX,t.offsetY))}},null==(r=ue[de])||r.addEventListener("mousemove",ue.ON_MOUSEMOVE),ue.ON_MOUSEUP=function(t){if(ue[de].style.cursor="default",null!=p&&"draw"===d)if("Rect"===ue[Re]){if(Math.abs(t.offsetX-f)>2&&Math.abs(t.offsetY-l)>2&&(ve(p),ue[ge]||(ue[Se]=!1)),ue[Fe]){var e,a={startPos:[],endPos:[]};a.startPos=[f,l],a.endPos=[t.offsetX,t.offsetY],null==(e=ue[Fe])||e.call(ue,a),ue.clearAllShape()}p=null}else"Polygon"===ue[Re]&&0===p.m_iPolygonType&&ue[be]&&Math.abs(t.offsetX-f)>2&&Math.abs(t.offsetY-l)>2&&(ve(p),ue[be]=!1,ue[ge]||(ue[Se]=!1),null==window.onDrawShapeEvent||window.onDrawShapeEvent.call(window,p.m_szType,"onDrawEnd",p.m_szId));x=!!ue[be],ue[be]||Ce()},null==(i=ue[de])||i.addEventListener("mouseup",ue.ON_MOUSEUP),ue.ON_DBLCLICK=function(){ue[Se]&&"Grid"===ue[Re]&&(ue[me][0].m_szGridMap="fffffcfffffcfffffcfffffcfffffcfffffcfffffcfffffcfffffcfffffcfffffcfffffcfffffcfffffcfffffcfffffcfffffcfffffc",Ce())},ue[de].addEventListener("dblclick",ue.ON_DBLCLICK),ue.ON_TOUCHSTART=function(t){var e,a=t.target.getBoundingClientRect();if(null==(e=t.touches)?void 0:e[0]){if(_=parseInt(t.touches[0].clientX-a.x)>0?parseInt(t.touches[0].clientX-a.x):0,h=parseInt(t.touches[0].clientY-a.y)>0?parseInt(t.touches[0].clientY-a.y):0,d="draw",ue[Se]){if(ue[Pe]<=ue[me].length&&"Grid"!==ue[Re]&&"Point"!==ue[Re])return;"Rect"===ue[Re]?(p=new Ie).m_szTips=ue[Ee].szTips||"":"Grid"===ue[Re]?0===ue[me].length&&ve(p=new Le):"Polygon"===ue[Re]?(ue[be]||(ue[be]=!0,(p=new Oe).m_szId=ue[Ee].szId||"",p.m_szTips=ue[Ee].szTips||"",p.m_iMinClosed=ue[Ee].iMinClosed||3,p.m_iMaxPointNum=ue[Ee].iMaxPointNum||11,p.m_iPolygonType=ue[Ee].iPolygonType,p.m_szDrawColor=ue[Ee].szDrawColor,p.m_szFillColor=ue[Ee].szFillColor,p.m_iTranslucent=ue[Ee].iTranslucent,p.m_iRedrawMode=ue[Ee].iRedrawMode),1===p.m_iPolygonType&&(p.addPoint(_,h),p.m_aPoint.length===p.m_iMaxPointNum&&(p.m_bClosed=!0,ue[be]=!1,ve(p),Ce(),x=!1,ue[ge]||(ue[Se]=!1),null==window.onDrawShapeEvent||window.onDrawShapeEvent.call(window,p.m_szType,"onDrawEnd",p.m_szId)))):"Point"===ue[Re]&&(ue.clearShapeByType("Point"),(p=new Be).m_szId=ue[Ee].szId||"",p.m_szDrawColor=ue[Ee].szDrawColor,p.setPointInfo([[_,h]]),ve(p),Ce())}x=!0}},null==(n=ue[de])||n.addEventListener("touchstart",ue.ON_TOUCHSTART),ue.ON_TOUCHMOVE=function(t){var e,a=t.target.getBoundingClientRect();if(null==(e=t.touches)?void 0:e[0])if(c=parseInt(t.touches[0].clientX-a.x)>0?parseInt(t.touches[0].clientX-a.x):0,u=parseInt(t.touches[0].clientY-a.y)>0?parseInt(t.touches[0].clientY-a.y):0,ue[be])ue[Se]&&x&&("Polygon"===ue[Re]&&0===p.m_iPolygonType&&(p.m_bClosed=!0),Ce(),p.move(t.touches[0].offsetX,t.touches[0].offsetY,_,h));else{var r=m();r>-1?x&&("drag"===d?(ue[me][r].drag(c,u),null==window.onDrawShapeEvent||window.onDrawShapeEvent.call(window,ue[me][r].m_szType,"onDrag",ue[me][r].m_szId)):"stretch"===d&&(ue[me][r].stretch(c,u),null==window.onDrawShapeEvent||window.onDrawShapeEvent.call(window,ue[me][r].m_szType,"onStretch",ue[me][r].m_szId))):ue[Se]&&x&&("Rect"===ue[Re]?p.move([[2*_,2*h],[2*c,2*u]]):"Grid"===ue[Re]&&ue[me][0].move(_,h,c,u))}},null==(s=ue[de])||s.addEventListener("touchmove",ue.ON_TOUCHMOVE),ue.ON_TOUCHEND=function(t){if(_!=c||h!=u){if(ue[de].style.cursor="default",null!=p&&"draw"===d)if("Rect"===ue[Re]){if(Math.abs(c-_)>2&&Math.abs(u-h)>2&&(ve(p),ue[ge]||(ue[Se]=!1)),ue[Fe]&&Math.abs(c-_)>15&&Math.abs(u-h)>15){var e,a={startPos:[],endPos:[]};a.startPos=[_,h],a.endPos=[c,u],null==(e=ue[Fe])||e.call(ue,a)}ue.clearAllShape(),p=null}else"Polygon"===ue[Re]&&0===p.m_iPolygonType&&ue[be]&&Math.abs(c-_)>2&&Math.abs(u-h)>2&&(ve(p),ue[be]=!1,ue[ge]||(ue[Se]=!1),null==window.onDrawShapeEvent||window.onDrawShapeEvent.call(window,p.m_szType,"onDrawEnd",p.m_szId));x=!!ue[be],ue[be]||Ce()}},ue[de].addEventListener("touchend",ue.ON_TOUCHEND)}function De(){var t,e,a,r,i,n,s,x,o;ue.ON_MOUSEDOWN&&(null==(t=ue[de])||t.removeEventListener("mousedown",ue.ON_MOUSEDOWN),ue.ON_MOUSEDOWN=null);ue.ON_MOUSEENTER&&(null==(e=ue[de])||e.removeEventListener("mouseenter",ue.ON_MOUSEENTER),ue.ON_MOUSEENTER=null);ue.ON_MOUSELEAVE&&(null==(a=ue[de])||a.removeEventListener("mouseleave",ue.ON_MOUSELEAVE),ue.ON_MOUSELEAVE=null);ue.ON_MOUSEMOVE&&(null==(r=ue[de])||r.removeEventListener("mousemove",ue.ON_MOUSEMOVE),ue.ON_MOUSEMOVE=null);ue.ON_MOUSEUP&&(null==(i=ue[de])||i.removeEventListener("mouseup",ue.ON_MOUSEUP),ue.ON_MOUSEUP=null);ue.ON_DBLCLICK&&(null==(n=ue[de])||n.removeEventListener("dblclick",ue.ON_DBLCLICK),ue.ON_DBLCLICK=null);ue.ON_TOUCHSTART&&(null==(s=ue[de])||s.removeEventListener("touchstart",ue.ON_TOUCHSTART),ue.ON_TOUCHSTART=null);ue.ON_TOUCHMOVE&&(null==(x=ue[de])||x.removeEventListener("touchmove",ue.ON_TOUCHMOVE),ue.ON_TOUCHMOVE=null);ue.ON_TOUCHEND&&(null==(o=ue[de])||o.removeEventListener("touchend",ue.ON_TOUCHEND),ue.ON_TOUCHEND=null)}var Ae=function(){function t(){this.m_szId="",this.m_aPoint=[],this.m_bChoosed=!1,this.m_szDrawColor=ue[ye].szDrawColor,this.m_szFillColor=ue[ye].szFillColor,this.m_iTranslucent=ue[ye].iTranslucent,this.m_iIndexChoosePoint=-1,this.m_iDriftStartX=0,this.m_iDriftStartY=0,this.m_oEdgePoints={top:{x:0,y:0},left:{x:0,y:0},right:{x:0,y:0},bottom:{x:0,y:0}},this.m_szTips="",this.m_iEditType=0,this.m_iMinClosed=3,this.m_iMaxPointNum=11,this.m_bClosed=!1,this.m_iRedrawMode=0}var e=t.prototype;return e.draw=function(){},e.drag=function(t,e){if(2!==this.m_iEditType){var a=this.m_aPoint.length,r=0;for(r=0;r<a;r++)if(this.m_aPoint[r][0]+t-this.m_iDriftStartX>ue.m_iCanvasWidth||this.m_aPoint[r][1]+e-this.m_iDriftStartY>ue.m_iCanvasHeight||this.m_aPoint[r][0]+t-this.m_iDriftStartX<0||this.m_aPoint[r][1]+e-this.m_iDriftStartY<0)return this.m_iDriftStartX=t,void(this.m_iDriftStartY=e);for(r=0;r<a;r++)this.m_aPoint[r][0]=this.m_aPoint[r][0]+t-this.m_iDriftStartX,this.m_aPoint[r][1]=this.m_aPoint[r][1]+e-this.m_iDriftStartY;this.m_iDriftStartX=t,this.m_iDriftStartY=e,this.setPointInfo(this.m_aPoint),Ce()}},e.stretch=function(t,e){0===this.m_iEditType&&(-1!==this.m_iIndexChoosePoint&&(this.m_aPoint[this.m_iIndexChoosePoint][0]=t,this.m_aPoint[this.m_iIndexChoosePoint][1]=e),this.setPointInfo(this.m_aPoint),Ce())},e.inShape=function(t,e){for(var a=!1,r=this.m_aPoint.length,i=0,n=r-1;i<r;n=i++)this.m_aPoint[i][1]>e!=this.m_aPoint[n][1]>e&&t<(this.m_aPoint[n][0]-this.m_aPoint[i][0])*(e-this.m_aPoint[i][1])/(this.m_aPoint[n][1]-this.m_aPoint[i][1])+this.m_aPoint[i][0]&&(a=!a);return a},e.inArc=function(t,e,a){for(var r=!1,i=0,n=this.m_aPoint.length;i<n;i++){if(Math.sqrt((t-this.m_aPoint[i][0])*(t-this.m_aPoint[i][0])+(e-this.m_aPoint[i][1])*(e-this.m_aPoint[i][1]))<a){r=!0,this.m_iIndexChoosePoint=i;break}}return r},e.getMouseDownPoints=function(t,e){this.m_iDriftStartX=t,this.m_iDriftStartY=e},e.getPointInfo=function(){return this.m_aPoint},e.setPointInfo=function(t){null!=t&&t.length>0&&(this.m_aPoint=t,this.setEdgePoints(t))},e.addPoint=function(t,e){this.m_aPoint.length<this.m_iMaxPointNum&&this.m_aPoint.push([t,e]),this.m_aPoint.length===this.m_iMaxPointNum&&this.setPointInfo(this.m_aPoint)},e.setEdgePoints=function(t){for(var e=0,a=t.length;e<a;e++)0===e?(this.m_oEdgePoints.top.x=t[e][0],this.m_oEdgePoints.top.y=t[e][1],this.m_oEdgePoints.left.x=t[e][0],this.m_oEdgePoints.left.y=t[e][1],this.m_oEdgePoints.right.x=t[e][0],this.m_oEdgePoints.right.y=t[e][1],this.m_oEdgePoints.bottom.x=t[e][0],this.m_oEdgePoints.bottom.y=t[e][1]):(t[e][1]<this.m_oEdgePoints.top.y&&(this.m_oEdgePoints.top.x=t[e][0],this.m_oEdgePoints.top.y=t[e][1]),t[e][0]>this.m_oEdgePoints.right.x&&(this.m_oEdgePoints.right.x=t[e][0],this.m_oEdgePoints.right.y=t[e][1]),t[e][1]>this.m_oEdgePoints.bottom.y&&(this.m_oEdgePoints.bottom.x=t[e][0],this.m_oEdgePoints.bottom.y=t[e][1]),t[e][0]<this.m_oEdgePoints.left.x&&(this.m_oEdgePoints.left.x=t[e][0],this.m_oEdgePoints.left.y=t[e][1]))},t}(),Ie=function(t){function e(){var e;return(e=t.call(this)||this).m_szType="Rect",e}he(e,t);var a=e.prototype;return a.setPointInfo=function(t){if(null!=t){for(var e=t[0][0],a=t[0][1],r=t[0][0],i=t[0][1],n=0,s=t.length;n<s;n++)e>t[n][0]&&(e=t[n][0]),a>t[n][1]&&(a=t[n][1]),r<t[n][0]&&(r=t[n][0]),i<t[n][1]&&(i=t[n][1]);this.m_aPoint=[[e,a],[r,a],[r,i],[e,i]]}},a.draw=function(){ue[pe].fillStyle=this.m_szFillColor,ue[pe].strokeStyle=this.m_szDrawColor;var t=this.m_aPoint[0][0],e=this.m_aPoint[0][1],a=this.m_aPoint[2][0]-t,r=this.m_aPoint[2][1]-e;if(ue[pe].globalAlpha=this.m_iTranslucent,ue[pe].fillRect(t,e,a,r),ue[pe].globalAlpha=1,ue[pe].fillText(this.m_szTips,(t+this.m_aPoint[2][0])/2,(e+this.m_aPoint[2][1])/2),this.m_bChoosed){var i=Math.round(a/2),n=Math.round(r/2);if(0===this.m_iEditType)for(var s=[t,t+i,t+a,t,t+a,t,t+i,t+a],x=[e,e,e,e+n,e+n,e+r,e+r,e+r],o=0;o<8;o++)ue[pe].beginPath(),ue[pe].arc(s[o],x[o],3,0,360,!1),ue[pe].fillStyle=this.m_szDrawColor,ue[pe].closePath(),ue[pe].fill()}ue[pe].strokeRect(t,e,a,r)},a.stretch=function(t,e){0===this.m_iEditType&&(0===this.m_iIndexChoosePoint?t<this.m_aPoint[2][0]&&e<this.m_aPoint[2][1]&&(this.m_aPoint[0][0]=t,this.m_aPoint[0][1]=e,this.m_aPoint[3][0]=t,this.m_aPoint[1][1]=e):1===this.m_iIndexChoosePoint?e<this.m_aPoint[2][1]&&(this.m_aPoint[0][1]=e,this.m_aPoint[1][1]=e):2===this.m_iIndexChoosePoint?t>this.m_aPoint[3][0]&&e<this.m_aPoint[3][1]&&(this.m_aPoint[1][0]=t,this.m_aPoint[1][1]=e,this.m_aPoint[2][0]=t,this.m_aPoint[0][1]=e):3===this.m_iIndexChoosePoint?t<this.m_aPoint[2][0]&&(this.m_aPoint[0][0]=t,this.m_aPoint[3][0]=t):4===this.m_iIndexChoosePoint?t>this.m_aPoint[0][0]&&(this.m_aPoint[1][0]=t,this.m_aPoint[2][0]=t):5===this.m_iIndexChoosePoint?t<this.m_aPoint[1][0]&&e>this.m_aPoint[1][1]&&(this.m_aPoint[3][0]=t,this.m_aPoint[3][1]=e,this.m_aPoint[0][0]=t,this.m_aPoint[2][1]=e):6===this.m_iIndexChoosePoint?e>this.m_aPoint[1][1]&&(this.m_aPoint[2][1]=e,this.m_aPoint[3][1]=e):7===this.m_iIndexChoosePoint&&t>this.m_aPoint[0][0]&&e>this.m_aPoint[0][1]&&(this.m_aPoint[2][0]=t,this.m_aPoint[2][1]=e,this.m_aPoint[1][0]=t,this.m_aPoint[3][1]=e),Ce())},a.move=function(t){Ce(),this.m_bChoosed=!0;var e=t[0][0],a=t[0][1],r=t[1][0],i=t[1][1];this.setPointInfo([[e,a],[r,a],[r,i],[e,i]]),this.draw()},a.inArc=function(t,e,a){for(var r=this.m_aPoint[0][0],i=this.m_aPoint[0][1],n=this.m_aPoint[2][0]-r,s=this.m_aPoint[2][1]-i,x=Math.round(n/2),o=Math.round(s/2),f=[r,r+x,r+n,r,r+n,r,r+x,r+n],l=[i,i,i,i+o,i+o,i+s,i+s,i+s],_=0;_<8;_++){if(Math.sqrt((t-f[_])*(t-f[_])+(e-l[_])*(e-l[_]))<a)return this.m_iIndexChoosePoint=_,!0}return!1},e}(Ae),Me=function(t){function e(e,a){var r;return(r=t.call(this)||this).m_szType="RectOSD",r.m_szOSDType="overlay-date",r.m_szText=e||"",r.m_szEnabled=a||"",r.m_szDateStyle="",r.m_szClockType="",r.m_szDisplayWeek="",r.m_szId="",r.m_szAlignment="0",r}he(e,t);var a=e.prototype;return a.draw=function(){if("true"===this.m_szEnabled){var t=this.m_aPoint[0][0],e=this.m_aPoint[0][1],a=this.m_aPoint[2][0]-t,r=this.m_aPoint[2][1]-e;ue[pe].beginPath(),ue[pe].strokeStyle=this.m_szDrawColor,ue[pe].globalAlpha=1,ue[pe].rect(t,e,a,r),ue[pe].font="15px serif",ue[pe].strokeText(this.m_szText,t,e+15),ue[pe].stroke()}},a.drag=function(t,e){var a=this.m_aPoint.length,r=0;if("0"===this.m_szAlignment){for(r=0;r<a;r++)if(this.m_aPoint[r][1]+e-this.m_iDriftStartY>ue.m_iCanvasHeight||this.m_aPoint[r][0]+t-this.m_iDriftStartX<0||this.m_aPoint[r][1]+e-this.m_iDriftStartY<0)return this.m_iDriftStartX=t,void(this.m_iDriftStartY=e);for(r=0;r<a;r++)this.m_aPoint[r][0]=this.m_aPoint[r][0]+t-this.m_iDriftStartX,this.m_aPoint[r][1]=this.m_aPoint[r][1]+e-this.m_iDriftStartY}else if("1"===this.m_szAlignment||"2"===this.m_szAlignment){for(r=0;r<a;r++)if(this.m_aPoint[r][1]+e-this.m_iDriftStartY>ue.m_iCanvasHeight||this.m_aPoint[r][1]+e-this.m_iDriftStartY<0)return this.m_iDriftStartX=t,void(this.m_iDriftStartY=e);for(r=0;r<a;r++)this.m_aPoint[r][1]=this.m_aPoint[r][1]+e-this.m_iDriftStartY}this.m_iDriftStartX=t,this.m_iDriftStartY=e,this.setEdgePoints(this.m_aPoint),Ce()},a.stretch=function(){},e}(Ae),Le=function(t){function e(){var e;return(e=t.call(this)||this).m_szType="Grid",e.m_iGridColNum=22,e.m_iGridRowNum=18,e.m_szGridMap="",e.m_aAddGridMap=[],e}he(e,t);var a=e.prototype;return a.draw=function(){for(var t=ue.m_iCanvasWidth/this.m_iGridColNum,e=ue.m_iCanvasHeight/this.m_iGridRowNum,a="",r=0;r<this.m_iGridRowNum;r++){for(var i=this.m_szGridMap.substring(6*r,6*r+6),n=parseInt("f"+i,16).toString(2).split("").slice(4),s="",x=0;x<this.m_iGridColNum;x++){var o="";"1"===n[x]?(ue[pe].strokeStyle=this.m_szDrawColor,ue[pe].globalAlpha=1,ue[pe].strokeRect(t*x,e*r,t,e),o="1"):o="0",this.m_aAddGridMap.length&&1===this.m_aAddGridMap[r][x]&&(ue[pe].strokeStyle=this.m_szDrawColor,ue[pe].strokeRect(t*x,e*r,t,e),o="1"),s+=o}a+=parseInt("1111"+s+"00",2).toString(16).substring(1)}this.m_szGridMap=a},a.move=function(t,e,a,r){var i=ue.m_iCanvasWidth/this.m_iGridColNum,n=ue.m_iCanvasHeight/this.m_iGridRowNum,s=Math.floor(t/i),x=Math.floor(e/n),o=Math.floor(Math.abs(a-t)/i),f=Math.floor(Math.abs(r-e)/n),l=1,_=1;l=a-t>0?1:-1,_=r-e>0?1:-1;for(var h=[],c=0;c<this.m_iGridRowNum;c++){h[c]=[];for(var u=0;u<this.m_iGridColNum;u++)h[c][u]=1===l?1===_?c>=x&&c<=x+f&&u>=s&&u<=s+o?1:0:c<=x&&c>=x-f&&u>=s&&u<=s+o?1:0:1===_?c>=x&&c<=x+f&&u<=s&&u>=s-o?1:0:c<=x&&c>=x-f&&u<=s&&u>=s-o?1:0}this.m_aAddGridMap=h,this.draw()},e}(Ae),we=function(t){function e(){var e;return(e=t.call(this)||this).m_szType="Line",e.m_iLineType=0,e.m_iDirection=0,e.m_iArrowType=0,e.m_aCrossArrowPoint=[],e}he(e,t);var a=e.prototype;return a.draw=function(){0===this.m_iLineType?this.drawNormalLine():1===this.m_iLineType?this.drawArrowLine():3===this.m_iLineType?this.drawCrossLine():4===this.m_iLineType&&this.drawLineCount()},a.drawNormalLine=function(){if(ue[pe].globalAlpha=1,this.m_aPoint.length>0){ue[pe].beginPath(),ue[pe].strokeStyle=this.m_szDrawColor,ue[pe].lineWidth=2,ue[pe].moveTo(this.m_aPoint[0][0],this.m_aPoint[0][1]);for(var t=1,e=this.m_aPoint.length;t<e;t++)ue[pe].lineTo(this.m_aPoint[t][0],this.m_aPoint[t][1]);if(ue[pe].stroke(),this.m_bChoosed)for(var a=0,r=this.m_aPoint.length;a<r;a++)ue[pe].beginPath(),ue[pe].fillStyle=this.m_szDrawColor,ue[pe].arc(this.m_aPoint[a][0],this.m_aPoint[a][1],3,0,2*Math.PI,!0),ue[pe].closePath(),ue[pe].fill();""!==this.m_szTips&&(ue[pe].strokeStyle=this.m_szDrawColor,ue[pe].fillText(this.m_szTips,this.m_aPoint[0][0]+10,this.m_aPoint[0][1]+4))}},a.drawArrowLine=function(t,e,a,r,i,n,s,x){n=void 0!==n?n:30,s=void 0!==s?s:10,x=void 0!==x?x:1;var o=180*Math.atan2(a-i,e-r)/Math.PI,f=(o+n)*Math.PI/180,l=(o-n)*Math.PI/180,_=s*Math.cos(f),h=s*Math.sin(f),c=s*Math.cos(l),u=s*Math.sin(l);ue[pe].save(),ue[pe].beginPath();var d=e-_,p=a-h;ue[pe].moveTo(d,p),ue[pe].lineTo(e,a),d=e-c,p=a-u,ue[pe].lineTo(d,p),ue[pe].moveTo(e,a),ue[pe].lineTo(r,i),1===t&&(d=r+_,p=i+h,ue[pe].moveTo(d,p),ue[pe].lineTo(r,i),d=r+c,p=i+u,ue[pe].lineTo(d,p)),ue[pe].strokeStyle=this.m_szDrawColor,ue[pe].lineWidth=x,ue[pe].stroke(),ue[pe].restore()},a.drawCrossLine=function(){this.drawNormalLine();var t=(this.m_aPoint[0][0]+this.m_aPoint[1][0])/2,e=(this.m_aPoint[0][1]+this.m_aPoint[1][1])/2,a=180*Math.atan2(e-this.m_aPoint[0][1],t-this.m_aPoint[0][0])/Math.PI,r=(a+90)*Math.PI/180,i=(a-90)*Math.PI/180,n=25*Math.cos(r),s=25*Math.sin(r),x=25*Math.cos(i),o=25*Math.sin(i),f=0,l=0;f=t-n,l=e-s;var _=0,h=0;0===this.m_iDirection?(_=-10,h=-15):1===this.m_iDirection?(_=10,h=10):(_=10,h=-15),0!==this.m_iDirection&&this.drawArrowLine(0,f,l,t,e),ue[pe].strokeStyle=this.m_szDrawColor,ue[pe].font="8px",ue[pe].strokeText("A",f+_,l+4),f=t-x,l=e-o,1!==this.m_iDirection&&this.drawArrowLine(0,f,l,t,e),ue[pe].strokeStyle=this.m_szDrawColor,ue[pe].font="8px",ue[pe].strokeText("B",f+h,l+4)},a.drawLineCount=function(){this.drawNormalLine();var t=(this.m_aPoint[0][0]+this.m_aPoint[1][0])/2,e=(this.m_aPoint[0][1]+this.m_aPoint[1][1])/2,a=180*Math.atan2(e-this.m_aPoint[0][1],t-this.m_aPoint[0][0])/Math.PI,r=(a+90)*Math.PI/180,i=(a-90)*Math.PI/180,n=25*Math.cos(r),s=25*Math.sin(r),x=25*Math.cos(i),o=25*Math.sin(i),f=0,l=0;f=t-n,l=e-s,1===this.m_iArrowType?(f=t-x,l=e-o,this.drawArrowLine(0,f,l,t,e)):0===this.m_iArrowType&&this.drawArrowLine(0,f,l,t,e),this.m_aCrossArrowPoint=[[t,e],[f,l]]},a.inShape=function(t,e){for(var a=!1,r=0,i=this.m_aPoint.length-1;r<i;r++){var n=Math.sqrt((this.m_aPoint[r+1][0]-this.m_aPoint[r][0])*(this.m_aPoint[r+1][0]-this.m_aPoint[r][0])+(this.m_aPoint[r+1][1]-this.m_aPoint[r][1])*(this.m_aPoint[r+1][1]-this.m_aPoint[r][1]));Math.sqrt((t-this.m_aPoint[r][0])*(t-this.m_aPoint[r][0])+(e-this.m_aPoint[r][1])*(e-this.m_aPoint[r][1]))+Math.sqrt((t-this.m_aPoint[r+1][0])*(t-this.m_aPoint[r+1][0])+(e-this.m_aPoint[r+1][1])*(e-this.m_aPoint[r+1][1]))-n<1&&(a=!0)}return a},e}(Ae),Oe=function(t){function e(){var e;return(e=t.call(this)||this).m_szType="Polygon",e.m_iPolygonType=1,e}he(e,t);var a=e.prototype;return a.setPointInfo=function(t){if(null!=t){if(0===this.m_iPolygonType){for(var e=t[0][0],a=t[0][1],r=t[0][0],i=t[0][1],n=0,s=t.length;n<s;n++)e>t[n][0]&&(e=t[n][0]),a>t[n][1]&&(a=t[n][1]),r<t[n][0]&&(r=t[n][0]),i<t[n][1]&&(i=t[n][1]);this.m_aPoint=[[e,a],[r,a],[r,i],[e,i]]}else this.m_iPolygonType,this.m_aPoint=t;this.setEdgePoints(t)}},a.draw=function(){if(this.m_aPoint.length>0){ue[pe].fillStyle=this.m_szFillColor,ue[pe].strokeStyle=this.m_szDrawColor,ue[pe].globalAlpha=1;var t=0,e=0;if(this.m_bChoosed)for(t=0,e=this.m_aPoint.length;t<e;t++)ue[pe].beginPath(),ue[pe].arc(this.m_aPoint[t][0],this.m_aPoint[t][1],3,0,360,!1),ue[pe].fillStyle=this.m_szDrawColor,ue[pe].closePath(),ue[pe].fill();for(ue[pe].beginPath(),ue[pe].moveTo(this.m_aPoint[0][0],this.m_aPoint[0][1]),t=0,e=this.m_aPoint.length;t<e;t++)0!==t&&ue[pe].lineTo(this.m_aPoint[t][0],this.m_aPoint[t][1]);ue[pe].stroke(),this.m_bClosed&&(ue[pe].fillText(this.m_szTips,(this.m_oEdgePoints.left.x+this.m_oEdgePoints.right.x)/2,(this.m_oEdgePoints.top.y+this.m_oEdgePoints.bottom.y)/2),ue[pe].closePath(),ue[pe].stroke(),ue[pe].globalAlpha=this.m_iTranslucent,ue[pe].fill())}},a.move=function(t,e,a,r){if(1===this.m_iPolygonType){if(this.m_aPoint.length<this.m_iMaxPointNum&&this.m_aPoint.length>0){ue[pe].fillStyle=this.m_szFillColor,ue[pe].strokeStyle=this.m_szDrawColor,ue[pe].globalAlpha=1;var i=0,n=0;for(i=0,n=this.m_aPoint.length;i<n;i++)ue[pe].beginPath(),ue[pe].arc(this.m_aPoint[i][0],this.m_aPoint[i][1],3,0,360,!1),ue[pe].fillStyle=this.m_szDrawColor,ue[pe].closePath(),ue[pe].fill();for(ue[pe].beginPath(),ue[pe].moveTo(this.m_aPoint[0][0],this.m_aPoint[0][1]),i=0,n=this.m_aPoint.length;i<n;i++)0!==i&&ue[pe].lineTo(this.m_aPoint[i][0],this.m_aPoint[i][1]);ue[pe].lineTo(t,e),ue[pe].closePath(),ue[pe].stroke()}}else if(0===this.m_iPolygonType){this.m_bChoosed=!0;var s=a,x=r,o=t,f=e;this.setPointInfo([[s,x],[o,x],[o,f],[s,f]]),this.draw()}},a.stretch=function(t,e){0===this.m_iEditType&&(1===this.m_iPolygonType?-1!==this.m_iIndexChoosePoint&&(this.m_aPoint[this.m_iIndexChoosePoint][0]=t,this.m_aPoint[this.m_iIndexChoosePoint][1]=e):0===this.m_iIndexChoosePoint?t<this.m_aPoint[2][0]&&e<this.m_aPoint[2][1]&&(this.m_aPoint[0][0]=t,this.m_aPoint[0][1]=e,this.m_aPoint[3][0]=t,this.m_aPoint[1][1]=e):1===this.m_iIndexChoosePoint?t>this.m_aPoint[3][0]&&e<this.m_aPoint[3][1]&&(this.m_aPoint[1][0]=t,this.m_aPoint[1][1]=e,this.m_aPoint[2][0]=t,this.m_aPoint[0][1]=e):2===this.m_iIndexChoosePoint?t>this.m_aPoint[0][0]&&e>this.m_aPoint[0][1]&&(this.m_aPoint[2][0]=t,this.m_aPoint[2][1]=e,this.m_aPoint[1][0]=t,this.m_aPoint[3][1]=e):3===this.m_iIndexChoosePoint&&t<this.m_aPoint[1][0]&&e>this.m_aPoint[1][1]&&(this.m_aPoint[3][0]=t,this.m_aPoint[3][1]=e,this.m_aPoint[0][0]=t,this.m_aPoint[2][1]=e),this.setPointInfo(this.m_aPoint),Ce())},e}(Ae),Be=function(t){function e(){var e;return(e=t.call(this)||this).m_szType="Point",e.m_szId="",e}he(e,t);var a=e.prototype;return a.draw=function(){ue[pe].beginPath(),ue[pe].fillStyle=this.m_szDrawColor,ue[pe].globalAlpha=1,ue[pe].arc(this.m_aPoint[0][0],this.m_aPoint[0][1],10,0,2*Math.PI,!0),ue[pe].closePath(),ue[pe].fill()},a.drag=function(){},a.stretch=function(){},e}(Ae),ke=function(){function t(t){ue=this,this[de]=document.createElement("canvas"),this[de].width=t.clientWidth,this[de].height=t.clientHeight,t.appendChild(this[de]),this[de].style.cssText="position: absolute; width: 100%; height: 100%; left: 0; top: 0;z-index: 1; border: 0; outline: none;",this[de].classList.add("ezplayer-3d_draw"),this[pe]=this[de].getContext("2d"),this[me]=[],this[Se]=!1,this[Re]="Rect",this[Pe]=10,this[ge]=!0,this[Ee]={},this[Fe]=null,this[ye]={szDrawColor:"#ff0000",szFillColor:"#343434",iTranslucent:.7},this[be]=!1,this.m_iCanvasWidth=this[de].clientWidth,this.m_iCanvasHeight=this[de].clientHeight,this.m_iHorizontalResolution=0,this.m_iVerticalResolution=0,this.m_szDisplayMode="",this.m_szVideoFormat="",Te(),this[me].length=0}var e=t.prototype;return e.setDrawMutiShapeOneTime=function(t){this[ge]=t},e.setMaxShapeSupport=function(t){this[Pe]=t},e.getMaxShapeSupport=function(){return this[Pe]},e.setDrawStatus=function(t,e){this[Se]=t,e&&t&&(this[Fe]=e),t||(this[Fe]=null,De())},e.setShapeType=function(t){this[Re]=t,Ce()},e.setCurrentShapeInfo=function(t){this[Ee]=t||{szId:"",szTips:"",iMinClosed:3,iMaxPointNum:11,iPolygonType:1,iRedrawMode:0}},e.getShapeType=function(){return this[Re]},e.getAllShapesInfo=function(){for(var t=[],e=0,a=this[me].length;e<a;e++)"Grid"===this[me][e].m_szType?t.push({szType:this[me][e].m_szType,szGridMap:this[me][e].m_szGridMap,iGridColNum:this[me][e].m_iGridColNum,iGridRowNum:this[me][e].m_iGridRowNum}):"RectOSD"===this[me][e].m_szType?t.push({szType:this[me][e].m_szType,szText:this[me][e].m_szText,szEnabled:this[me][e].m_szEnabled,szOSDType:this[me][e].m_szOSDType,iPositionX:this[me][e].m_aPoint[0][0],iPositionY:this[me][e].m_aPoint[0][1],szDateStyle:this[me][e].m_szDateStyle,szClockType:this[me][e].m_szClockType,szDisplayWeek:this[me][e].m_szDisplayWeek,szId:this[me][e].m_szId,szAlignment:this[me][e].m_szAlignment}):t.push({szType:this[me][e].m_szType,aPoint:this[me][e].m_aPoint,szId:this[me][e].m_szId,bChoosed:this[me][e].m_bChoosed});return t},e.deleteRepeatPolyonById=function(t){var e=this.getAllShapesInfo(),a=e.length;if(a>0)for(var r=0;r<a;r++)"Polygon"===e[r].szType&&e[r].szId===t&&this.deleteShape(r)},e.getShapesInfoByType=function(t){for(var e=[],a=0,r=this[me].length;a<r;a++)this[me][a].m_szType===t&&("Grid"===this[me][a].m_szType?e.push({szType:this[me][a].m_szType,szGridMap:this[me][a].m_szGridMap,iGridColNum:this[me][a].m_iGridColNum,iGridRowNum:this[me][a].m_iGridRowNum}):"RectOSD"===this[me][a].m_szType?e.push({szType:this[me][a].m_szType,szText:this[me][a].m_szText,szEnabled:this[me][a].m_szEnabled,szOSDType:this[me][a].m_szOSDType,iPositionX:this[me][a].m_aPoint[0][0],iPositionY:this[me][a].m_aPoint[0][1],szDateStyle:this[me][a].m_szDateStyle,szClockType:this[me][a].m_szClockType,szDisplayWeek:this[me][a].m_szDisplayWeek,szId:this[me][a].m_szId,szAlignment:this[me][a].m_szAlignment}):"Polygon"===t?e.push({szType:this[me][a].m_szType,szId:this[me][a].m_szId,iPolygonType:this[me][a].m_iPolygonType,iMinClosed:this[me][a].m_iMinClosed,iMaxPointNum:this[me][a].m_iMaxPointNum,iEditType:this[me][a].m_iEditType,aPoint:this[me][a].m_aPoint,bClosed:this[me][a].m_bClosed,szTips:this[me][a].m_szTips,szDrawColor:this[me][a].m_szDrawColor,szFillColor:this[me][a].m_szFillColor,iTranslucent:this[me][a].m_iTranslucent}):"Line"===t?e.push({szType:this[me][a].m_szType,szId:this[me][a].m_szId,aPoint:this[me][a].m_aPoint,szTips:this[me][a].m_szTips,iLineType:this[me][a].m_iLineType,iDirection:this[me][a].m_iDirection,iArrowType:this[me][a].m_iArrowType,szDrawColor:this[me][a].m_szDrawColor,aCrossArrowPoint:this[me][a].m_aCrossArrowPoint}):"Rect"===t?e.push({szType:this[me][a].m_szType,iEditType:this[me][a].m_iEditType,aPoint:this[me][a].m_aPoint,szTips:this[me][a].m_szTips,szDrawColor:this[me][a].m_szDrawColor,szFillColor:this[me][a].m_szFillColor,iTranslucent:this[me][a].m_iTranslucent}):e.push({szType:this[me][a].m_szType,aPoint:this[me][a].m_aPoint}));return e},e.setShapesInfoByType=function(t,e){e||(e=[]);var a=null;if("Rect"===t||"Polygon"===t||"Line"===t||"Point"===t)for(var r=0,i=e.length;r<i;r++)"Rect"===t?((a=new Ie).m_iEditType=e[r].iEditType,a.m_szTips=e[r].szTips||"",a.m_szDrawColor=e[r].szDrawColor,a.m_szFillColor=e[r].szFillColor,a.m_iTranslucent=e[r].iTranslucent,a.m_iRedrawMode=e[r].iRedrawMode):"Polygon"===t?(a=new Oe,0===e[r].iPolygonType?a.m_bClosed=!0:a.m_bClosed=e[r].bClosed,a.m_szTips=e[r].szTips||"",a.m_szId=e[r].szId||"",a.m_iPolygonType=e[r].iPolygonType,a.m_iMinClosed=e[r].iMinClosed||3,a.m_iMaxPointNum=e[r].iMaxPointNum||11,a.m_iEditType=e[r].iEditType,a.m_szDrawColor=e[r].szDrawColor,a.m_szFillColor=e[r].szFillColor,a.m_iTranslucent=e[r].iTranslucent,a.m_iRedrawMode=e[r].iRedrawMode):"Line"===t?((a=new we).m_iLineType=e[r].iLineType,a.m_szTips=e[r].szTips||"",a.m_szId=e[r].szId,a.m_iDirection=e[r].iDirection,a.m_iArrowType=e[r].iArrowType,a.m_szDrawColor=e[r].szDrawColor,a.setPointInfo(e[r].aPoint)):"Point"===t&&((a=new Be).m_szId=e[r].szId,a.m_szDrawColor=e[r].szDrawColor,a.setPointInfo(e[r].aPoint)),a.setPointInfo(e[r].aPoint),0===r&&(a.m_bChoosed=!0),ve(a);else"Grid"===t&&((a=new Le).m_szGridMap=e[0].szGridMap||"",a.m_iGridColNum=e[0].iGridColNum||22,a.m_iGridRowNum=e[0].iGridRowNum||18,ve(a));Ce()},e.addOSDShape=function(t,e,a,r,i){a||r||(a=0,r=0),i||(i={});var n=new Me(t,e),s=10*t.replace(/[^x00-xff]/g,"rr").length;n.m_szOSDType=i.szOSDType||"",n.m_szDateStyle=i.szDateStyle||"",n.m_szClockType=i.szClockType||"",n.m_szDisplayWeek=i.szDisplayWeek||"",n.m_szId=i.szId||"",n.m_szAlignment=""+i.szAlignment||"0","0"===n.m_szAlignment?n.m_aPoint=[[a,r],[s+a,r],[s+a,r+20],[a,r+20]]:"1"===n.m_szAlignment?n.m_aPoint=[[0,r],[s,r],[s,r+20],[0,r+20]]:"2"===n.m_szAlignment?n.m_aPoint=[[this.m_iCanvasWidth-s,r],[this.m_iCanvasWidth,r],[this.m_iCanvasWidth,r+20],[this.m_iCanvasWidth-s,r+20]]:n.m_aPoint=[[a,r],[s+a,r],[s+a,r+20],[a,r+20]],ve(n),Ce()},e.selectShapeById=function(t,e){for(var a=0,r=ue[me].length;a<r;a++)t===ue[me][a].m_szType&&(e===ue[me][a].m_szId?ue[me][a].m_bChoosed=!0:ue[me][a].m_bChoosed=!1);Ce()},e.setCanvasSize=function(t,e){t>0&&e>0&&(this.m_iCanvasWidth=t,this.m_iCanvasHeight=e,Ce())},e.setDrawStyle=function(t,e,a){this[ye]={szDrawColor:t,szFillColor:e,iTranslucent:a}},e.clearAllShape=function(){this[me].length=0,ue[be]=!1,Ce()},e.clearShapeByType=function(t){for(var e=this[me].length;e>0;e--)this[me][e-1].m_szType===t&&("Grid"===t?(this[me][e-1].m_szGridMap="",this[me][e-1].m_aAddGridMap=[]):this[me].splice(e-1,1));"Polygon"===t&&(ue[be]=!1),Ce()},e.deleteShape=function(t){this[me].length>t&&this[me].splice(t,1),Ce()},e.updateCanvas=function(t){this[de]=document.getElementById(t),this[pe]=this[de].getContext("2d"),this.m_iCanvasWidth=this[de].clientWidth,this.m_iCanvasHeight=this[de].clientHeight,Te()},e.resizeCanvas=function(){this.m_iCanvasWidth=this[de].clientWidth,this.m_iCanvasHeight=this[de].clientHeight},e.canvasRedraw=function(){Ce()},e.resize=function(t,e){this[de].width=t,this[de].height=e,this.resizeCanvas(t,e)},e.destroy=function(){this[de]&&this[de].remove(),this[de]=null,this[pe]=null,this[me]=[],this[ye]={},this[be]=!1,this.m_iCanvasWidth=0,this.m_iCanvasHeight=0},t}();function Ne(t){return t.esCanvas&&(t.esCanvas.setDrawStatus(!1),t.esCanvas.destroy(),t.esCanvas=null,t.__fCallback=null,t.__b3DZoom=!1),0}function Ve(t){return null==t||""===t}function Ue(t){return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t}var He="object"===("undefined"==typeof window?"undefined":Ue(window))&&window.window===window?window:"object"===("undefined"==typeof self?"undefined":Ue(self))&&self.self===self?self:"object"===("undefined"==typeof global?"undefined":Ue(global))&&global.global===global?global:void 0;function We(t,e,a){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){Je(r.response,e,a)},r.onerror=function(){},r.send()}function Ye(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return e.status>=200&&e.status<=299}function Ge(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(a){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var Xe=He.navigator&&navigator.userAgent.includes("Macintosh")&&navigator.userAgent.includes("AppleWebKit")&&!navigator.userAgent.includes("Safari"),Je="object"!==("undefined"==typeof window?"undefined":Ue(window))||window!==He?function(){}:"download"in HTMLAnchorElement.prototype&&!Xe?function(t,e,a){var r=He.URL||He.webkitURL,i=document.createElementNS("http://www.w3.org/1999/xhtml","a");e=e||t.name||"download",i.download=e,i.rel="noopener","string"==typeof t?(i.href=t,i.origin!==location.origin?Ye(i.href)?We(t,e,a):Ge(i,i.target="_blank"):Ge(i)):(i.href=r.createObjectURL(t),setTimeout((function(){r.revokeObjectURL(i.href)}),4e4),setTimeout((function(){Ge(i)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,e,a){if(e=e||t.name||"download","string"==typeof t)if(Ye(t))We(t,e,a);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout((function(){Ge(r)}))}else navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!==(void 0===e?"undefined":Ue(e))&&(e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t}(t,a),e)}:function(t,e,a,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof t)return We(t,e,a);var i="application/octet-stream"===t.type,n=/constructor/i.test(He.HTMLElement)||He.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&n||Xe)&&"undefined"!=typeof FileReader){var x=new FileReader;x.onloadend=function(){var t=x.result;t=s?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=t:location=t,r=null},x.readAsDataURL(t)}else{var o=He.URL||He.webkitURL,f=o.createObjectURL(t);r?r.location=f:location.href=f,r=null,setTimeout((function(){o.revokeObjectURL(f)}),4e4)}};function Ze(t,e,a,r,i,n,s){return void 0===a&&(a="jpeg"),void 0===n&&(n=!0),void 0===s&&(s=!1),a="jpeg",e=(Ve(e)?(new Date).getTime():e)+"."+a,new Promise((function(r,x){var o,f;s?je(t,e,a,i,n).then((function(t){0===(null==t?void 0:t.code)&&r(t)})):(t.logger.log("snapshot GetJPEG start:",(new Date).getTime()),1!=+(null==(f=t.wasmplayer)||null==(o=f.JSPlayM4_GetJPEG)?void 0:o.call(f,(function(a){if(a){var s,x,o,f=function(t){for(var e=new Uint8Array(t),a="",r=0;r<e.length;r++)a+=String.fromCharCode(e[r]);return"data:image/jpeg;base64,"+window.btoa(a)}(a);i&&ze(f,e);var l=null==t||null==(s=t.getOSDTime)?void 0:s.call(t);n&&(null==t.emit||t.emit.call(t,A.API.snapshot,F({fileName:e,base64:f,currentOSD:l}))),null==(o=t.logger)||null==(x=o.log)||x.call(o,"snapshot GetJPEG end:",(new Date).getTime()),r(g({fileName:e,base64:f,currentOSD:l}))}}),!1))&&je(t,e,a,i,n).then((function(t){0===(null==t?void 0:t.code)?r(t):x(t)})))}))}function je(t,e,a,r,i){void 0===i&&(i=!1);var n=t.wasmplayer;return new Promise((function(s,x){var o,f;null==(o=t.logger)||o.log("snapshot GetCanvasCapture start:",(new Date).getTime());var l=null==n||null==(f=n.JSPlayM4_GetCanvasCapture)?void 0:f.call(n,(function(n,x,o){if(n&&x&&o){var f;a=a||"jpeg",e=(Ve(e)?(new Date).getTime():e)+"."+a;var l=new ImageData(x,o);l.data.set(n);var _="image/"+a,h=document.createElement("canvas"),c=h.getContext("2d");h.width=x,h.height=o,null==c||c.putImageData(l,0,0);var u=h.toDataURL(_,.7);r&&ze(u,e);var d=t.getOSDTime();i&&(null==t.emit||t.emit.call(t,A.API.snapshot,F({fileName:e,base64:u,currentOSD:d}))),null==(f=t.logger)||f.log("snapshot GetCanvasCapture end:",(new Date).getTime()),s(g({fileName:e,base64:u,currentOSD:d}))}}));1!==l&&s(g(null,-1,"截图失败"))}))}function ze(t,e){Je(function(t){void 0===t&&(t="");for(var e=t.split(","),a=atob(e[1]),r=e[0].replace("data:","").replace(";base64",""),i=a.length,n=new Uint8Array(i);i--;)n[i]=a.charCodeAt(i);return new File([n],"file",{type:r})}(t),e)}var Ke={.5:3,1:1,2:2,4:4,8:6,16:8,32:10};Date.prototype.Format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?e[a]:("00"+e[a]).substr((""+e[a]).length)));return t};var qe=function(t,e){var a=new RegExp("(\\?|#|&)"+t+"=(.*?)(#|&|$)"),r=(e||window.location.href).match(a);return decodeURIComponent(r?r[2]:"")},Qe=function(t,e){var a=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),r=e.match(a);return null!=r?unescape(r[2]):null};function $e(){return $e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},$e.apply(this,arguments)}function ta(t,e,a){var r=t.reduce((function(t,e,a){return 0===a?(null==e||delete e.coverPic,t.push($e({},e)),t):(t[t.length-1].downloadPath===e.downloadPath?t[t.length-1].endTime=e.endTime:(null==e||delete e.coverPic,t.push($e({},e))),t)}),[]);return r.length>0&&(r[0].startTime=e.valueOf(),r[r.length-1].endTime=a.valueOf()),r}function ea(t){var e=t.wasmplayer;e&&e.JSPlayM4_CloseStream(),t.playing=!1}function aa(){return aa=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},aa.apply(this,arguments)}function ra(t,e,a,r){var i,n,s,x,o,f=(x=(s=e).split("?")[0].replace("/live","").replace("/playback",""),(o=(s.includes("/live")?"/live?":s.includes("cloudplayback")?"/cloudplayback?":"/playback?")+s.split("?")[1]).includes("/playback")&&(o=o.replace("stream=2","stream=1")),{websocketConnectUrl:x,websocketStreamingParam:o});if(f.websocketConnectUrl){var l,_=null!=(l=null==(n=t._options)||null==(i=n.env)?void 0:i.wsUrl)?l:f.websocketConnectUrl;sa(t,_,{playURL:f.websocketStreamingParam}).then((function(){return a(0)}),(function(e){t.logger.error("play error: ",e),t.emit(C,F(e)),r(1)}))}}function ia(t){var e=t._options.url;return t.service.getRealPlayUrl({ezopen:t._options.url}).then((function(a){var r=a.realUrl,i=Qe("checkCode",r);return i&&(t._validateCode=i),r.includes("playback")?function(t,e,a){var r,i=l(Qe("begin",e)||Qe("begin",a)||l().format("YYYY-MM-DD 00:00:00")),n=l(Qe("end",e)||Qe("end",a)||l().format("YYYY-MM-DD 23:59:59")),s=Qe("end",e)||Qe("end",a),x=+qe("timeZone",a);x<24&&x>-24?x=Math.round(x):(x=0,t.logger.warn("timeZone时区参数错误，取值范围为-23~23"));var o=l(i).add(x,"hour"),f=s?l(n).add(x,"hour"):l(l(o).format("YYYYMMDD 23:59:59"));o>=f&&(f=l(l(o).format("YYYYMMDD 23:59:59")),t.logger.warn("End time greater than or equal to start time"));var _,h="YYYYMMDDTHHmmss";e=e.replace("&begin="+qe("begin",e),""),e=e+"&begin="+o.format(h)+"Z",function(t,e){var a=l(t).startOf("day"),r=l(e).startOf("day");return!a.isSame(r)}(o,f)&&"cloud"===t.urlInfo.recType&&(f=l(l(o).format("YYYYMMDD 23:59:59")),t.logger.warn("The start and end times have crossed days"));e=e.replace("&end="+qe("end",e),""),e=e+"&end="+f.format(h)+"Z",qe("stream",e)||(e=e.replace("stream","&stream"));return"cloud"===t.urlInfo.recType&&"7"===(null==(r=t.urlInfo.searchParams)?void 0:r.busType)?function(t,e){return new Promise((function(a,r){t.service.getRecordCloudVideoByTime(e).then((function(e){t.emit(A.NETWORK.videoFragmentFiles,F(e.data||[],"云录制录像信息查询","RecordCloud")),a(e)})).catch((function(e){t.emit(A.NETWORK.error.error,F(e)),t.emit(A.NETWORK.error.videoFragmentFiles,F(e)),r(e)}))}))}(t,{channelNo:t.urlInfo.channelNo,startTime:l(l(o).format("YYYY-MM-DD 00:00:00")).valueOf(),endTime:l(l(f).format("YYYY-MM-DD 23:59:59")).valueOf(),spaceId:null==(_=t.urlInfo.searchParams)?void 0:_.spaceId}).then((function(t){var a=f;t.data.length>0&&l(t.data[t.data.length-1].endTime)<l(f)&&(a=l(t.data[t.data.length-1].endTime));var r=JSON.stringify(ta(t.data,o,a)).replace("\\","");return e+="&recSlice="+r.replace("\\","")+"&r="+Math.random()})):"cloud"===t.urlInfo.recType?te(t,{recType:1,channelNo:t.urlInfo.channelNo,startTime:l(l(o).format("YYYY-MM-DD 00:00:00")).valueOf(),endTime:l(l(f).format("YYYY-MM-DD 23:59:59")).valueOf()}).then((function(t){var a=f;t.data.length>0&&l(t.data[t.data.length-1].endTime)<l(f)&&(a=l(t.data[t.data.length-1].endTime));var r=JSON.stringify(ta(t.data,o,a)).replace("\\","");return e+="&recSlice="+r.replace("\\","")+"&r="+Math.random()})):(te(t,{recType:2,channelNo:t.urlInfo.channelNo,startTime:l(l(o).format("YYYY-MM-DD 00:00:00")).valueOf(),endTime:l(l(f).format("YYYY-MM-DD 23:59:59")).valueOf()}),Promise.resolve(e))}(t,r,e):Promise.resolve(r)}))}var na="";function sa(t,e,a,r){var i,n;return null==(n=t._playerWindow)||null==(i=n.reRenderCanvas)||i.call(n,!0),t.playing=!1,t.__videoInfo={},t.__audioInfo={},t._wss_info={wssUrl:e,oParams:a},new Promise((function(e,a){var r;(na="",t._oStreamClient.stopAll(),null===t._g_port)&&((null==(r=t._options)?void 0:r.debugDownloadData)&&t.wasmplayer.JSPlayM4_DownloadData(),t._g_port=t.wasmplayer.JSPlayM4_GetPort(),t.logger.log("1.获取播放库端口号 g_port:"+t._g_port));/^ws[s]?:\/\//.test(t._wss_info.wssUrl)?(t.emit(T,F({type:D.openStreamCallback,data:null})),xa(t).then(e,a)):(t.logger.error("wssUrl:",t._wss_info.wssUrl),a("Socket stream address invalid!"))}))}function xa(t,e){var a=!0,r=!0,i=0;return new Promise((function(n,s){oa(t),t.playing=!0,t._oStreamClient.openStream(t._wss_info.wssUrl,t._wss_info.oParams,(function(s){if(s.errorCode&&"1"!=s.errorCode&&t.emit(A.SOCKET.autoClose),null==s?void 0:s.bHead){var x;if(t.emit(T,F({type:D.getStreamHeaderCallback})),"resume"!==e&&function(t,e){var a=t.wasmplayer,r=a.JSPlayM4_OpenStream(e,40,4194304);t.emit("PlayM4_openStream",F(e)),t.setStreamInfoCallBackType(t._options.streamInfoCBType),void 0!==t._options.decodeEngine&&t.wasmplayer.JSPlayM4_SetDecodeEngine(t._options.decodeEngine);a.JSPlayM4_SetFirstFrameCallBack(1,(function(e){var a=e.decodeEngine;t.emit(T,F({type:D.firstFrameCallback,decodeEngine:a}))})),a.JSPlayM4_SetRunTimeInfoCallbackType(1,1024,1),a.JSPlayM4_SetRunTimeInfoCallbackType(2,352321537,1),a.JSPlayM4_SetRunTimeInfoCallbackType(4,262144,1);var i=0;t&&t.on("seek",(function(t){i=t.data.startTime.replace(/[TZ]/gi,"")}));a.JSPlayM4_SetRunTimeInfoCallBackEx(2,(function(e){var a,r,c,u,d=Date.now();1024===e.nErrorCode&&e.nFrameNum>0&&(e.nFrameNumInterval&&(o+=e.nFrameNumInterval),d-h>=3e3&&(t.emit(T,F({type:D.stutterDetectedCallback,data:{type:1,frameNumInterval:e.nFrameNum-f,frameLossNum:o}})),f=e.nFrameNum,h=d,o=0),t.emit(T,F({type:D.stutterDetectedCallback,data:{type:1,pstRuntimeInfo:e,errorTime:l(i||(null==t||null==(r=t.urlInfo)||null==(a=r.searchParams)?void 0:a.begin)||l().format("YYYYMMDD000000"))}})));(352321537===e.nErrorCode&&(n>0&&e.nAverageDecodeTime&&(x+=Math.floor(e.nAverageDecodeTime),s++),d-_>=1e3&&(n>0?(t.emit(T,F({type:D.stutterDetectedCallback,data:{type:2,runtimeInfo:e,averageDecodeTime:x,account:s}})),x=0,s=0):n++,_=d)),262144===e.nErrorCode)&&t.emit(T,F({type:D.stutterDetectedCallback,data:{type:4,pstRuntimeInfo:e,errorTime:l(i||(null==t||null==(u=t.urlInfo)||null==(c=u.searchParams)?void 0:c.begin)||l().format("YYYYMMDD000000"))}}));if(t){var p,m,S=t.getOSDTime();i=i||(Number.isNaN(S)?0:1e3*S),t.emit(T,F({type:D.setRunTimeInfoCallBack,data:{pstRuntimeInfo:e,errorTime:l(i||(null==t||null==(m=t.urlInfo)||null==(p=m.searchParams)?void 0:p.begin)||l().format("YYYYMMDD000000"))}})),i=0}}));var n=-3,s=0,x=0,o=0,f=0,_=0,h=0,c=48;function u(t){var e={};if(t)for(var a=c,r=0;r<1500&&!(a+28>t.additionDataBuffer.length);r++){var i={id:-1,x:0,y:0,type:0,viewAngleH:0,viewAngleV:0,r:0,r_max:0,north:0,res0:0,res1:0,res2:0};i.id=parseInt(t.additionDataBuffer[a])>244?parseInt(t.additionDataBuffer[a])+256:parseInt(t.additionDataBuffer[a]),i.x=t.additionDataBuffer[a+2],i.y=t.additionDataBuffer[a+4],i.type=t.additionDataBuffer[a+6],i.viewAngleH=t.additionDataBuffer[a+8],i.viewAngleV=t.additionDataBuffer[a+10],i.r=t.additionDataBuffer[a+12],i.r_max=t.additionDataBuffer[a+14],i.res0=t.additionDataBuffer[a+7],a+=28,e[i.id]=i}return e}a.JSPlayM4_SetAdditionDataCallBack(2052,1,(function(e){t&&t.emit(T,F({type:D.setAdditionDataCallBack,data:{additionInfo:aa({},e,{additionDataBufferView:new Int32Array(e.additionDataBuffer)}),labelMap:u(e)}}))})),t.logger.log("3.打开流 resO:"+r)}(t,s.buf),t._aHead=new Uint8Array(s.buf),(null==t||null==(x=t.urlInfo)?void 0:x.validateCode)||t._secretKey){var o,f,_,h=(null==t||null==(o=t.urlInfo)?void 0:o.validateCode)||t._secretKey;if(1==+(null==(f=t.wasmplayer)?void 0:f.JSPlayM4_SetSecretKey(h)))null==(_=t.logger)||_.log("set secretKey success, ",h);else t.logger.error("set secretKey fail, ",h)}if("resume"!==e){if(1!=+t.wasmplayer.JSPlayM4_SetFrameInfoCallBack(1)){var c=t.wasmplayer.JSPlayM4_GetLastError();t.logger.error("resFrameInfoError:",c)}a=!0,r=!0,t.emit("JSPlayM4_Play_Before",F(void 0));var u,d=t.wasmplayer.JSPlayM4_Play(t._playerWindow.canvasId);if(t._options.disableRenderPrivateData)t.wasmplayer.JSPlayM4_RenderPrivateData(1,!1),t.wasmplayer.JSPlayM4_RenderPrivateData(2,!1),t.wasmplayer.JSPlayM4_RenderPrivateData(4,!1),t.wasmplayer.JSPlayM4_RenderPrivateData(8,!1),t.wasmplayer.JSPlayM4_RenderPrivateData(16,!1),t.wasmplayer.JSPlayM4_RenderPrivateData(32,!1),t.wasmplayer.JSPlayM4_RenderPrivateData(64,!1),t.wasmplayer.JSPlayM4_RenderPrivateData(128,!1),null==(u=t.logger)||u.log("disable render private data");else t.wasmplayer.JSPlayM4_RenderPrivateData(4,1),t.wasmplayer.JSPlayM4_RenderPrivateData(8,1),t.wasmplayer.JSPlayM4_RenderPrivateData(32,1),t.wasmplayer.JSPlayM4_RenderPrivateData(64,1),t.wasmplayer.JSPlayM4_RenderPrivateData(128,1);t.emit("JSPlayM4_Play_After",F(void 0)),t.logger.log("4.开始播放 resP:"+d,t._playerWindow.canvasId),n(d)}}else{if(r&&s.buf&&(r=!1,t.emit(T,F({type:D.getVideoStreamCallback}))),a&&s.buf){var p=t.getFrameInfo();(null==p?void 0:p.width)&&(t.emit(T,F({type:D.appearFirstFrameCallback})),t.emit(T,F({type:D.averageStreamSuccessCallback})),a=!1,t.playing=!0)}var m=new Uint8Array(s.buf);s.statusString?t.emit(T,F({type:D.pluginErrorHandler,iWndIndex:0,code:1001,data:s})):s.type&&"exception"===s.type&&t.emit(T,F({type:D.pluginErrorHandler,iWndIndex:0,code:1002,data:s})),i+=m.length,t.wasmplayer.JSPlayM4_InputData(m,m.length),m=null}t.emit("recordInputData",F(s.buf))}),(function(e){na===e&&t&&(t.emit(T,F({type:D.pluginErrorHandler,iWndIndex:0,code:1003})),t.emit(A.SOCKET.close)),t.playing=!1,oa(t),s()}),(function(e,a){t&&(null==t||t.emit(T,F({type:D.pluginErrorHandler,iWndIndex:0,code:1004,msg:a})),null==t||t.emit(A.SOCKET.error))})).then((function(a){na=a,t._oStreamClient.startPlay().then((function(){var a;if("resume"===e){var r,i,x=null==(i=t.wasmplayer)||null==(r=i.JSPlayM4_Pause)?void 0:r.call(i,0);x?(t.playing=!0,t._tempPauseDate=null,n(x)):(t.logger.error("startPlay pause error"),s())}else{var o,f,l=null==(f=t.wasmplayer)||null==(o=f.JSPlayM4_SetStreamOpenMode)?void 0:o.call(f,1);t.logger.log("2.设置流模式 resSSOM:"+l)}t.emit(A.API.play),(null==t||null==(a=t._options)?void 0:a.url.includes(".rec"))&&(null==t?void 0:t._playbackRate)>0&&setTimeout((function(){t.setPlaybackRate(t._playbackRate||1)}),1e3)})).catch((function(e){t.playing=!1,t.logger.error("startPlay error:",e),oa(t),s(e.oError)})),t._detectTimer=setInterval((function(){t.emit(T,F({type:D.stutterDetectedCallback,data:{type:5,codeRate:(8*i/1e3).toFixed(2)}})),i=0}),1e3)}),(function(e){oa(t),t.playing=!1,t.logger.error("openStream error:",e),ea(t),s(e)}))}))}function oa(t){t._detectTimer&&(clearInterval(t._detectTimer),t._detectTimer=null)}function fa(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function la(t){return(t=+t)<10&&(t="0"+t),t+""}var _a={startPos:{fX:.1,fY:.1},fontColor:{fR:0,fG:0,fB:0,fA:1},fontSize:{nFontWidth:20,nFontHeight:20},fontRotate:{fRotateAngle:0,fFillFullScreen:!1},fontFamily:"Arial",fontNumber:{nRowNumber:5,nColNumber:5},space:1,fontAlign:0,pstCanvasAdapt:{nCanvasAdaptMode:2,nRowSpace:0,nColSpace:0,nBaseCanvasWidth:0,nBaseCanvasHeight:0}};function ha(){return ha=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},ha.apply(this,arguments)}function ca(t,e,a){return e&&function(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,e),t}function ua(){return ua=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},ua.apply(this,arguments)}function da(t,e){return da=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},da(t,e)}var pa=function(e){function a(t){var a;return(a=e.call(this)||this).event=null,a.initializing=!0,a.loading=!1,a.playbackRate=1,a.playing=!1,a.volume=0,a.destroyed=!1,a.deviceCapacity={},a.deviceInfo={},a.error=null,a._aHead=null,a._detectTimer=null,a._g_port=null,a._secretKey="",a._tempPauseDate=null,a._tempPauseTime="",a._playbackRate=1,a.__videoInfo={},a.__audioInfo={},a._waterMarkParams=null,a._decoderStatus={},a._wss_info={wssUrl:"",oParams:{playURL:""}},a._setOptions(t),a.event={on:a.on.bind(a),emit:a.emit.bind(a),off:a.off.bind(a),once:a.once.bind(a),removeAllListeners:a.removeAllListeners.bind(a)},a._playerWindow=new ne({container:a.$container,id:a._options.id,dpr:a._options.dpr,player:a}),a._playerInit(),a._addEventListener(),a}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&da(t,e)}(a,e);var r=a.prototype;return r._playerInit=function(){var t,e=this;return(t=this,t.logger.log("player engine start init"),_e(t).then((function(e){return t.logger.log("player engine init success"),e}))).then((function(t){return e._wasmDecoderInfo=t,"loaded"===t.cmd&&e._options.autoPlay&&e.play(),t}))},r.play=function(t){var e=this;return this.loading=!0,this._destroyed(),t&&this._setOptions(null!=t?t:{}),new Promise((function(t,a){var r;(r=e,r._playerWindow.hide(),new Promise((function(t,e){r._options.accessToken&&p(r._options.url)?r._oStreamClient._streamUUID?r.stop().then((function(){ia(r).then((function(a){ra(r,a,t,e)})).catch((function(t){r.logger.error("play error: ",t),r.emit(C,F(t)),e(t)}))})).catch((function(t){e(t)})):ia(r).then((function(a){ra(r,a,t,e)})).catch((function(t){r.logger.error("play error: ",t),r.emit(C,F(t)),e(t)})):e(1)}))).then((function(){e._options.audio&&setTimeout((function(){e.setVolume(.8)}),100),e.loading=!1,t(0)})).catch((function(){e.loading=!1,a(1)}))}))},r._wss_play=function(t,e,a){var r=this;return void 0===e&&(e={playURL:""}),this._destroyed(),new Promise((function(a,i){var n=setInterval((function(){window.JSPlayerModuleLoaded&&(clearInterval(n),sa(r,t,e).then((function(t){a(t)})).catch((function(t){i(t)})))}),50)}))},r.pause=function(t){return function(t,e){if(!t.playing)return t._tempPauseDate?Promise.resolve(g(new Date(t._tempPauseDate),0)):Promise.reject(g(void 0,-1,"当前不是播放状态，不需要暂停"));t._detectTimer&&(clearInterval(t._detectTimer),t._detectTimer=null);var a=t.getFrameInfo(),r=new Date(a.year+"/"+a.month+"/"+a.day+" "+a.hour+":"+a.minute+":"+a.second).getTime()/1e3,i=new Date(1e3*r);return t._tempPauseDate=i.valueOf(),t._tempPauseTime=""+a.year+la(a.month)+la(a.day)+la(a.hour)+la(a.minute)+la(a.second),new Promise((function(a,r){e?t.stop().then((function(){a(g(i,0,"暂停成功"))})).catch((function(t){r(g(i,-1,"暂停失败"))})):(t._oStreamClient.stopAll(),1==+t.wasmplayer.JSPlayM4_Pause(1)?(t.playing=!1,a(g(i))):r(g(i,-1,"暂停失败"))),t.emit("pause",F(void 0))}))}(this,t)},r.resume=function(t){return this._destroyed(),function(t,e){var a=t._tempPauseTime,r=t._tempPauseDate,i=t._wss_info;if(t.playing)return Promise.resolve();var n=!1;return new Promise((function(s,x){var o,f,l;e&&(a?a=a.slice(0,14-e.length)+e:(n=!0,a=e)),(null==(o=i.oParams)?void 0:o.playURL.includes("playback"))&&(i.oParams.playURL=null==i||null==(f=i.oParams)?void 0:f.playURL.replace(/begin=[0-9]{8}T[0-9]{6}Z/gi,"begin="+a.slice(0,8)+"T"+a.slice(8,14)+"Z")),i.oParams.playURL.includes("cloudplayback")&&(i.oParams.playURL=null==i||null==(l=i.oParams)?void 0:l.playURL.replace(/"startTime":[0-9]{13}/gi,'"startTime":'+r)),t.emit(A.API.resume,F(e)),e&&!n?t._wss_play(null==i?void 0:i.wssUrl,null==i?void 0:i.oParams).then((function(e){t._waterMarkParams&&t.setWaterMark(t._waterMarkParams),s(e)})).catch((function(t){x(t)})):xa(t,"resume").then((function(e){t._waterMarkParams&&t.setWaterMark(t._waterMarkParams),s(e)})).catch((function(t){x(t)}))}))}(this,t)},r.destroy=function(){return function(t){var e,a,r,i,n,s;if(t._detectTimer&&(clearInterval(t._detectTimer),t._detectTimer=null),t._oStreamClient&&(null==(e=t._oStreamClient)||e.destroy(),t._oStreamClient=null,null==(a=t.logger)||a.log("[destroy] StreamClient destroy")),t.wasmplayer&&(null==t.wasmplayer.JSPlayM4_Stop||t.wasmplayer.JSPlayM4_Stop.call(t.wasmplayer),null==(r=t.logger)||r.log("[destroy] stop")),ea(t),t.wasmplayer)try{var x,o,f;null==(o=t.wasmplayer)||null==(x=o.JSPlayM4_FreePort)||x.call(o),t.wasmplayer=null,null==(f=t.logger)||f.log("[destroy] free port")}catch(e){var l,_;null==(_=t.logger)||null==(l=_.error)||l.call(_,"[destroy] free port",e)}return t._g_port=null,t.pluginManager&&(t.pluginManager.destroy(),t.pluginManager=null,null==(i=t.logger)||i.log("[destroy] plugin destroy")),t._playerWindow&&(null==t._playerWindow.destroy||t._playerWindow.destroy.call(t._playerWindow),t._playerWindow=null,null==(n=t.logger)||n.log("[destroy] window destroy")),t.esCanvas&&(Ne(t),null==(s=t.logger)||s.log("[destroy] esCanvas destroy")),setTimeout((function(){t&&(t.emit(A.API.destroy),t.removeAllListeners(),t.event&&(t.event=null))}),0),t.__videoInfo={},t.__audioInfo={},t.destroyed=!0,Promise.resolve()}(this)},r._destroyed=function(){return function(t){if(t.destroyed)throw new Error("player is destroyed!")}(this)},r.stop=function(t){return void 0===t&&(t=!1),function(t,e){void 0===e&&(e=!1),t.playing=!1;var a,r=t.wasmplayer;return e||(t._playerWindow.hide(),t.wasmplayer&&(null==t.wasmplayer.JSPlayM4_Stop||t.wasmplayer.JSPlayM4_Stop.call(t.wasmplayer),null==(a=t.logger)||a.log("[destroy] stop"),ea(t))),t.playbackRate=1,t._detectTimer&&(clearInterval(t._detectTimer),t._detectTimer=null),new Promise((function(a,i){if(e)try{Ze(t,"","jpeg",0,!1,!1,!0).then((function(e){var a,r;if(t.logger.log("保留最后一帧....",null==(a=e.data)?void 0:a.base64),!t.destroyed&&!t.playing){var i,n,s,x=null==(r=t.$container)?void 0:r.querySelector(".ezplayer-poster-img");x||(x=t.$container),x&&null===t.fECCorrect._correctType&&((null==(i=e.data)?void 0:i.base64)?fa(x,HTMLImageElement)?x.src=null==(n=e.data)?void 0:n.base64:(x.style.backgroundImage="url("+(null==(s=e.data)?void 0:s.base64)+")",x.style.backgroundSize="100% 100%"):fa(x,HTMLImageElement)||(x.style.backgroundImage="none"))}}))}catch(e){t.logger.warn("保留最后一帧....",e)}setTimeout((function(){t._oStreamClient&&t._oStreamClient.stopAll().then((function(){t.emit("stop",F(void 0)),t.emit("JSPlayM4_Stop",F(void 0));var e=r.JSPlayM4_Stop(!1);if(1===e)ea(t),a({resS:e});else{var i=r.JSPlayM4_GetLastError();if(35==+i)var n=setInterval((function(){e?clearInterval(n):1==+(e=r.JSPlayM4_Stop(!1))?(ea(t),a({resS:e})):(i=r.JSPlayM4_GetLastError(),t.logger.error("JSPlayM4_Stop error: ",i))}),50);else t.logger.error("stop - other error, still resolve: ",i),ea(t),a({resS:e,jsPluginErrorCode:i})}})).catch((function(e){ea(t);var a=r.JSPlayM4_GetLastError();t.logger.error("JSPlayM4_Stop error: ",a),i({jsPluginErrorCode:a})}))}),100)}))}(this,t)},r.snapshot=function(t,e,a,r,i){return void 0===e&&(e="jpeg"),Ze(this,t,e,0,r,!0,i)},r.snapshotByCanvas=function(t,e,a){return void 0===e&&(e="jpeg"),je(this,t,e,a)},r.resize=function(t,e){return function(t,e,a){var r=t._options.dpr||1,i="";/^\d+(\.\d+)?$/.test(e+"")?i+="width: "+e+"px;":e&&(i+="width: "+e+";"),/^\d+(\.\d+)?$/.test(a+"")?i+="height: "+a+"px;":a&&(i+="height: "+a+";"),t.$container&&(t.$container.style.cssText+=i);var n,s=t.$container.clientWidth,x=t.$container.clientHeight;if(s<16||x<16)return Promise.reject();if(t._playerWindow&&t.wasmplayer)try{null==t.wasmplayer.JSPlayM4_SetCanvasSize||t.wasmplayer.JSPlayM4_SetCanvasSize.call(t.wasmplayer,s*r,x*r)}catch(e){var o;null==(o=t.logger)||o.error("[engine] [resize] error:",e)}return t&&(null==t||t.emit("resize",F({width:x,height:x}))),t.logger&&(null==(n=t.logger)||n.log("[engine] [resize] width: "+x+"  height: "+x+" dpr: "+r)),Promise.resolve({width:e,height:a})}(this,t,e)},r.setVolume=function(t){return function(t,e){var a=0;return e<0||e>1?(t.logger.warn("audio volume ("+e+") is invalid!"),0):(0===e?1===(a=t.wasmplayer.JSPlayM4_StopSoundShare())&&(t.volume=0):1===(a=t.wasmplayer.JSPlayM4_PlaySoundShare())&&(t.volume=e),t.emit(A.volumeChange,F(e)),a)}(this,t)},r.use=function(t){this.pluginManager.use(t)},r.setFECCorrectType=function(t,e){return this.fECCorrect.setFECCorrectType(t,e)},r.setFEC2DParam=function(t,e){return this.fECCorrect.setFEC2DParam(t,e)},r.setFEC3DViewParam=function(t){return this.fECCorrect.setFEC3DViewParam(t)},r.get3DViewParam=function(t){return this.fECCorrect.get3DViewParam(t)},r.setPoster=function(t){},r.setPlaybackRate=function(t){!function(t,e){var a,r;if(e=+e,Number.isNaN(e))throw new Error("rate is error, only support 0.5 | 1 | 2 | 4 | 8 | 16 | 32");if(![.5,1,2,4,8,16,32].includes(e))throw new Error("rate is error, only support  0.5 | 1 | 2 | 4 | 8 | 16 | 32");null==(r=t._oStreamClient)||null==(a=r.setPlayRate)||a.call(r,Ke[e]);var i,n,s,x,o,f,l=t.playbackRate;if(l>e)for(var _=e;_<l;){var h,c;_*=2,null==(c=t.wasmplayer)||null==(h=c.JSPlayM4_Slow)||h.call(c)}else if(l<e)for(var u=l;u<e;){var d,p;u*=2,null==(p=t.wasmplayer)||null==(d=p.JSPlayM4_Fast)||d.call(p)}+e>=4&&(null==(n=t.wasmplayer)||null==(i=n.JSPlayM4_SetDecodeThreadNum)||i.call(n,4)),+e>=8?null==(x=t.wasmplayer)||null==(s=x.JSPlayM4_SetDecodeFrameType)||s.call(x,1):null==(f=t.wasmplayer)||null==(o=f.JSPlayM4_SetDecodeFrameType)||o.call(f,0),t.emit(A.API.rateChange,F(e)),t.playbackRate=e,t._playbackRate=e}(this,t)},r.seek=function(t,e){return function(t,e,a){return t.wasmplayer,t.emit(A.API.seek,F({startTime:e,endTime:a})),t._oStreamClient.seek(e,a).then((function(e){t._waterMarkParams&&t.setWaterMark(t._waterMarkParams)})),Promise.resolve()}(this,t,e)},r._setOptions=function(t){ee(this,t)},r.enable3DZoom=function(t){return function(t,e){if(!t.playing)return-1;var a=t.wasmplayer,r=null==a.JSPlayM4_GetFrameInfo?void 0:a.JSPlayM4_GetFrameInfo.call(a);return new Promise((function(e,i){e({code:0,data:null==a.JSPlayM4_SetDisplayRegion?void 0:a.JSPlayM4_SetDisplayRegion.call(a,t._playerWindow.canvasId,0,r.width,0,r.height,!1,!0)})})),t.__fCallback=e,t.esCanvas=new ke(t.$container),t.esCanvas.setShapeType("Rect"),t.esCanvas.setDrawStyle("#ff0000","",0),t.esCanvas.setDrawStatus(!0,(function(t){"function"==typeof e&&e(t)})),t.__b3DZoom=!0,0}(this,t)},r.disable3DZoom=function(){return Ne(this)},r.getOSDTime=function(){var t=this.getFrameInfo();return(null==t?void 0:t.year)?new Date((null==t?void 0:t.year)+"/"+(null==t?void 0:t.month)+"/"+(null==t?void 0:t.day)+" "+(null==t?void 0:t.hour)+":"+(null==t?void 0:t.minute)+":"+(null==t?void 0:t.second)).getTime()/1e3:0},r.getFrameInfo=function(){var t,e,a,r,i,n=null==(e=this.wasmplayer)||null==(t=e.JSPlayM4_GetFrameInfo)?void 0:t.call(e);if(!n)return null==(i=this.logger)||i.warn("[getFrameInfo] error",n),{};var s=ae[null==n?void 0:n.codecType];return n.videoFormatName=s,(null==n?void 0:n.width)>0&&(null==n?void 0:n.height)>0&&((null==(a=this.__videoInfo)?void 0:a.width)!==(null==n?void 0:n.width)||(null==(r=this.__videoInfo)?void 0:r.height)!==(null==n?void 0:n.height))&&(n.videoFormatName||(n.videoFormatName=this.__videoInfo.videoFormatName),n.frameRate||(n.frameRate=this.__videoInfo.frameRate),this.__videoInfo=ua({},this.__videoInfo,n),this.emit(A.videoInfo,F(this.__videoInfo))),n},r.setDisplayRegion=function(t,e,a,r,i,n){void 0===i&&(i=!0),void 0===n&&(n=!1);var s=function(t,e,a,r,i,n,s){void 0===n&&(n=!0),void 0===s&&(s=!1);var x=t.wasmplayer,o=t.getFrameInfo(),f=t._playerWindow.canvasId,l=document.getElementById(f);if(l){var _=function(t){return{width:(null==t?void 0:t.style.width)?+(null==t?void 0:t.style.width.replace("px","")):t.width||t.offsetWidth,height:(null==t?void 0:t.style.height)?+(null==t?void 0:t.style.height.replace("px","")):t.height||t.offsetHeight}}(l);t._options.dpr;var h=_.width,c=_.height;return s&&(c=_.width,h=_.height),null==t||t.emit("setDisplayRegion",F({left:e,right:a,top:r,bottom:i,flag:n,isFullscreen:s})),x.JSPlayM4_SetDisplayRegion(f,h*e/o.width,h*a/o.width,c*r/o.height,c*i/o.height,!n,!1)}}(this,t,e,a,r,i,n);return 1===s},r.setSecretKey=function(t){null!=t&&""!==t&&(this._secretKey=t)},r.getOptions=function(){return this._options},r.setLogger=function(e){var a,r;this._options=t(this._options,{logger:e},{clone:!1}),null==(r=this.logger)||null==(a=r.setOptions)||a.call(r,e)},r.getVersion=function(){var t=this.wasmplayer.JSPlayM4_GetSDKVersion();return{version:"8.2.5",decoder:this._wasmDecoderInfo.bSupHardOrSoft?"V3":"V1",decoderVersion:t.toString(16)}},r.setWaterMark=function(e){return this._waterMarkParams=e,function(e,a){var r=e.wasmplayer,i=e.$container.getBoundingClientRect(),n=i.width,s=i.height,x={nCanvasAdaptMode:2,nRowSpace:0,nColSpace:0,nBaseCanvasWidth:Math.floor(n),nBaseCanvasHeight:Math.floor(s)};return a=t.all([{},_a,a||{},{pstCanvasAdapt:x}],{clone:!1}),new Promise((function(t,e){var i;1===(i=a&&a.fontString?r.JSPlayM4_SetWaterMarkFont({pFontString:a.fontString,pstStartPos:a.startPos,pstFontColor:a.fontColor,pstFontSize:a.fontSize,pstFontRotate:a.fontRotate,pstFontNumber:a.fontNumber,pFontFamily:a.fontFamily,pSpace:a.space,pstCanvasAdapt:a.pstCanvasAdapt}):r.JSPlayM4_SetWaterMarkFont(null))?t({code:0,msg:"水印设置成功"}):e({code:-1,msg:i})}))}(this,e)},r.setAntialias=function(t){return this.wasmplayer.JSPlayM4_SetAntialias(t)},r.setGlobalBaseTime=function(t){return function(t,e){return t.wasmplayer.JSPlayM4_SetGlobalBaseTime(e.year,e.month,e.day,e.hour,e.min,e.sec,e.ms)}(this,t)},r.setMirrorFlip=function(t){return function(t,e){var a;return t.service.setMirrorFlip({command:e,channelNo:null==(a=t.urlInfo)?void 0:a.channelNo})}(this,t)},r.setStreamInfoCallBackType=function(t,e){!function(t,e,a){var r,i,n,s;[0,1].includes(e)?t.wasmplayer?t.wasmplayer.JSPlayM4_SetStreamInfoCallBack(e,(function(e){null==a||a(e),t.emit(A.streamInfoCB,F({systemFormat:e.nSystemformat,videoFormat:e.nVideoformat,videoFormatName:ae[e.nVideoformat],audioFormat:e.nAudioformat,audioFormatName:re[e.nAudioformat],audioChannels:e.nAudiochannels,audioBitsPerSample:e.nAudiobitspersample,audioSamplesRate:e.nAudiosamplesrate,audioBitRate:e.nAudiobitrate,width:e.nWidth,height:e.nHeight,frameRate:e.fFrameRate,intervalOfIFrame:e.nIntervalOfIFrame})),e.nWidth>0&&e.nHeight>0&&(t.__videoInfo.width!==e.nWidth||t.__videoInfo.height!==e.nHeight||t.__videoInfo.frameRate!==e.fFrameRate||t.__videoInfo.videoFormatName!==ae[e.nVideoformat])&&(t.__videoInfo={videoFormat:e.nVideoformat,videoFormatName:ae[e.nVideoformat],width:e.nWidth,height:e.nHeight,frameRate:e.fFrameRate,intervalOfIFrame:e.nIntervalOfIFrame},t.emit(A.videoInfo,F(ha({},t.__videoInfo,{from:"setStreamInfoCallBack"})))),t.__audioInfo.audioFormat===e.nAudioformat&&t.__audioInfo.audioChannels===e.nAudiochannels&&t.__audioInfo.audioBitsPerSample===e.nAudiobitspersample&&t.__audioInfo.audioSamplesRate===e.nAudiosamplesrate&&t.__audioInfo.audioBitRate===e.nAudiobitrate||(t.__audioInfo={audioFormat:e.nAudioformat,audioFormatName:re[e.nAudioformat],audioChannels:e.nAudiochannels,audioBitsPerSample:e.nAudiobitspersample,audioSamplesRate:e.nAudiosamplesrate,audioBitRate:e.nAudiobitrate},t.emit(A.audioInfo,F(t.__audioInfo)))})):null==(i=t.logger)||null==(r=i.warn)||r.call(i,"player.wasmplayer is not defined"):null==(s=t.logger)||null==(n=s.warn)||n.call(s,"type "+e+" not supported")}(this,t,e)},r._addEventListener=function(){var t,e,a,r,i=this;this.on(A.videoInfo,(t=function(t){t.data.width&&t.data.height&&i._playerWindow.resize(t.data.width,t.data.height)},e=500,a=null,r=0,function(){for(var i=this,n=arguments.length,s=new Array(n),x=0;x<n;x++)s[x]=arguments[x];var o=Date.now(),f=e-(o-r);f<=0?(r=o,t.apply(this,s)):a||(a=setTimeout((function(){r=Date.now(),a=null,t.apply(i,s)}),f))})),this.on("Control.contentRerender",(function(t){t.width&&t.height&&i._waterMarkParams&&i.setWaterMark(i._waterMarkParams)}))},ca(a,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]),a}(f);function ma(t,e,a){return e&&function(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(t.prototype,e),t}function Sa(){return Sa=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},Sa.apply(this,arguments)}pa.EVENT_TYPE=A,pa.version="8.2.5";var Ra=function(){function t(t){var e=t.szId;delete t.szId,this.iWidth=t.iWidth,this.iHeight=t.iHeight,this.player=new pa(Sa({},t,{decoderType:!0===t.isCloudRecord?"v1":t.decoderType||"auto",id:e})),this.i18n=this.player.i18n,this.downloadRecord=t.downloadRecord,this._recordPlugin=new _({downloadRecord:this.downloadRecord}),this.player.use(this._recordPlugin),this.nWidth=0,this.nHeight=0,this.oStreamClient=this.player._oStreamClient,this.g_port=0,this._initEventCallback()}var e=t.prototype;return e._initEventCallback=function(){var t=this;this.player.on(T,(function(e){var a,r,i,n,s,x,o,f,l,_,h,c;(e.data.type===D.openStreamCallback&&(null==(a=t.EventCallback)?void 0:a.openStreamCallback)&&t.EventCallback.openStreamCallback(),e.data.type===D.pluginErrorHandler&&(null==(r=t.EventCallback)?void 0:r.pluginErrorHandler)&&t.EventCallback.openStreamCallback(e.data.iWndIndex,e.data.code,e.data.data),e.data.type===D.getStreamHeaderCallback&&(null==(i=t.EventCallback)?void 0:i.getStreamHeaderCallback)&&t.EventCallback.getStreamHeaderCallback(),e.data.type===D.getVideoStreamCallback&&(null==(n=t.EventCallback)?void 0:n.getVideoStreamCallback)&&t.EventCallback.getVideoStreamCallback(),e.data.type===D.appearFirstFrameCallback&&(null==(s=t.EventCallback)?void 0:s.appearFirstFrameCallback)&&t.EventCallback.appearFirstFrameCallback(),e.data.type===D.firstFrameCallback&&(null==(x=t.EventCallback)?void 0:x.firstFrameCallback)&&t.EventCallback.firstFrameCallback(e.data.decodeEngine),e.data.type===D.averageStreamSuccessCallback&&(null==(o=t.EventCallback)?void 0:o.averageStreamSuccessCallback)&&t.EventCallback.averageStreamSuccessCallback(),e.data.type===D.pluginErrorHandler&&(null==(f=t.EventCallback)?void 0:f.pluginErrorHandler))&&t.EventCallback.pluginErrorHandler(e.data.iWndIndex,e.data.code,null==(c=e.data)?void 0:c.data);e.data.type===D.setRunTimeInfoCallBack&&(null==(l=t.EventCallback)?void 0:l.setRunTimeInfoCallBack)&&t.EventCallback.setRunTimeInfoCallBack(e.data.data),e.data.type===D.stutterDetectedCallback&&(null==(_=t.EventCallback)?void 0:_.stutterDetectedCallback)&&t.EventCallback.stutterDetectedCallback(e.data.data),e.data.type===D.setAdditionDataCallBack&&(null==(h=t.EventCallback)?void 0:h.setAdditionDataCallBack)&&t.EventCallback.setAdditionDataCallBack(e.data.data)}))},e.JSPlayM4_SetDecodeEngine=function(t){this.useHard=t},e.JS_Play=function(t,e,a,r,i){return void 0===t&&(t=""),void 0===e&&(e={playURL:""}),this.player._wss_play(t,e,a,r,i)},e.JS_SetSecretKey=function(t,e){this.secretKey=e,this.player.setSecretKey(e)},e.JS_OpenSound=function(){return this.player.setVolume(.8)},e.JS_CloseSound=function(){return this.player.setVolume(0)},e.JS_Enable3DZoom=function(t,e){return this.player.enable3DZoom(e,t)},e.JSPlayM4_SetDisplayRegion=function(t,e,a,r){var i=this;new Promise((function(n,s){n({code:0,data:window["wasmplayer-"+i.szId].JSPlayM4_SetDisplayRegion(i.szId+"-player",t,e,a,r,!1,!0)})}))},e.JS_Disable3DZoom=function(){return this.player.disable3DZoom(fCallback,iWin)},e.JS_StartSave=function(t,e,a){return void 0===t&&(t=""+(new Date).getTime()),this._recordPlugin.startRecord(t,e,a)},e.JS_StopSave=function(t){return void 0===t&&(t=!0),this._recordPlugin.stopRecord(t)},e._JSPlayM4_GetFrameInfo=function(){return this.player.getFrameInfo()},e._JSPlayM4_SetDisplayRegion=function(t,e,a,r,i,n){return this.player.setDisplayRegion(t,e,a,r,!0,n)},e.JS_CapturePicture=function(t,e,a,r,i,n){var s=this;return new Promise((function(t,a){s.player.snapshot(e,"jpeg","base",i,n).then((function(e){0===e.code?("function"==typeof r&&r({fileName:e.data.fileName,base64:e.data.base64}),t(Sa({},e,{code:1}))):a(e)}))}))},e.JS_GetOSDTime=function(){return Promise.resolve(this.player.getOSDTime())},e.JS_Resize=function(t,e){this.player.resize(t,e)},e.JS_GetSDKVersion=function(){return this.player.getVersion().decoderVersion},e.JS_Stop=function(t){return this.player.stop(t)},e.JS_DestroyWorker=function(){this.player.destroy()},e.JS_Speed=function(t){this.player.setPlaybackRate(3!=+t?t:.5)},e.JS_Seek=function(t,e,a){return this.player.seek(e,a)},e.JS_Pause=function(t,e){var a=this;return new Promise((function(t,r){a.player.pause(e).then((function(e){t({pauseDate:e.pauseDate,code:1,msg:null==e?void 0:e.msg})}),(function(){r()}))}))},e.JS_Resume=function(t){return this.player.resume(t)},e.JS_FECCorrectType=function(t,e){return this.player.setFECCorrectType(t,e)},e.JS_FECSetParam2D=function(t,e){return this.player.setFEC2DParam(t,e)},e.FEC_Set3DViewParam=function(t){return this.player.setFEC3DViewParam(t)},e.FEC_Get3DViewParam=function(t){return this.player.get3DViewParam(t)},e.JS_SetWaterMarkFont=function(t){return this.player.setWaterMark(t)},e.JS_SetGlobalBaseTime=function(t){this.player.setGlobalBaseTime(t)},e.JS_SetAntialias=function(t){return this.player.setAntialias(t)},ma(t,[{key:"bPlay",get:function(){return this.player.playing}},{key:"iRate",get:function(){return this.player.playbackRate}},{key:"playURL",get:function(){return this.player._wss_info.oParams.playURL},set:function(t){this.player._wss_info=Sa({},this.player._wss_info,{oParams:{playURL:t}})}},{key:"FECSplitIds",get:function(){return this.player.fECCorrect._FECSplitIds},set:function(t){this.player.fECCorrect._FECSplitIds=t}},{key:"correctType",get:function(){return this.player.fECCorrect._correctType},set:function(t){this.player.fECCorrect._correctType=t}}]),t}();export{Ra as default};
